import{be as et,dj as le,d as E,r as f,G as tt,w as nt,X as at,b4 as lt,c as ot,o as G,b as a,e as x,f as c,m as l,v as H,g as oe,Z as ie,t as it,bb as rt,F as ut,a$ as _,aZ as st}from"./main-Ct-cOeg8.js";import{D as j,a as b,g as dt,h as ct,v as pt,i as mt,l as gt,e as U,n as ft,o as ht,w as vt,p as bt,q as yt,c as xt,r as St,s as wt,x as re,u as ue}from"./data-grid-DKUNlWAv.js";import{D as Ct}from"./load-panel-CvubkHiW.js";import{D as S}from"./tabs-Djfj3Wyv.js";import{e as Dt}from"./export_data_grid-3CWIRf6c.js";import{r as Y,b3 as Et,R as Bt,e as se,T as _t,s as It}from"./overlay-13VzdNFH.js";import{av as kt,aw as Rt,z as Tt,L as Ft}from"./m_select_box-C5o2mfAR.js";import{ae as At}from"./m_row_dragging-HGH9sKes.js";import{n as N}from"./notify-Du6b7w0H.js";import{e as Ot}from"./exceljs.min-Cn748wQI.js";import{s as Mt}from"./FileSaver-CQu8bA20.js";import{_ as Nt}from"./kullanici-ekle.vue_vue_type_script_setup_true_lang-DeKuZJ_P.js";import{D as R}from"./button-CyZkkiim.js";import{p as $t,a as k}from"./editor-DpHBKwSy.js";import"./list.edit.decorator.swipe-BiR5V9hO.js";import{S as $}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{V as Pt}from"./VCardText-BZLgaicz.js";import{V as F,a as zt}from"./VCard-C_065gsn.js";import{a as Kt}from"./VOverlay-C4hY1w65.js";import{_ as Lt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./themes-pU--lpmJ.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./validators-BwBNGiur.js";import"./helpers-BGv4x_9E.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-B8j2sCVE.js";import"./focus-BuUhN7Vj.js";import"./VSelect-Ca-P5LPC.js";import"./VTextField-BV0ZqzlM.js";/* empty css                   */import"./VCounter-D0O2rp3f.js";import"./VImg-Boy2iGVc.js";import"./VField-F-RhcOp-.js";import"./easing-Bybner-F.js";import"./VInput-BGideHSu.js";import"./form-ChCww0pi.js";import"./forwardRefs-C-GTDzx5.js";import"./VList-7XCEG9jg.js";import"./ssrBoot-CwL6LQ8M.js";import"./VAvatar-DUugVa62.js";import"./VDivider-BibceQOS.js";import"./dialog-transition-B7hjrvOH.js";import"./VMenu-DtYH3taR.js";import"./scopeId-BnxrN3KV.js";import"./VCheckboxBtn-JLJPngP_.js";import"./VSelectionControl-DGXIaHOi.js";import"./VChip-COCjw8Os.js";import"./VSlideGroup-BTyn2lNq.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-CF2_0pIY.js";import"./VDialog-kI1XmkJU.js";import"./VForm-D3-qd3z8.js";import"./VRow-BfCrrdmd.js";/* empty css              */import"./VCol-CC8YbPqG.js";import"./m_popover-Bu_B1CtJ.js";import"./delay-4G3CWm1H.js";import"./lazy-CGNsHgSe.js";const Vt="dx-list-reorder-handle-container",de="dx-list-reorder-handle",Gt="dx-list-item-ghost-reordering";class Ht extends Rt{_init(){const r=this._list,{grouped:v,itemDragging:m}=this._list.option();this._groupedEnabled=v,this._lockedDrag=!1;const B=this._groupedEnabled?"> .dx-list-items > .dx-list-group > .dx-list-group-body > .dx-list-item":"> .dx-list-items > .dx-list-item";this._sortable=r._createComponent(r._scrollView.content(),At,et({component:r,contentTemplate:null,allowReordering:!1,filter:B,container:r.$element().get(0),dragDirection:m!=null&&m.group?"both":"vertical",handle:`.${de}`,dragTemplate:this._dragTemplate,onDragStart:i=>{this._dragStartHandler(i)},onDragChange:i=>{this._dragChangeHandler(i)},onReorder:i=>{this._reorderHandler(i)}},m))}afterRender(){this._sortable.update()}_dragTemplate(r){const v=Y(r.itemElement).clone().addClass(Gt).addClass("dx-state-hover");return Et(v,Bt(r.itemElement)),v}_dragStartHandler(r){this._lockedDrag&&(r.cancel=!0)}_dragChangeHandler(r){this._groupedEnabled&&le(r.fromIndex)&&le(r.toIndex)&&!this._sameParent(r.fromIndex,r.toIndex)&&(r.cancel=!0)}_sameParent(r,v){const m=this._list.getItemElementByFlatIndex(r);return this._list.getItemElementByFlatIndex(v).parent().get(0)===m.parent().get(0)}_reorderHandler(r){const v=this._list.getItemElementByFlatIndex(r.toIndex);this._list.reorderItem(Y(r.itemElement),v)}afterBag(r){const v=Y("<div>").addClass(de);se.on(v,_t.down,(m=>{this._lockedDrag=!It(m)})),se.on(v,Tt.name,{timeout:30},(m=>{m.cancel=!0,this._lockedDrag=!1})),r.$container.addClass(Vt).append(v)}}kt("reorder","default",Ht);/*!
 * devextreme-vue
 * Version: 25.1.5
 * Build date: Wed Sep 03 2025
 *
 * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file in the root of the project for details.
 *
 * https://github.com/DevExpress/devextreme-vue
 */const pe={props:{accessKey:String,activeStateEnabled:Boolean,allowItemDeleting:Boolean,bounceEnabled:Boolean,collapsibleGroups:Boolean,dataSource:[Array,Object,String],disabled:Boolean,displayExpr:[Function,String],elementAttr:Object,focusStateEnabled:Boolean,grouped:Boolean,groupTemplate:{},height:[Number,String],hint:String,hoverStateEnabled:Boolean,indicateLoading:Boolean,itemDeleteMode:String,itemDragging:Object,itemHoldTimeout:Number,items:Array,itemTemplate:{},keyExpr:[Function,String],menuItems:Array,menuMode:String,nextButtonText:String,noDataText:String,onContentReady:Function,onDisposing:Function,onGroupRendered:Function,onInitialized:Function,onItemClick:Function,onItemContextMenu:Function,onItemDeleted:Function,onItemDeleting:Function,onItemHold:Function,onItemRendered:Function,onItemReordered:Function,onItemSwipe:Function,onOptionChanged:Function,onPageLoading:Function,onPullRefresh:Function,onScroll:Function,onSelectAllValueChanged:Function,onSelectionChanged:Function,onSelectionChanging:Function,pageLoadingText:String,pageLoadMode:String,pulledDownText:String,pullingDownText:String,pullRefreshEnabled:Boolean,refreshingText:String,repaintChangesOnly:Boolean,rtlEnabled:Boolean,scrollByContent:Boolean,scrollByThumb:Boolean,scrollingEnabled:Boolean,searchEditorOptions:Object,searchEnabled:Boolean,searchExpr:[Array,Function,String],searchMode:String,searchTimeout:Number,searchValue:String,selectAllMode:String,selectAllText:String,selectByClick:Boolean,selectedItemKeys:Array,selectedItems:Array,selectionMode:String,showScrollbar:String,showSelectionControls:Boolean,tabIndex:Number,useNativeScrolling:Boolean,visible:Boolean,width:[Number,String]},emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:allowItemDeleting":null,"update:bounceEnabled":null,"update:collapsibleGroups":null,"update:dataSource":null,"update:disabled":null,"update:displayExpr":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:grouped":null,"update:groupTemplate":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:indicateLoading":null,"update:itemDeleteMode":null,"update:itemDragging":null,"update:itemHoldTimeout":null,"update:items":null,"update:itemTemplate":null,"update:keyExpr":null,"update:menuItems":null,"update:menuMode":null,"update:nextButtonText":null,"update:noDataText":null,"update:onContentReady":null,"update:onDisposing":null,"update:onGroupRendered":null,"update:onInitialized":null,"update:onItemClick":null,"update:onItemContextMenu":null,"update:onItemDeleted":null,"update:onItemDeleting":null,"update:onItemHold":null,"update:onItemRendered":null,"update:onItemReordered":null,"update:onItemSwipe":null,"update:onOptionChanged":null,"update:onPageLoading":null,"update:onPullRefresh":null,"update:onScroll":null,"update:onSelectAllValueChanged":null,"update:onSelectionChanged":null,"update:onSelectionChanging":null,"update:pageLoadingText":null,"update:pageLoadMode":null,"update:pulledDownText":null,"update:pullingDownText":null,"update:pullRefreshEnabled":null,"update:refreshingText":null,"update:repaintChangesOnly":null,"update:rtlEnabled":null,"update:scrollByContent":null,"update:scrollByThumb":null,"update:scrollingEnabled":null,"update:searchEditorOptions":null,"update:searchEnabled":null,"update:searchExpr":null,"update:searchMode":null,"update:searchTimeout":null,"update:searchValue":null,"update:selectAllMode":null,"update:selectAllText":null,"update:selectByClick":null,"update:selectedItemKeys":null,"update:selectedItems":null,"update:selectionMode":null,"update:showScrollbar":null,"update:showSelectionControls":null,"update:tabIndex":null,"update:useNativeScrolling":null,"update:visible":null,"update:width":null},computed:{instance(){return this.$_instance}},beforeCreate(){this.$_WidgetClass=Ft,this.$_hasAsyncTemplate=!0,this.$_expectedChildren={item:{isCollectionItem:!0,optionName:"items"},itemDragging:{isCollectionItem:!1,optionName:"itemDragging"},menuItem:{isCollectionItem:!0,optionName:"menuItems"},searchEditorOptions:{isCollectionItem:!1,optionName:"searchEditorOptions"}}}};$t(pe);const jt=E(pe),me={emits:{"update:isActive":null,"update:hoveredElement":null,"update:location":null,"update:name":null,"update:options":null},props:{location:String,name:String,options:Object}};k(me);const W=E(me);W.$_optionName="buttons";W.$_isCollectionItem=!0;W.$_expectedChildren={options:{isCollectionItem:!1,optionName:"options"}};const ge={emits:{"update:isActive":null,"update:hoveredElement":null,"update:x":null,"update:y":null},props:{x:Number,y:Number}};k(ge);const Ut=E(ge);Ut.$_optionName="cursorOffset";const fe={emits:{"update:isActive":null,"update:hoveredElement":null,"update:badge":null,"update:disabled":null,"update:html":null,"update:icon":null,"update:showChevron":null,"update:template":null,"update:text":null,"update:visible":null},props:{badge:String,disabled:Boolean,html:String,icon:String,showChevron:Boolean,template:{},text:String,visible:Boolean}};k(fe);const he=E(fe);he.$_optionName="items";he.$_isCollectionItem=!0;const ve={emits:{"update:isActive":null,"update:hoveredElement":null,"update:allowDropInsideItem":null,"update:allowReordering":null,"update:autoScroll":null,"update:boundary":null,"update:container":null,"update:cursorOffset":null,"update:data":null,"update:dragDirection":null,"update:dragTemplate":null,"update:dropFeedbackMode":null,"update:elementAttr":null,"update:filter":null,"update:group":null,"update:handle":null,"update:height":null,"update:itemOrientation":null,"update:moveItemOnDrop":null,"update:onAdd":null,"update:onDisposing":null,"update:onDragChange":null,"update:onDragEnd":null,"update:onDragMove":null,"update:onDragStart":null,"update:onInitialized":null,"update:onOptionChanged":null,"update:onRemove":null,"update:onReorder":null,"update:rtlEnabled":null,"update:scrollSensitivity":null,"update:scrollSpeed":null,"update:width":null},props:{allowDropInsideItem:Boolean,allowReordering:Boolean,autoScroll:Boolean,boundary:{},container:{},cursorOffset:[Object,String],data:{},dragDirection:String,dragTemplate:{},dropFeedbackMode:String,elementAttr:Object,filter:String,group:String,handle:String,height:[Number,String],itemOrientation:String,moveItemOnDrop:Boolean,onAdd:Function,onDisposing:Function,onDragChange:Function,onDragEnd:Function,onDragMove:Function,onDragStart:Function,onInitialized:Function,onOptionChanged:Function,onRemove:Function,onReorder:Function,rtlEnabled:Boolean,scrollSensitivity:Number,scrollSpeed:Number,width:[Number,String]}};k(ve);const be=E(ve);be.$_optionName="itemDragging";be.$_expectedChildren={cursorOffset:{isCollectionItem:!1,optionName:"cursorOffset"}};const ye={emits:{"update:isActive":null,"update:hoveredElement":null,"update:action":null,"update:text":null},props:{action:Function,text:String}};k(ye);const xe=E(ye);xe.$_optionName="menuItems";xe.$_isCollectionItem=!0;const Se={emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:disabled":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:icon":null,"update:onClick":null,"update:onContentReady":null,"update:onDisposing":null,"update:onInitialized":null,"update:onOptionChanged":null,"update:rtlEnabled":null,"update:stylingMode":null,"update:tabIndex":null,"update:template":null,"update:text":null,"update:type":null,"update:useSubmitBehavior":null,"update:validationGroup":null,"update:visible":null,"update:width":null},props:{accessKey:String,activeStateEnabled:Boolean,disabled:Boolean,elementAttr:Object,focusStateEnabled:Boolean,height:[Number,String],hint:String,hoverStateEnabled:Boolean,icon:String,onClick:Function,onContentReady:Function,onDisposing:Function,onInitialized:Function,onOptionChanged:Function,rtlEnabled:Boolean,stylingMode:String,tabIndex:Number,template:{},text:String,type:String,useSubmitBehavior:Boolean,validationGroup:String,visible:Boolean,width:[Number,String]}};k(Se);const Yt=E(Se);Yt.$_optionName="options";const we={emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:buttons":null,"update:disabled":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:inputAttr":null,"update:isDirty":null,"update:isValid":null,"update:label":null,"update:labelMode":null,"update:mask":null,"update:maskChar":null,"update:maskInvalidMessage":null,"update:maskRules":null,"update:maxLength":null,"update:mode":null,"update:name":null,"update:onChange":null,"update:onContentReady":null,"update:onCopy":null,"update:onCut":null,"update:onDisposing":null,"update:onEnterKey":null,"update:onFocusIn":null,"update:onFocusOut":null,"update:onInitialized":null,"update:onInput":null,"update:onKeyDown":null,"update:onKeyUp":null,"update:onOptionChanged":null,"update:onPaste":null,"update:onValueChanged":null,"update:placeholder":null,"update:readOnly":null,"update:rtlEnabled":null,"update:showClearButton":null,"update:showMaskMode":null,"update:spellcheck":null,"update:stylingMode":null,"update:tabIndex":null,"update:text":null,"update:useMaskedValue":null,"update:validationError":null,"update:validationErrors":null,"update:validationMessageMode":null,"update:validationMessagePosition":null,"update:validationStatus":null,"update:value":null,"update:valueChangeEvent":null,"update:visible":null,"update:width":null},props:{accessKey:String,activeStateEnabled:Boolean,buttons:Array,disabled:Boolean,elementAttr:Object,focusStateEnabled:Boolean,height:[Number,String],hint:String,hoverStateEnabled:Boolean,inputAttr:{},isDirty:Boolean,isValid:Boolean,label:String,labelMode:String,mask:String,maskChar:String,maskInvalidMessage:String,maskRules:{},maxLength:[Number,String],mode:String,name:String,onChange:Function,onContentReady:Function,onCopy:Function,onCut:Function,onDisposing:Function,onEnterKey:Function,onFocusIn:Function,onFocusOut:Function,onInitialized:Function,onInput:Function,onKeyDown:Function,onKeyUp:Function,onOptionChanged:Function,onPaste:Function,onValueChanged:Function,placeholder:String,readOnly:Boolean,rtlEnabled:Boolean,showClearButton:Boolean,showMaskMode:String,spellcheck:Boolean,stylingMode:String,tabIndex:Number,text:String,useMaskedValue:Boolean,validationError:{},validationErrors:Array,validationMessageMode:String,validationMessagePosition:String,validationStatus:String,value:String,valueChangeEvent:String,visible:Boolean,width:[Number,String]}};k(we);const Ce=E(we);Ce.$_optionName="searchEditorOptions";Ce.$_expectedChildren={button:{isCollectionItem:!0,optionName:"buttons"}};const qt={class:"informer"},Wt={class:"count"},Jt={class:"grids mt-4"},Zt={class:"list-container"},q="/api/users",ce="roleColorsV4",Xt=E({__name:"kullanicilar",setup(De){document.title="OFT - Kullanıcılar";const r=f([]),v=f([]),m=f(null),B=f(!1),i=f(null);f([]);const T=f([]),w=f([]),C=f([]),P=f(null),z=f(null),A=f(!0),J=f(0),K=f(null),L=f(!1),V=f(""),Z=e=>{V.value=e,L.value=!0},X=()=>{L.value=!1,V.value=""},Ee=e=>{if(e.rowType==="group")return;const t=e.row.data;i.value=t;let n=[];(i.value.roles||"").split(",").forEach(s=>{n.push({name:s.trim()})}),T.value=n,O()},O=async()=>{if(i.value)try{Z("İzinler yükleniyor...");const{data:e}=await _.get(`/api/users/${i.value.id}/permissions`);C.value=e.assigned,w.value=e.available}finally{X()}},Be=async e=>{var t,n,o,s;try{const d=e.itemData;if(!i.value||!d)return;C.value.push(d),w.value=w.value.filter(u=>u.id!==d.id),C.value=[...C.value],w.value=[...w.value],(n=(t=z.value)==null?void 0:t.instance)==null||n.refresh(),(s=(o=P.value)==null?void 0:o.instance)==null||s.refresh(),_.post(`/api/users/${i.value.id}/permissions/${d.id}`)}catch(d){console.error("İzin atama işlemi başarısız oldu:",d)}},_e=async e=>{var n,o,s,d;const t=e.itemData;!i.value||!t||(w.value.push(t),C.value=C.value.filter(u=>u.id!==t.id),C.value=[...C.value],w.value=[...w.value],(o=(n=z.value)==null?void 0:n.instance)==null||o.refresh(),(d=(s=P.value)==null?void 0:s.instance)==null||d.refresh(),await _.delete(`/api/users/${i.value.id}/permissions/${t.id}`))},Q=()=>{const e=r.value.map(t=>Number(t.id)||0);return e.length?Math.max(...e):0},Ie=async()=>{K.value=Q(),i.value=null,B.value=!0},ke=async()=>{if(!i.value){N("Lütfen düzenlemek için bir satır seçin","warning",1500);return}B.value=!0},Re=async()=>{if(!i.value)return;const e=$.mixin({customClass:{confirmButton:"btn btn-primary",cancelButton:"btn btn-error"},buttonsStyling:!0});e.fire({title:"Emin misiniz?",text:"İstersen sonra yine değiştirirsin :)",icon:"warning",showCancelButton:!0,confirmButtonColor:"#88efb3",cancelButtonColor:"#ed9595",reverseButtons:!0,confirmButtonText:"Evet, yap gitsin!",cancelButtonText:"Hayır, vazcaydım!"}).then(t=>{t.isConfirmed?(qe(i.value.id,i.value.AKTIF),e.fire({confirmButtonColor:"#88efb3",title:"Durum değiştirildi!",text:"Yoksa pişman mı oldun :)",icon:"success"})):t.dismiss===$.DismissReason.cancel&&e.fire({confirmButtonColor:"#88efb3",title:"Vazgeçildi",text:"Birşey yapmadım merak etmeyin :)",icon:"error"})})},Te=async()=>{if(!i.value)return;const e=$.mixin({customClass:{confirmButton:"btn btn-primary",cancelButton:"btn btn-error"},buttonsStyling:!0});e.fire({title:"Emin misiniz?",text:"Şifre sıfırlanacak!!!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#88efb3",cancelButtonColor:"#ed9595",reverseButtons:!0,confirmButtonText:"Evet, yap gitsin!",cancelButtonText:"Hayır, vazcaydım!"}).then(async t=>{t.isConfirmed?await je(i.value.id)?e.fire({confirmButtonColor:"#88efb3",title:"Şifre Sıfırlandı!",text:"pass1234",icon:"success"}):e.fire({confirmButtonColor:"#88efb3",title:"Hata",text:"Şifre sıfırlanamadı",icon:"error"}):t.dismiss===$.DismissReason.cancel&&e.fire({confirmButtonColor:"#88efb3",title:"Vazgeçildi",text:"Birşey yapmadım merak etmeyin :)",icon:"error"})})},Fe=async e=>{Ve(e),await D()},Ae=async e=>{Ge(e),await D()},Oe=async e=>{var n,o;const t=(n=m.value)==null?void 0:n.instance;J.value=((o=t==null?void 0:t.getDataSource())==null?void 0:o.totalCount())??0},Me={placeholder:"Sütun ara"},D=async()=>{var e,t;try{Z("Veri yükleniyor...");const n=await _.get(q,{params:{_:Date.now()}});r.value=n.data.data,v.value=n.data.kademeler,N("Veri başarıyla alındı","success",1500),await st(),(t=(e=m.value)==null?void 0:e.instance)==null||t.refresh()}catch(n){console.error("Error fetching data:",n),N("Kullanıcılar verisi alınamadı","error",1500)}finally{X()}},Ne=(e,t)=>{const n=(t.data.roles||"").split(",");e.className="d-flex gap-2",n.forEach(o=>{const s=o.trim(),d=Le(s),u=document.createElement("span");u.textContent=d.label,u.style.display="inline-block",u.style.padding="2px 8px",u.style.borderRadius="8px",u.style.backgroundColor=d.bg,u.style.color=d.fg,u.style.fontSize="12px",e.appendChild(u)})},M=new Map,ee=[10,28,45,60,80,100,120,140,160,180,200,220,240,260,280,300,320,340];function $e(){try{const e=localStorage.getItem(ce);if(!e)return;const t=JSON.parse(e);Object.entries(t).forEach(([n,o])=>M.set(n,o))}catch{}}function Pe(){try{const e={};M.forEach((t,n)=>{e[n]=t}),localStorage.setItem(ce,JSON.stringify(e))}catch{}}function te(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return Math.abs(t)}function ze(e,t,n){t/=100,n/=100;const o=(1-Math.abs(2*n-1))*t,s=o*(1-Math.abs(e/60%2-1)),d=n-o/2;let u=0,h=0,p=0;0<=e&&e<60?(u=o,h=s,p=0):60<=e&&e<120?(u=s,h=o,p=0):120<=e&&e<180?(u=0,h=o,p=s):180<=e&&e<240?(u=0,h=s,p=o):240<=e&&e<300?(u=s,h=0,p=o):(u=o,h=0,p=s);const g=Math.round((u+d)*255),y=Math.round((h+d)*255),I=Math.round((p+d)*255);return{r:g,g:y,b:I}}function Ke(e,t,n){return(e*299+t*587+n*114)/1e3}function Le(e){const t=e||"—",n=M.get(t);if(n)return{...n,label:e||t};const o=ee[te(t)%ee.length],s=46,d=80,u=te(t),h=u%11-5,p=Math.floor(u/7)%9-4,g=ne(s+h,40,56),y=ne(d+p,76,84),I=`hsl(${o}, ${g}%, ${y}%)`,{r:Je,g:Ze,b:Xe}=ze(o,g,y),Qe=Ke(Je,Ze,Xe)>=140?"#111":"#fff",ae={bg:I,fg:Qe};return M.set(t,ae),Pe(),{...ae,label:e||t}}$e();function ne(e,t,n){return Math.min(n,Math.max(t,e))}const Ve=e=>{e.promise=new Promise(async(t,n)=>{try{const o={...e.oldData,...e.newData};await _.put(`${q}/${e.key}`,o),await D(),e.component.cancelEditData(),t()}catch(o){console.error("Error updating data:",o),n()}})},Ge=e=>{e.promise=new Promise(async(t,n)=>{try{await _.delete(`${q}/${e.key}`),await D(),e.component.cancelEditData(),t()}catch(o){console.error("Error deleting data:",o),n()}})};tt(async()=>{await D();const e=async t=>{var d,u,h;const n=t.detail,o=(n==null?void 0:n.id)??((d=i.value)==null?void 0:d.id);if(!o)return;await D();const s=r.value.find(p=>p.id===o);if(s){i.value=s;const p=(s.roles||"").split(",");T.value=p.map(g=>({name:g.trim()})).filter(g=>g.name),await O(),(h=(u=m.value)==null?void 0:u.instance)==null||h.option("focusedRowKey",o)}};window.addEventListener("user-updated",e)}),nt(B,(e,t)=>{!e&&t&&(async()=>{var o,s,d,u,h;await D();const n=Q();if(K.value!==null&&n>K.value){const p=r.value.find(g=>Number(g.id)===n);if(p){i.value=p,(s=(o=m.value)==null?void 0:o.instance)==null||s.option("focusedRowKey",p.id),N("Kullanıcı eklendi","success",1500);const g=(p.roles||"").split(",");T.value=g.map(y=>({name:y.trim()})).filter(y=>y.name),await O()}}else{const p=(d=i.value)==null?void 0:d.id;if(p){const g=r.value.find(y=>y.id===p);if(g){i.value=g;const y=(g.roles||"").split(",");T.value=y.map(I=>({name:I.trim()})).filter(I=>I.name),await O(),(h=(u=m.value)==null?void 0:u.instance)==null||h.option("focusedRowKey",p)}}}})()});const He=at(()=>{const e=i.value||{};return{id:e.id||0,name:e.name||"",email:e.email||"",unvan:e.unvan||"",ismerkezi:e.ismerkezi_id||"",istasyon:e.istasyon_id||"",proses:e.proses||"",tip:e.tip||"",roles:e.roles||""}}),je=async e=>{try{return await _.put(`/api/users/sifresifirla/${e}`),!0}catch(t){return console.error("Şifre sıfırlama hatası:",t),!1}},Ue=()=>{A.value=!A.value},Ye=lt("userData"),qe=async(e,t)=>{try{const n=await _.put(`/api/users/durumdegistir/${e}`,{userID:Ye.value.id,aktif:parseInt(t)});await D()}catch(n){console.error("Durum değiştirilirken hata oluştu: ",n)}},We=e=>{const t=new Ot.Workbook,n=t.addWorksheet("Kullanicilar");Dt({component:e.component,worksheet:n,autoFilterEnabled:!0}).then(()=>{t.xlsx.writeBuffer().then(o=>{Mt(new Blob([o],{type:"application/octet-stream"}),"Kullanicilar.xlsx")})}),e.cancel=!0};return(e,t)=>(G(),ot(ut,null,[a(F,{class:"mt-0 pa-0 pt-0"},{default:c(()=>[a(Pt,{class:"pa-1 ma-2 mt-0"},{default:c(()=>[a(l(j),{id:"gridusers","data-source":r.value,"key-expr":"id","show-borders":!0,ref_key:"dataGridRef",ref:m,onRowUpdating:Fe,onRowRemoving:Ae,"focused-row-enabled":!0,"column-auto-width":!1,"row-alternation-enabled":!0,onExporting:We,"allow-column-reordering":!0,onFocusedRowChanged:Ee,"allow-column-resizing":!0,"column-resizing-mode":"widget",onContentReady:Oe},{aktifTemplate:c(({data:n})=>[n.value==="0"||n.value===0||n.value===!1?(G(),oe(ie,{key:0,size:"20",icon:"tabler-x"})):(G(),oe(ie,{key:1,size:"20",icon:"tabler-check"}))]),totalRecordTemplate:c(()=>[x("div",qt,[x("div",Wt,H(J.value),1),t[2]||(t[2]=x("span",null,"Toplam Kayıt",-1))])]),yenileTemplate:c(()=>[a(l(R),{icon:"refresh","styling-mode":"text",hint:"Yenile",id:"sayim"})]),menuYenileTemplate:c(()=>t[3]||(t[3]=[x("div",{style:{display:"flex","align-items":"center"}},[x("i",{class:"dx-icon dx-icon-refresh"}),x("span",{style:{"margin-inline-start":"8px"}},"Yenile")],-1)])),collapseTemplate:c(()=>[a(l(R),{icon:A.value?"collapse":"expand",hint:"expandAll ? 'Daralt' : 'Genişlet'",width:"40",height:"40","styling-mode":"text",onClick:Ue},null,8,["icon"])]),addUserTemplate:c(()=>[a(l(R),{"styling-mode":"text",hint:"Kullanıcı Ekle",text:"Kullanıcı Ekle",onClick:Ie})]),editUserTemplate:c(()=>[a(l(R),{"styling-mode":"text",disabled:!i.value,hint:"Kullanıcı Düzenle",text:"Düzenle",onClick:ke},null,8,["disabled"])]),toggleActiveTemplate:c(()=>[a(l(R),{"styling-mode":"text",disabled:!i.value,hint:"Aktif/Pasif Yap",text:"Aktif/Pasif",onClick:Re},null,8,["disabled"])]),resetPasswordTemplate:c(()=>[a(l(R),{"styling-mode":"text",disabled:!i.value,hint:"Şifreyi Sıfırla",text:"Şifreyi Sıfırla",onClick:Te},null,8,["disabled"])]),default:c(()=>[a(l(b),{"data-field":"AKTIF",caption:"AKTİF","data-type":"boolean",visible:!0,width:70,"cell-template":"aktifTemplate"}),a(l(b),{"data-field":"id",caption:"ID","allow-editing":!1,visible:!0,width:"70"}),a(l(b),{"data-field":"name",caption:"İSİM","allow-editing":!0,visible:!0,"validation-rules":[{type:"required"}],width:"170"}),a(l(b),{"data-field":"unvan",caption:"ÜNVAN","validation-rules":[{type:"required"}],width:"150"}),a(l(b),{"data-field":"email",caption:"E-POSTA","allow-editing":!1,visible:!0,width:"150"}),a(l(b),{"data-field":"email_verified_at",caption:"ONAY TARİHİ","data-type":"date","allow-editing":!1,width:150,visible:!0,alignment:"center",format:{formatter:n=>new Intl.DateTimeFormat("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(n)).replace(/\//g,".")}},null,8,["format"]),a(l(b),{"data-field":"roles",caption:"ROLLER","cell-template":Ne,width:"350"}),a(l(b),{"data-field":"proses",caption:"PROSES",width:"200"}),a(l(b),{"data-field":"tip",caption:"KADEME","validation-rules":[{type:"required"}],width:"150"}),a(l(b),{"data-field":"ismerkezi_id",caption:"İş Merkezi",width:"150"}),a(l(b),{"data-field":"istasyon_id",caption:"İş İstasyonu",width:"150"}),a(l(dt),{"auto-expand-all":A.value},null,8,["auto-expand-all"]),a(l(ct),{visible:!0}),a(l(pt),{"allow-updating":!1,"allow-adding":!1,"allow-deleting":!1,mode:"row","use-icons":!0}),a(l(mt),{visible:!0}),a(l(gt),{visible:!0,width:240,placeholder:"Ara..."}),a(l(Ct),{enabled:!0}),a(l(U),{mode:"virtual","row-rendering-mode":"virtual","show-scrollbar":"always"}),a(l(ft),{enabled:!0,"allow-export-selected-data":!1}),a(l(ht),{height:"540px",enabled:!0,mode:"select",title:"Sütun Seçici"},{default:c(()=>[a(l(vt),{my:"right top",at:"right bottom",of:".dx-datagrid-column-chooser-button"}),a(l(bt),{enabled:!0,"editor-options":Me}),a(l(yt),{"allow-select-all":!0,"select-by-click":!0,recursive:!0})]),_:1}),a(l(xt),null,{default:c(()=>[a(l(S),{location:"before",name:"groupPanel"}),a(l(S),{location:"before","locate-in-menu":"auto",template:"collapseTemplate"}),a(l(S),{location:"before",template:"totalRecordTemplate"}),a(l(S),{location:"after","locate-in-menu":"auto",template:"yenileTemplate","menu-item-template":"menuYenileTemplate",onClick:t[0]||(t[0]=n=>D())}),a(l(S),{location:"after","locate-in-menu":"auto",template:"addUserTemplate"}),a(l(S),{location:"after","locate-in-menu":"auto",template:"editUserTemplate"}),a(l(S),{location:"after","locate-in-menu":"auto",template:"resetPasswordTemplate"}),a(l(S),{name:"exportButton"}),a(l(S),{name:"columnChooserButton"}),a(l(S),{name:"searchPanel"})]),_:1}),a(l(St),null,{default:c(()=>[a(l(wt),{"align-by-column":!0,column:"id","summary-type":"count","display-format":"{0} adet",alignment:"right"})]),_:1})]),_:1},8,["data-source"])]),_:1})]),_:1}),x("div",Jt,[x("div",Zt,[a(F,{class:"pa-2"},{default:c(()=>[a(zt,null,{default:c(()=>t[4]||(t[4]=[it("Atanmış Roller")])),_:1,__:[4]}),t[5]||(t[5]=x("hr",null,null,-1)),a(l(jt),{"data-source":T.value},{item:c(({data:n})=>[x("div",null,[x("div",null,H(n.name),1)])]),_:1},8,["data-source"])]),_:1,__:[5]})]),a(F,{class:"perm-card"},{default:c(()=>[a(l(j),{class:"perm-grid","data-source":w.value,"show-borders":!0,"repaint-changes-only":!0,"key-expr":"id",height:"100%",ref_key:"availableGridRef",ref:P},{default:c(()=>[a(l(re),{enabled:!1}),a(l(U),{mode:"virtual","row-rendering-mode":"virtual","show-scrollbar":"always"}),a(l(ue),{group:"permissionsGroup","on-add":_e}),a(l(b),{"data-field":"name",caption:"Atanmamış İzinler"})]),_:1},8,["data-source"])]),_:1}),a(F,{class:"perm-card"},{default:c(()=>[a(l(j),{class:"perm-grid","data-source":C.value,"show-borders":!0,"repaint-changes-only":!0,"key-expr":"id",height:"100%",ref_key:"assignedGridRef",ref:z},{default:c(()=>[a(l(re),{enabled:!1}),a(l(U),{mode:"virtual","row-rendering-mode":"virtual","show-scrollbar":"always"}),a(l(ue),{group:"permissionsGroup","on-add":Be}),a(l(b),{"data-field":"name",caption:"Atanmış İzinler"})]),_:1},8,["data-source"])]),_:1})]),a(Nt,{isDrawerOpen:B.value,"onUpdate:isDrawerOpen":t[1]||(t[1]=n=>B.value=n),userData:He.value},null,8,["isDrawerOpen","userData"]),a(Kt,{persistent:"",contained:"","model-value":L.value,class:"align-center justify-center"},{default:c(()=>[a(F,{class:"pa-4 d-flex align-center justify-center"},{default:c(()=>[a(rt,{indeterminate:"",color:"primary",class:"me-3"}),x("span",null,H(V.value),1)]),_:1})]),_:1},8,["model-value"])],64))}}),aa=Lt(Xt,[["__scopeId","data-v-b93ae6d8"]]);export{aa as default};
