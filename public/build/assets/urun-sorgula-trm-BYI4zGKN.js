import{_ as oe}from"./AppSelect.vue_vue_type_script_setup_true_lang-Du13uovy.js";import{_ as ie}from"./AppTextarea.vue_vue_type_script_setup_true_lang-DVYouBQ3.js";import{_ as re}from"./AppTextField.vue_vue_type_script_setup_true_lang-BHuusMQ8.js";import{d as de,r as n,A as ue,aG as ne,aI as p,w as se,c as M,b as e,f as d,F as Y,g as D,j as R,e as u,cT as me,L as c,aB as f,u as o,k as v,au as pe,o as b}from"./main-Z2bCo_SY.js";import{s as j,D as i}from"./data-grid-COTBUV6G.js";import{n as g}from"./notify-DI9DDHrT.js";import{V as W}from"./VRow-BWgUjVnf.js";import{V as ce}from"./VDialog-BKRJ-ugR.js";import{V as fe}from"./VSnackbar-iZo0MlRC.js";import{V as w}from"./VCol-DlTh-hEz.js";import{V as _,b as ve}from"./VCard-DZz6s3gu.js";import{V as H}from"./VDivider-bME6_KsO.js";import{V as be}from"./VTextField-DM_4OmHz.js";import{V as we}from"./VFileInput-Dfqapfeq.js";import{V as $}from"./VImg-DNkLCn7F.js";import{V as _e}from"./VSpacer-pbjKaRl3.js";import{V as C}from"./VCardText-DiKn-Sxx.js";import"./focus-Cz7qgAt6.js";import"./VSelect-CZqgrQjA.js";import"./form-D_fVMas1.js";import"./forwardRefs-C-GTDzx5.js";import"./VList-BKXiGX5D.js";import"./ssrBoot-9tsuM1OA.js";import"./index-COtPnnZQ.js";import"./VAvatar-DQnMERNO.js";import"./dialog-transition-B2DVOUTt.js";import"./easing-Bybner-F.js";import"./VMenu-048WtKnW.js";import"./VOverlay-e1-dBb4N.js";import"./delay-D4B4K4FC.js";import"./lazy-DppAwYtJ.js";import"./scopeId-C6Vm4C3W.js";import"./VCheckboxBtn-C2TeTkQX.js";import"./VSelectionControl-CmR1rNNa.js";import"./VChip-Ct7sFLQ8.js";import"./VSlideGroup-Ctu-bJO8.js";import"./VTextarea-CDGM0CSa.js";/* empty css                   */import"./VCounter-UlzDYoNk.js";import"./VField-C6QKK3EL.js";import"./VInput-BHjw0v-2.js";import"./editor-COtmFKCi.js";import"./overlay-CZPbzO_l.js";import"./m_row_dragging-CNR76fst.js";import"./m_select_box-CUuhHspy.js";import"./themes-SlMNtXOK.js";/* empty css              */const ye={class:"w-100 sticky-header overflow-hidden rounded-t"},he={class:"d-flex align-center gap-4 flex-wrap bg-custom-background pa-6"},ge={class:"d-flex align-center gap-4",style:{flex:"1"}},Ve={class:"w-100 sticky-header overflow-hidden rounded-t"},ke={class:"text-h5 mt-2"},xe={class:"toplam"},De={class:"toplam"},Ce={class:"toplam"},Ae={class:"w-100 sticky-header overflow-hidden rounded-t"},Se={class:"text-h5 mt-2"},Ie={class:"d-flex align-center gap-4 flex-wrap bg-custom-background pa-6"},Ke={class:"w-100 sticky-header overflow-hidden rounded-t"},Fe={class:"d-flex align-center mt-2 gap-4",style:{flex:"1"}},Te={class:"w-100 sticky-header overflow-hidden rounded-t"},Be={class:"d-flex align-center gap-4 flex-wrap bg-custom-background pa-6"},Ue={class:"d-flex align-center gap-4",style:{flex:"1"}},Re={class:"d-flex align-center gap-4",style:{flex:"1"}},$e={class:"d-flex align-center mt-1"},qe={class:"ms-2 text-caption"},Tt=de({__name:"urun-sorgula-trm",setup(ze){document.title="OFT - Ürün Sorgula";const V=n(null),l=n({barkod:"",urunID:0,urunKodu:"",urunAdi:"",urunAdi2:"",toplama:0,toplami:0,toplamSayim:0}),A=n([]),S=n([]);ue(()=>{Z(),ne(()=>{var a,t;(t=(a=V.value)==null?void 0:a.focus)==null||t.call(a)})});const y=n(!1),I=n(!1),q=n(""),z=n("success"),O=async()=>{var a,t;if(l.value.barkod){y.value=!0;try{l.value.urunID=0,l.value.urunKodu="",l.value.urunAdi="",l.value.urunAdi2="",l.value.toplama=0,l.value.toplami=0,l.value.toplamSayim=0,A.value=[],S.value=[],await J(),l.value.barkod="",(t=(a=V.value)==null?void 0:a.focus)==null||t.call(a)}catch(s){console.error("Hata:",s),q.value="Bir hata oluştu!",z.value="error",I.value=!0}finally{y.value=!1}}},J=async()=>{try{const a=await p.get("/api/urunsorgula",{params:{itemID:l.value.barkod}});l.value.urunID=a.data.urun.item_id,l.value.urunKodu=a.data.urun.item_code,l.value.urunAdi=a.data.urun.item_name,l.value.urunAdi2=a.data.urun.item_name2,l.value.toplama=a.data.toplama,l.value.toplami=a.data.toplami,l.value.toplamSayim=a.data.toplamSayim,A.value=a.data.stoklar||[],S.value=a.data.detay||[],h.value="",B()}catch(a){throw console.error("Veri çekilirken hata oluştu: ",a),a}},N=a=>{a.rowType==="data"&&a.column.dataField==="qty_prm"&&a.value>0&&(a.cellElement.style.fontWeight="bold",a.cellElement.style.color="green"),a.rowType==="data"&&a.column.dataField==="qty_prm"&&a.value<0&&(a.cellElement.style.fontWeight="bold",a.cellElement.style.color="red")},m=n(null),K=n([]),h=n(""),F=n(""),P=n(),T=n([]),E=n([]),Q=()=>{var a,t,s;(s=(t=(a=P.value)==null?void 0:a.$el)==null?void 0:t.querySelector("input[type=file]"))==null||s.click()},X=async a=>{try{const t={depoID:T.value,raf:F.value,itemID:a};await p.post("/api/rafgir",t),g("Başarıyla kaydedildi.","success",2e3)}catch(t){console.error("Kayıt sırasında hata oluştu:",t)}},Z=async()=>{try{const a=await p.get("/api/depolarial",{params:{}});E.value=a.data.depolar}catch(a){console.error("Veri çekilirken hata oluştu: ",a)}},ee=async a=>{if(!m.value){g("Fotoğraf seçiniz.","warning",2e3);return}if(!l.value.urunKodu){g("Ürün kodu yok.","error",2e3);return}const t=new FormData;t.append("photo",m.value),t.append("itemCode",l.value.urunKodu);try{await p.post("/api/stok-foto/upload",t,{headers:{"Content-Type":"multipart/form-data"}}),g("Fotoğraf yüklendi","success",1500),m.value=null,h.value="",B()}catch(s){console.error(s),g("Yükleme hatası","error",2e3)}};se(m,a=>{a&&(h.value=URL.createObjectURL(a))});const B=async()=>{if(!l.value.urunKodu){K.value=[];return}try{const{data:a}=await p.get("/api/stok-foto/list",{params:{itemCode:l.value.urunKodu}});K.value=a}catch(a){console.error("Foto listeleme hata",a)}},te=async a=>{if(confirm("Silmek istediğinize emin misiniz?"))try{await p.delete("/api/stok-foto/delete",{data:{itemCode:l.value.urunKodu,name:a}}),B()}catch(t){console.error("Silme hata",t)}},k=n(!1),L=n(""),ae=a=>{L.value=a,k.value=!0},x=a=>new Intl.NumberFormat("tr-TR",{maximumFractionDigits:1}).format(a);return(a,t)=>{const s=re,G=ie,le=oe;return b(),M(Y,null,[e(W,null,{default:d(()=>[e(w,{md:"6",cols:"12",class:"mx-auto"},{default:d(()=>[e(_,{class:"overflow-visible"},{default:d(()=>[u("div",ye,[u("div",he,[u("div",ge,[e(s,{ref_key:"barkodInput",ref:V,modelValue:l.value.barkod,"onUpdate:modelValue":t[0]||(t[0]=r=>l.value.barkod=r),placeholder:"BARKOD",class:"flex-1",onKeyup:me(O,["enter"]),disabled:y.value},null,8,["modelValue","disabled"]),e(c,{loading:y.value,disabled:y.value||!V.value,onClick:O},{default:d(()=>t[13]||(t[13]=[f(" Ara ")])),_:1,__:[13]},8,["loading","disabled"])])])]),e(o(C),null,{default:d(()=>[t[14]||(t[14]=u("h5",{class:"text-h5 mb-2"}," Ürün Bilgileri ",-1)),e(H,{class:"my-2"}),e(s,{modelValue:l.value.urunID,"onUpdate:modelValue":t[1]||(t[1]=r=>l.value.urunID=r),label:"Ürün ID",class:"mb-2",readOnly:""},null,8,["modelValue"]),e(s,{modelValue:l.value.urunKodu,"onUpdate:modelValue":t[2]||(t[2]=r=>l.value.urunKodu=r),label:"Ürün Kodu",class:"mb-2",readOnly:""},null,8,["modelValue"]),e(G,{modelValue:l.value.urunAdi,"onUpdate:modelValue":t[3]||(t[3]=r=>l.value.urunAdi=r),label:"Ürün Adı",class:"mb-2","auto-grow":"",rows:"1",readOnly:""},null,8,["modelValue"]),e(G,{modelValue:l.value.urunAdi2,"onUpdate:modelValue":t[4]||(t[4]=r=>l.value.urunAdi2=r),label:"Ürün Adı 2","auto-grow":"",rows:"1",readOnly:""},null,8,["modelValue"])]),_:1,__:[14]})]),_:1})]),_:1}),e(w,{md:"6",cols:"12",class:"mx-auto"},{default:d(()=>[e(_,{class:"overflow-visible"},{default:d(()=>[e(o(C),null,{default:d(()=>[u("div",Ve,[t[18]||(t[18]=u("h5",{class:"text-h5 mb-2"}," Depo Bilgileri ",-1)),e(o(j),{id:"gridDepo",ref:"dataGridRefD","data-source":A.value,"show-borders":!0,"column-auto-width":!0,"row-alternation-enabled":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",onCellPrepared:N,height:"332px"},{default:d(()=>[e(o(i),{"data-field":"branch_desc",caption:"Firma Adı",visible:!0,width:120}),e(o(i),{"data-field":"whouse_code",caption:"Depo Kodu",visible:!0,width:80}),e(o(i),{"data-field":"description",caption:"Depo Adı",visible:!0,"min-width":180}),e(o(i),{"data-field":"add_string01",caption:"Raf Yeri",visible:!0,width:80}),e(o(i),{"data-field":"qty_prm",caption:"Miktar","data-type":"number",visible:!0,"min-width":50,format:{type:"fixedPoint",precision:2,thousandsSeparator:","}}),e(o(i),{"data-field":"unit_code",caption:"Birim",visible:!0,"min-width":40})]),_:1},8,["data-source"]),u("h5",ke,[t[15]||(t[15]=f(" Ana Depo: ")),u("span",xe,v(x(l.value.toplama,1)),1),t[16]||(t[16]=f("       İstasyon Depo: ")),u("span",De,v(x(l.value.toplami,1)),1),t[17]||(t[17]=f("       Genel       : ")),u("span",Ce,v(x(l.value.toplama+l.value.toplami,1)),1)])])]),_:1})]),_:1})]),_:1}),e(w,{cols:"12",class:"mx-auto"},{default:d(()=>[e(_,{class:"overflow-visible"},{default:d(()=>[e(o(C),null,{default:d(()=>[u("div",Ae,[t[19]||(t[19]=u("h5",{class:"text-h5 mb-2"}," Sayım Bilgileri ",-1)),e(o(j),{id:"gridSayim","data-source":S.value,"show-borders":!0,"column-auto-width":"true","row-alternation-enabled":!0,"allow-column-resizing":!0,"column-resizing-mode":"widget",onCellPrepared:N},{default:d(()=>[e(o(i),{"data-field":"id",caption:"#",visible:!0,"min-width":50}),e(o(i),{"data-field":"qty_prm",caption:"Miktar","data-type":"number",visible:!0,"min-width":60,format:{type:"fixedPoint",precision:2,thousandsSeparator:","}}),e(o(i),{"data-field":"note1",caption:"Raf Yeri",visible:!0,"min-width":60}),e(o(i),{"data-field":"whouse_code",caption:"Depo",visible:!0,"min-width":40}),e(o(i),{"data-field":"sorumlu",caption:"Sorumlu",visible:!0,"min-width":80}),e(o(i),{"data-field":"create_date",caption:"Sayım Tarihi",visible:!0,"min-width":60,"data-type":"date",format:{formatter:r=>new Intl.DateTimeFormat("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(new Date(r)).replace(/\//g,".")}},null,8,["format"]),e(o(i),{"data-field":"doc_no",caption:"Sayım No",visible:!0,"min-width":60}),e(o(i),{"data-field":"description",caption:"Depo Adı",visible:!0,"min-width":60}),e(o(i),{"data-field":"serial_m_id",visible:!0,"min-width":60}),e(o(i),{"data-field":"barcode",visible:!0,"min-width":60}),e(o(i),{"data-field":"item_id",visible:!0,"min-width":60}),e(o(i),{"data-field":"item_code",visible:!0,"min-width":60}),e(o(i),{"data-field":"item_name",visible:!0,"min-width":60}),e(o(i),{"data-field":"qty",visible:!0,"min-width":60}),e(o(i),{"data-field":"qty_free_prm",visible:!0,"min-width":60}),e(o(i),{"data-field":"qty_free_sec",visible:!0,"min-width":60}),e(o(i),{"data-field":"create_user_id",visible:!0,"min-width":60}),e(o(i),{"data-field":"update_user_id",visible:!0,"min-width":60}),e(o(i),{"data-field":"update_date",visible:!0,"min-width":60,"data-type":"date",format:{formatter:r=>new Intl.DateTimeFormat("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(new Date(r)).replace(/\//g,".")}},null,8,["format"]),e(o(i),{"data-field":"whouse_id",visible:!0,"min-width":60}),e(o(i),{"data-field":"location_id",visible:!0,"min-width":60}),e(o(i),{"data-field":"us_id",visible:!0,"min-width":60}),e(o(i),{"data-field":"unit_id",visible:!0,"min-width":60}),e(o(i),{"data-field":"cycle_count_m_id",visible:!0,"min-width":60}),e(o(i),{"data-field":"cycle_count_d_id",visible:!0,"min-width":60}),e(o(i),{"data-field":"co_id",visible:!0,"min-width":60}),e(o(i),{"data-field":"branch_id",visible:!0,"min-width":60}),e(o(i),{"data-field":"is_passive",visible:!0,"min-width":60})]),_:1},8,["data-source"]),u("h5",Se," Toplam: "+v(x(l.value.toplamSayim)),1)])]),_:1})]),_:1})]),_:1}),l.value.urunKodu?(b(),D(w,{key:0,cols:"12",class:"mx-auto"},{default:d(()=>[e(_,{class:"overflow-visible"},{default:d(()=>[u("div",Ie,[e(le,{modelValue:T.value,"onUpdate:modelValue":t[5]||(t[5]=r=>T.value=r),items:E.value,"item-title":"description","item-value":"whouse_id",label:"Depo","persistent-hint":"","return-object":"","single-line":"",placeholder:"Seçiniz...",variant:"outlined"},null,8,["modelValue","items"]),u("div",Ke,[u("div",Fe,[e(be,{modelValue:F.value,"onUpdate:modelValue":t[6]||(t[6]=r=>F.value=r),label:"Raf Yeri",variant:"outlined"},null,8,["modelValue"]),e(c,{icon:"tabler-device-floppy",rounded:"",onClick:t[7]||(t[7]=r=>X(l.value.urunID))})])])])]),_:1})]),_:1})):R("",!0),l.value.urunKodu?(b(),D(w,{key:1,cols:"12",class:"mx-auto"},{default:d(()=>[e(_,{class:"overflow-visible"},{default:d(()=>[u("div",Te,[u("div",Be,[u("div",Ue,[e(we,{ref_key:"fileInput",ref:P,modelValue:m.value,"onUpdate:modelValue":t[8]||(t[8]=r=>m.value=r),accept:"image/*",capture:"environment",label:"Fotoğraf Çek veya Seç","prepend-icon":"mdi-camera"},null,8,["modelValue"])]),u("div",Re,[e(c,{icon:"tabler-camera-plus",rounded:"",onClick:Q}),e(c,{icon:"tabler-upload",rounded:"",onClick:t[9]||(t[9]=r=>ee(l.value.urunID))})])]),h.value?(b(),D($,{key:0,src:h.value,class:"ma-4"},null,8,["src"])):R("",!0)]),e(o(C),null,{default:d(()=>[t[20]||(t[20]=u("h5",{class:"text-h5 mb-2"}," Ürün Fotoğrafları ",-1)),e(H,{class:"my-2"}),e(W,null,{default:d(()=>[(b(!0),M(Y,null,pe(K.value,r=>(b(),D(w,{key:r.name,cols:"12",sm:"4",md:"3"},{default:d(()=>[e($,{src:r.url,"max-height":"200",style:{cursor:"pointer","margin-inline-start":"-18px"},class:"rounded-lg",onClick:U=>ae(r.url)},null,8,["src","onClick"]),u("div",$e,[e(c,{icon:"tabler-trash",color:"error",rounded:"",onClick:U=>te(r.name)},null,8,["onClick"]),u("span",qe,v(r.name),1)])]),_:2},1024))),128))]),_:1})]),_:1,__:[20]})]),_:1})]),_:1})):R("",!0)]),_:1}),e(ce,{modelValue:k.value,"onUpdate:modelValue":t[11]||(t[11]=r=>k.value=r),"max-width":"1200"},{default:d(()=>[e(_,null,{default:d(()=>[e($,{src:L.value,class:"ma-4","aspect-ratio":"1.5"},null,8,["src"]),e(ve,null,{default:d(()=>[e(_e),e(c,{text:"",onClick:t[10]||(t[10]=r=>k.value=!1)},{default:d(()=>t[21]||(t[21]=[f("Kapat")])),_:1,__:[21]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(fe,{modelValue:I.value,"onUpdate:modelValue":t[12]||(t[12]=r=>I.value=r),color:z.value,timeout:"3000",location:"bottom center"},{default:d(()=>[f(v(q.value),1)]),_:1},8,["modelValue","color"])],64)}}});export{Tt as default};
