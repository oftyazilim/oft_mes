import{e as v,r as h,V as Ie,h as M,l as V,C as Q,a0 as Th,aG as Dh,a1 as Rh,f as cn,_ as Jo,E as se,P as pe,aH as R,B as ge,am as Vh,N as oe,Y as re,g as X,b as me,aI as Co,a5 as ii,c as $,aC as us,Q as hs,R as H,H as Y,T as Z,aJ as sn,aK as fe,i as Ae,aL as Rs,d as G,S as wi,aD as ei,aj as ve,aM as Oh,a as _e,W as Lt,aF as Fh,aN as Ah,aO as Ph,aP as vo,D as ps,aQ as kh,ac as Mh,F as Bh,U as jt,ae as wd,aR as Vs,z as Nh,aS as Lh,aT as $h,Z as bd,aU as er,aV as Hh,ag as Wh,aW as Br,aX as Nr,aY as yd,a7 as zh,aZ as Id,a_ as Sd,a$ as Ed,ak as Td,X as Gi,b0 as Kh,b1 as Gh,b2 as un,af as Dd,aB as ti,al as Uh,b3 as on,x as Lr,b4 as qh,q as Zn,aE as Yh,an as xo,ao as wo,ap as bo,v as Os,ai as Ui,ah as jh,b5 as Xh,b6 as Zh,b7 as Qh,at as Jh}from"./overlay-DvDTQIG6.js";import{di as w,dm as Ce,db as b,dP as Dt,dj as m,d_ as bi,dg as x,be as T,dx as $e,dk as B,dy as ep,dc as W,ed as P,dn as ze,dB as Ee,dG as xt,ee as le,dq as wt,df as S,ec as gt,de as O,dv as ae,dh as Gt,du as hn,dr as Te,dA as yo,ds as L,dD as Rd,dl as Pe,dO as Vd,dZ as Et,dS as $r,dE as gs,ef as Od,dW as Re,dQ as tp,e7 as Ot,e3 as je,e8 as ip,e6 as Nn,eg as np,dN as sp,d$ as _t,dp as nt,eh as op,dt as We,e9 as Jt,ea as At,dJ as rp,ei as Ln,ej as ap,dV as Qn,dK as Fd,ek as Ad,el as lp,em as dp,en as cp,dI as up,eo as rn,ep as hp,e1 as Io,eq as pp,er as gp}from"./main-C24QGA__.js";import{D as Ei,b as pn,h as mp,n as _p,i as fp,j as Cp,l as vp,A as Pd,m as xp,o as $n,p as it,r as wp,q as Xi,t as bp,s as kd,u as ms,T as tr,v as yp,c as ir,g as Ti,w as Md,x as _s,y as Ip,z as Di,E as Sp,B as Ze,P as ni,F as Ep,G as Tp,H as yi,I as So,J as Dp,K as Rp,M as Eo,N as Bd,O as Nd,Q as Vp,R as Op,U as Fp,V as Ap,C as nr,S as Ld,W as Fs,L as $d,f as Pp,X as kp,Y as Xt,Z as Mp,_ as Hd,$ as Ii,a0 as Bp,a1 as Np,a2 as Lp,a3 as $p,e as Hp,a4 as Wp,a5 as Wd,a6 as zd,a7 as $t,a8 as He,a9 as Pt,aa as Oi,ab as kt,ac as zp,ad as fs,ae as sr,af as xe,ag as Kd,ah as Rt,ai as Gd,aj as Kp,ak as Gp,al as Up,am as qp,an as Yp,ao as jp}from"./m_select_box-gdn6O2gN.js";import{b as Xp,c as Se,i as Cs,d as st,a as Fi}from"./themes-BjloixqS.js";import{E as gn,V as he}from"./editor-DXOc8Fml.js";const To={ariaColIndex:"aria-colindex",dragCell:"dx-drag-cell"},As="rowsview",Zp="table",Qp="edit-form",Ud="dx-data-row",Jp="dx-group-row",eg="dx-header-row",tg="edit-form-item",qd="dx-master-detail-row",Yd="dx-freespace-row",ig="dx-virtual-row",Ps="dx-master-detail-cell",ng="dx-dropdowneditor-overlay",xn="dx-command-expand",sg="dx-command-adaptive",og="dx-adaptive-item-text",jd="dx-command-select",Xd="dx-command-edit",ks="[class^=dx-command]",Ai="dx-cell-focus-disabled",rg="dxDateBox",Hr="dx-state-focused",ag="dx-widget",lg="dx-revert-button",Wr="dx-focused",Ms="delete",qi=`
  input:not([type="hidden"]):not([disabled]),
  textarea:not([disabled]),
  a:not([disabled]),
  select:not([disabled]),
  button:not([disabled]),
  [tabindex]:not([disabled]),
  .dx-checkbox:not([disabled],.dx-state-readonly)
`,zr=`${qi}, .dx-dropdowneditor-icon`,Kr="row",Gr="cell",Ur="columnHeadersView",dg="rowsView",cg=["shift","control","alt"],ug="drag";var Ne;(function(r){r.Next="next",r.Previous="previous"})(Ne||(Ne={}));var qr;(function(r){r.Group="group",r.Headers="headers"})(qr||(qr={}));const vS={G:71},Yr="arrowleft",jr="arrowright",hg=r=>class extends r{constructor(){super(...arguments),this.isNeedToFocusColumn=!1}getMoveColumnContextMenuItems(e){var t,i;const{column:n,rowIndex:s}=e,o=(t=this.isColumnReorderingEnabled)===null||t===void 0?void 0:t.call(this,e==null?void 0:e.column),a=(i=this.getKeyboardNavigationController)===null||i===void 0?void 0:i.call(this);if(!o||!a)return[];const l=this.option("rtlEnabled"),d=c=>{var u;this.isNeedToFocusColumn=!0,a.moveColumn(n,(u=c.itemData)===null||u===void 0?void 0:u.value,s)};return[{text:l?w.format("dxDataGrid-moveColumnToTheRight"):w.format("dxDataGrid-moveColumnToTheLeft"),value:Ne.Previous,beginGroup:!0,disabled:!a.canReorderColumn(n,Ne.Previous,s),icon:l?jr:Yr,onItemClick:d},{text:l?w.format("dxDataGrid-moveColumnToTheLeft"):w.format("dxDataGrid-moveColumnToTheRight"),value:Ne.Next,disabled:!a.canReorderColumn(n,Ne.Next,s),icon:l?Yr:jr,onItemClick:d}]}},Jn={draggableColumn:"draggable-column"},es="dx-state-focused",pg="dx-cell-focus-disabled",Zd=".dx-datagrid-rowsview .dx-row",Xr=`${Zd} > td`,Qd=".dx-treelist-rowsview .dx-row",Zr=`${Qd} > td`,Qr={groupPanel:[".dx-datagrid-group-panel .dx-group-panel-item[tabindex]"],columnHeaders:[".dx-datagrid-headers .dx-header-row > td.dx-datagrid-action",".dx-treelist-headers .dx-header-row > td.dx-treelist-action"],filterRow:[".dx-datagrid-headers .dx-datagrid-filter-row .dx-editor-cell .dx-texteditor-input",".dx-treelist-headers .dx-treelist-filter-row .dx-editor-cell .dx-texteditor-input"],rowsView:[".dx-row-focused",`${Zd}[tabindex]`,`${Xr}[tabindex]`,`${Xr}`,`${Qd}[tabindex]`,`${Zr}[tabindex]`,`${Zr}`],footer:[".dx-datagrid-total-footer .dx-datagrid-summary-item",".dx-treelist-total-footer .dx-treelist-summary-item"],filterPanel:[".dx-datagrid-filter-panel .dx-icon-filter",".dx-treelist-filter-panel .dx-icon-filter"],pager:[".dx-datagrid-pager [tabindex]",".dx-treelist-pager [tabindex]"]};let wn=!1,Do=!1,_i=null,Ro=!1;function gg(r,e,t,i,n,s){if(_g(e,t.originalEvent,s))return;const a=Ie(t);a==="enter"||a==="space"?(Jd(t.target,e),i&&i({event:t})):a==="tab"?n.addClass(es):or(r,e,t)}function Jd(r,e){const t=h(r),i=t.attr("aria-label"),s=ec(i,e.element()).index(t);_i=b({},{ariaLabel:i,index:s},{viewInstance:e})}function ec(r,e){const t=h(e);let i;if(r){const n=r==null?void 0:r.replace(/\\/g,"\\\\").replace(/"/g,'\\"');i=t.find(`[aria-label="${n}"][tabindex]`)}else i=t.find("[tabindex]");return i}function mg(r,e,t){const i=r??(t==null?void 0:t.getRootNode())??M.getDocument();if(!i)return;const n=h(i);for(const s in e){const o=e[s],a=n.find(o).first();if(a.length)return a}}function _g(r,e,t){const i={event:e,handled:!1};return t?t(i):r._createActionByOption("onKeyDown")(i),i.handled}function tc(){const r=M.getActiveElement();Ro=r&&!r.closest(`.${es}`)}function fg(){v.on(M.getDocument(),"visibilitychange",tc)}function Jr(){v.off(M.getDocument(),"visibilitychange",tc)}function Cg(r,e){Do=!0,r.focus({preventScroll:e}),Do=!1}function ic(r,e,t,i,n,s){if(e.option("useLegacyKeyboardNavigation"))return Ce;const o=()=>h(e.element()),a=u=>gg(r,e,u,n,o(),s),l=()=>{wn=!0,o().removeClass(es)},d=()=>{if(Ro){Ro=!1;return}!wn&&!Do&&o().addClass(es),wn=!1},c=()=>{wn=!1};return v.on(t,"keydown",i,a),v.on(t,"mousedown",i,l),v.on(t,"focusin",i,d),v.on(t,"mouseup contextmenu",i,c),()=>{v.off(t,"keydown",i,a),v.off(t,"mousedown",i,l),v.off(t,"focusin",i,d),v.off(t,"mouseup contextmenu",i,c)}}function nc(r){if(!r.option("useLegacyKeyboardNavigation")&&_i){const e=_i.viewInstance;if(e){const i=ec(_i.ariaLabel,e.element()).eq(_i.index);_i=null,v.trigger(i,"focus")}}}function or(r,e,t){const i=Ie(t);if(t.ctrlKey&&(i==="upArrow"||i==="downArrow")){var n,s;const o=Object.keys(Qr);let a=o.indexOf(r);const l=e==null||(n=e.component)===null||n===void 0||(s=n.element)===null||s===void 0?void 0:s.call(n);for(;a>=0&&a<o.length;){a=i==="upArrow"?--a:++a;const d=o[a],c=Qr[d],u=mg(l,c,t.target);if(u&&u.length){u.attr("tabindex",e.option("tabindex")||0),v.trigger(u,"focus"),u.removeClass(pg);break}}}}function xS(r,e){r.option("useLegacyKeyboardnavigation")||e.attr("tabindex",r.option("tabindex")||0)}const Hn=function(r,e,t,i,n){let s=a=>{};const o=e.getController("keyboardNavigation");e.option("useLegacyKeyboardNavigation")||o&&!o.isKeyboardEnabled()||(r==="filterPanel"&&(s=a=>{e.executeAction("onKeyDown",a)},e.createAction("onKeyDown")),ic(r,e,t,i,n,s))},mn="dxdblclick",ea=V(Q,"dxDblClick"),vg=Dt.inherit({ctor(){this._handlerCount=0,this._forgetLastClick()},_forgetLastClick(){this._firstClickTarget=null,this._lastClickTimeStamp=-300},add(){this._handlerCount<=0&&v.on(M.getDocument(),ea,this._clickHandler.bind(this)),this._handlerCount+=1},_clickHandler(r){const e=r.timeStamp||Date.now(),t=e-this._lastClickTimeStamp;!(t<0)&&t<300?(Th({type:"dxdblclick",target:Dh(this._firstClickTarget,r.target),originalEvent:r}),this._forgetLastClick()):(this._firstClickTarget=r.target,this._lastClickTimeStamp=e,clearTimeout(this._lastClickClearTimeout),this._lastClickClearTimeout=setTimeout((()=>{this._forgetLastClick()}),600))},remove(){this._handlerCount-=1,this._handlerCount<=0&&(this._forgetLastClick(),v.off(M.getDocument(),ea,void 0),clearTimeout(this._lastClickClearTimeout),this._handlerCount=0)}}),xg=new vg;Rh(mn,xg);const wg=r=>class extends r{_applyColumnState(e){var t;const i=this.option("rtlEnabled"),n=this._getColumnAlignment(e.column.alignment,i),s=b(!0,{columnAlignment:n},e),o=s.rootElement.hasClass("dx-group-panel-item"),a=this._createIndicatorContainer(s,o),l=h("<span>").addClass(this._getIndicatorClassName(e.name)),d=(t=this.component)===null||t===void 0?void 0:t.getController("columns"),c=(d==null?void 0:d.getHeaderContentAlignment(n))||n;return s.container=a,s.indicator=l,this._renderIndicator(s),a[(o||!e.showColumnLines)&&c==="left"?"appendTo":"prependTo"](e.rootElement),l}_getIndicatorClassName(e){}_getColumnAlignment(e,t){return t=t||this.option("rtlEnabled"),e&&e!=="center"?e:cn(t)}_createIndicatorContainer(e,t){let i=this._getIndicatorContainer(e.rootElement);const n=e.columnAlignment==="left"?"right":"left";return i.length||(i=h("<div>").addClass("dx-column-indicators")),this.setAria("role","presentation",i),i.css("float",e.showColumnLines&&!t?n:null)}_getIndicatorContainer(e){return e&&e.find(".dx-column-indicators")}_getIndicatorElements(e){const t=this._getIndicatorContainer(e);return t&&t.children()}_renderIndicator(e){const t=e.container,i=e.indicator;t&&i&&t.append(i)}_updateIndicators(e){const t=this,i=t.getColumns(),n=t.getColumnElements();let s;if(!(!n||i.length!==n.length))for(let o=0;o<i.length;o++){s=n.eq(o),t._updateIndicator(s,i[o],e);const a=s.parent().data("options");a&&a.cells&&(a.cells[s.index()].column=i[o])}}_updateIndicator(e,t,i){if(!t.command)return this._applyColumnState({name:i,rootElement:e,column:t,showColumnLines:this.option("showColumnLines")})}},bg=["rowsView"],bt={borderedTop:"dx-bordered-top-view",borderedBottom:"dx-bordered-bottom-view"},yg=r=>{let{columnHeadersView:e,rowsView:t}=r;return e!=null&&e.isVisible()?e.element():t.element()},Ig=r=>{let{filterPanelView:e,footerView:t,rowsView:i}=r;return e!=null&&e.isVisible()?e.element():t!=null&&t.isVisible()?t.element():i.element()},ta=(r,e)=>{const t=Object.values(r).find((i=>{var n;return i==null||(n=i.element())===null||n===void 0?void 0:n.hasClass(e)}));return(t==null?void 0:t.element())??null},Sg=(r,e)=>{var t;if(!Object.keys(e).includes(r))return!1;const{rowsView:i}=e,n=Jo(e,bg);return m(i==null||(t=i.element)===null||t===void 0?void 0:t.call(i))?Object.values(n).filter((s=>{var o;return s==null||(o=s.isVisible)===null||o===void 0?void 0:o.call(s)})).every((s=>m(s==null?void 0:s.element()))):!1},Eg=(r,e)=>{if(!Sg(r,e))return;const t=ta(e,bt.borderedTop),i=ta(e,bt.borderedBottom),n=yg(e),s=Ig(e);t&&!t.is(n)&&t.removeClass(bt.borderedTop),i&&!i.is(s)&&i.removeClass(bt.borderedBottom),n.hasClass(bt.borderedTop)||n.addClass(bt.borderedTop),s.hasClass(bt.borderedBottom)||s.addClass(bt.borderedBottom)};class sc{constructor(e){const t=this;t._updateLockCount=0,t.component=e,t._actions={},t._actionConfigs={},x(this.callbackNames()||[],(function(i,n){const s=t.callbackFlags(n)||{};s.unique=!0,s.syncStrategy=!0,t[this]=$e(s)}))}_endUpdateCore(){}init(){}callbackNames(){}callbackFlags(e){}publicMethods(){return[]}beginUpdate(){this._updateLockCount++}endUpdate(){this._updateLockCount>0&&(this._updateLockCount--,this._updateLockCount||this._endUpdateCore())}option(e){const{component:t}=this,i=t._optionCache;return arguments.length===1&&i?(e in i||(i[e]=t.option(e)),i[e]):t.option.apply(t,arguments)}_silentOption(e,t){const{component:i}=this,n=i._optionCache;return n&&(n[e]=t),i._setOptionWithoutOptionChange(e,t)}localize(e){const t=this.component._optionCache;return t?(e in t||(t[e]=w.format(e)),t[e]):w.format(e)}on(e,t){return this.component.on.apply(this.component,arguments)}off(){return this.component.off.apply(this.component,arguments)}optionChanged(e){e.name in this._actions&&(this.createAction(e.name,this._actionConfigs[e.name]),e.handled=!0)}getAction(e){return this._actions[e]}setAria(e,t,i){const n=i.get(0),s=e!=="role"&&e!=="id"?"aria-":"";n.setAttribute?n.setAttribute(s+e,t):i.attr(s+e,t)}_createComponent(e,t,i){return this.component._createComponent(e,t,i)}getController(e){return this.component._controllers[e]}createAction(e,t){if(B(e)){const i=this.component._createAction(e.bind(this),t);return function(n){i({event:n})}}this._actions[e]=this.component._createActionByOption(e,t),this._actionConfigs[e]=t}executeAction(e,t){const i=this._actions[e];return i&&i(t)}dispose(){const e=this;x(e.callbackNames()||[],(function(){e[this].empty()}))}addWidgetPrefix(e){return`dx-${this.component.NAME.slice(2).toLowerCase()}${e?`-${e}`:""}`}getWidgetContainerClass(){const e=this.component.NAME==="dxDataGrid"?null:"container";return this.addWidgetPrefix(e)}elementIsInsideGrid(e){return e.closest(`.${this.getWidgetContainerClass()}`).parent().is(this.component.$element())}}class vs extends sc{}class Tg extends vs{getView(e){return this.component._views[e]}getViews(){return this.component._views}}class oc extends sc{constructor(e){super(e),this.renderCompleted=$e(),this.resizeCompleted=$e()}_isReady(){return this.component.isReady()}_endUpdateCore(){super._endUpdateCore(),!this._isReady()&&this._requireReady&&(this._requireRender=!1,this.component._requireResize=!1),this._requireRender&&(this._requireRender=!1,this.render(this._$parent))}_invalidate(e,t){this._requireRender=!0,this.component._requireResize=pe()&&(this.component._requireResize||e),this._requireReady=this._requireReady||t}_renderCore(e){}_resizeCore(){}_parentElement(){return this._$parent}element(){return this._$element}getElementHeight(){const e=this.element();if(!e)return 0;const t=parseFloat(e.css("marginTop"))||0,i=parseFloat(e.css("marginBottom"))||0,{offsetHeight:n}=e.get(0);return n+t+i}isVisible(){return!0}getTemplate(e){return this.component._getTemplate(e)}getView(e){return this.component._views[e]}_getBorderedViews(){return{columnHeadersView:this.component._views.columnHeadersView,rowsView:this.component._views.rowsView,filterPanelView:this.component._views.filterPanelView,footerView:this.component._views.footerView}}render(e,t){let i=this._$element;const n=this.isVisible();if(!(!i&&!e)&&(this._requireReady=!1,i||(i=this._$element=h("<div>").appendTo(e),this._$parent=e),i.toggleClass("dx-hidden",!n),this.component._views&&Eg(this.name,this._getBorderedViews()),n)){this.component._optionCache={};const s=this._renderCore(t);this.component._optionCache=void 0,s?s.done((()=>{this.renderCompleted.fire(t)})):this.renderCompleted.fire(t)}}resize(){this.isResizing=!0,this._resizeCore(),this.resizeCompleted.fire(),this.isResizing=!1}focus(e){this.element().get(0).focus({preventScroll:e})}}function ia(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};return Object.entries(e).forEach((i=>{let[n,s]=i;const o=r[n];if(o)if(B(s))t[n]=s(o);else{const a=o;t[n]=a.inherit(s)}})),t}function Dg(r,e,t){const i=t.publicMethods();i&&x(i,((n,s)=>{if(t[s])if(!r[s])r[s]=function(){return t[s](...arguments)};else throw se.Error("E1005",s);else throw se.Error("E1006",e,s)}))}function Rg(r,e){const{modules:t}=e,{modulesOrder:i}=e;function n(c){const u={};return x(c,((p,g)=>{const _=new g(r);_.name=p,Dg(r,p,_),u[p]=_})),u}i&&t.sort(((c,u)=>{let p=i.indexOf(c.name),g=i.indexOf(u.name);return p<0&&(p=1e6),g<0&&(g=1e6),p-g}));const s={},o={};t.forEach((c=>{let{name:u,controllers:p={},views:g={}}=c;Object.entries(p).forEach((_=>{let[f,C]=_;if(s[f])throw se.Error("E1001",u,f);if(!((C==null?void 0:C.prototype)instanceof vs))throw se.Error("E1002",u,f);s[f]=C})),Object.entries(g).forEach((_=>{let[f,C]=_;if(o[f])throw se.Error("E1003",u,f);if(!((C==null?void 0:C.prototype)instanceof oc))throw se.Error("E1004",u,f);o[f]=C}))}));const a=t.filter((c=>{let{extenders:u}=c;return!!u})),l=a.reduce(((c,u)=>{let{extenders:p}=u;return T({},c,ia(c,p==null?void 0:p.controllers))}),s),d=a.reduce(((c,u)=>{let{extenders:p}=u;return T({},c,ia(c,p==null?void 0:p.views))}),o);r._controllers=n(l),r._views=n(d)}const Vg=function(r,e,t){t=t||[],r._controllers&&x(r._controllers,(function(){this[e]&&this[e].apply(this,t)})),r._views&&x(r._views,(function(){this[e]&&this[e].apply(this,t)}))},j={modules:[],View:oc,ViewController:Tg,Controller:vs,registerModule(r,e){const{modules:t}=this;for(let i=0;i<t.length;i++)if(t[i].name===r)return;e.name=r,t.push(e)},registerModulesOrder(r){this.modulesOrder=r},unregisterModule(r){this.modules=bi(this.modules,(e=>e.name!==r))},processModules:Rg,callModuleItemsMethod:Vg},Vo=ep({format:function(r,e){const t=W(e)&&e!==""||ze(e)||B(e),i=Ee(r)||xt(r);if(!t||!i)return m(r)?r.toString():"";if(B(e))return e(r);if(W(e)&&(e={type:e}),Ee(r))return le.format(r,e);if(xt(r))return P.format(r,e)},getTimeFormat:function(r){return r?"longtime":"shorttime"},_normalizeFormat:function(r){return Array.isArray(r)?r.length===1?r[0]:function(e){return r.map((function(t){return P.format(e,t)})).join(" ")}:r},getDateFormatByDifferences:function(r,e){const t=[],i=e&&r.millisecond&&!(r.year||r.month||r.day);if(i){const n=function(s){return s.getSeconds()+s.getMilliseconds()/1e3+"s"};t.push(n)}else r.millisecond&&t.push("millisecond");if((r.hour||r.minute||!i&&r.second)&&t.unshift(this.getTimeFormat(r.second)),r.year&&r.month&&r.day)return e&&e==="month"?"monthandyear":(t.unshift("shortdate"),this._normalizeFormat(t));if(r.year&&r.month)return"monthandyear";if(r.year&&r.quarter)return"quarterandyear";if(r.year)return"year";if(r.quarter)return"quarter";if(r.month&&r.day){if(e){const n=function(s){return P.getMonthNames("abbreviated")[s.getMonth()]+" "+P.format(s,"day")};t.unshift(n)}else t.unshift("monthandday");return this._normalizeFormat(t)}if(r.month)return"month";if(r.day){if(e)t.unshift("day");else{const n=function(s){return P.format(s,"dayofweek")+", "+P.format(s,"day")};t.unshift(n)}return this._normalizeFormat(t)}return this._normalizeFormat(t)},getDateFormatByTicks:function(r){let e,t,i;if(r.length>1)for(e=R.getDatesDifferences(r[0],r[1]),i=1;i<r.length-1;i++)t=R.getDatesDifferences(r[i],r[i+1]),e.count<t.count&&(e=t);else e={year:!0,month:!0,day:!0,hour:r[0].getHours()>0,minute:r[0].getMinutes()>0,second:r[0].getSeconds()>0,millisecond:r[0].getMilliseconds()>0};return this.getDateFormatByDifferences(e)},getDateFormatByTickInterval:function(r,e,t){let i;const n=function(a,l,d){switch(l){case"year":case"quarter":a.month=d;case"month":a.day=d;case"week":case"day":a.hour=d;case"hour":a.minute=d;case"minute":a.second=d;case"second":a.millisecond=d}};t=W(t)?t.toLowerCase():t;const s=R.getDatesDifferences(r,e);return r!==e&&(function(a,l,d){!d.getMilliseconds()&&d.getSeconds()?d.getSeconds()-l.getSeconds()===1&&(a.millisecond=!0,a.second=!1):!d.getSeconds()&&d.getMinutes()?d.getMinutes()-l.getMinutes()===1&&(a.second=!0,a.minute=!1):!d.getMinutes()&&d.getHours()?d.getHours()-l.getHours()===1&&(a.minute=!0,a.hour=!1):!d.getHours()&&d.getDate()>1?d.getDate()-l.getDate()===1&&(a.hour=!0,a.day=!1):d.getDate()===1&&d.getMonth()?d.getMonth()-l.getMonth()===1&&(a.day=!0,a.month=!1):!d.getMonth()&&d.getFullYear()&&d.getFullYear()-l.getFullYear()===1&&(a.month=!0,a.year=!1)})(s,r>e?e:r,r>e?r:e),i=R.getDateUnitInterval(s),n(s,i,!0),i=R.getDateUnitInterval(t||"second"),n(s,i,!1),s[{week:"day"}[i]||i]=!0,this.getDateFormatByDifferences(s)}}),Og=["year","month","day"],Fg=["year","month","day","hour","minute"],Oo=function(r){return r==="date"||r==="datetime"},Bs=function(r){let e,t=[];const i=["year","month","day","hour","minute","second"],n=r.headerFilter&&r.headerFilter.groupInterval,s=n==="quarter"?"month":n;if(Oo(r.dataType)&&n!==null)return t=r.dataType==="datetime"?Fg:Og,e=i.indexOf(s),e>=0&&(t=i.slice(0,e),t.push(n)),t;if(m(n))return Array.isArray(n)?n:[n]},Ag=function(r){var e;return(e=r.calculateDisplayValue)!==null&&e!==void 0&&e.context?r.calculateDisplayValue:null},si=(function(){const r=function(n,s){let o=n.dataField||n.selector;return s==="search"&&(o=n.displayField||Ag(n)||o),o},e=function(n,s){const o=this;let a,l,d;const c=r(o,s);if(Array.isArray(n)&&m(n[0])&&m(n[1]))return l=[c,">=",n[0]],d=[c,"<=",n[1]],Oo(o.dataType)&&(u=n[1],u.getHours()+u.getMinutes()+u.getSeconds()+u.getMilliseconds()<1)&&(a=new Date(n[1].getTime()),o.dataType==="date"&&a.setDate(n[1].getDate()+1),d=[c,"<",a]),[l,"and",d];var u},t=function(n,s,o){const a=this;let l,d,c;const u=(function(g){return xt(g)?[g.getFullYear(),g.getMonth(),g.getDate(),g.getHours(),g.getMinutes(),g.getSeconds()]:wt((""+g).split("/"),(function(_,f){return f===1?Number(_)-1:Number(_)}))})(n),p=r(a,o);switch(o==="headerFilter"?c=Bs(a)[u.length-1]:a.dataType==="datetime"&&(c="minute"),c){case"year":l=new Date(u[0],0,1),d=new Date(u[0]+1,0,1);break;case"month":l=new Date(u[0],u[1],1),d=new Date(u[0],u[1]+1,1);break;case"quarter":l=new Date(u[0],3*u[1],1),d=new Date(u[0],3*u[1]+3,1);break;case"hour":l=new Date(u[0],u[1],u[2],u[3]),d=new Date(u[0],u[1],u[2],u[3]+1);break;case"minute":l=new Date(u[0],u[1],u[2],u[3],u[4]),d=new Date(u[0],u[1],u[2],u[3],u[4]+1);break;case"second":l=new Date(u[0],u[1],u[2],u[3],u[4],u[5]),d=new Date(u[0],u[1],u[2],u[3],u[4],u[5]+1);break;default:l=new Date(u[0],u[1],u[2]),d=new Date(u[0],u[1],u[2]+1)}switch(s){case"<":return[p,"<",l];case"<=":return[p,"<",d];case">":return[p,">=",d];case">=":return[p,">=",l];case"<>":return[[p,"<",l],"or",[p,">=",d]];default:return[[p,">=",l],"and",[p,"<",d]]}},i=function(n,s,o){const a=r(this,o),l=Bs(this);if(o==="headerFilter"&&l&&m(n)){const d=(""+n).split("/"),c=Number(d[d.length-1]),u=l[d.length-1],p=[a,">=",c],g=[a,"<",c+u];return[p,"and",g]}return[a,s||"=",n]};return{defaultCalculateFilterExpression:function(n,s,o){const a=this,l=r(a,o),d=a.calculateDisplayValue&&o==="search",c=d&&a.lookup&&a.lookup.dataType||a.dataType;let u=null;if((o==="headerFilter"||o==="filterBuilder")&&n===null)u=[l,s||"=",null],c==="string"&&(u=[u,s==="="?"or":"and",[l,s||"=",""]]);else if(c==="string"&&(!a.lookup||d))u=[l,s||"contains",n];else{if(s==="between")return e.apply(a,[n,o]);if(Oo(c)&&m(n))return t.apply(a,arguments);if(c==="number")return i.apply(a,arguments);u=[l,s||"=",n]}return u},getGroupInterval:Bs}})(),na=r=>"originalCallback"in r?r.originalCallback:r,sa=r=>"columnIndex"in r?r.columnIndex??null:void 0,rc=(r,e)=>{const t=na(r),i=na(e),n=sa(r),s=sa(e);return t===i&&(!(n!==void 0)||n===s)},oa=(r,e)=>typeof r=="string"&&typeof e=="string"?r===e:typeof r=="function"&&typeof e=="function"?rc(r,e):!1,Pg=(r,e)=>typeof r=="function"&&typeof e=="function"?rc(r,e):!1,kg="scrolling.legacyMode",Mg="scrolling.rowRenderingMode",Bg={year:r=>r&&r.getFullYear(),month:r=>r&&r.getMonth()+1,day:r=>r&&r.getDate(),quarter:r=>r&&Math.floor(r.getMonth()/3)+1,hour:r=>r&&r.getHours(),minute:r=>r&&r.getMinutes(),second:r=>r&&r.getSeconds()},Ng=function(){const r=arguments[1],e=this.calculateCellValue(r);if(!m(e))return null;if(ac(this.dataType)){const t=arguments[0];return Bg[t](e)}if(this.dataType==="number"){const t=arguments[0];return Math.floor(Number(e)/t)*t}};function ac(r){return r==="date"||r==="datetime"}const ra=function(r){r.get(0).textContent="Â "},Ns=function(r){r=r||[];const e=_p(r);for(let t=0;t<r.length;t++)r&&r[t]&&r[t].isExpanded!==void 0&&(e[t].isExpanded=r[t].isExpanded),r&&r[t]&&r[t].groupInterval!==void 0&&(e[t].groupInterval=r[t].groupInterval);return e},lc=function(r,e){const t=Vo.format(r,e.format)||r&&r.toString()||"",i={value:r,valueText:e.getDisplayFormat?e.getDisplayFormat(t):t,target:e.target||"row",groupInterval:e.groupInterval};return e.customizeText?e.customizeText.call(e,i):i.valueText},aa=function(r,e){const t=r.displayFormat||r.columnCaption&&e[`${r.summaryType}OtherColumn`]||e[r.summaryType];return lc(r.value,{format:r.valueFormat,getDisplayFormat:i=>t?hn(t,i,r.columnCaption):i,customizeText:r.customizeText})},la=function(r){const e=r.data&&r.data(),t=e&&e.dxComponents,i=t&&t[0];return i&&e[i]},dc=function(r,e,t){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;for(let i=0;i<r.length;i++)if(!dc(r[i],e[i],t))return!1;return!0}return B(r)&&r.columnIndex>=0&&B(e)&&e.columnIndex>=0?r.columnIndex===e.columnIndex&&Gt(r.filterValue,void 0,t)===Gt(e.filterValue,void 0,t)&&Gt(r.selectedFilterOperation,void 0,t)===Gt(e.selectedFilterOperation,void 0,t):Gt(r,void 0,t)==Gt(e,void 0,t)},Lg=r=>({index:r.index,columnIndex:r.columnIndex,x:r.x,y:r.y}),da=(r,e,t)=>{let i=!1;if(t&&(i=t(e)),!i){const n=Lg(e);r.push(n)}};function $g(r){return Array.isArray(r)||(r=[r]),r.map(((e,t)=>W(e)?{selector:e,isExpanded:t<r.length-1}:e))}const y={renderNoDataText(r){const e=this;if(r=r||this.element(),!r)return;const t=e.addWidgetPrefix("nodata");let i=r.find(`.${t}`).last();const n=this._dataController.isEmpty(),s=this._dataController.isLoading();i.length||(i=h("<span>").addClass(t)),i.parent().is(r)||i.appendTo(r),n&&!s?i.removeClass("dx-hidden").text(e._getNoDataText()):i.addClass("dx-hidden")},renderLoadPanel(r,e,t){const i=this;let n;i._loadPanel&&i._loadPanel.$element().remove(),n=i.option("loadPanel"),n&&(n.enabled==="auto"?!t:n.enabled)?(n=b({shading:!1,message:n.text,container:e},n),i._loadPanel=i._createComponent(h("<div>").appendTo(e),mp,n)):i._loadPanel=null},calculateLoadPanelPosition(r){const e=h(oe());return X(r)>X(e)?{of:e,boundary:r,collision:"fit"}:{of:r}},getIndexByKey(r,e,t){let i=-1;if(r!==void 0&&Array.isArray(e)){t=arguments.length<=2?"key":t;for(let n=0;n<e.length;n++){const s=m(t)?e[n][t]:e[n];if(ae(r,s)){i=n;break}}}return i},combineFilters(r,e){let t=[];e=e||"and";for(let n=0;n<r.length;n++){var i;if(r[n]){if(((i=r[n])===null||i===void 0?void 0:i.length)===1&&r[n][0]==="!"){if(e==="and")return["!"];if(e==="or")continue}t.length&&t.push(e),t.push(r[n])}}if(t.length===1&&(t=t[0]),t.length)return t},checkChanges(r,e){let t=0;for(let i=0;i<e.length;i++)r[e[i]]&&t++;return r.length&&r.length===t},equalFilterParameters:dc,proxyMethod(r,e,t){r[e]||(r[e]=function(){const i=this._dataSource;return i?i[e].apply(i,arguments):t})},formatValue:lc,getFormatOptionsByColumn:(r,e)=>({format:r.format,getDisplayFormat:r.getDisplayFormat,customizeText:r.customizeText,target:e,trueText:r.trueText,falseText:r.falseText}),getDisplayValue(r,e,t,i){return r.displayValueMap&&r.displayValueMap[e]!==void 0?r.displayValueMap[e]:r.calculateDisplayValue&&t&&i!=="group"?r.calculateDisplayValue(t):r.lookup&&!(i==="group"&&(r.calculateGroupValue||r.calculateDisplayValue))?r.lookup.calculateCellValue(e):e},getGroupRowSummaryText(r,e){let t="(";for(let i=0;i<r.length;i++){const n=r[i];t+=(i>0?", ":"")+aa(n,e)}return t+")"},getSummaryText:aa,normalizeSortingInfo:Ns,getFormatByDataType(r){switch(r){case"date":return"shortDate";case"datetime":return"shortDateShortTime";default:return}},getHeaderFilterGroupParameters(r,e){let t=[];const i=r.dataField||r.name,n=si.getGroupInterval(r);return n?(x(n,((s,o)=>{t.push(e?{selector:i,groupInterval:o,isExpanded:s<n.length-1}:Ng.bind(r,o))})),t):(e?t=[{selector:i,isExpanded:!1}]:(t=function(s){let o=r.calculateCellValue(s);return(o===void 0||o==="")&&(o=null),o},r.sortingMethod&&(t=[{selector:t,compare:r.sortingMethod.bind(r)}])),t)},equalSortParameters(r,e,t){if(r=Ns(r),e=Ns(e),Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;for(let i=0;i<r.length;i++)if(!oa(r[i].selector,e[i].selector)||r[i].desc!==e[i].desc||r[i].groupInterval!==e[i].groupInterval||!t&&!!r[i].isExpanded!=!!e[i].isExpanded)return!1;return!0}return(!r||!r.length)==(!e||!e.length)},getPointsByColumns(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;const s=[],o=r.length;let a,l={left:0,top:0},d={width:0,height:0},c=i,u;for(let g=0;g<=o;g++){var p;g<o&&(a=r.eq(g),l=a.offset(),d=re(a.get(0)),u=a.css("direction")==="rtl");const _=l.left+d.width,f=l.top+d.height,C={index:c,columnIndex:c,item:(p=a)===null||p===void 0?void 0:p.get(0),x:!t&&u!==(g===o)?_:l.left,y:t&&g===o?f:l.top};if(!t&&g>0){const I=r.eq(g-1).offset(),{width:E}=re(r[g-1]),D=u?I.left:I.left+E;if(I.top<C.y&&(C.y=I.top),n&&Math.round(D)!==Math.round(C.x)){const k=T({},C,{item:r[g-1],x:D});u?(C.isRightBoundary=!0,k.isLeftBoundary=!0):(C.isLeftBoundary=!0,k.isRightBoundary=!0),da(s,k,e)}}da(s,C,e),c++}return s},getExpandCellTemplate:()=>({allowRenderToDetachedContainer:!0,render(r,e){const t=h(r);if(m(e.value)&&!(e.data&&e.data.isContinuation)&&!e.row.isNewRow){const i=e.component.getView("rowsView");t.addClass("dx-datagrid-expand").addClass("dx-selection-disabled"),h("<div>").addClass(e.value?"dx-datagrid-group-opened":"dx-datagrid-group-closed").appendTo(t),i.setAria("label",e.value?i.localize("dxDataGrid-ariaCollapse"):i.localize("dxDataGrid-ariaExpand"),t)}else ra(t)}}),setEmptyText:ra,isDateType:ac,getSelectionRange(r){try{if(r)return{selectionStart:r.selectionStart,selectionEnd:r.selectionEnd}}catch{}return{}},setSelectionRange(r,e){try{r&&r.setSelectionRange&&r.setSelectionRange(e.selectionStart,e.selectionEnd)}catch{}},focusAndSelectElement(r,e){const t=e.is(":focus");v.trigger(e,"focus");const i=r.option("editing.selectTextOnEditStart"),n=e.get(0);if(!t&&i&&e.is(".dx-texteditor-input")&&!e.is("[readonly]")){const s=la(e.closest(".dx-texteditor"));O(s&&s._loadItemDeferred).done((()=>{n.select()}))}},getWidgetInstance:la,getLastResizableColumnIndex(r,e){const t=r.some((n=>n&&!n.command&&!n.fixed&&n.allowResizing!==!1));let i;for(i=r.length-1;r[i];i--){const n=r[i],s=e&&e[i],o=!t||n.allowResizing!==!1;if(!n.command&&!n.fixed&&s!=="adaptiveHidden"&&o)break}return i},isElementInCurrentGrid(r,e){return e&&e.length?e.closest(`.${r.getWidgetContainerClass()}`).parent().is(r.component.$element()):!1},isVirtualRowRendering(r){const e=r.option(Mg),t=r.option("scrolling.mode")==="virtual",i=r.option("scrolling.mode")==="infinite";return r.option(kg)===!1&&(t||i)?!0:e==="virtual"},getPixelRatio:r=>r.devicePixelRatio||1,getContentHeightLimit(r){return r.mozilla?8e6:15e6/this.getPixelRatio(oe())},normalizeLookupDataSource(r){let e;return r.items?e=r.items:(e=r.dataSource,B(e)&&!gt.isWrapped(e)&&(e=e({}))),pn(e)},getWrappedLookupDataSource(r,e,t){if(!e)return[];const i=this.normalizeLookupDataSource(r.lookup);if(r.calculateCellValue!==r.defaultCalculateCellValue)return i;const n=e.remoteOperations().groupPaging,s=r.displayField&&W(r.displayField);let o,a,l;const d=(u,p)=>{const g=p.skip??0,_=p.take?g+p.take:u.length;return u.slice(g,_)};return T({},i,{__dataGridSourceFilter:t,load:u=>{const p=new S;return(g=>{const _=$g(s?[r.dataField,r.displayField]:r.dataField),f=new S;return o&&(!n||g.skip===l&&g.take===a)?f.resolve(d(o,g)):(l=g.skip,a=g.take,e.load({filter:t,group:_,take:n?g.take:void 0,skip:n?g.skip:void 0}).done((I=>{o=I,f.resolve(n?I:d(I,g))})).fail(f.fail)),f})(u).done((g=>{if(g.length===0){p.resolve([]);return}const _=this.combineFilters(g.flatMap((C=>C.key)).map((C=>[r.lookup.valueExpr,C])),"or");new Ei(T({},i,u,{filter:this.combineFilters([_,u.filter],"and"),paginate:!1})).load().done(p.resolve).fail(p.fail)})).fail(p.fail),p},key:r.lookup.valueExpr,byKey(u){const p=S();return this.load({filter:[r.lookup.valueExpr,"=",u]}).done((g=>{p.resolve(g[0])})),p.promise()}})},logHeaderFilterDeprecatedWarningIfNeed(r){const e=r._logDeprecatedOptionWarning.bind(r);m(r.option("headerFilter.allowSearch"))&&e("headerFilter.allowSearch",{since:"23.1",alias:"headerFilter.search.enabled"}),m(r.option("headerFilter.searchTimeout"))&&e("headerFilter.searchTimeout",{since:"23.1",alias:"headerFilter.search.timeout"});const t=r.NAME==="dxPivotGrid"?"dataSource.fields":"columns",i=r.option(t);if(!Array.isArray(i))return;const n=s=>{s.forEach((o=>{var a;const l=o.headerFilter||{};m(l.allowSearch)&&e(`${t}[].headerFilter.allowSearch`,{since:"23.1",alias:`${t}[].headerFilter.search.enabled`}),m(l.searchMode)&&e(`${t}[].headerFilter.searchMode`,{since:"23.1",alias:`${t}[].headerFilter.search.mode`}),(a=o.columns)!==null&&a!==void 0&&a.length&&n(o.columns)}))};n(i)},getComponentBorderWidth(r,e){return r.option("showBorders")?Math.ceil(ge(e)-Vh(e)):0},isCustomCommandColumn(r,e){return!!r.filter((i=>i.type===e.type)).length},isEqualSelectors:oa,isSelectorEqualWithCallback:Pg},Ls="dx-master-detail-row",$s="dxCellHintVisible",Hg={render(r){r.container.append(r.content)}},Wg=function(r,e){let t,i,n;function s(o){return setTimeout((()=>{t=i=null}),o)}v.on(e,"touchstart touchend",".dx-row",(o=>{var a;o!=null&&(a=o.event)!==null&&a!==void 0&&a.target&&!y.isElementInCurrentGrid(r,h(o.event.target))||(clearTimeout(n),o.type==="touchstart"?(t=o.target,i=o.currentTarget,n=s(1e3)):n=s())})),v.on(e,[Q,mn,Z.down].join(" "),".dx-row",r.createAction((o=>{var a;const{event:l}=o;o!=null&&(a=o.event)!==null&&a!==void 0&&a.target&&!y.isElementInCurrentGrid(r,h(l.target))||(t&&(l.target=t,l.currentTarget=i),h(l.target).closest("a").length||(o.rowIndex=r.getRowIndex(l.currentTarget),o.rowIndex>=0&&(o.rowElement=$(h(l.currentTarget)),o.columns=r.getColumns(),l.type===Z.down?r._rowPointerDown(o):l.type===Q?r._rowClick(o):r._rowDblClick(o))))})))},bn=function(r){return r==="auto"?"":Ee(r)?`${r}px`:r},zg=function(r,e,t){r.style.width=r.style.maxWidth=e.width==="auto"?"":t},Kg=function(r,e){if(!r||!e)return;const t=r.attributes,i=e.attributes;let n;for(n=0;n<t.length;n++){const s=t[n].nodeName;e.hasAttribute(s)||r.removeAttribute(s)}for(n=0;n<i.length;n++)r.setAttribute(i[n].nodeName,i[n].nodeValue)},Gg=function(r){r.resolve()},cc=r=>typeof r=="number"?`${r.toFixed(3)}px`:r==="adaptiveHidden"?"0.0001px":r;class xs extends wg(j.View){init(){this._scrollLeft=-1,this._columnsController=this.getController("columns"),this._dataController=this.getController("data"),this._adaptiveColumnsController=this.getController("adaptiveColumns"),this._columnChooserController=this.getController("columnChooser"),this._editorFactoryController=this.getController("editorFactory"),this._selectionController=this.getController("selection"),this._columnChooserView=this.getView("columnChooserView"),this._delayedTemplates=[],this._templateDeferreds=new Set,this._templatesCache={},this._templateTimeouts=new Set,this.createAction("onCellClick"),this.createAction("onRowClick"),this.createAction("onCellDblClick"),this.createAction("onRowDblClick"),this.createAction("onCellHoverChanged",{excludeValidators:["disabled","readOnly"]}),this.createAction("onCellPrepared",{excludeValidators:["disabled","readOnly"],category:"rendering"}),this.createAction("onRowPrepared",{excludeValidators:["disabled","readOnly"],category:"rendering",afterExecute:e=>{this._afterRowPrepared(e)}}),this._columnsController.columnsChanged.add(this._columnOptionChanged.bind(this)),this._dataController&&this._dataController.changed.add(this._handleDataChanged.bind(this))}dispose(){if(pe()){var e,t;const i=oe();(e=this._templateTimeouts)===null||e===void 0||e.forEach((n=>i.clearTimeout(n))),(t=this._templateTimeouts)===null||t===void 0||t.clear()}}optionChanged(e){switch(super.optionChanged(e),e.name){case"cellHintEnabled":case"onCellPrepared":case"onRowPrepared":case"onCellHoverChanged":this._invalidate(!0,!0),e.handled=!0;break;case"keyboardNavigation":e.fullName==="keyboardNavigation.enabled"&&this._invalidate(!0,!0),e.handled=!0}}_createScrollableOptions(){const e=this.option("scrolling");let t=this.option("scrolling.useNative");const i=b({},e,{direction:"both",bounceEnabled:!1,useKeyboard:!1});return t===void 0&&(t=!0),t==="auto"?(delete i.useNative,delete i.useSimulatedScrollbar):(i.useNative=!!t,i.useSimulatedScrollbar=!t),i}_updateCell(e,t){t.rowType&&this._cellPrepared(e,t)}_needToSetCellWidths(){return this.option("columnAutoWidth")}_createCell(e){const{column:t}=e,i=t.alignment||cn(this.option("rtlEnabled")),n=this._needToSetCellWidths(),s=M.createElement("td");s.style.textAlign=i;const o=h(s);return t.cssClass&&o.addClass(t.cssClass),Array.isArray(t.elementAttr)&&t.elementAttr.forEach((a=>{let{name:l,value:d}=a;o.attr(l,d)})),t.command==="expand"&&(o.addClass(t.cssClass),o.addClass(this.addWidgetPrefix("group-space"))),t.colspan>1?o.attr("colSpan",t.colspan):!t.isBand&&t.visibleWidth!=="auto"&&n&&((t.width||t.minWidth)&&(s.style.minWidth=bn(t.minWidth||t.width)),t.width&&zg(s,t,bn(t.width))),o}_createRow(e,t){t=t||"tr";const i=h(`<${t}>`).addClass("dx-row");return t==="tr"&&this.setAria("role","row",i),i}_isAltRow(e){return e&&e.dataIndex%2===1}_createTable(e,t){const i=h("<table>").addClass(this.addWidgetPrefix("table")).addClass(this.addWidgetPrefix("table-fixed"));if(e&&!t?(i.attr("id",`dx-${new Te}`).append(this._createColGroup(e)),me.safari&&i.append(h("<thead>").append("<tr>")),this.setAria("role","presentation",i)):this.setAria("hidden",!0,i),this.setAria("role","presentation",h("<tbody>").appendTo(i)),t)return i;me.mozilla&&v.on(i,"mousedown","td",(s=>{s.ctrlKey&&s.preventDefault()})),this.option("cellHintEnabled")&&v.on(i,"mousemove",".dx-row > td",this.createAction((s=>{const o=s.event,a=h(o.target),l=h(o.currentTarget),d=l.parent(),c=this._columnsController.getVisibleColumns(),u=d.data("options"),p=l.index(),g=u&&u.cells&&u.cells[p],_=g?g.column:c[p],f=d.hasClass("dx-header-row"),C=d.hasClass("dx-data-row"),I=d.hasClass(Ls),E=d.hasClass("dx-group-row"),D=d.hasClass(this.addWidgetPrefix("filter-row")),k=C&&(!_||_.cellTemplate),A=C&&g&&(u.isEditing||g.isEditing||(_==null?void 0:_.showEditorAlways)),F=f&&(!_||_.headerCellTemplate),z=E&&(!_||_.groupIndex&&_.groupCellTemplate);!I&&!D&&!A&&!k&&!F&&!z&&(a.data($s)&&(a.removeAttr("title"),a.data($s,!1)),a[0].scrollWidth-a[0].clientWidth>0&&!m(a.attr("title"))&&(a.attr("title",a.text()),a.data($s,!0)))})));const n=s=>{const o=h(s.currentTarget),a=h(s.target).closest(".dx-field-item-content"),l=o.parent(),d=l.data("options"),c=d&&d.cells&&d.cells[o.index()];if(!o.closest("table").is(s.delegateTarget))return;const u=b({},c,{cellElement:$(o),event:s,eventType:s.type});if(u.rowIndex=this.getRowIndex(l),a.length){const p=a.data("dx-form-item");p.column&&(u.column=p.column,u.columnIndex=this._columnsController.getVisibleIndex(u.column.index))}return u};return v.on(i,"mouseover",".dx-row > td",(s=>{const o=n(s);o&&this.executeAction("onCellHoverChanged",o)})),v.on(i,"mouseout",".dx-row > td",(s=>{const o=n(s);o&&this.executeAction("onCellHoverChanged",o)})),v.on(i,Q,".dx-row > td",(s=>{const o=n(s);o&&this.executeAction("onCellClick",o)})),v.on(i,mn,".dx-row > td",(s=>{const o=n(s);o&&this.executeAction("onCellDblClick",o)})),Wg(this,i),i}_rowPointerDown(e){}_rowClick(){}_rowDblClick(){}_createColGroup(e){const t=h("<colgroup>");for(let i=0;i<e.length;i++){const n=e[i].colspan||1;for(let s=0;s<n;s++)t.append(this._createCol(e[i]))}return t}_createCol(e){let t=e.visibleWidth||e.width;t==="adaptiveHidden"&&(t="0.0001px");const i=h("<col>");return Co(i,t),i}renderDelayedTemplates(e){const t=this._delayedTemplates,i=t.filter((s=>!s.async)),n=t.filter((s=>s.async));this._delayedTemplates=[],this._renderDelayedTemplatesCore(i,!1,e),this._renderDelayedTemplatesCoreAsync(n)}_renderDelayedTemplatesCoreAsync(e){if(e.length){const t=oe().setTimeout((()=>{this._templateTimeouts.delete(t),this._renderDelayedTemplatesCore(e,!0)}));this._templateTimeouts.add(t)}}_renderDelayedTemplatesCore(e,t,i){const n=new Date;for(;e.length;){const s=e.shift(),{options:o}=s,a=M.getRootNode(h(o.container).get(0)),l=this.needWaitAsyncTemplates();if((!t||h(o.container).closest(a).length||l)&&(i&&(o.change=i),s.template.render(o)),t&&new Date-n>30){this._renderDelayedTemplatesCoreAsync(e);break}}!e.length&&this._delayedTemplates.length&&this.renderDelayedTemplates()}_processTemplate(e,t){const i=this;let n;if(e&&e.render&&!yo(e))n={allowRenderToDetachedContainer:e.allowRenderToDetachedContainer,render(s){e.render(s.container,s.model,s.change),s.deferred&&s.deferred.resolve()}};else if(B(e))n={render(s){const o=e($(s.container),s.model,s.change);o&&(o.nodeType||yo(o))&&s.container.append(o),s.deferred&&s.deferred.resolve()}};else{const s=W(e)?e:h(e).attr("id");s?(i._templatesCache[s]||(i._templatesCache[s]=i.getTemplate(e)),n=i._templatesCache[s]):n=i.getTemplate(e)}return n}renderTemplate(e,t,i,n,s){const o=this._processTemplate(t,i),{column:a}=i,l=i.rowType==="data",d=new S,c={container:e,model:i,deferred:d,onRendered:()=>{this.isDisposed()?d.reject():d.resolve()}};if(o){i.component=this.component;const u=a&&(a.renderAsync&&l||this.option("renderAsync")&&(a.renderAsync!==!1&&(a.command||a.showEditorAlways)&&l||i.rowType==="filter")),p=i.renderAsync??u;(o.allowRenderToDetachedContainer||n)&&!p?o.render(c):this._delayedTemplates.push({template:o,options:c,async:p}),this._templateDeferreds.add(d),v.on(e,ii,Gg.bind(null,d))}else d.reject();return d.promise().always((()=>{this._templateDeferreds.delete(d)}))}_getBodies(e){return h(e).children("tbody").not(".dx-header").not(".dx-footer")}_needWrapRow(e){var t;return!!this.option().rowTemplate&&!!((t=this._getBodies(e))!==null&&t!==void 0&&t.filter(".dx-row").length)}_wrapRowIfNeed(e,t,i){const n=i?e||this._tableElement:this._tableElement||e;if(this._needWrapRow(n)){const o=h("<tbody>").addClass(t.attr("class"));return this.setAria("role","presentation",o),o.append(t)}return t}_appendRow(e,t,i){i=i||Hg,i.render({content:t,container:e})}_resizeCore(){const e=this._scrollLeft;e>=0&&(this._scrollLeft=0,this.scrollTo({left:e}))}_renderCore(e){const t=this.element().parent();return(!t||t.parent().length)&&this.renderDelayedTemplates(e),new S().resolve()}_renderTable(e){e=e||{},e.columns=this._columnsController.getVisibleColumns();const t=e.change&&e.change.changeType,i=this._createTable(e.columns,t==="append"||t==="prepend"||t==="update");return this._renderRows(i,e),i}_renderRows(e,t){const i=this,n=i._getRows(t.change),s=t.change&&t.change.columnIndices||[],o=t.change&&t.change.changeTypes||[];for(let a=0;a<n.length;a++)i._renderRow(e,b({row:n[a],columnIndices:s[a],changeType:o[a]},t))}_renderRow(e,t){t.columnIndices||(t.row.cells=[]);const i=this._createRow(t.row),n=this._wrapRowIfNeed(e,i);t.changeType!=="remove"&&this._renderCells(i,t),this._appendRow(e,n);const s=b({columns:t.columns},t.row);this._addWatchMethod(s,t.row),this._rowPrepared(n,s,t.row)}_needRenderCell(e,t){return!t||t.indexOf(e)>=0}_renderCells(e,t){const i=this;let n=0;const{row:s}=t,{columns:o}=t;for(let a=0;a<o.length;a++)this._needRenderCell(a,t.columnIndices)&&i._renderCell(e,b({column:o[a],columnIndex:n,value:s.values&&s.values[n],oldValue:s.oldValues&&s.oldValues[n]},t)),o[a].colspan>1?n+=o[a].colspan:n++}_updateCells(e,t,i,n){var s;const o=this,a=e.children(),l=t.children(),d=this.option("highlightChanges"),c=this.addWidgetPrefix("cell-updated-animation");n!=null&&(s=n.node)!==null&&s!==void 0&&s.hasChildren&&a.each((function(){o.setAria("expanded",n.isExpanded,h(this))})),i.forEach(((u,p)=>{const g=a.eq(u),_=l.eq(p);g.replaceWith(_),d&&!_.hasClass("dx-command-expand")&&_.addClass(c)})),Kg(e.get(0),t.get(0))}_setCellAriaAttributes(e,t,i){var n;const{row:s}=i,o=t.rowType==="freeSpace",a=t.rowType==="group",l=s==null||(n=s.node)===null||n===void 0?void 0:n.hasChildren;if(o)return;this.setAria("role","gridcell",e),l&&this.setAria("expanded",s.isExpanded,e);const d=this._columnsController.getColumnIndexOffset(),c=a?t.columnIndex+1:t.columnIndex+d+1;this.setAria("colindex",c,e)}_renderCell(e,t){const i=this._getCellOptions(t);if(t.columnIndices){if(t.row.cells){const s=t.row.cells.findIndex((o=>o.columnIndex===i.columnIndex));t.row.cells[s]=i}}else t.row.cells.push(i);const n=this._createCell(i);return this._setCellAriaAttributes(n,i,t),this._renderCellContent(n,i,t),e.get(0).appendChild(n.get(0)),n}_renderCellContent(e,t,i){const n=this._getCellTemplate(t);O(!n||this.renderTemplate(e,n,t,void 0,i.change)).done((()=>{this._updateCell(e,t)}))}_getCellTemplate(e){}_getRows(e){return[]}_getCellOptions(e){const t={column:e.column,columnIndex:e.columnIndex,rowType:e.row.rowType,rowIndex:e.row.rowIndex,isAltRow:this._isAltRow(e.row)};return this._addWatchMethod(t),t}_addWatchMethod(e,t){if(!this.option("repaintChangesOnly"))return;const i=[];return t=t||e,t.watch=t.watch||function(n,s,o){let a=n(t.data);const l=function(d){d&&o&&o(d);const c=n(t.data);JSON.stringify(a)!==JSON.stringify(c)&&(d&&s(c),a=c)};return i.push(l),function(){const d=i.indexOf(l);d>=0&&i.splice(d,1)}},t.update=t.update||function(n,s){n&&(this.data=e.data=n.data,this.rowIndex=e.rowIndex=n.rowIndex,this.dataIndex=e.dataIndex=n.dataIndex,this.isExpanded=e.isExpanded=n.isExpanded,e.row&&!s&&(e.row=n)),i.forEach((o=>{o(n)}))},t!==e&&(e.watch=t.watch.bind(t)),e}_cellPrepared(e,t){t.cellElement=$(h(e)),this.executeAction("onCellPrepared",t)}_rowPrepared(e,t,i){us(e.get(0),"options",t),t.rowElement=$(e),this.executeAction("onRowPrepared",t)}_columnOptionChanged(e){const{optionNames:t}=e;if(y.checkChanges(t,["width","visibleWidth"])){const n=this._columnsController.getVisibleColumns().map((s=>s.visibleWidth||s.width));this.setColumnWidths({widths:n,optionNames:t});return}this._requireReady||this.render()}getCellIndex(e,t){return e.length?e[0].cellIndex:-1}getTableElements(){return this._tableElement||h()}getTableElement(e){return this._tableElement}setTableElement(e,t){this._tableElement=e}_afterRowPrepared(e){}_handleDataChanged(e){}callbackNames(){return["scrollChanged"]}_updateScrollLeftPosition(){const e=this._scrollLeft;e>=0&&(this._scrollLeft=0,this.scrollTo({left:e}))}scrollTo(e){const t=this.element(),i=t&&t.children(`.${this.addWidgetPrefix("scroll-container")}`).not(`.${this.addWidgetPrefix("content-fixed")}`);m(e)&&m(e.left)&&this._scrollLeft!==e.left&&(this._scrollLeft=e.left,i&&i.scrollLeft(e.left))}getContent(e){var t;return(t=this._tableElement)===null||t===void 0?void 0:t.parent()}_removeContent(e){const t=this.getContent(e);t!=null&&t.length&&t.remove()}handleScroll(e){const t=h(e.target).scrollLeft();t!==this._scrollLeft&&this.scrollChanged.fire({left:t},this.name)}_wrapTableInScrollContainer(e,t){const i=h("<div>"),n=this.option("scrolling.useNative");return(n===!1||n==="auto"&&!hs.nativeScrolling)&&i.addClass(this.addWidgetPrefix("scrollable-simulated")),v.on(i,"scroll",this.handleScroll.bind(this)),i.addClass(this.addWidgetPrefix("content")).addClass(this.addWidgetPrefix("scroll-container")).append(e).appendTo(this.element()),this.setAria("role","presentation",i),i}needWaitAsyncTemplates(){return this.option("templatesRenderAsynchronously")&&this.option("renderAsync")===!1}waitAsyncTemplates(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=new S;if(!(e||this.needWaitAsyncTemplates())||!m(this._templateDeferreds))return t.resolve();const n=()=>O.apply(this,Array.from(this._templateDeferreds)).done((()=>{this.isDisposed()?t.reject():this._templateDeferreds.size>0?n():t.resolve()})).fail(t.reject);return n(),t.promise()}_updateContent(e,t,i){return this.waitAsyncTemplates().done((()=>{this._removeContent(i),this.setTableElement(e,i),this._wrapTableInScrollContainer(e,i)}))}_findContentElement(e){}_getWidths(e){if(!e)return[];const t=[];return e.toArray().forEach((n=>{let s=n.offsetWidth;if(n.getBoundingClientRect){const o=re(n);o.width>n.offsetWidth-1&&(s=o.width)}t.push(s)})),t}getColumnWidths(e,t){if((this.option("forceApplyBindings")||Ce)(),e=e??this.getTableElement(),e){const i=e.children("tbody:not(.dx-header)").children();for(let n=0;n<i.length;n++){const s=i.eq(n),o=s.hasClass("dx-group-row"),a=s.hasClass(Ls),l=s.hasClass("dx-error-row");if(s.get(0).style.display!=="none"&&!s.hasClass("dx-state-invisible")&&(!o&&!a&&!l)){const u=s.children("td");return this._getWidths(u)}}}return[]}getVisibleColumnIndex(e,t){return e}setCellPropertiesCore(e,t,i){const n=t.hasClass("dx-group-row")?t.find(`td[aria-colindex='${i+1}']:not(.dx-group-cell)`):t.find("td").eq(i);for(let s=0;s<n.length;s+=1){const o=n.get(s);Object.assign(o.style,e)}}setCellProperties(e,t,i){const n=this.getTableElement();if(!(n!=null&&n.length))return;const s=n.children().children(".dx-row").not(`.${Ls}`);if(m(i))this.setCellPropertiesCore(e,s.eq(i),t);else for(let o=0;o<s.length;o++){const a=this.getVisibleColumnIndex(t,o);a>=0&&this.setCellPropertiesCore(e,s.eq(o),a)}}setColumnWidths(e){let{widths:t,optionNames:i}=e;const n=this.getTableElement();if(!(n!=null&&n.length)||!t)return;const s=this.getColumns(),o=this._needToSetCellWidths(),a=n.children("colgroup").children("col");a.toArray().forEach((l=>l.removeAttribute("style"))),s.forEach(((l,d)=>{if(o&&l.width&&!l.command){const u={},p=bn(l.visibleWidth||l.width),g=bn(l.minWidth||p);u.width=l.width==="auto"?"":p,u.maxWidth=u.width,u.minWidth=g,this.setCellProperties(u,d)}const c=cc(t[d]);m(c)&&Co(a.eq(d),c)}))}getCellElements(e){return this._getCellElementsCore(e)}_getCellElementsCore(e){return e<0?void 0:this._getRowElements().eq(e).children()}_getCellElement(e,t){const i=this.getCellElements(e),n=this._getVisibleColumnIndex(i,e,t);if(!(i!=null&&i.length)||n<0)return;const s=i.eq(n);return s.length>0?s:void 0}_getRowElement(e){const t=this;let i=h();const n=t.getTableElements();if(x(n,((s,o)=>{i=i.add(t._getRowElements(h(o)).eq(e))})),i.length)return i}getCellElement(e,t){const i=this._getCellElement(e,t);if(i)return $(i)}getRowElement(e){const t=this._getRowElement(e);let i=[];if(t&&!$(t).get)for(let n=0;n<t.length;n++)i.push(t[n]);else i=t;return i}_getVisibleColumnIndex(e,t,i){if(W(i)){const n=this._columnsController.columnOption(i,"index");return this._columnsController.getVisibleIndex(n)}return i}getColumnElements(){}getColumns(e,t){return this._columnsController.getVisibleColumns(e)}getCell(e,t,i){const n=t||this._getRowElements();let s;if(n.length>0&&e.rowIndex>=0){var o;if(this.option("scrolling.mode")!=="virtual"&&this.option("scrolling.rowRenderingMode")!=="virtual"&&(e.rowIndex=e.rowIndex<n.length?e.rowIndex:n.length-1),s=i||this.getCellElements(e.rowIndex),((o=s)===null||o===void 0?void 0:o.length)>0)return s.eq(s.length>e.columnIndex?e.columnIndex:s.length-1)}}getRowsCount(){const e=this.getTableElement();return e&&e.length===1?e[0].rows.length:0}_getRowElementsCore(e){if(e=e||this.getTableElement(),e){const i=(this.option().rowTemplate||this.option("dataRowTemplate"))&&e.find("> tbody.dx-row");return i&&i.length?i:e.find("> tbody > .dx-row, > .dx-row")}return h()}_getRowElements(e){return this._getRowElementsCore(e)}getRowIndex(e){return this._getRowElements().index(e)}getBoundingRect(){}getName(){}setScrollerSpacing(e){const t=this.element(),i=this.option("rtlEnabled");t&&t.css({paddingLeft:i?e:"",paddingRight:i?"":e})}isScrollbarVisible(e){const t=this.element(),i=this._tableElement;return t&&i?e?ge(i)-H(t)>0:Y(i)-X(t)>0:!1}isDisposed(){var e;return(e=this.component)===null||e===void 0?void 0:e._disposed}}const Ug="dx-link",Hs=function(r,e,t){const i=h("<div>").addClass(r.addWidgetPrefix("text-content"));r.setAria("role","presentation",i),uc(r,e,t.column,i);const n=r.option("showColumnLines"),s=r.getController("columns").getHeaderContentAlignment(t.column.alignment);return i[n||s==="right"?"appendTo":"prependTo"](e)};function uc(r,e,t,i){const n=r._getIndicatorElements(e,!0),s=r._getIndicatorElements(e),o=n==null?void 0:n.length,a=r._getColumnAlignment(t.alignment),l=`.${r._getIndicatorClassName("sort")}`,d=`.${r._getIndicatorClassName("sortIndex")}`,c=s.filter(l),u=s.children().filter(d);i=i||e.children(`.${r.addWidgetPrefix("text-content")}`),i.toggleClass("dx-text-content-alignment-"+a,o>0).toggleClass("dx-text-content-alignment-"+(a==="left"?"right":"left"),o>0&&t.alignment==="center").toggleClass("dx-sort-indicator",!!c.length).toggleClass("dx-sort-index-indicator",!!u.length).toggleClass("dx-header-filter-indicator",!!s.filter(`.${r._getIndicatorClassName("headerFilter")}`).length)}class qg extends hg(xs){init(){super.init(),this._headerPanelView=this.getView("headerPanel"),this._headerFilterController=this.getController("headerFilter"),this._dataController=this.getController("data"),this._headersKeyboardNavigation=this.getController("headersKeyboardNavigation")}_createTable(){const e=super._createTable.apply(this,arguments);return v.on(e,"mousedown selectstart",this.createAction((t=>{const{event:i}=t;i.shiftKey&&i.preventDefault()}))),e}_isLegacyKeyboardNavigation(){return this.option("useLegacyKeyboardNavigation")}_getDefaultTemplate(e){const t=this;return function(i,n){const{caption:s}=e,o=!e.command||s&&e.command!=="expand";e.command==="empty"?t._renderEmptyMessage(i,n):o?Hs(t,i,n).text(s):e.command&&i.html("&nbsp;")}}_renderEmptyMessage(e,t){const i=this._getEmptyHeaderText();if(!i){e.html("&nbsp;");return}const n=Hs(this,e,t);if(i.includes("{0}")){const[o,a]=i.split("{0}"),l=w.format("dxDataGrid-emptyHeaderColumnChooserText"),d=this._columnChooserView,c=h("<a>").text(l).addClass(Ug);v.on(c,"click",this.createAction((()=>d.showColumnChooser()))),n.append(M.createTextNode(o)).append(c).append(M.createTextNode(a))}else n.text(i)}_getEmptyHeaderText(){const e=!!this._columnChooserView.hasHiddenColumns(),t=!!this._headerPanelView.hasGroupedColumns();switch(!0){case(e&&t):return w.format("dxDataGrid-emptyHeaderWithColumnChooserAndGroupPanelText");case t:return w.format("dxDataGrid-emptyHeaderWithGroupPanelText");case e:return w.format("dxDataGrid-emptyHeaderWithColumnChooserText");default:return""}}_getHeaderTemplate(e){return e.headerCellTemplate||{allowRenderToDetachedContainer:!0,render:this._getDefaultTemplate(e)}}_processTemplate(e,t){const i=this;let n;const{column:s}=t,o=super._processTemplate(e);return t.rowType==="header"&&o&&s.headerCellTemplate&&!s.command?n={render(a){const l=Hs(i,a.container,a.model);o.render(b({},a,{container:l}))}}:n=o,n}_handleDataChanged(e){e.changeType==="refresh"&&(this._isGroupingChanged||this._requireReady)&&(this._isGroupingChanged=!1,this.render())}_renderCell(e,t){const i=super._renderCell(e,t);if(t.row.rowType==="header"&&(i.addClass("dx-cell-focus-disabled"),!this._isLegacyKeyboardNavigation())){const{column:n}=t,s=this._columnsController.isCustomCommandColumn(n);n&&(!n.type||s)&&i.attr("tabindex",this.option("tabindex")||0)}return i}_setCellAriaAttributes(e,t,i){super._setCellAriaAttributes(e,t,i),t.rowType==="header"&&(t.column.type||this.setAria("role","columnheader",e),t.column&&!t.column.command&&!t.column.isBand&&(e.attr("id",t.column.headerId),this.setAria("label",`${w.format("dxDataGrid-ariaColumn")} ${t.column.caption}`,e)))}_createRow(e){const t=super._createRow.apply(this,arguments);return t.toggleClass("dx-column-lines",this.option("showColumnLines")),e.rowType==="header"&&(t.addClass("dx-header-row"),this._isLegacyKeyboardNavigation()||Hn("columnHeaders",this,t,"td",this._handleActionKeyDown.bind(this))),t}_processHeaderAction(e,t){}_handleActionKeyDown(e){const{event:t}=e,i=h(t.target);if(this._lastActionElement=t.target,i.is(".dx-header-filter")){const n=this._headerFilterController,s=i.closest("td"),o=this.getColumnIndexByElement(s);o>=0&&n.showHeaderFilterMenu(o,!1)}else{const n=i.closest(".dx-row");this._processHeaderAction(t,n)}t.preventDefault()}_renderCore(){const e=this.element(),t={};if(this._tableElement&&!this._dataController.isLoaded()&&!this._hasRowElements)return new S().resolve();e.addClass(this.addWidgetPrefix("headers")).toggleClass(this.addWidgetPrefix("nowrap"),!this.option("wordWrapEnabled")),this.setAria("role","presentation",e);const i=this._updateContent(this._renderTable({change:t}),t);return e.toggleClass("dx-header-multi-row",this.getRowCount()>1),super._renderCore.apply(this,arguments),i}_renderRows(){const e=this;(e._dataController.isLoaded()||e._hasRowElements)&&(super._renderRows.apply(e,arguments),e._hasRowElements=!0)}_renderRow(e,t){const i=this.getRowCount()===1?null:t.row.rowIndex;t.columns=this.getColumns(i),super._renderRow(e,t)}_createCell(e){const{column:t}=e,i=super._createCell.apply(this,arguments);return t.rowspan>1&&e.rowType==="header"&&i.attr("rowSpan",t.rowspan),i}_getRows(){const e=[],t=this.getRowCount();if(this.option("showColumnHeaders"))for(let i=0;i<t;i++)e.push({rowType:"header",rowIndex:i});return e}_getCellTemplate(e){if(e.rowType==="header")return this._getHeaderTemplate(e.column)}_columnOptionChanged(e){const{changeTypes:t}=e,{optionNames:i}=e;if(t.grouping||t.groupExpanding){t.grouping&&(this._isGroupingChanged=!0);return}super._columnOptionChanged(e),(i.width||i.visible)&&this.resizeCompleted.fire()}_isElementVisible(e){return e==null?void 0:e.visible}_alignCaptionByCenter(e){var t;let i=this._getIndicatorContainer(e,!0);(t=i)!==null&&t!==void 0&&t.length&&(i.filter(".dx-visibility-hidden").remove(),i=this._getIndicatorContainer(e),i.clone().addClass("dx-visibility-hidden").css("float","").insertBefore(e.children(`.${this.addWidgetPrefix("text-content")}`)))}_updateCell(e,t){t.rowType==="header"&&t.column.alignment==="center"&&this._alignCaptionByCenter(e),super._updateCell.apply(this,arguments)}_updateIndicator(e,t,i){const n=super._updateIndicator.apply(this,arguments);return t.alignment==="center"&&this._alignCaptionByCenter(e),uc(this,e,t),n}_getIndicatorContainer(e,t){const i=super._getIndicatorContainer(e);return t?i:i.filter(":not(.dx-visibility-hidden)")}_isSortableElement(e){return!0}getHeadersRowHeight(){const e=this.getTableElement(),t=e==null?void 0:e.find(".dx-header-row");return(t==null?void 0:t.toArray().reduce(((i,n)=>i+X(n)),0))||0}getHeaderElement(e){const t=this.getColumnElements();return(t==null?void 0:t.eq(e))??h("")}getColumnElements(e,t){const i=this;let n;const s=i._columnsController,o=i.getRowCount();if(i.option("showColumnHeaders")){if(o>1&&(!m(e)||m(t))){const a=[],l=m(t)?s.getChildrenByBandColumn(t,!0):s.getVisibleColumns();return x(l,((d,c)=>{const u=m(e)?e:s.getRowIndex(c.index);n=i._getCellElement(u,s.getVisibleIndex(c.index,u)),n&&a.push(n.get(0))})),h(a)}if(!e||e<o)return i.getCellElements(e||0)}}getColumnIndexByElement(e){const t=this.getCellIndex(e),i=e.closest(".dx-row"),{rowIndex:n}=i[0],s=this.getColumns(n)[t];return s?s.index:-1}getVisibleColumnIndex(e,t){const i=this.getColumns()[e];return i?this._columnsController.getVisibleIndex(i.index,t):-1}getColumnWidths(e,t){const i=this.getColumnElements(t);return i!=null&&i.length?this._getWidths(i):super.getColumnWidths.apply(this,arguments)}isColumnReorderingEnabled(e){return e.allowReordering&&(this.option("allowColumnReordering")??this._columnsController.isColumnOptionUsed("allowReordering"))}allowDragging(e){const t=e&&this._columnsController.getRowIndex(e.index),i=this.getColumns(t);return this.isColumnReorderingEnabled(e)&&i.length>1}getBoundingRect(){const e=this,t=e.getColumnElements();return t!=null&&t.length?{top:e.getTableElement().offset().top}:null}getName(){return"headers"}getColumnCount(){const e=this.getColumnElements();return e?e.length:0}isVisible(){return this.option("showColumnHeaders")}optionChanged(e){const t=this;switch(e.name){case"showColumnHeaders":case"wordWrapEnabled":case"showColumnLines":t._invalidate(!0,!0),e.handled=!0;break;default:super.optionChanged(e)}}getHeight(){return this.getElementHeight()}getContextMenuItems(e){let t;const{column:i}=e;if(e.row&&(e.row.rowType==="header"||e.row.rowType==="detailAdaptive")){const n=this.option("sorting");if(n&&n.mode!=="none"&&i!==null&&i!==void 0&&i.allowSorting){const s=o=>{setTimeout((()=>{this._columnsController.changeSortOrder(i.index,o.itemData.value)}))};t=[{text:n.ascendingText,value:"asc",disabled:i.sortOrder==="asc",icon:"context-menu-sort-asc",onItemClick:s},{text:n.descendingText,value:"desc",disabled:i.sortOrder==="desc",icon:"context-menu-sort-desc",onItemClick:s},{name:"clearSorting",text:n.clearText,value:"none",disabled:!i.sortOrder,icon:"context-menu-sort-none",onItemClick:s}]}if(e.row.rowType==="header"){const s=this.getMoveColumnContextMenuItems(e);s!=null&&s.length&&(t=t??[],t.push(...s))}}return t}getRowCount(){var e;return(e=this._columnsController)===null||e===void 0?void 0:e.getRowCount()}toggleDraggableColumnClass(e,t,i){let n,s;const o=this.getRowCount(),a=this._columnsController.getColumns(),l=a==null?void 0:a[e],d=(l==null?void 0:l.isBand)&&l.index,c=(u,p)=>{u.ownerBand===d&&(s.eq(p).toggleClass(this.addWidgetPrefix(Jn.draggableColumn),t),u.isBand&&this.toggleDraggableColumnClass(u.index,t,n+1))};if(m(d))for(i=i||0,n=i;n<o;n++)s=this.getCellElements(n),s&&this.getColumns(n).forEach(c)}isFilterRowCell(e){return!1}getKeyboardNavigationController(){return this._headersKeyboardNavigation}}const wS={defaultOptions:()=>({showColumnHeaders:!0,cellHintEnabled:!0}),views:{columnHeadersView:qg}},Yg=2;var U;(function(r){r.Left="left",r.Right="right",r.Sticky="sticky"})(U||(U={}));const J={stickyColumn:"sticky-column",stickyColumnLeft:"sticky-column-left",stickyColumnRight:"sticky-column-right",stickyColumnBorderRight:"sticky-column-border-right",stickyColumnBorderLeft:"sticky-column-border-left",stickyColumns:"sticky-columns",firstHeader:"first-header",columnNoBorder:"column-no-border",groupRowContainer:"group-row-container",focusedFixedElement:"dx-focused-fixed-element"},hc=["filterValues","filterType","fixed","fixedPosition"],ts=["visibleIndex","dataField","name","dataType","width","visible","sortOrder","lastSortOrder","sortIndex","groupIndex","filterValue","bufferedFilterValue","selectedFilterOperation","bufferedSelectedFilterOperation","added"].concat(hc),jg={visibleWidth:!0,bestFitWidth:!0,bufferedFilterValue:!0},Xg="dx-command-expand",ca=Number.MAX_SAFE_INTEGER||9007199254740991,Ft="groupExpand",Zg="detailExpand",Ws=/columns\[(\d+)\]\.?/gi,Qg={visible:!0,showInColumnChooser:!0},Jg={number:["=","<>","<",">","<=",">=","between"],string:["contains","notcontains","startswith","endswith","=","<>"],date:["=","<>","<",">","<=",">=","between"],datetime:["=","<>","<",">","<=",">=","between"]},em={visibleIndex:!0,groupIndex:!0,grouped:!0,sortIndex:!0,sortOrder:!0},fi="group",Ci="columnChooser",tm=["fixed","fixedPosition","type","buttons"],rr="adaptiveHidden",Mt=(r,e)=>{const{fixedPosition:t}=e,i=r.option("rtlEnabled"),n=e.command&&e.command==="expand";return e.command&&!y.isCustomCommandColumn(r._columns,e)&&i&&!n?t===U.Right?U.Left:U.Right:t??U.Left},ar=function(r,e){return r.isVirtualMode()&&!!e.fixed&&e.fixedPosition===U.Sticky},ua=function(r,e){return e.map((t=>ar(r,t)?T({},t,{fixed:!1,fixedPosition:""}):t))},lr=function(r,e){return e.visibleWidth!==rr&&(!e.isBand||!!r.getVisibleDataColumnsByBandColumn(e.index).length)},ha=function(r,e){return!e.some((t=>!t.fixed&&lr(r,t)))},yn=function(r,e,t,i,n,s){const o=e[i],a=m(o.ownerBand),l=n===U.Right,d=o.fixedPosition===U.Sticky,c=l?e.slice(i+1):e.slice(0,i).reverse(),u=l?t.slice(i+1):t.slice(0,i).reverse();let p=0,g=0,_=!ha(r,c)&&d&&c.length?1:0;if(c.forEach(((C,I)=>{if(C.fixed&&(!m(s)||o.ownerBand===C.ownerBand)){const E=C.fixedPosition===U.Sticky;p+=u[I]??C.visibleWidth,d&&E&&!ha(r,c.slice(I+1))&&(I!==g?(_+=1,g=I+1):g+=1)}else lr(r,C)||(g+=1)})),a&&m(s)){var f;return p+=(s==null||(f=s[o.ownerBand])===null||f===void 0?void 0:f[n])??0,p}return p-_*Yg},pc=function(r,e,t){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=arguments.length>5?arguments[5]:void 0;const a=r.option("rtlEnabled")!==n?"isLastColumn":"isFirstColumn";if(e.fixedPosition===U.Sticky){const l=r.getParentColumn(e)??e;if(r[a](l,0))return!1}return r[a](e,t,i,s)},im=function(r,e,t,i){const n=r.getVisibleIndex(e.index,i);return t==null?void 0:t.slice(0,n).reverse().find((s=>lr(r,s)))},gc=function(r,e,t,i,n){const s={},o=e[i];if(o)switch(Mt(r,o)){case U.Sticky:{const l=yn(r,e,t,i,U.Left,n),d=yn(r,e,t,i,U.Right,n);s.left=l,s.right=d;break}case U.Right:{const l=yn(r,e,t,i,U.Right,n);s.right=l;break}default:{const l=yn(r,e,t,i,U.Left,n);s.left=l}}return s},pa=function(r,e,t,i){const n=im(r,e,t,i),s=Mt(r,e),o=n&&Mt(r,n);return!!(n!=null&&n.fixed)&&!ar(r,n)&&(!e.fixed||s===U.Sticky||o===U.Sticky)},nm=function(r,e,t){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const n=r.getVisibleColumns(i?null:t),s=r.getParentColumn(e);return s?r.isFirstColumn(e,t,!0)&&pa(r,s,r.getVisibleColumns(0),0):pa(r,e,n,t)},mc=function(r){const e={};return m(r.left)&&(e.left=`${r.left}px`),m(r.right)&&(e.right=`${r.right}px`),e},sm=function(r,e,t){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,n=arguments.length>4?arguments[4]:void 0;return pc(r,e,t,i,!1,n)},om=function(r,e,t){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,n=arguments.length>4?arguments[4]:void 0;return pc(r,e,t,i,!0,n)},_c=function(r,e,t){return!(m(r.isLeftBoundary)||m(r.isRightBoundary))&&!!e&&!!t&&e.fixed!==t.fixed},rm=(r,e)=>{if(r!=null&&r._isWarnedAboutUnsupportedProperties||!e||!Array.isArray(e)||(e==null?void 0:e.length)===0)return;let t=null;for(const i of e){if(t)break;if(!(!i||typeof i!="object"||i===null)){for(const n of tm)if(n in i){t=n;break}}}t&&(r&&(r._isWarnedAboutUnsupportedProperties=!0),se.log("W1028",t))},fc=function(r){r.filterOperations=r.defaultFilterOperations};let am=1;const ws=function(r,e,t,i){let n={};if(e){W(e)&&(e={dataField:e}),r.setName(e);let s={};if(e.command)s=Et(n,e);else{n=r.getCommonSettings(e),t&&t.name&&t.dataField&&(e=b({},e,{dataField:t.dataField}));const o=r._createCalculatedColumnOptions(e,i);e.type||(s={headerId:"dx-col-"+am++}),s=Et(s,Qg,!1,!0),Et(s,n,!1,!0),Et(s,o,!1,!0),Et(s,e,!1,!0),Et(s,{selector:null},!1,!0)}return e.filterOperations===e.defaultFilterOperations&&fc(s),s}},qt=function(r,e,t,i){let n=[];return e&&x(e,((s,o)=>{const a=(i??0)+n.length,l=r._columnsUserState&&dr(o,r._columnsUserState[a])&&r._columnsUserState[a],d=ws(r,o,l,t);d&&(t&&(d.ownerBand=t),n.push(d),d.columns&&(rm(r,d.columns),n=n.concat(qt(r,d.columns,d,n.length)),delete d.columns,d.hasColumns=!0))})),n},mt=function(r,e){const t=[];let i=e[r];for(;i;)t.unshift(i),r=i.index,i=e[r];return t},Cc=function(r,e,t){let i=[];const n=e[r];if(n)for(let s=0;s<n.length;s++){const o=n[s];(!m(o.groupIndex)||o.showWhenGrouped)&&(i.push(o),t&&o.isBand&&(i=i.concat(Cc(o.index,e,t))))}return i},lm=function(r,e){let t,i;const n=r.getBandColumnsCache(),s=function(o){const a=t?t.index:void 0;return o.ownerBand===a};if(n.isPlain)t=r._columns[e[0]];else{i=r._columns.filter(s);for(let o=0;o<e.length;o++)t=i[e[o]],t&&(i=r._columns.filter(s))}return t},dm=function(r,e){let t=[],i;const n=r.getBandColumnsCache(),s=function(o){return o.ownerBand===e.ownerBand};if(n.isPlain){const o=r._columns.indexOf(e);o>=0&&(t=[`columns[${o}]`])}else for(i=r._columns.filter(s);i.length&&i.indexOf(e)!==-1;)t.unshift(`columns[${i.indexOf(e)}]`),e=n.columnParentByIndex[e.index],i=e?r._columns.filter(s):[];return t.join(".")},vc=function(r,e){let t=0;const i=r.getChildrenByBandColumn(e,!0);return x(i,((n,s)=>{s.isBand?(s.colspan=s.colspan||vc(r,s.index),t+=s.colspan||1):t+=1})),t},cm=function(r,e,t){let i;for(let n=0;n<e.length;n++){const s=e[n];(s.visible||s.command)&&(s.isBand&&(s.colspan=s.colspan||vc(r,s.index)),(!s.isBand||!s.colspan)&&(i=r.getRowCount(),!s.command&&(!m(s.groupIndex)||s.showWhenGrouped)&&(i-=mt(s.index,t.columnParentByIndex).length),i>1&&(s.rowspan=i)))}},zs=function(r){let e=Rd(r);return e!=="string"&&e!=="boolean"&&e!=="number"&&e!=="date"&&e!=="object"&&(e=void 0),e},ga=function(r,e){switch(r){case"date":case"datetime":return fe.getDateSerializationFormat(e);case"number":if(W(e))return"string";if(Ee(e))return null}},ma=function(r,e){r.deserializeValue||(y.isDateType(e)&&(r.deserializeValue=function(t){return fe.deserializeDate(t)},r.serializeValue=function(t){return W(t)?t:fe.serializeDate(t,this.serializationFormat)}),e==="number"&&(r.deserializeValue=function(t){const i=parseFloat(t);return isNaN(i)?t:i},r.serializeValue=function(t,i){return i==="filter"?t:m(t)&&this.serializationFormat==="string"?t.toString():t}))},um=function(r,e){switch(r){case"number":return"right";case"boolean":return"center";default:return cn(e)}},hm=function(r){return r.value===!0?this.trueText||"true":r.value===!1?this.falseText||"false":r.valueText||""},_a=function(r){if(r==="boolean")return hm},pm=function(r,e){const t=r._getFirstItems(e);let i;const n={},s=[];for(let o=0;o<t.length;o++)if(t[o])for(i in t[o])(!B(t[o][i])||gt.isWrapped(t[o][i]))&&(n[i]=!0);for(i in n)if(i.indexOf("__")!==0){const o=ws(r,i);s.push(o)}return s},xc=function(r){x(r._columns,((e,t)=>{t.index=e})),x(r._columns,((e,t)=>{L(t.ownerBand)&&(t.ownerBand=t.ownerBand.index)})),x(r._commandColumns,((e,t)=>{t.index=-(e+1)}))},wc=function(r,e){sn(r._columns,"groupIndex",e,(t=>{const{grouped:i}=t;return delete t.grouped,i}))},gm=function(r,e){x(r._columns,((t,i)=>{m(i.sortIndex)&&!is(i.sortOrder)&&delete i.sortIndex})),sn(r._columns,"sortIndex",e,(t=>!m(t.groupIndex)&&is(t.sortOrder)))},mm=function(r,e){let t;const i=[],n=r.getBandColumnsCache(),s=[],o=r._columns.filter((a=>!a.command));for(let a=0;a<o.length;a++)t=o[a],mt(a,n.columnParentByIndex).length?s.push(t):i.push(t);sn(s,"visibleIndex",e),sn(i,"visibleIndex",e)},Ks=function(r,e,t){const i=L(e)?e.rowIndex:null,n=t===fi?r.getGroupColumns():t===Ci?r.getChooserColumns():r.getVisibleColumns(i,!0);let s;return e=L(e)?e.columnIndex:e,s=n[e],s&&s.type===Ft&&(s=r._columns.filter((o=>s.type===o.type))[0]||s),s&&m(s.index)?s.index:-1},_m=function(r,e,t){const i=r.getGroupColumns();let n;if(t>=0)for(n=0;n<i.length;n++)i[n].groupIndex>=t&&i[n].groupIndex++;else for(t=0,n=0;n<i.length;n++)t=Math.max(t,i[n].groupIndex+1);return t};function dr(r,e){return r&&e&&e.name===(r.name||r.dataField)&&(e.dataField===r.dataField||r.name)}const fa=function(r){const e=r._columnsUserState,t=r._ignoreColumnOptionNames||[],i=r._columns,n={};let s=[],o=!0;const a=[];let l,d,c;function u(g,_){if(_)for(let f=0;f<ts.length;f++){const C=ts[f];t.includes(C)||(C==="dataType"?g[C]=g[C]||_[C]:hc.includes(C)?C in _&&(g[C]=_[C]):(C==="selectedFilterOperation"&&_[C]&&(g.defaultSelectedFilterOperation=g[C]||null),g[C]=_[C]))}}function p(g,_){const f=_.name||_.dataField;let C=n[f]||0;for(let I=0;I<g.length;I++)if(dr(_,g[I]))if(C)C--;else return n[f]=n[f]||0,n[f]++,I;return-1}if(e){for(c=0;c<i.length;c++)d=p(e,i[c]),o=o&&d>=0,a.push(d);for(c=0;c<i.length;c++)l=i[c],d=a[c],(r._hasUserState||o)&&u(l,e[d]),d>=0&&m(e[d].initialIndex)?s[d]=l:s.push(l);let g=!1;for(c=0;c<e.length;c++){const _=e[c];_.added&&p(i,_)<0&&(l=ws(r,_.added),u(l,_),s.push(l),_.added.columns&&(g=!0))}g&&(xc(r),s=qt(r,s)),vi(r,s)}},Ut=function(r,e){xc(r),wc(r,e),gm(r,e),yc(r),mm(r,e)},bs=function(r){r.resetColumnsCache()};function vi(r,e){r._previousColumns=r._columns,r._columns=e,bs(r),r.updateColumnDataTypes()}const ot=function(r,e,t,i){const n=r._columnChanges||{optionNames:{length:0},changeTypes:{length:0},columnIndex:i};t=t||"all",t=t.split(".")[0];const{changeTypes:s}=n;e&&!s[e]&&(s[e]=!0,s.length++);const{optionNames:o}=n;t&&!o[t]&&(o[t]=!0,o.length++),(i===void 0||i!==n.columnIndex)&&(m(i)&&(n.columnIndices??(n.columnIndices=[]),m(n.columnIndex)&&n.columnIndices.push(n.columnIndex),n.columnIndices.push(i)),delete n.columnIndex),r._columnChanges=n,bs(r)},Pi=function(r){const e=r.option("onColumnsChanging"),t=r._columnChanges,i=["dataField","lookup","dataType","columns"];r.isInitialized()&&!r._updateLockCount&&t&&(e&&(r._updateLockCount++,e(b({component:r.component},t)),r._updateLockCount--),r._columnChanges=void 0,n=t.optionNames,n&&i.some((s=>n[s]))?(r._reinitAfterLookupChanges=t==null?void 0:t.optionNames.lookup,r.reinit(),r._reinitAfterLookupChanges=void 0):r.columnsChanged.fire(t));var n},fm=function(r,e,t,i){const n=i>=0;if(t>=0)n||(e.lastSortOrder=e.sortOrder);else{const s=r.option("sorting.mode");let o=e.lastSortOrder;s==="single"&&r._columns.some((l=>l!==e&&m(l.sortIndex)))&&(o=void 0),e.sortOrder=o}},Cm=function(r,e){const{value:t}=e,{optionName:i}=e,{prevValue:n}=e,{fullOptionName:s}=e,o=`${s}.${i}`;!jg[i]&&r._skipProcessingColumnsChange!==o&&(r._skipProcessingColumnsChange=o,r.component._notifyOptionChanged(o,t,n),r._skipProcessingColumnsChange=!1)},Gs=function(r,e,t,i,n){const s=Pe(t),o=e.index;let a,l,d;if(arguments.length===3)return s(e,{functionsAsIs:!0});const c=s(e,{functionsAsIs:!0});if(!ae(c,i,{maxDepth:5})){t==="groupIndex"?(l="grouping",fm(r,e,i,c)):t==="calculateGroupValue"?l="grouping":t==="sortIndex"||t==="sortOrder"||t==="calculateSortValue"?l="sorting":l="columns";const u=Vd(t);u(e,i,{functionsAsIs:!0});const p=dm(r,e);em[t]&&(Ut(r,e),i=s(e)),(t==="name"||t==="allowEditing")&&r._checkColumns(),!m(c)&&!m(i)&&t.indexOf("buffer")!==0&&n!==!1&&(n=!0),n?bs(r):(!ts.includes(t)&&t!=="visibleWidth"&&(a=r.option("columns"),d=r.getColumnByPath(p,a),W(d)&&(d=a[o]={dataField:d}),d&&dr(d,e)&&u(d,i,{functionsAsIs:!0})),ot(r,l,t,o)),p&&Cm(r,{fullOptionName:p,optionName:t,value:i,prevValue:c})}};function is(r){return r==="asc"||r==="desc"}const vm=function(r){const e=r._getExpandColumnOptions();r.addCommandColumn(e)},xm=function(r,e){if(!this.dataField)return;const t=this.dataField.split("."),i=t.length-1;this.serializeValue&&(e=this.serializeValue(e));for(let n=0;n<i;n++){const s=t[n];r=r[s]=r[s]||{}}r[t[i]]=e},bc=function(r,e,t){const i=[];return e=e||0,r[e]&&x(r[e],((n,s)=>{(s.ownerBand===t||s.type===Ft)&&(!s.isBand||!s.colspan?(!s.command||e<1)&&i.push(s):i.push.apply(i,bc(r,e+1,s.index)))})),i},wm=function(r){let e=1;const t=r.getBandColumnsCache(),{columnParentByIndex:i}=t;return r._columns.forEach((n=>{const s=mt(n.index,i),o=s.filter((a=>!a.visible));n.visible&&!o.length&&(e=Math.max(e,s.length+1))})),e},Ca=function(r,e){const t=r.option("rtlEnabled");return e.command&&!y.isCustomCommandColumn(r._columns,e)||!e.fixedPosition?t?"right":"left":e.fixedPosition},va=function(r,e,t,i){let n;const s=this.getRowCount();let o=r[i]&&r[i].rowspan,a=e.filter((l=>l.type===t));return r.forEach(((l,d)=>{l.type===t&&(n=d,o=r[d+1]?r[d+1].rowspan:s)})),o>1&&(a=wt(a,(l=>b({},l,{rowspan:o})))),a.unshift.apply(a,m(n)?[n,1]:[i,0]),r.splice.apply(r,a),o||1},bm=function(r){let e;for(e=0;r>1;e++)r/=10;return e},xa=function(r,e){let t=r?r.toString():"0";for(;t.length<e;)t=`0${t}`;return t},wa=(r,e,t,i)=>{let n,s,o=e.slice().map((u=>b({},u)));const a=r._isColumnFixing();let l=t.slice().map((u=>b({fixed:a},u)));const d=u=>t.reduce(((p,g,_)=>{const f=i&&u.type===Ft?"expand":u.type;return g.type===f||g.command===u.command?_:p}),-1),c=u=>u.command!==t[s].command;for(let u=0;u<e.length;u++)if(n=e[u],s=n&&(n.type||n.command)?d(n):-1,s>=0)if(i)o[u]=b({fixed:a},t[s],n),n.type!==Ft&&(l=l.filter(c));else{const p={visibleIndex:n.visibleIndex,index:n.index,headerId:n.headerId,allowFixing:n.groupIndex===0,allowReordering:n.groupIndex===0,groupIndex:n.groupIndex};o[u]=b({},n,t[s],n.type===Ft&&p)}return e.length&&i&&l.length&&(o=o.concat(l)),o},ba=(r,e)=>m(e.fixed)||!e.type?e.fixed&&e.fixedPosition!==U.Sticky:r._isColumnFixing(),ym=r=>{r.forEach((e=>{m(e.ownerBand)&&(e.ownerBand=r[e.ownerBand])}))},yc=r=>{r._bandColumnsCache=void 0},ya=(r,e)=>{const t=W(e)&&e.substr(0,e.indexOf(":"));let i;if(e!==void 0)return t&&(e=e.substr(t.length+1)),t?i=r.filter((n=>`${n[t]}`===e))[0]:["index","name","dataField","caption"].some((n=>(i=r.filter((s=>s[n]===e))[0],!!i))),i},Im=(r,e)=>{if(e!=="asc"&&e!=="desc")return r;const t=e==="asc"?1:-1;return r.sort(((i,n)=>{const s=i.caption||"",o=n.caption||"";return t*s.localeCompare(o)})),r},Sm=function(r,e){const t=le.parse(r);if(Ee(t)){const i=le.format(t,e),n=le.format(t,"decimal");if(i===r||n===r)return t}},Em=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,n=arguments.length>4?arguments[4]:void 0;return e.every(((s,o)=>t&&o===0||Ic(r,s,o,t,i,n)))},Ic=function(r,e,t){var i,n;let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,a=arguments.length>5?arguments[5]:void 0;const l=e.index,d=(c=t,r.getVisibleColumns(c).filter((p=>{let g=!0;return p.visibleWidth===rr?!1:(s&&e?g&&(g=p.ownerBand===e.ownerBand):a&&g&&(g=p.fixed&&Mt(r,p)===a),g)})));var c;const u=r.getVisibleIndex(l,t);return o?u===r.getVisibleIndex((i=d[d.length-1])===null||i===void 0?void 0:i.index,t):u===r.getVisibleIndex((n=d[0])===null||n===void 0?void 0:n.index,t)},Ia=function(r,e,t){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=arguments.length>5?arguments[5]:void 0;const o=e.index,a=r.getBandColumnsCache(),l=!m(e.type)&&mt(o,a.columnParentByIndex);return l!=null&&l.length?Em(r,l.concat([e]),i,n,s):i||Ic(r,e,t,i,n,s)};class Tm extends j.Controller{init(e){this._dataController=this.getController("data"),this._focusController=this.getController("focus"),this._stateStoringController=this.getController("stateStoring");const t=this.option("columns");this._commandColumns=this._commandColumns||[],this._columns=this._columns||[],this._isColumnsFromOptions=!!t,this._isColumnsFromOptions?(vi(this,t?qt(this,t):[]),fa(this)):vi(this,this._columnsUserState?qt(this,this._columnsUserState):this._columns),vm(this),this._dataSourceApplied?this.applyDataSource(this._dataSource,!0,e):Ut(this),this._checkColumns()}_getExpandColumnOptions(){return{type:"expand",command:"expand",width:"auto",cssClass:Xg,allowEditing:!1,allowGrouping:!1,allowSorting:!1,allowResizing:!1,allowReordering:!1,allowHiding:!1}}_getFirstItems(e){let t,i=[];const n=function(s,o){if(!s||!o)return s;for(let a=0;a<s.length;a++){const l=n(s[a].items||s[a].collapsedItems,o-1);if(l&&l.length)return l}};return e&&e.items().length>0&&(t=y.normalizeSortingInfo(e.group()).length,i=n(e.items(),t)||[]),i}_endUpdateCore(){!this._skipProcessingColumnsChange&&Pi(this)}callbackNames(){return["columnsChanged"]}getColumnByPath(e,t){const i=this;let n;const s=[];return e.replace(Ws,((o,a)=>(s.push(parseInt(a)),""))),s.length&&(t?n=s.reduce(((o,a)=>o&&o.columns&&o.columns[a]),{columns:t}):n=lm(i,s)),n}optionChanged(e){let t;switch(e.name){case"adaptColumnWidthByRatio":e.handled=!0;break;case"dataSource":e.value!==e.previousValue&&!this.option("columns")&&(!Array.isArray(e.value)||!Array.isArray(e.previousValue))&&(this._columns=[]);break;case"columns":t=this._skipProcessingColumnsChange,e.handled=!0,this._skipProcessingColumnsChange||(e.name===e.fullName?(this._columnsUserState=null,this._ignoreColumnOptionNames=null,this.init()):(this._columnOptionChanged(e),t=!0)),t&&this._updateRequireResize(e);break;case"commonColumnSettings":case"columnAutoWidth":case"allowColumnResizing":case"allowColumnReordering":case"columnFixing":case"grouping":case"groupPanel":case"regenerateColumnsByVisibleItems":case"customizeColumns":case"columnHidingEnabled":case"dateSerializationFormat":case"columnResizingMode":case"columnMinWidth":case"columnWidth":{e.handled=!0;const i=e.fullName==="columnWidth"&&["width"];this.reinit(i);break}case"rtlEnabled":this.reinit();break;default:super.optionChanged(e)}}_columnOptionChanged(e){let t={};const i=this.getColumnByPath(e.fullName),n=e.fullName.replace(Ws,"");i&&(n?t[n]=e.value:t=e.value,this._skipProcessingColumnsChange=e.fullName,this.columnOption(i.index,t),this._skipProcessingColumnsChange=!1)}_updateRequireResize(e){const{component:t}=this;e.fullName.replace(Ws,"")==="width"&&t._updateLockCount&&(t._requireResize=!0)}publicMethods(){return["addColumn","deleteColumn","columnOption","columnCount","clearSorting","clearGrouping","getVisibleColumns","getVisibleColumnIndex","getColumns"]}applyDataSource(e,t,i){const n=this,s=e&&e.isLoaded();if(n._dataSource=e,!n._dataSourceApplied||n._dataSourceColumnsCount===0||t||n.option("regenerateColumnsByVisibleItems")){if(s){if(!n._isColumnsFromOptions){const o=pm(n,e);o.length&&(vi(n,o),n._dataSourceColumnsCount=n._columns.length,fa(n))}return n.updateColumns(e,t,i)}n._dataSourceApplied=!1,Ut(n)}else if(s&&!n.isAllDataTypesDefined(!0)&&n.updateColumnDataTypes(e))return ot(n,"columns"),Pi(n),new S().reject().promise()}reset(){this._dataSource=null,this._dataSourceApplied=!1,this._dataSourceColumnsCount=void 0,this.reinit()}resetColumnsCache(){this._visibleColumns=void 0,this._fixedColumns=void 0,this._rowCount=void 0,yc(this)}reinit(e){this._columnsUserState=this.getUserState(),this._ignoreColumnOptionNames=e||null,this.init(),e&&(this._ignoreColumnOptionNames=null)}isInitialized(){return!!this._columns.length||!!this.option("columns")}isDataSourceApplied(){return this._dataSourceApplied}getCommonSettings(e){const t=(!e||!e.type)&&this.option("commonColumnSettings")||{},i=this.option("grouping")??{},n=this.option("groupPanel")??{};return b({allowFixing:this.option("columnFixing.enabled"),allowResizing:this.option("allowColumnResizing")||void 0,allowReordering:this.option("allowColumnReordering"),minWidth:this.option("columnMinWidth"),width:this.option("columnWidth"),autoExpandGroup:i.autoExpandAll,allowCollapsing:i.allowCollapsing,allowGrouping:n.allowColumnDragging&&n.visible||i.contextMenuEnabled},t)}isColumnOptionUsed(e){for(let t=0;t<this._columns.length;t++)if(this._columns[t][e])return!0}isAllDataTypesDefined(e){const t=this._columns;if(!t.length)return!1;for(let i=0;i<t.length;i++)if(!(!t[i].dataField&&t[i].calculateCellValue===t[i].defaultCalculateCellValue)&&(!t[i].dataType||e&&t[i].deserializeValue&&t[i].serializationFormat===void 0))return!1;return!0}getColumns(){return this._columns}isBandColumnsUsed(){return this.getColumns().some((e=>e.isBand))}getGroupColumns(){const e=[];return x(this._columns,(function(){const t=this;m(t.groupIndex)&&(e[t.groupIndex]=t)})),e}_shouldReturnVisibleColumns(){return!0}_compileVisibleColumns(e){return this._visibleColumns=this._visibleColumns||this._compileVisibleColumnsCore(),e=m(e)?e:this._visibleColumns.length-1,this._visibleColumns[e]||[]}getVisibleColumns(e,t){return this._shouldReturnVisibleColumns()?this._compileVisibleColumns.apply(this,arguments):[]}getFixedColumns(e){return this._fixedColumns=this._fixedColumns||this._getFixedColumnsCore(),e=m(e)?e:this._fixedColumns.length-1,this._fixedColumns[e]||[]}getFilteringColumns(){return this.getColumns().filter((e=>(e.dataField||e.name)&&(e.allowFiltering||e.allowHeaderFiltering))).map((e=>{const t=b(!0,{},e);return m(t.dataField)||(t.dataField=t.name),t.filterOperations=e.filterOperations!==e.defaultFilterOperations?t.filterOperations:null,t}))}getColumnIndexOffset(){return 0}getStickyColumns(e){return this.getVisibleColumns(e,!0).filter((i=>i.fixed))}_getFixedColumnsCore(){const e=this,t=[],i=e.getRowCount(),n=e._isColumnFixing(),s={command:"transparent"};let o=0,a,l,d;if(n)for(let c=0;c<=i;c++){a=0,d=null,l=null;const u=e.getVisibleColumns(c,!0);for(let p=0;p<u.length;p++){const g=u[p-1],_=u[p];!_.fixed||_.fixedPosition===U.Sticky?(c===0&&(_.isBand&&_.colspan?o+=_.colspan:o++),a++,m(l)||(l=p)):g&&g.fixed&&Ca(e,g)!==Ca(e,_)?m(l)||(l=p):d=_.fixedPosition}if(c===0&&(a===0||a>=u.length))return[];m(l)||(l=d==="right"?0:u.length),t[c]=u.slice(0),s.colspan||(s.colspan=o),t[c].splice(l,a,s)}return t.map((c=>c.map((u=>{const p=T({},u);return p.headerId&&(p.headerId+="-fixed"),p}))))}_isColumnFixing(){let e=this.option("columnFixing.enabled");return!e&&x(this._columns,((t,i)=>{if(i.fixed)return e=!0,!1})),e}_getExpandColumnsCore(){return this.getGroupColumns()}getExpandColumns(){let e=this._getExpandColumnsCore(),t;const i=e.filter((a=>a.groupIndex===0))[0],n=i&&i.fixed,s=this._isColumnFixing(),o=this.option("rtlEnabled");return e.length&&(t=this.columnOption("command:expand")),e=wt(e,(a=>b({},T({},a,{ownerBand:void 0}),{visibleWidth:null,minWidth:null,cellTemplate:m(a.groupIndex)?null:a.cellTemplate,headerCellTemplate:null,fixed:!m(a.groupIndex)||!n?s:!0,fixedPosition:o?"right":"left"},t,{index:a.index,type:a.type||Ft}))),e}getBandColumnsCache(){if(!this._bandColumnsCache){const e=this._columns,t={},i={};let n=!0;e.forEach((s=>{const{ownerBand:o}=s;let a=L(o)?o.index:o;const l=e[a];s.hasColumns&&(n=!1),s.colspan&&(s.colspan=void 0),s.rowspan&&(s.rowspan=void 0),l?i[s.index]=l:a=-1,t[a]=t[a]||[],t[a].push(s)})),this._bandColumnsCache={isPlain:n,columnChildrenByIndex:t,columnParentByIndex:i}}return this._bandColumnsCache}_isColumnVisible(e){return e.visible&&this.isParentColumnVisible(e.index)}_isColumnInGroupPanel(e){return m(e.groupIndex)&&!e.showWhenGrouped}hasVisibleDataColumns(){return this._columns.some((t=>{const i=this._isColumnVisible(t),n=this._isColumnInGroupPanel(t),s=!!t.command;return i&&!n&&!s}))}_compileVisibleColumnsCore(){const e=this.getBandColumnsCache(),t=wa(this,this._columns,this._commandColumns,!0);cm(this,t,e);const i=this._getIndexedColumns(t),n=this._getVisibleColumnsFromIndexed(i);return!this.hasVisibleDataColumns()&&this._columns.length&&n[n.length-1].push({command:"empty",type:"empty"}),n}_getIndexedColumns(e){const t=this.option("rtlEnabled"),i=this.getRowCount(),n=bm(e.length),s=this.getBandColumnsCache(),o=[],a=[];for(let l=0;l<i;l+=1)a[l]=[{}],o[l]=[{},{},{}];return e.forEach((l=>{let{visibleIndex:d}=l,c;const u=mt(l.index,s.columnParentByIndex),p=this._isColumnVisible(l),g=this._isColumnInGroupPanel(l);if(p&&!g){const C=u.length;if(d<0)d=-d,c=a[C];else{var _,f;if(l.fixed=((_=u[0])===null||_===void 0?void 0:_.fixed)??l.fixed,l.fixedPosition=((f=u[0])===null||f===void 0?void 0:f.fixedPosition)??l.fixedPosition,l.fixed&&l.fixedPosition!==U.Sticky){const I=!!l.command&&!y.isCustomCommandColumn(this._columns,l);let E=l.fixedPosition==="right";t&&!I&&(E=!E),c=E?o[C][2]:o[C][0]}else c=o[C][1]}if(u.length){d=xa(d,n);for(let I=u.length-1;I>=0;I-=1)d=xa(u[I].visibleIndex,n)+d}c[d]=c[d]||[],c[d].push(l)}})),{positiveIndexedColumns:o,negativeIndexedColumns:a}}_getVisibleColumnsFromIndexed(e){let{positiveIndexedColumns:t,negativeIndexedColumns:i}=e;const n=[],s=this.getRowCount(),o=wa(this,this.getExpandColumns(),this._columns);let a=0,l=0;for(let d=0;d<s;d+=1){n.push([]),$r(i[d],((p,g)=>{n[d].unshift.apply(n[d],g)}));const c=n[d].length;t[d].forEach((p=>{$r(p,((g,_)=>{n[d].push.apply(n[d],_)}))})),l<=d&&(l+=va.call(this,n[d],o,Zg,c)),a<=d&&(a+=va.call(this,n[d],o,Ft,c))}return n.push(bc(n)),n}getInvisibleColumns(e,t){const i=this;let n=[],s;return e=e||i._columns,x(e,((o,a)=>{if(a.ownerBand===t){if(a.isBand){a.visible?s=i.getInvisibleColumns(i.getChildrenByBandColumn(a.index),a.index):s=i.getChildrenByBandColumn(a.index),s.length&&(n.push(a),n=n.concat(s));return}a.visible||n.push(a)}})),n}getChooserColumns(e){const i=(e?this.getColumns():this.getInvisibleColumns()).filter((s=>s.showInColumnChooser)),n=this.option("columnChooser.sortOrder");return Im(i,n)}allowMoveColumn(e,t,i,n){const s=Ks(this,e,i),o=this._columns[s];return o&&(o.allowReordering||o.allowGrouping||o.allowHiding)?i===n?i===Ci?!1:(e=L(e)?e.columnIndex:e,t=L(t)?t.columnIndex:t,e!==t&&e+1!==t):i===fi&&n!==Ci||n===fi?o&&o.allowGrouping:i===Ci||n===Ci?o&&o.allowHiding:!0:!1}moveColumn(e,t,i,n){const s=this,o={};let a;const l=Ks(s,e,i),d=Ks(s,t,n);let c;if(l>=0){const u=s._columns[l];if(t=L(t)?t.columnIndex:t,c=d>=0?s._columns[d].groupIndex:-1,m(u.groupIndex)&&i===fi&&(c>u.groupIndex&&c--,n!==fi?o.groupIndex=void 0:(a=u.groupIndex,delete u.groupIndex,wc(s))),n===fi)o.groupIndex=_m(s,u,c),u.groupIndex=a;else if(t>=0){const g=s._columns[d];!g||u.ownerBand!==g.ownerBand||ba(s,u)^ba(s,g)?o.visibleIndex=ca:o.visibleIndex=g.visibleIndex}const p=n!==Ci;u.visible!==p&&(o.visible=p),s.columnOption(u.index,o)}}allowColumnSorting(e){const t=this.option("sorting");return((t==null?void 0:t.mode)==="single"||(t==null?void 0:t.mode)==="multiple")&&(e==null?void 0:e.allowSorting)}changeSortOrder(e,t){const i=this,n={},s=i.option("sorting"),a=(s==null?void 0:s.mode)==="single"||!t,l=i._columns[e];this.allowColumnSorting(l)&&(a&&!m(l.groupIndex)&&x(i._columns,(function(d){d!==e&&this.sortOrder&&(m(this.groupIndex)||delete this.sortOrder,delete this.sortIndex)})),is(t)?l.sortOrder!==t&&(n.sortOrder=t):t==="none"?l.sortOrder&&(n.sortIndex=void 0,n.sortOrder=void 0):(function(d){if(t==="ctrl"){if(!("sortOrder"in d&&"sortIndex"in d))return!1;n.sortOrder=void 0,n.sortIndex=void 0}else m(d.groupIndex)||m(d.sortIndex)?n.sortOrder=d.sortOrder==="desc"?"asc":"desc":n.sortOrder="asc";return!0})(l)),i.columnOption(l.index,n)}getSortDataSourceParameters(e){const t=[],i=[];return x(this._columns,(function(){(this.dataField||this.selector||this.calculateCellValue)&&m(this.sortIndex)&&!m(this.groupIndex)&&(t[this.sortIndex]=this)})),x(t,(function(){const n=this&&this.sortOrder;if(is(n)){const s={selector:this.calculateSortValue||this.displayField||this.calculateDisplayValue||e&&this.selector||this.dataField||this.calculateCellValue,desc:this.sortOrder==="desc"};this.sortingMethod&&(s.compare=this.sortingMethod.bind(this)),i.push(s)}})),i.length>0?i:null}getGroupDataSourceParameters(e){const t=[];return x(this.getGroupColumns(),(function(){const i=this.calculateGroupValue||this.displayField||this.calculateDisplayValue||e&&this.selector||this.dataField||this.calculateCellValue;if(i){const n={selector:i,desc:this.sortOrder==="desc",isExpanded:!!this.autoExpandGroup};this.sortingMethod&&(n.compare=this.sortingMethod.bind(this)),t.push(n)}})),t.length>0?t:null}refresh(e){const t=[];return x(this._columns,(function(){const{lookup:i}=this;if(i&&!this.calculateDisplayValue){if(e&&i.valueMap)return;i.update&&t.push(i.update())}})),O.apply(h,t).done(bs.bind(null,this))}_updateColumnOptions(e,t){var i,n;const s=this._reinitAfterLookupChanges&&((i=this._previousColumns)===null||i===void 0?void 0:i[t]);e.selector=e.selector??(l=>e.calculateCellValue(l)),e.selector.columnIndex=t,e.selector.originalCallback=s?((n=this._previousColumns[t].selector)===null||n===void 0?void 0:n.originalCallback)??e.selector:e.selector,x(["calculateSortValue","calculateGroupValue","calculateDisplayValue"],((l,d)=>{const c=e[d];if(B(c))if(c.originalCallback)e[d].context.column=e;else{const u={column:e};e[d]=function(p){return c.call(u.column,p)},e[d].originalCallback=c,e[d].columnIndex=t,e[d].context=u}})),W(e.calculateDisplayValue)&&(e.displayField=e.calculateDisplayValue,e.calculateDisplayValue=Pe(e.displayField)),e.calculateDisplayValue&&(e.displayValueMap=e.displayValueMap||{}),ma(e,e.dataType);const{lookup:o}=e;o&&ma(o,o.dataType);const a=o?o.dataType:e.dataType;a&&(e.alignment=e.alignment||um(a,this.option("rtlEnabled")),e.format=e.format||y.getFormatByDataType(a),e.customizeText=e.customizeText||_a(a),e.defaultFilterOperations=e.defaultFilterOperations||!o&&Jg[a]||[],m(e.filterOperations)||fc(e),e.defaultFilterOperation=e.filterOperations&&e.filterOperations[0]||"=",e.showEditorAlways=m(e.showEditorAlways)?e.showEditorAlways:a==="boolean"&&!e.cellTemplate&&!e.lookup)}updateColumnDataTypes(e){const t=this,i=t.option("dateSerializationFormat"),n=t._getFirstItems(e);let s=!1;return x(t._columns,((o,a)=>{let l,d,c,u,p;const{lookup:g}=a;if(y.isDateType(a.dataType)&&a.serializationFormat===void 0&&(a.serializationFormat=i),g&&y.isDateType(g.dataType)&&a.serializationFormat===void 0&&(g.serializationFormat=i),a.calculateCellValue&&n.length){if(!a.dataType||g&&!g.dataType){for(l=0;l<n.length;l++)d=a.calculateCellValue(n[l]),a.dataType||(p=zs(d),c=c||p,c&&p&&c!==p&&(c="string")),g&&!g.dataType&&(p=zs(y.getDisplayValue(a,d,n[l])),u=u||p,u&&p&&u!==p&&(u="string"));(c||u)&&(c&&(a.dataType=c),g&&u&&(g.dataType=u),s=!0)}if(a.serializationFormat===void 0||g&&g.serializationFormat===void 0)for(l=0;l<n.length;l++)d=a.calculateCellValue(n[l],!0),a.serializationFormat===void 0&&(a.serializationFormat=ga(a.dataType,d)),g&&g.serializationFormat===void 0&&(g.serializationFormat=ga(g.dataType,g.calculateCellValue(d,!0)))}t._updateColumnOptions(a,o)})),s}_customizeColumns(e){const t=this,i=t.option("customizeColumns");i&&(e.some((s=>L(s.ownerBand)))&&Ut(t),i(e),vi(t,qt(t,e)))}updateColumns(e,t,i){if(t||this.updateSortingGrouping(e),!e||e.isLoaded()){const n=e?e.sort()||[]:this.getSortDataSourceParameters(),s=e?e.group()||[]:this.getGroupDataSourceParameters(),o=e==null?void 0:e.lastLoadOptions().filter;i||this._customizeColumns(this._columns),Ut(this);const a=this._columns;return O(this.refresh(!0)).always((()=>{this._columns===a&&(this._updateChanges(e,{sorting:n,grouping:s,filtering:o}),Pi(this))}))}}_updateChanges(e,t){var i;const n=e==null||(i=e.loadOptions)===null||i===void 0||(i=i.call(e))===null||i===void 0?void 0:i.langParams;e&&(this.updateColumnDataTypes(e),this._dataSourceApplied=!0),y.equalSortParameters(t.sorting,this.getSortDataSourceParameters())||ot(this,"sorting"),y.equalSortParameters(t.grouping,this.getGroupDataSourceParameters())||ot(this,"grouping"),this._dataController&&!y.equalFilterParameters(t.filtering,this._dataController.getCombinedFilter(),n)&&ot(this,"filtering"),ot(this,"columns")}updateSortingGrouping(e,t){const i=this;let n;const s=function(a,l,d){x(a,((c,u)=>{if(delete u[d],l)for(let p=0;p<l.length;p++){const{selector:g}=l[p],{isExpanded:_}=l[p];if(g===u.dataField||g===u.name||g===u.displayField||y.isEqualSelectors(g,u.selector)||y.isSelectorEqualWithCallback(g,u.calculateCellValue)||y.isSelectorEqualWithCallback(g,u.calculateGroupValue)||y.isSelectorEqualWithCallback(g,u.calculateDisplayValue)){t?u.sortOrder="sortOrder"in u?u.sortOrder:l[p].desc?"desc":"asc":u.sortOrder=u.sortOrder||(l[p].desc?"desc":"asc"),_!==void 0&&(u.autoExpandGroup=_),u[d]=p;break}}}))};if(e){var o;const a=y.normalizeSortingInfo(e.sort()),l=y.normalizeSortingInfo(e.group()),d=i.getGroupDataSourceParameters(),c=i.getSortDataSourceParameters(),u=(o=this._columnChanges)===null||o===void 0?void 0:o.changeTypes,p=!y.equalSortParameters(a,c),g=t&&!(u!=null&&u.sorting),_=t&&!(u!=null&&u.grouping),f=!y.equalSortParameters(l,d,!0),C=!f&&!y.equalSortParameters(l,d);i._columns.length||(x(l,((I,E)=>{i._columns.push(E.selector)})),x(a,((I,E)=>{B(E.selector)||i._columns.push(E.selector)})),vi(i,qt(i,i._columns))),(_||!d&&!i._hasUserState)&&(f||C)&&(s(i._columns,l,"groupIndex"),t&&(f&&ot(i,"grouping"),C&&ot(i,"groupExpanding"),n=!0)),(g||!c&&!i._hasUserState)&&p&&(s(i._columns,a,"sortIndex"),t&&(ot(i,"sorting"),n=!0)),n&&Pi(i)}}updateFilter(e,t,i,n){const s=this;if(!Array.isArray(e))return e;if(e=b([],e),i=e.columnIndex!==void 0?e.columnIndex:i,n=e.filterValue!==void 0?e.filterValue:n,W(e[0])&&e[0]!=="!"){const o=s.columnOption(e[0]);t?gs().forceIsoDateParsing&&o&&o.serializeValue&&e.length>1&&(e[e.length-1]=o.serializeValue(e[e.length-1],"filter")):o&&o.selector&&(e[0]=o.selector,e[0].columnIndex=o.index)}else B(e[0])&&(e[0].columnIndex=i,e[0].filterValue=n,e[0].selectedFilterOperation=e.selectedFilterOperation);for(let o=0;o<e.length;o++)e[o]=s.updateFilter(e[o],t,i,n);return e}columnCount(){return this._columns?this._columns.length:0}columnOption(e,t,i,n){const s=this,o=s._columns.concat(s._commandColumns),a=ya(o,e);if(a){if(arguments.length===1)return b({},a);if(W(t)){if(arguments.length===2)return Gs(s,a,t);Gs(s,a,t,i,n)}else L(t)&&x(t,((l,d)=>{Gs(s,a,l,d,n)}));Pi(s)}}clearSorting(){const e=this,t=this.columnCount();e.beginUpdate();for(let i=0;i<t;i++)e.columnOption(i,"sortOrder",void 0),delete ya(e._columns,i).sortOrder;e.endUpdate()}clearGrouping(){const e=this,t=this.columnCount();e.beginUpdate();for(let i=0;i<t;i++)e.columnOption(i,"groupIndex",void 0);e.endUpdate()}getVisibleIndex(e,t){const i=this.getVisibleColumns(t);for(let n=i.length-1;n>=0;n--)if(i[n].index===e)return n;return-1}getVisibleIndexByColumn(e,t){const i=this.getVisibleColumns(t),n=i.filter((s=>s.index===e.index&&s.command===e.command))[0];return i.indexOf(n)}getVisibleColumnIndex(e,t){const i=this.columnOption(e,"index");return this.getVisibleIndex(i,t)}addColumn(e){const t=this;let i=ws(t,e);const n=t._columns.length;t._columns.push(i),i.isBand&&(t._columns=qt(t,t._columns),i=t._columns[n]),i.added=e,Ut(t,i),t.updateColumns(t._dataSource),t._checkColumns()}deleteColumn(e){const t=this,i=t.columnOption(e);if(i&&i.index>=0){if(ym(t._columns),t._columns.splice(i.index,1),i.isBand){const n=t.getChildrenByBandColumn(i.index).map((s=>s.index));t._columns=t._columns.filter((s=>n.indexOf(s.index)<0))}Ut(t),t.updateColumns(t._dataSource)}}addCommandColumn(e){let t=this._commandColumns.filter((i=>i.command===e.command))[0];t||(t=e,this._commandColumns.push(t))}getUserState(){const e=this._columns,t=[];let i;function n(s,o){e[i][o]!==void 0&&(t[i][o]=e[i][o])}for(i=0;i<e.length;i++)t[i]={},x(ts,n);return t}setName(e){e.name=e.name||e.dataField||e.type}setUserState(e){const t=this,i=t._dataSource;let n=t.option("stateStoring.ignoreColumnOptionNames");if(e==null||e.forEach(this.setName),!n){n=[];const s=t.getCommonSettings();t.option("columnChooser.enabled")||n.push("visible"),t.option("sorting.mode")==="none"&&n.push("sortIndex","sortOrder"),s.allowGrouping||n.push("groupIndex"),s.allowFixing||n.push("fixed","fixedPosition"),s.allowResizing||n.push("width","visibleWidth");const o=!t.option("filterPanel.visible");!t.option("filterRow.visible")&&o&&n.push("filterValue","selectedFilterOperation"),!t.option("headerFilter.visible")&&o&&n.push("filterValues","filterType")}t._columnsUserState=e,t._ignoreColumnOptionNames=n,t._hasUserState=!!e,ot(t,"filtering"),t.init(!0),i&&(i.sort(t.getSortDataSourceParameters()),i.group(t.getGroupDataSourceParameters()))}_checkColumns(){const e={};let t=!1;const i=[];this._columns.forEach((n=>{var s;const{name:o}=n,a=(s=n.columns)===null||s===void 0?void 0:s.length,l=n.allowEditing&&(n.dataField||n.setCellValue)&&!a;o?(e[o]&&i.push(`"${o}"`),e[o]=!0):l&&(t=!0)})),i.length&&se.log("E1059",i.join(", ")),t&&se.log("E1060")}_createCalculatedColumnOptions(e,t){let i={},{dataField:n}=e;if((Array.isArray(e.columns)&&e.columns.length||e.isBand)&&(i.isBand=!0,n=null),n){if(W(n)){const s=Pe(n);i={caption:Od.captionize(n),calculateCellValue(o,a){const l=s(o);return this.deserializeValue&&!a?this.deserializeValue(l):l},setCellValue:xm,parseValue(o){const a=this;let l,d;return a.dataType==="number"?W(o)&&a.format?l=Sm(o.trim(),a.format):m(o)&&Ee(o)&&(l=Number(o)):a.dataType==="boolean"?o===a.trueText?l=!0:o===a.falseText&&(l=!1):y.isDateType(a.dataType)?(d=P.parse(o,a.format),d&&(l=d)):l=o,l}}}i.allowFiltering=!0}else i.allowFiltering=!!e.calculateFilterExpression;return i.calculateFilterExpression=function(){return si.defaultCalculateFilterExpression.apply(this,arguments)},i.defaultFilterOperation="=",i.createFilterExpression=function(s,o){let a;return this.calculateFilterExpression&&(a=this.calculateFilterExpression.apply(this,arguments)),B(a)&&(a=[a,"=",!0]),a&&(a.columnIndex=this.index,a.filterValue=s,a.selectedFilterOperation=o),a},(!n||!W(n))&&b(!0,i,{allowSorting:!1,allowGrouping:!1,calculateCellValue:()=>null}),t&&(i.allowFixing=!1),e.dataType&&(i.userDataType=e.dataType),e.selectedFilterOperation&&!("defaultSelectedFilterOperation"in i)&&(i.defaultSelectedFilterOperation=e.selectedFilterOperation),e.lookup&&(i.lookup={calculateCellValue(s,o){return this.valueExpr&&(s=this.valueMap&&this.valueMap[s]),this.deserializeValue&&!o?this.deserializeValue(s):s},updateValueMap(){if(this.valueMap={},this.items){const s=Pe(this.valueExpr),o=Pe(this.displayExpr);for(let a=0;a<this.items.length;a++){const l=this.items[a],d=o(l);this.valueMap[s(l)]=d,this.dataType=this.dataType||zs(d)}}},update(){const s=this;let{dataSource:o}=s;if(o)if(B(o)&&!gt.isWrapped(o)&&(o=o({})),ze(o)||o instanceof fp||Array.isArray(o)){if(s.valueExpr){const a=pn(o);return a.paginate=!1,o=new Ei(a),o.load().done((l=>{s.items=l,s.updateValueMap&&s.updateValueMap()}))}}else se.log("E1016");else s.updateValueMap&&s.updateValueMap()}}),i.resizedCallbacks=$e(),e.resized&&i.resizedCallbacks.add(e.resized.bind(e)),x(i,(s=>{if(B(i[s])&&s.indexOf("default")!==0){const o=`default${s.charAt(0).toUpperCase()}${s.substr(1)}`;i[o]=i[s]}})),i}getRowCount(){return this._rowCount=this._rowCount||wm(this),this._rowCount}getRowIndex(e,t){const i=this._columns[e],n=this.getBandColumnsCache();return i&&(t||i.visible&&!(i.command||m(i.groupIndex)))?mt(e,n.columnParentByIndex).length:0}getChildrenByBandColumn(e,t){const i=this.getBandColumnsCache(),n=Cc(e,i.columnChildrenByIndex,!t);return t?n.filter((s=>s.visible&&!s.command)).sort(((s,o)=>s.visibleIndex-o.visibleIndex)):n}getVisibleDataColumnsByBandColumn(e){const t=this.getBandColumnsCache();return this.getChildrenByBandColumn(e,t.columnChildrenByIndex).filter((n=>!n.isBand&&n.visible))}isParentBandColumn(e,t){let i=!1;const n=this._columns[e],s=this.getBandColumnsCache(),o=n&&mt(e,s.columnParentByIndex);return o&&x(o,((a,l)=>{if(l.index===t)return i=!0,!1})),i}isParentColumnVisible(e){let t=!0;const i=this.getBandColumnsCache(),n=e>=0&&mt(e,i.columnParentByIndex);return n&&x(n,((s,o)=>(t=t&&o.visible,t))),t}getParentColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.getBandColumnsCache(),n=mt(e.index,i.columnParentByIndex),s=t?-1:0;return n.at(s)}isFirstColumn(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=arguments.length>3?arguments[3]:void 0;return Ia(this,e,t,i,!1,n)}isLastColumn(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=arguments.length>3?arguments[3]:void 0;return Ia(this,e,t,i,!0,n)}isCustomCommandColumn(e){return y.isCustomCommandColumn(this._columns,e)}getColumnId(e){return e.command&&e.type===Ft?y.isCustomCommandColumn(this._columns,e)?`type:${e.type}`:`command:${e.command}`:e.index}getCustomizeTextByDataType(e){return _a(e)}getHeaderContentAlignment(e){return this.option("rtlEnabled")?e==="left"?"right":"left":e}isVirtualMode(){return!1}isNeedToRenderVirtualColumns(e){return!1}}const bS={defaultOptions:()=>({commonColumnSettings:{allowFiltering:!0,allowHiding:!0,allowSorting:!0,allowEditing:!0,encodeHtml:!0,trueText:w.format("dxDataGrid-trueText"),falseText:w.format("dxDataGrid-falseText")},allowColumnReordering:!1,allowColumnResizing:!1,columnResizingMode:"nextColumn",columnMinWidth:void 0,columnWidth:void 0,adaptColumnWidthByRatio:!0,columns:void 0,regenerateColumnsByVisibleItems:!1,customizeColumns:null,dateSerializationFormat:void 0}),controllers:{columns:Tm}},Sa="_dataSourceChangedHandler",Ea="_getSpecificDataSourceOption",Ta="_normalizeDataSource",Dm=r=>class extends r{postCtor(){this.on("disposing",(()=>{this._disposeDataSource()}))}_refreshDataSource(){this._initDataSource(),this._loadDataSource()}_initDataSource(){let e=Ea in this?this[Ea]():this.option("dataSource"),t,i;this._disposeDataSource(),e&&(e instanceof Ei?(this._isSharedDataSource=!0,this._dataSource=e):(t="_dataSourceOptions"in this?this._dataSourceOptions():{},i=this._dataSourceType?this._dataSourceType():Ei,e=pn(e,{fromUrlLoadMode:"_dataSourceFromUrlLoadMode"in this&&this._dataSourceFromUrlLoadMode()}),this._dataSource=new i(b(!0,{},t,e))),Ta in this&&(this._dataSource=this[Ta](this._dataSource)),this._addDataSourceHandlers(),this._initDataController())}_initDataController(){var e;const t=(e=this.option)===null||e===void 0?void 0:e.call(this,"_dataController"),i=this._dataSource;t?this._dataController=t:this._dataController=new Cp(i)}_addDataSourceHandlers(){Sa in this&&this._addDataSourceChangeHandler(),"_dataSourceLoadErrorHandler"in this&&this._addDataSourceLoadErrorHandler(),"_dataSourceLoadingChangedHandler"in this&&this._addDataSourceLoadingChangedHandler(),this._addReadyWatcher()}_addReadyWatcher(){this.readyWatcher=(function(e){this._ready&&this._ready(!e)}).bind(this),this._dataSource.on("loadingChanged",this.readyWatcher)}_addDataSourceChangeHandler(){const e=this._dataSource;this._proxiedDataSourceChangedHandler=(function(t){this[Sa](e.items(),t)}).bind(this),e.on("changed",this._proxiedDataSourceChangedHandler)}_addDataSourceLoadErrorHandler(){this._proxiedDataSourceLoadErrorHandler=this._dataSourceLoadErrorHandler.bind(this),this._dataSource.on("loadError",this._proxiedDataSourceLoadErrorHandler)}_addDataSourceLoadingChangedHandler(){this._proxiedDataSourceLoadingChangedHandler=this._dataSourceLoadingChangedHandler.bind(this),this._dataSource.on("loadingChanged",this._proxiedDataSourceLoadingChangedHandler)}_loadDataSource(){const e=this._dataSource;e&&(e.isLoaded()?this._proxiedDataSourceChangedHandler&&this._proxiedDataSourceChangedHandler():e.load())}_loadSingle(e,t){return e=e==="this"?this._dataSource.key()||"this":e,this._dataSource.loadSingle(e,t)}_isLastPage(){return!this._dataSource||this._dataSource.isLastPage()||!this._dataSource._pageSize}_isDataSourceLoading(){return this._dataSource&&this._dataSource.isLoading()}_disposeDataSource(){this._dataSource&&(this._isSharedDataSource?(delete this._isSharedDataSource,this._proxiedDataSourceChangedHandler&&this._dataSource.off("changed",this._proxiedDataSourceChangedHandler),this._proxiedDataSourceLoadErrorHandler&&this._dataSource.off("loadError",this._proxiedDataSourceLoadErrorHandler),this._proxiedDataSourceLoadingChangedHandler&&this._dataSource.off("loadingChanged",this._proxiedDataSourceLoadingChangedHandler),this._dataSource._eventsStrategy&&this._dataSource._eventsStrategy.off("loadingChanged",this.readyWatcher)):this._dataSource.dispose(),delete this._dataSource,delete this._proxiedDataSourceChangedHandler,delete this._proxiedDataSourceLoadErrorHandler,delete this._proxiedDataSourceLoadingChangedHandler)}getDataSource(){return this._dataSource||null}},Da=function(r,e,t){const i=r._dataSource;if(i){if(t!==void 0){if(r._getPagingOptionValue(e)!==t){e==="pageSize"&&i.pageIndex(0),i[e](t),r._skipProcessingPagingChange=!0,r.option(`paging.${e}`,t),r._skipProcessingPagingChange=!1;const s=i.pageIndex();return r._isPaging=e==="pageIndex",i[e==="pageIndex"?"load":"reload"]().done((()=>{r._isPaging=!1,r.pageChanged.fire(s)}))}return S().resolve().promise()}return i[e]()}return e==="pageIndex"&&t!==void 0?S().resolve().promise():0};class Rm extends Dm(j.Controller){init(){this._items=[],this._cachedProcessedItems=null,this._columnsController=this.getController("columns"),this._adaptiveColumnsController=this.getController("adaptiveColumns"),this._editingController=this.getController("editing"),this._editorFactoryController=this.getController("editorFactory"),this._errorHandlingController=this.getController("errorHandling"),this._filterSyncController=this.getController("filterSync"),this._applyFilterController=this.getController("applyFilter"),this._keyboardNavigationController=this.getController("keyboardNavigation"),this._focusController=this.getController("focus"),this._headerFilterController=this.getController("headerFilter"),this._selectionController=this.getController("selection"),this._stateStoringController=this.getController("stateStoring"),this._validatingController=this.getController("validating"),this._isPaging=!1,this._currentOperationTypes=null,this._dataChangedHandler=e=>{this._currentOperationTypes=this._dataSource.operationTypes(),this._handleDataChanged(e),this._currentOperationTypes=null},this._columnsChangedHandler=this._handleColumnsChanged.bind(this),this._loadingChangedHandler=this._handleLoadingChanged.bind(this),this._loadErrorHandler=this._handleLoadError.bind(this),this._customizeStoreLoadOptionsHandler=this._handleCustomizeStoreLoadOptions.bind(this),this._changingHandler=this._handleChanging.bind(this),this._dataPushedHandler=this._handleDataPushed.bind(this),this._columnsController.columnsChanged.add(this._columnsChangedHandler),this._isLoading=!1,this._isCustomLoading=!1,this._repaintChangesOnly=void 0,this._changes=[],this.createAction("onDataErrorOccurred"),this.dataErrorOccurred.add((e=>this.executeAction("onDataErrorOccurred",{error:e}))),this._refreshDataSource(),this.postCtor()}_getPagingOptionValue(e){return this._dataSource[e]()}callbackNames(){return["changed","loadingChanged","dataErrorOccurred","pageChanged","dataSourceChanged","pushed"]}callbackFlags(e){if(e==="dataErrorOccurred")return{stopOnFalse:!0}}publicMethods(){return["_disposeDataSource","beginCustomLoading","byKey","clearFilter","endCustomLoading","filter","getCombinedFilter","getDataByKeys","getDataSource","getKeyByRowIndex","getRowIndexByKey","getVisibleRows","keyOf","pageCount","pageIndex","pageSize","refresh","repaintRows","totalCount"]}reset(){this._columnsController.reset(),this._items=[],this._refreshDataSource()}_handleDataSourceChange(e){if(e.value===e.previousValue||this.option("columns")&&Array.isArray(e.value)&&Array.isArray(e.previousValue)){if(e.value!==e.previousValue){const i=this.store();i&&(i._array=e.value)}return this.needToRefreshOnDataSourceChange(e)&&this.refresh(this.option("repaintChangesOnly")),!0}return!1}needToRefreshOnDataSourceChange(e){return!0}optionChanged(e){const t=this;let i,n;function s(){e.handled=!0}if(e.name==="dataSource"&&e.name===e.fullName&&this._handleDataSourceChange(e)){s();return}switch(e.name){case"cacheEnabled":case"repaintChangesOnly":case"highlightChanges":case"loadingTimeout":s();break;case"remoteOperations":case"keyExpr":case"dataSource":case"scrolling":s(),t.reset();break;case"paging":if(i=t.dataSource(),i&&(n=t._setPagingOptions(i),n)){const o=i.pageIndex();this._isPaging=n.isPageIndexChanged,i.load().done((()=>{this._isPaging=!1,t.pageChanged.fire(o)}))}s();break;case"rtlEnabled":t.reset();break;case"columns":i=t.dataSource(),i&&i.isLoading()&&e.name===e.fullName&&(this._useSortingGroupingFromColumns=!0,i.load());break;default:super.optionChanged(e)}}isReady(){return!this._isLoading}getDataSource(){return this._dataSource&&this._dataSource._dataSource}getCombinedFilter(e){return this.combinedFilter(void 0,e)}combinedFilter(e,t){if(!this._dataSource)return e;let i=e??this._dataSource.filter();if(this._columnsController.isDataSourceApplied()||this._columnsController.isAllDataTypesDefined()){const o=this._calculateAdditionalFilter();i=o?y.combineFilters([o,i]):i}const s=this._dataSource.remoteOperations().filtering||t;return i=this._columnsController.updateFilter(i,s),i}waitReady(){return this._updateLockCount?(this._readyDeferred=new S,this._readyDeferred):O()}_endUpdateCore(){const e=this._changes;if(e.length){this._changes=[];const t=e.every((i=>i.repaintChangesOnly));this.updateItems(e.length===1?e[0]:{repaintChangesOnly:t})}this._readyDeferred&&(this._readyDeferred.resolve(),this._readyDeferred=null)}_handleCustomizeStoreLoadOptions(e){var t;const i=this._columnsController,n=this._dataSource,{storeLoadOptions:s}=e;e.isCustomLoading&&!s.isLoadingAll||(s.filter=this.combinedFilter(s.filter),((t=s.filter)===null||t===void 0?void 0:t.length)===1&&s.filter[0]==="!"&&(e.data=[],e.extra=e.extra||{},e.extra.totalCount=0),i.isDataSourceApplied()||i.updateColumnDataTypes(n),this._columnsUpdating=!0,i.updateSortingGrouping(n,!this._useSortingGroupingFromColumns),this._columnsUpdating=!1,s.sort=i.getSortDataSourceParameters(),s.group=i.getGroupDataSourceParameters(),n.sort(s.sort),n.group(s.group),s.sort=i.getSortDataSourceParameters(!n.remoteOperations().sorting),e.group=i.getGroupDataSourceParameters(!n.remoteOperations().grouping))}_handleColumnsChanged(e){const t=this,{changeTypes:i}=e,{optionNames:n}=e;let s,o,a;const l=function(d){var c,u;t._columnsController.columnsChanged.remove(l),t.updateItems({repaintChangesOnly:!1,event:d==null||(c=d.changeTypes)===null||c===void 0?void 0:c.event,virtualColumnsScrolling:d==null||(u=d.changeTypes)===null||u===void 0?void 0:u.virtualColumnsScrolling})};if(i.sorting||i.grouping)t._dataSource&&!t._columnsUpdating&&(t._dataSource.group(t._columnsController.getGroupDataSourceParameters()),t._dataSource.sort(t._columnsController.getSortDataSourceParameters()),t.reload());else if(i.columns&&(o=t._columnsController.columnOption(e.columnIndex,"filterValues"),(n.filterValues||n.filterType&&Array.isArray(o)||n.filterValue||n.selectedFilterOperation||n.allowFiltering)&&(s=t._columnsController.columnOption(e.columnIndex,"filterValue"),(Array.isArray(o)||e.columnIndex===void 0||m(s)||!n.selectedFilterOperation||n.filterValue)&&(t._applyFilter(),a=!0)),!t._needApplyFilter&&!y.checkChanges(n,["width","visibleWidth","filterValue","bufferedFilterValue","selectedFilterOperation","filterValues","filterType"])&&t._columnsController.columnsChanged.add(l),m(n.visible))){const d=t._columnsController.columnOption(e.columnIndex);d&&(m(d.filterValue)||m(d.filterValues))&&(t._applyFilter(),a=!0)}!a&&i.filtering&&!this._needApplyFilter&&t.reload()}_handleDataChanged(e){const t=this,i=t._dataSource,n=t._columnsController;let s=!1;this._useSortingGroupingFromColumns=!1,i&&!t._isDataSourceApplying&&(t._isDataSourceApplying=!0,O(t._columnsController.applyDataSource(i)).done((()=>{t._isLoading&&t._handleLoadingChanged(!1),s&&e&&e.isDelayed&&(e.isDelayed=!1),t._isDataSourceApplying=!1;const o=t._needApplyFilter;t._needApplyFilter=!1,o&&!t._isAllDataTypesDefined&&(()=>{const a=t._calculateAdditionalFilter();return a&&a.length})()?(se.log("W1005",t.component.NAME),t._applyFilter()):t.updateItems(e,!0)})).fail((()=>{t._isDataSourceApplying=!1})),t._isDataSourceApplying&&(s=!0,t._handleLoadingChanged(!0)),t._needApplyFilter=!t._columnsController.isDataSourceApplied(),t._isAllDataTypesDefined=n.isAllDataTypesDefined())}_handleLoadingChanged(e){this._isLoading=e,this._fireLoadingChanged()}_handleLoadError(e){this.dataErrorOccurred.fire(e)}_handleDataPushed(e){this.pushed.fire(e)}fireError(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.dataErrorOccurred.fire(se.Error.apply(se,t))}_setPagingOptions(e){const t=this.option("paging.pageIndex"),i=this.option("paging.pageSize"),n=this.option("paging.enabled"),s=this.option("scrolling.mode"),o=s==="infinite",l=n||s==="virtual"||o;let d=!1,c=!1,u=!1;return e.requireTotalCount(!o),n!==void 0&&e.paginate()!==l&&(e.paginate(l),d=!0),i!==void 0&&e.pageSize()!==i&&(e.pageSize(i),c=!0),t!==void 0&&e.pageIndex()!==t&&(e.pageIndex(t),u=!0),d||c||u?{isPaginateChanged:d,isPageSizeChanged:c,isPageIndexChanged:u}:!1}_getSpecificDataSourceOption(){const e=this.option("dataSource");return Array.isArray(e)?{store:{type:"array",data:e,key:this.option("keyExpr")}}:e}_initDataSource(){const e=this,t=this._dataSource;super._initDataSource();const i=e._dataSource;if(e._useSortingGroupingFromColumns=!0,e._cachedProcessedItems=null,i){const n=e._setPagingOptions(i);this._isPaging=n==null?void 0:n.isPageIndexChanged,e.setDataSource(i)}else t&&e.updateItems()}_loadDataSource(){const e=this,t=e._dataSource,i=new S;return O(this._columnsController.refresh(!0)).always((()=>{t?t.load().done((function(){e._isPaging=!1,i.resolve.apply(i,arguments)})).fail(i.reject):i.resolve()})),i.promise()}_beforeProcessItems(e){return e.slice(0)}getRowIndexDelta(){return 0}getDataIndex(e){const t=this._items,i=e.changeType==="append"&&t.length>0?t[t.length-1]:null;return m(i==null?void 0:i.dataIndex)?i.dataIndex+1:0}_processItems(e,t){const i=this,n=i.getRowIndexDelta(),{changeType:s}=t,o=i._columnsController.getVisibleColumns(null,s==="loadingAll"),a=this.getDataIndex(t),l={visibleColumns:o,dataIndex:a},d=[];return x(e,((c,u)=>{m(u)&&(l.rowIndex=c-n,u=i._processItem(u,l),d.push(u))})),d}_processItem(e,t){return e=this._generateDataItem(e,t),e=this._processDataItem(e,t),e.dataIndex=t.dataIndex++,e}_generateDataItem(e,t){return{rowType:"data",data:e,key:this.keyOf(e)}}_processDataItem(e,t){return e.values=this.generateDataValues(e.data,t.visibleColumns),e}generateDataValues(e,t,i){const n=[];let s;for(let o=0;o<t.length;o++){const a=t[o];s=i?void 0:null,a.command||(a.calculateCellValue?s=a.calculateCellValue(e):a.dataField&&(s=e[a.dataField])),n.push(s)}return n}_applyChange(e){const t=this;e.changeType==="update"?t._applyChangeUpdate(e):t.items().length&&e.repaintChangesOnly&&e.changeType==="refresh"?t._applyChangesOnly(e):e.changeType==="refresh"&&t._applyChangeFull(e)}_applyChangeFull(e){this._items=e.items.slice(0)}_getRowIndices(e){const t=e.rowIndices.slice(0),i=this.getRowIndexDelta();t.sort(((n,s)=>n-s));for(let n=0;n<t.length;n++){let s=t[n];e.allowInvisibleRowIndices&&(s+=i),s<0&&(t.splice(n,1),n--)}return t}_applyChangeUpdate(e){const t=this,{items:i}=e,n=t._getRowIndices(e),s=t.getRowIndexDelta(),o=t.option("repaintChangesOnly");let a=-1,l=0,d;e.items=[],e.rowIndices=[],e.columnIndices=[],e.changeTypes=[];const c=function(u,p,g){let _=u&&p&&ae(u.key,p.key);return _&&g&&(_=u.rowType===p.rowType&&(p.rowType!=="detail"||u.isEditing===p.isEditing)),_};x(n,((u,p)=>{let g;if(p+=l+s,a===p)return;a=p;const _=t._items[p],f=t._items[p+1],C=i[p],I=i[p+1],E=c(_,f)||c(C,I);if(C&&(C.rowIndex=p,e.items.push(C)),_&&C&&c(_,C,E))d="update",t._items[p]=C,_.visible!==C.visible?e.items.splice(-1,1,{visible:C.visible}):o&&!e.isFullUpdate&&(g=t._partialUpdateRow(_,C,p-s));else if(C&&!_||I&&c(_,I,E))d="insert",t._items.splice(p,0,C),l++;else if(_&&!C||f&&c(C,f,E))d="remove",t._items.splice(p,1),l--,a=-1;else if(C)d="update",t._items[p]=C;else return;e.rowIndices.push(p-s),e.changeTypes.push(d),e.columnIndices.push(g)}))}_isCellChanged(e,t,i,n,s){if(JSON.stringify(e.values[n])!==JSON.stringify(t.values[n]))return!0;function o(a,l){return a.modifiedValues?a.modifiedValues[l]!==void 0:!1}return o(e,n)!==o(t,n)}_getChangedColumnIndices(e,t,i,n){let s;if(e.rowType===t.rowType){if(t.rowType!=="group"&&t.rowType!=="groupFooter"&&(s=[],t.rowType!=="detail"))for(let o=0;o<e.values.length;o++)this._isCellChanged(e,t,i,o,n)&&s.push(o);t.rowType==="group"&&e.cells&&t.isExpanded===e.isExpanded&&t.data.isContinuation===e.data.isContinuation&&t.data.isContinuationOnNextPage===e.data.isContinuationOnNextPage&&(s=e.cells.map(((a,l)=>{var d;return((d=a.column)===null||d===void 0?void 0:d.type)!=="groupExpand"?l:-1})).filter((a=>a>=0)))}return s}_partialUpdateRow(e,t,i,n){var s;let o=this._getChangedColumnIndices(e,t,i,n);return(s=o)!==null&&s!==void 0&&s.length&&this.option("dataRowTemplate")&&(o=void 0),o&&(e.cells&&e.cells.forEach(((a,l)=>{!(o.indexOf(l)>=0)&&a&&a.update&&a.update(t)})),t.update=e.update,t.watch=e.watch,t.cells=e.cells,n&&(t.oldValues=e.values),e.update&&e.update(t)),o}_isItemEquals(e,t){if(JSON.stringify(e.values)!==JSON.stringify(t.values)||["modified","isNewRow","removed","isEditing"].some((a=>e[a]!==t[a])))return!1;if(e.rowType==="group"||e.rowType==="groupFooter"){var i,n,s,o;const a=e.isExpanded===t.isExpanded,l=JSON.stringify(e.summaryCells)===JSON.stringify(t.summaryCells),d=((i=e.data)===null||i===void 0?void 0:i.isContinuation)===((n=t.data)===null||n===void 0?void 0:n.isContinuation)&&((s=e.data)===null||s===void 0?void 0:s.isContinuationOnNextPage)===((o=t.data)===null||o===void 0?void 0:o.isContinuationOnNextPage);if(!a||!l||!d)return!1}return!0}_applyChangesOnly(e){const t=[],i=[],n=[],s=[],o={},a=(e==null?void 0:e.isLiveUpdate)??!0;function l(p){if(p)return`${p.rowType},${JSON.stringify(p.key)}`}const d=this._items,c=d.slice();e.items.forEach(((p,g)=>{const _=l(p);o[_]=g,p.rowIndex=g}));const u=vp({oldItems:c,newItems:e.items,getKey:l,isItemEquals:(p,g)=>this._isItemEquals(p,g)?(p.cells&&(p.update&&p.update(g),p.cells.forEach((_=>{_&&_.update&&_.update(g,!0)}))),!0):!1});if(!u){this._applyChangeFull(e);return}u.forEach((p=>{switch(p.type){case"update":{const{index:g}=p,_=p.data,{oldItem:f}=p,C=this._partialUpdateRow(f,_,g,a);t.push(g),n.push("update"),s.push(_),d[g]=_,i.push(C);break}case"insert":t.push(p.index),n.push("insert"),s.push(p.data),i.push(void 0),d.splice(p.index,0,p.data);break;case"remove":t.push(p.index),n.push("remove"),d.splice(p.index,1),s.push(p.oldItem),i.push(void 0)}})),e.repaintChangesOnly=!0,e.changeType="update",e.rowIndices=t,e.columnIndices=i,e.changeTypes=n,e.items=s,c.length&&(e.isLiveUpdate=!0),this._correctRowIndices((p=>{const g=this._rowIndexOffset||0,_=this.getRowIndexOffset(),f=c[p-g],C=l(f),I=o[C];return I>=0?I+_-p:0}))}_correctRowIndices(e){}_afterProcessItems(e,t){return e}_updateItemsCore(e){let t;const i=this._dataSource,n=e.changeType||"refresh";if(e.changeType=n,i){const s=this._cachedProcessedItems;e.useProcessedItemsCache&&s?t=s:(t=e.items||i.items(),t=this._beforeProcessItems(t),t=this._processItems(t,e),this._cachedProcessedItems=t),t=this._afterProcessItems(t,e),e.items=t;const o=this._items.length===t.length&&this._items;this._applyChange(e);const a=this.getRowIndexDelta();x(this._items,((l,d)=>{d.rowIndex=l-a,o&&(d.cells=o[l].cells??[]);const c=t[l];c&&(d.loadIndex=c.loadIndex)})),this._rowIndexOffset=this.getRowIndexOffset()}else this._items=[]}_handleChanging(e){const t=this.getVisibleRows();this.dataSource()&&e.changes.forEach((n=>{if(n.type==="insert"&&n.index>=0){let s=0;for(let o=0;o<n.index;o++){const a=t[o];a&&(a.rowType==="data"||a.rowType==="group")&&s++}n.index=s}}))}updateItems(e,t){e=e||{};const i=this;if(e.isFirstRender=!i.changed.fired(),i._repaintChangesOnly!==void 0)e.repaintChangesOnly=e.repaintChangesOnly??i._repaintChangesOnly,e.needUpdateDimensions=e.needUpdateDimensions||i._needUpdateDimensions;else if(e.changes)e.repaintChangesOnly=i.option("repaintChangesOnly");else if(t){const n=i.dataSource().operationTypes();e.repaintChangesOnly=n&&!n.grouping&&!n.filtering&&i.option("repaintChangesOnly"),e.isDataChanged=!0,n&&(n.reload||n.paging||n.groupExpanding)&&(e.needUpdateDimensions=!0)}if(i._updateLockCount&&!e.cancel){i._changes.push(e);return}i._updateItemsCore(e),!e.cancel&&i._fireChanged(e)}loadingOperationTypes(){const e=this.dataSource();return e&&e.loadingOperationTypes()||{}}_fireChanged(e){this._currentOperationTypes&&(e.operationTypes=this._currentOperationTypes,this._currentOperationTypes=null),Re((()=>{this.changed.fire(e)}))}isLoading(){return this._isLoading||this._isCustomLoading}_fireLoadingChanged(){this.loadingChanged.fire(this.isLoading(),this._loadingText)}_calculateAdditionalFilter(){return null}_applyFilter(){const e=this._dataSource;return e?(e.pageIndex(0),this._isFilterApplying=!0,this.reload().done((()=>{this._isFilterApplying&&this.pageChanged.fire()}))):new S().resolve()}resetFilterApplying(){this._isFilterApplying=!1}filter(e){var t;const i=this._dataSource,n=i==null?void 0:i.filter(),s=i==null||(t=i.loadOptions)===null||t===void 0||(t=t.call(i))===null||t===void 0?void 0:t.langParams;if(arguments.length===0)return n;e=arguments.length>1?Array.prototype.slice.call(arguments,0):e,!y.equalFilterParameters(n,e,s)&&(i&&i.filter(e),this._applyFilter())}clearFilter(e){const t=this,i=t._columnsController,n=function(s){const o=i.columnCount();for(let a=0;a<o;a++)i.columnOption(a,s,void 0)};if(t.component.beginUpdate(),arguments.length>0)switch(e){case"dataSource":t.filter(null);break;case"search":t.searchByText("");break;case"header":n("filterValues");break;case"row":n("filterValue")}else t.filter(null),t.searchByText(""),n("filterValue"),n("bufferedFilterValue"),n("filterValues");t.component.endUpdate()}_fireDataSourceChanged(){const e=this,t=function(){e.changed.remove(t),e.dataSourceChanged.fire()};e.changed.add(t)}_getDataSourceAdapter(){}_createDataSourceAdapterCore(e,t){const n=this._getDataSourceAdapter().create(this.component);return n.init(e,t),n}isLocalStore(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.store())instanceof Pd}isCustomStore(e){return e=e||this.store(),e instanceof xp}_createDataSourceAdapter(e){let t=this.option("remoteOperations");const i=e.store(),n={filtering:!0,sorting:!0,paging:!0,grouping:!0,summary:!0};return L(t)&&t.groupPaging&&(t=b({},n,t)),t==="auto"&&(t=this.isLocalStore(i)||this.isCustomStore(i)?{}:{filtering:!0,sorting:!0,paging:!0}),t===!0&&(t=n),this._createDataSourceAdapterCore(e,t)}setDataSource(e){const t=this,i=t._dataSource;!e&&i&&(i.cancelAll(),i.changed.remove(t._dataChangedHandler),i.loadingChanged.remove(t._loadingChangedHandler),i.loadError.remove(t._loadErrorHandler),i.customizeStoreLoadOptions.remove(t._customizeStoreLoadOptionsHandler),i.changing.remove(t._changingHandler),i.pushed.remove(t._dataPushedHandler),i.dispose(t._isSharedDataSource)),e&&(e=t._createDataSourceAdapter(e)),t._dataSource=e,e&&(t._fireDataSourceChanged(),t._isLoading=!e.isLoaded(),t._needApplyFilter=!0,t._isAllDataTypesDefined=t._columnsController.isAllDataTypesDefined(),e.changed.add(t._dataChangedHandler),e.loadingChanged.add(t._loadingChangedHandler),e.loadError.add(t._loadErrorHandler),e.customizeStoreLoadOptions.add(t._customizeStoreLoadOptionsHandler),e.changing.add(t._changingHandler),e.pushed.add(t._dataPushedHandler))}items(e){return this._items}isEmpty(){return!this.items().length}pageCount(){return this._dataSource?this._dataSource.pageCount():1}dataSource(){return this._dataSource}store(){const e=this._dataSource;return e&&e.store()}loadAll(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this,n=new S,s=i._dataSource;if(s)if(e){const o={data:e,isCustomLoading:!0,storeLoadOptions:{isLoadingAll:!0},loadOptions:{filter:t?null:i.getCombinedFilter(),group:s.group(),sort:s.sort()}};s._handleDataLoaded(o),O(o.data).done((a=>{var l;a=i._beforeProcessItems(a),n.resolve(i._processItems(a,{changeType:"loadingAll"}),(l=o.extra)===null||l===void 0?void 0:l.summary)})).fail(n.reject)}else if(s.isLoading())n.reject();else{const o=b({},s.loadOptions(),{isLoadingAll:!0,requireTotalCount:!1});s.load(o).done(((a,l)=>{a=i._beforeProcessItems(a),a=i._processItems(a,{changeType:"loadingAll"}),n.resolve(a,l&&l.summary)})).fail(n.reject)}else n.resolve([]);return n}getKeyByRowIndex(e,t){const i=this.items(t)[e];if(i)return i.key}getRowIndexByKey(e,t){return y.getIndexByKey(e,this.items(t))}getRowByKey(e){var t;return(t=this.items())===null||t===void 0?void 0:t[this.getRowIndexByKey(e)]}keyOf(e){const t=this.store();if(t)return t.keyOf(e)}byKey(e){const t=this.store(),i=this.getRowIndexByKey(e);let n;if(t)return i>=0&&(n=new S().resolve(this.items()[i].data)),n||t.byKey(e)}key(){const e=this.store();if(e)return e.key()}getRowIndexOffset(e){return 0}getDataByKeys(e){const t=this,i=new S,n=[],s=[];return x(e,((o,a)=>{n.push(t.byKey(a).done((l=>{s[o]=l})))})),O.apply(h,n).always((()=>{i.resolve(s)})),i}pageIndex(e){return Da(this,"pageIndex",e)}pageSize(e){return Da(this,"pageSize",e)}beginCustomLoading(e){this._isCustomLoading=!0,this._loadingText=e||"",this._fireLoadingChanged()}endCustomLoading(){this._isCustomLoading=!1,this._loadingText=void 0,this._fireLoadingChanged()}refresh(e){e===!0?e={reload:!0,changesOnly:!0}:e||(e={reload:!0,lookup:!0});const t=this,i=t.getDataSource(),{changesOnly:n}=e,s=new S,o=function(){t._repaintChangesOnly=!!n};return O(!e.lookup||t._columnsController.refresh()).always((()=>{e.load||e.reload?(i&&i.on("customizeLoadResult",o),O(t.reload(e.reload,n)).always((()=>{i&&i.off("customizeLoadResult",o),t._repaintChangesOnly=void 0})).done(s.resolve).fail(s.reject)):(t.updateItems({repaintChangesOnly:e.changesOnly}),s.resolve())})),s.promise()}getVisibleRows(){return this.items()}_disposeDataSource(){this._dataSource&&this._dataSource._eventsStrategy&&this._dataSource._eventsStrategy.off("loadingChanged",this.readyWatcher),this.setDataSource(null)}dispose(){this._disposeDataSource(),super.dispose()}repaintRows(e,t){e=Array.isArray(e)?e:[e],(e.length>1||m(e[0]))&&this.updateItems({changeType:"update",rowIndices:e,isFullUpdate:!t})}skipProcessingPagingChange(e){return this._skipProcessingPagingChange&&(e==="paging.pageIndex"||e==="paging.pageSize")}getUserState(){return{searchText:this.option("searchPanel.text"),pageIndex:this.pageIndex(),pageSize:this.pageSize()}}getCachedStoreData(){return this._dataSource&&this._dataSource.getCachedStoreData()}isLastPageLoaded(){const e=this.pageIndex(),t=this.pageCount();return e===t-1}load(){var e;return(e=this._dataSource)===null||e===void 0?void 0:e.load()}reload(e,t){var i;return(i=this._dataSource)===null||i===void 0?void 0:i.reload(e,t)}push(){for(var e,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return(e=this._dataSource)===null||e===void 0?void 0:e.push(...i)}itemsCount(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.itemsCount():0}totalItemsCount(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.totalItemsCount():0}hasKnownLastPage(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.hasKnownLastPage():!0}isLoaded(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.isLoaded():!0}totalCount(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.totalCount():0}hasLoadOperation(){var e;const t=((e=this._dataSource)===null||e===void 0?void 0:e.operationTypes())??{};return Object.keys(t).some((i=>t[i]))}}const yS={defaultOptions:()=>({loadingTimeout:0,dataSource:null,cacheEnabled:!0,repaintChangesOnly:!1,highlightChanges:!1,onDataErrorOccurred:null,remoteOperations:"auto",paging:{enabled:!0,pageSize:void 0,pageIndex:void 0}}),controllers:{data:Rm}},Wn=function(r,e){if(r&&(r=r.slice(0),e))for(let t=0;t<r.length;t++)r[t]=b({key:r[t].key},r[t]),r[t].items=Wn(r[t].items,e-1);return r},Ra=function(r,e,t){let i={reload:!0,fullReload:!0};return e&&(i={sorting:!y.equalSortParameters(r.sort,e.sort),grouping:!y.equalSortParameters(r.group,e.group,!0),groupExpanding:!y.equalSortParameters(r.group,e.group)||e.groupExpand,filtering:!y.equalFilterParameters(r.filter,e.filter,r.langParams),pageIndex:r.pageIndex!==e.pageIndex,skip:r.skip!==e.skip,take:r.take!==e.take,pageSize:r.pageSize!==e.pageSize,fullReload:t,reload:!1,paging:!1},i.reload=t||i.sorting||i.grouping||i.filtering,i.paging=i.pageIndex||i.pageSize||i.take),i},Vm=function(r,e){m(e)?tp.executeAsync(r,e):r()},ki=function(){return{items:{}}},Va=function(r,e){const t=y.normalizeSortingInfo(r.group||r.storeLoadOptions.group||r.loadOptions.group).length,i=[];if(Sc(i,r,t))return i;e&&Fm(i,r,t)},Sc=function(r,e,t,i){var n;const{storeLoadOptions:s}=e,o=e.take??s.take??0,a=(n=e.cachedData)===null||n===void 0?void 0:n.items;if(o&&a){const l=e.skip??s.skip??0;for(let d=0;d<o;d+=1){const c=i?o-1-d:d,u=c+l,p=a[u];if(p===void 0&&u in a)return!0;const g=Om(e,p,t,c,o);if(g)r.push(g);else return!1}return!0}return!1},Om=function(r,e,t,i,n){if(t&&e){const s=i===0&&r.skips||[],o=i===n-1&&r.takes||[];return Ec(e,t,s,o)}return e},Ec=function(r,e,t,i){if(e&&r){const n=T({},r),s=t[0]||0,o=i[0],{items:a}=r;if(a){if(o===void 0&&!a[s])return;n.items=[],t.length&&(n.isContinuation=!0),o&&(n.isContinuationOnNextPage=r.count>o);for(let l=0;o===void 0?a[l+s]:l<o;l+=1){const d=a[l+s],c=l+1===o,u=Ec(d,e-1,l===0?t.slice(1):[],c?i.slice(1):[]);if(u!==void 0)n.items.push(u);else return}}return n}return r},Fm=function(r,e,t){const i=r.length,{storeLoadOptions:n}=e;if(n.skip!==void 0&&n.take&&!t){const s=[];Sc(s,e,t,!0);const o=s.length;(i||o)&&(e.skip=e.skip??n.skip,e.take=e.take??n.take),i&&(n.skip+=i,n.take-=i,e.cachedDataPartBegin=r),o&&(n.take-=o,e.cachedDataPartEnd=s.reverse())}},Am=function(r,e,t){const{storeLoadOptions:i}=r,n=r.skip??i.skip??0,s=r.take??i.take??0;for(let o=0;o<s;o+=1){const a=o+n,l=r.cachedData.items,d=o===0&&r.skips||[];l[a]=Tc(l[a],e[o],t,d)}},Tc=function(r,e,t,i){if(t&&e){const n=T({},e);delete n.isContinuation,delete n.isContinuationOnNextPage;const s=i[0]||0;return e.items&&(n.items=(r==null?void 0:r.items)||{},e.items.forEach(((o,a)=>{const l=a+s,d=a===0?i.slice(1):[];n.items[l]=Tc(n.items[l],o,t-1,d)}))),n}return e};class IS extends j.Controller{init(e,t){const i=this;i._dataSource=e,i._remoteOperations=t||{},i._isLastPage=!e.isLastPage(),i._hasLastPage=!1,i._currentTotalCount=0,i._cachedData=ki(),i._lastOperationTypes={},i._eventsStrategy=e._eventsStrategy,i._totalCountCorrection=0,i._isLoadingAll=!1,i.changed=$e(),i.loadingChanged=$e(),i.loadError=$e(),i.customizeStoreLoadOptions=$e(),i.changing=$e(),i.pushed=$e(),i._dataChangedHandler=i._handleDataChanged.bind(i),i._customizeStoreLoadOptionsHandler=i._handleCustomizeStoreLoadOptions.bind(i),i._dataLoadedHandler=i._handleDataLoaded.bind(i),i._loadingChangedHandler=i._handleLoadingChanged.bind(i),i._loadErrorHandler=i._handleLoadError.bind(i),i._pushHandler=i._handlePush.bind(i),i._changingHandler=i._handleChanging.bind(i),e.on("changed",i._dataChangedHandler),e.on("customizeStoreLoadOptions",i._customizeStoreLoadOptionsHandler),e.on("customizeLoadResult",i._dataLoadedHandler),e.on("loadingChanged",i._loadingChangedHandler),e.on("loadError",i._loadErrorHandler),e.on("changing",i._changingHandler),e.store().on("beforePush",i._pushHandler),x(e,((n,s)=>{!i[n]&&B(s)&&(i[n]=function(){return this._dataSource[n].apply(this._dataSource,arguments)})}))}dispose(e){const t=this._dataSource,i=t.store();t.off("changed",this._dataChangedHandler),t.off("customizeStoreLoadOptions",this._customizeStoreLoadOptionsHandler),t.off("customizeLoadResult",this._dataLoadedHandler),t.off("loadingChanged",this._loadingChangedHandler),t.off("loadError",this._loadErrorHandler),t.off("changing",this._changingHandler),i&&i.off("beforePush",this._pushHandler),e||t.dispose()}remoteOperations(){return this._remoteOperations}refresh(e,t){const i=this,n=i._dataSource;t.reload&&(i.resetCurrentTotalCount(),i._isLastPage=!n.paginate(),i._hasLastPage=i._isLastPage)}resetCurrentTotalCount(){this._currentTotalCount=0,this._totalCountCorrection=0}resetCache(){this._cachedStoreData=void 0,this._cachedPagingData=void 0}resetPagesCache(e){this._cachedData=ki()}_needClearStoreDataCache(){const e=this.remoteOperations(),t=Ra(this._lastLoadOptions||{},{});return!Object.keys(e).every((n=>!t[n]||!e[n]))}push(e,t){const i=this.store();this._needClearStoreDataCache()&&(this._cachedStoreData=void 0),this._cachedPagingData=void 0,this.resetPagesCache(!0),this._cachedStoreData&&$n({keyInfo:i,data:this._cachedStoreData,changes:e}),t||this._applyBatch(e),this.pushed.fire(e)}getDataIndexGetter(){if(!this._dataIndexGetter){let e,t;const i=this.store();this._dataIndexGetter=n=>{const s=t&&t!==this._cachedStoreData;if(!e||s){t=this._cachedStoreData||[],e={};for(let o=0;o<t.length;o++)e[Ot(i.keyOf(t[o]))]=o}return e[Ot(i.keyOf(n))]}}return this._dataIndexGetter}_getKeyInfo(){return this.store()}_needToCopyDataObject(){return!0}_applyBatch(e,t){const i=this._getKeyInfo(),n=this._dataSource,s=y.normalizeSortingInfo(this.group()).length,o=this.option("editing.refreshMode")==="reshape",a=this.option("scrolling.mode")==="virtual";e=e.filter((u=>!n.paginate()||u.type!=="insert"||u.index!==void 0));const l=()=>s?this.itemsCount():this.items().length,d=l();$n({keyInfo:i,data:this._items,changes:e,groupCount:s,useInsertIndex:!0,skipCopying:!this._needToCopyDataObject()}),$n({keyInfo:i,data:n.items(),changes:e,groupCount:s,useInsertIndex:!0,skipCopying:!this._needToCopyDataObject()}),(this._currentTotalCount>0||(t||!o)&&a)&&(this._totalCountCorrection+=l()-d),e.splice(0,e.length)}_handlePush(e){let{changes:t}=e;this.push(t,!0)}_handleChanging(e){this.changing.fire(e),this._applyBatch(e.changes,!0)}_needCleanCacheByOperation(e,t){const i=["filtering","sorting","paging"],n=i.indexOf(e);return(n>=0?i.slice(n):[e]).some((o=>t[o]))}_customizeRemoteOperations(e,t){let i=this._cachedStoreData,n=this._cachedPagingData,s=this._cachedData;(e.storeLoadOptions.filter&&!e.remoteOperations.filtering||e.storeLoadOptions.sort&&!e.remoteOperations.sorting)&&(e.remoteOperations={filtering:e.remoteOperations.filtering,summary:e.remoteOperations.summary}),t.fullReload?(i=void 0,n=void 0,s=ki()):(t.reload?(n=void 0,s=ki()):t.groupExpanding&&(s=ki()),x(t,((o,a)=>{a&&this._needCleanCacheByOperation(o,e.remoteOperations)&&(i=void 0,n=void 0)}))),n&&(e.remoteOperations.paging=!1),e.cachedStoreData=i,e.cachedPagingData=n,e.cachedData=s,e.isCustomLoading||(this._cachedStoreData=i,this._cachedPagingData=n,this._cachedData=s)}_handleCustomizeStoreLoadOptions(e){var t;this._handleDataLoading(e),((t=e.data)===null||t===void 0?void 0:t.length)!==0&&(e.data=Va(e,!0)||e.cachedStoreData)}_handleDataLoading(e){const t=this._dataSource,i=this._lastLoadOptions;this.customizeStoreLoadOptions.fire(e),e.delay=this.option("loadingTimeout"),e.originalStoreLoadOptions=e.storeLoadOptions,e.remoteOperations=b({},this.remoteOperations());const n=!this.isLoaded()&&!this._isRefreshing;this.option("integrationOptions.renderedOnServer")&&!this.isLoaded()&&(e.delay=void 0);const s=b({pageIndex:this.pageIndex(),pageSize:this.pageSize()},e.storeLoadOptions),o=Ra(s,i,n);if(this._customizeRemoteOperations(e,o),!e.isCustomLoading){const a=this._isRefreshing;e.pageIndex=t.pageIndex(),e.lastLoadOptions=s,e.operationTypes=o,this._loadingOperationTypes=o,this._isRefreshing=!0,O(a||this._isRefreshed||this.refresh(e,o)).done((()=>{this._lastOperationId===e.operationId&&(this._isRefreshed=!0,this.load().always((()=>{this._isRefreshed=!1})))})).fail((()=>{t.cancel(e.operationId)})).always((()=>{this._isRefreshing=!1})),t.cancel(this._lastOperationId),this._lastOperationId=e.operationId,this._isRefreshing&&t.cancel(this._lastOperationId)}this._handleDataLoadingCore(e)}_handleDataLoadingCore(e){const{remoteOperations:t}=e;e.loadOptions={};const i=e.cachedData.extra,n={filter:!t.filtering,sort:!t.sorting,group:!t.grouping,summary:!t.summary,skip:!t.paging,take:!t.paging,requireTotalCount:i&&"totalCount"in i||!t.paging,langParams:!t.filtering||!t.sorting};x(e.storeLoadOptions,((s,o)=>{n[s]&&(e.loadOptions[s]=o,delete e.storeLoadOptions[s])})),i&&(e.extra=i)}_handleDataLoaded(e){const{loadOptions:t}=e,i=e.remoteOperations&&!e.remoteOperations.paging,{cachedData:n}=e,{storeLoadOptions:s}=e,o=this.option("cacheEnabled")!==!1&&s,a=o&&!e.isCustomLoading&&n&&(!i||s.group),l=o&&i,d=l&&!e.isCustomLoading;if(!t){this._dataSource.cancel(e.operationId);return}i&&(e.skip=t.skip,e.take=t.take,delete t.skip,delete t.take),t.group&&(t.group=e.group||t.group);const c=y.normalizeSortingInfo(e.group||s.group||t.group).length;if(e.cachedDataPartBegin&&(e.data=e.cachedDataPartBegin.concat(e.data)),e.cachedDataPartEnd&&(e.data=e.data.concat(e.cachedDataPartEnd)),!a||!Va(e)){var u;l&&e.cachedPagingData?e.data=Wn(e.cachedPagingData,c):(d&&(this._cachedStoreData?e.mergeStoreLoadData&&(e.data=this._cachedStoreData=this._cachedStoreData.concat(e.data)):this._cachedStoreData=Wn(e.data,y.normalizeSortingInfo(s.group).length)),new Pd(e.data).load(t).done((p=>{e.data=p,d&&(this._cachedPagingData=Wn(e.data,c))})).fail((p=>{e.data=new S().reject(p)}))),t.requireTotalCount&&i&&(e.extra=ze(e.extra)?e.extra:{},e.extra.totalCount=e.data.length),e.extra&&e.extra.totalCount>=0&&(s.requireTotalCount===!1||t.requireTotalCount===!1)&&(e.extra.totalCount=-1),!t.data&&(s.requireTotalCount||(((u=e.extra)===null||u===void 0?void 0:u.totalCount)??-1)>=0)&&(this._totalCountCorrection=0),this._handleDataLoadedCore(e),a&&(n.extra=n.extra||b({},e.extra),O(e.data).done((p=>{Am(e,p,c)})))}O(e.data).done((()=>{e.lastLoadOptions&&(this._lastLoadOptions=e.lastLoadOptions,Object.keys(e.operationTypes).forEach((p=>{this._lastOperationTypes[p]=this._lastOperationTypes[p]||e.operationTypes[p]})))})),e.storeLoadOptions=e.originalStoreLoadOptions}_handleDataLoadedCore(e){e.remoteOperations&&!e.remoteOperations.paging&&Array.isArray(e.data)&&(e.skip!==void 0&&(e.data=e.data.slice(e.skip)),e.take!==void 0&&(e.data=e.data.slice(0,e.take)))}_handleLoadingChanged(e){this.loadingChanged.fire(e)}_handleLoadError(e){this.loadError.fire(e),this.changed.fire({changeType:"loadError",error:e})}_loadPageSize(){return this.pageSize()}_handleDataChanged(e){let t;const i=this._dataSource;let n=!1;const s=!e||m(e.changeType),o=this.itemsCount();s&&(this._isLastPage=!o||!this._loadPageSize()||o<this._loadPageSize(),this._isLastPage&&(this._hasLastPage=!0)),i.totalCount()>=0?i.pageIndex()>=this.pageCount()&&(i.pageIndex(this.pageCount()-1),this.pageIndex(i.pageIndex()),this.resetPagesCache(),i.load(),n=!0):s&&(t=i.pageIndex()*this.pageSize()+o,t>this._currentTotalCount&&(this._currentTotalCount=t,(i.pageIndex()===0||!this.option("scrolling.legacyMode"))&&(this._totalCountCorrection=0)),o===0&&i.pageIndex()>=this.pageCount()&&(i.pageIndex(this.pageCount()-1),this.option("scrolling.mode")!=="infinite"&&(i.load(),n=!0))),n||(this._operationTypes=this._lastOperationTypes,this._lastOperationTypes={},this.component._optionCache={},this.changed.fire(e),this.component._optionCache=void 0)}_scheduleCustomLoadCallbacks(e){const t=this;t._isCustomLoading=!0,e.always((()=>{t._isCustomLoading=!1}))}loadingOperationTypes(){return this._loadingOperationTypes}operationTypes(){return this._operationTypes}lastLoadOptions(){return this._lastLoadOptions||{}}isLastPage(){return this._isLastPage}_dataSourceTotalCount(){return this._dataSource.totalCount()}_changeRowExpandCore(e){}changeRowExpand(e){}totalCount(){return parseInt((this._currentTotalCount||this._dataSourceTotalCount())+this._totalCountCorrection)}totalCountCorrection(){return this._totalCountCorrection}items(){}itemsCount(){return this._dataSource.items().length}totalItemsCount(){return this.totalCount()}pageSize(){const e=this._dataSource;return!arguments.length&&!e.paginate()?0:e.pageSize.apply(e,arguments)}pageCount(){const e=this.totalItemsCount()-this._totalCountCorrection,t=this.pageSize();return t&&e>0?Math.max(1,Math.ceil(e/t)):1}hasKnownLastPage(){return this._hasLastPage||this._dataSource.totalCount()>=0}loadFromStore(e,t){const i=this._dataSource,n=new S;if(i)return t=t||i.store(),t.load(e).done(((s,o)=>{s&&!Array.isArray(s)&&Array.isArray(s.data)&&(o=s,s=s.data),n.resolve(s,o)})).fail(n.reject),n}isCustomLoading(){return!!this._isCustomLoading}load(e){const t=this,i=t._dataSource,n=new S;if(e){const s=i.store(),o=i.loadOptions(),a={storeLoadOptions:b({},e,{langParams:o==null?void 0:o.langParams}),isCustomLoading:!0};return x(s._customLoadOptions()||[],((l,d)=>{d in a.storeLoadOptions||(a.storeLoadOptions[d]=o[d])})),this._isLoadingAll=e.isLoadingAll,t._scheduleCustomLoadCallbacks(n),i._scheduleLoadCallbacks(n),t._handleCustomizeStoreLoadOptions(a),Vm((()=>{if(!i.store())return n.reject("canceled");O(a.data||t.loadFromStore(a.storeLoadOptions)).done(((l,d)=>{a.data=l,a.extra=d||{},t._handleDataLoaded(a),e.requireTotalCount&&a.extra.totalCount===void 0&&(a.extra.totalCount=s.totalCount(a.storeLoadOptions)),O(a.data,a.extra.totalCount).done(((c,u)=>{a.extra.totalCount=u,n.resolve(c,a.extra)})).fail(n.reject)})).fail(n.reject)}),t.option("loadingTimeout")),n.fail((function(){t._eventsStrategy.fireEvent("loadError",arguments)})).always((()=>{this._isLoadingAll=!1})).promise()}return i.load()}reload(e){return e?this._dataSource.reload():this._dataSource.load()}getCachedStoreData(){return this._cachedStoreData}isLoaded(){}pageIndex(e){}}const Dc=r=>class extends r{_applyColumnState(e){const t=this;let i,n;const s=t.option("sorting.mode"),{rootElement:o}=e,{column:a}=e,l=t._getIndicatorContainer(o);if(e.name==="sort"){o.find(".dx-sort").remove(),!l.children().length&&l.remove();const d=s!=="none"&&a.allowSorting,c=t.getController&&!!t.getController("columns").columnOption("sortIndex:1");return!m(a.groupIndex)&&(d||m(a.sortOrder))&&(i=a.sortOrder==="asc"?"ascending":"descending",n=super._applyColumnState(e).toggleClass("dx-sort-up",a.sortOrder==="asc").toggleClass("dx-sort-down",a.sortOrder==="desc"),c&&t.option("sorting.showSortIndexes")&&a.sortIndex>=0&&(h("<span>").addClass("dx-sort-index-icon").text(a.sortIndex+1).appendTo(n),n.addClass("dx-sort-index")),d&&e.rootElement.addClass(t.addWidgetPrefix("action"))),this._setAriaSortAttribute(a,i,o,c),n}return super._applyColumnState(e)}_setAriaSortAttribute(e,t,i,n){if(i.removeAttr("aria-roledescription"),e.isGrouped){let s=this.localize("dxDataGrid-ariaNotSortedColumn");m(e.sortOrder)&&(s=e.sortOrder==="asc"?this.localize("dxDataGrid-ariaSortedAscendingColumn"):this.localize("dxDataGrid-ariaSortedDescendingColumn")),this.setAria("roledescription",s,i)}else if(!m(e.sortOrder))this.setAria("sort","none",i);else if(this.setAria("sort",t,i),n&&e.sortIndex>=0){const s=w.format("dxDataGrid-ariaColumnHeader"),o=w.format("dxDataGrid-ariaSortIndex",e.sortIndex+1),a=`${s}, ${o}`;this.setAria("roledescription",a,i)}}_getIndicatorClassName(e){return e==="sort"?"dx-sort":e==="sortIndex"?"dx-sort-index-icon":super._getIndicatorClassName(e)}_renderIndicator(e){const{column:t}=e,i=e.container,n=e.indicator;if(e.name==="sort"){const s=this.option("rtlEnabled");if(m(t.sortOrder)||n&&n.addClass("dx-sort-none"),i.children().length&&(!s&&e.columnAlignment==="left"||s&&e.columnAlignment==="right")){i.prepend(n);return}}super._renderIndicator(e)}_updateIndicator(e,t,i){if(!(i==="sort"&&m(t.groupIndex)))return super._updateIndicator.apply(this,arguments)}_getIndicatorElements(e,t){const i=super._getIndicatorElements(e);return t?i:i&&i.not(".dx-sort-none")}},Pm=r=>class extends Dc(r){optionChanged(e){const t=this;e.name==="sorting"?(t._invalidate(),e.handled=!0):super.optionChanged(e)}_createRow(e){const t=super._createRow(e);return e.rowType==="header"&&v.on(t,V(Q,"dxDataGridColumnHeadersView"),"td",this.createAction((i=>{this._processHeaderAction(i.event,t)}))),t}_processHeaderAction(e,t){if(h(e.currentTarget).parent().get(0)!==t.get(0))return;const i=this;let n=null;const s=h(e.currentTarget),o=s.parent().index();let a=-1;[].slice.call(i.getCellElements(o)).some(((g,_)=>{if(g===s.get(0))return a=_,!0}));const d=i._columnsController.getVisibleColumns(o)[a],c=i.getController("editing"),u=i.option("editing.mode");c&&c.isEditing()&&(u==="batch"||u==="cell")||!i._isSortableElement(h(e.target))||d&&!m(d.groupIndex)&&!d.command&&(e.shiftKey?n="shift":Ae(e)&&(n="ctrl"),setTimeout((()=>{i._columnsController.changeSortOrder(d.index,n)})))}_renderCellContent(e,t){const i=this,{column:n}=t;!n.command&&t.rowType==="header"&&i._applyColumnState({name:"sort",rootElement:e,column:n,showColumnLines:i.option("showColumnLines")}),super._renderCellContent.apply(this,arguments)}_columnOptionChanged(e){const{changeTypes:t}=e;if(t.length===1&&t.sorting){this._updateIndicators("sort");return}super._columnOptionChanged(e)}},km=r=>class extends Dc(r){optionChanged(e){const t=this;e.name==="sorting"?(t._invalidate(),e.handled=!0):super.optionChanged(e)}_createGroupPanelItem(e,t){const i=this,n=super._createGroupPanelItem(...arguments);return v.on(n,V(Q,"dxDataGridHeaderPanel"),i.createAction((()=>{i._processGroupItemAction(t.index)}))),i._applyColumnState({name:"sort",rootElement:n,column:{alignment:i.option("rtlEnabled")?"right":"left",allowSorting:t.allowSorting,sortOrder:t.sortOrder==="desc"?"desc":"asc",isGrouped:!0},showColumnLines:!0}),n}_processGroupItemAction(e){setTimeout((()=>this.getController("columns").changeSortOrder(e)))}},SS={defaultOptions:()=>({sorting:{mode:"single",ascendingText:w.format("dxDataGrid-sortingAscendingText"),descendingText:w.format("dxDataGrid-sortingDescendingText"),clearText:w.format("dxDataGrid-sortingClearText"),showSortIndexes:!0}}),extenders:{views:{columnHeadersView:Pm,headerPanel:km}}},In="dx-freespace-row",Oa="dx-last-row-border";function Fa(r){return r?Math.round(r.scrollWidth()-r.clientWidth()):0}function Fo(r){let{rowType:e,column:t}=r;return e==="group"&&m(t.groupIndex)&&!t.showWhenGrouped&&!t.command}function Aa(r){let{element:e,watch:t,getter:i,callBack:n}=r;if(t){const s=t(i,n);v.on(e,ii,s)}}const Mm=function(r,e){const t=ip(e.text)&&e.rowType==="data",{text:i}=e,n=r.get(0);t?y.setEmptyText(r):e.column.encodeHtml?n.textContent=i:n.innerHTML=i},Bm=function(r){const e=r.getScrollable();return e?Math.ceil(parseFloat(h(e.content()).css("paddingBottom"))):0};class Nm extends xs{init(){super.init(),this._editingController=this.getController("editing"),this._resizingController=this.getController("resizing"),this._columnsResizerController=this.getController("columnsResizer"),this._focusController=this.getController("focus"),this._keyboardNavigationController=this.getController("keyboardNavigation"),this._validatingController=this.getController("validating"),this._errorHandlingController=this.getController("errorHandling"),this._columnHeadersView=this.getView("columnHeadersView"),this._rowHeight=0,this._scrollTop=0,this._scrollLeft=-1,this._scrollRight=0,this._hasHeight=void 0,this._contentChanges=[],this._dataController.loadingChanged.add(((e,t)=>{this.setLoading(e,t)})),this._dataController.dataSourceChanged.add((()=>{this._scrollLeft>=0&&!this._dataController.isLoading()&&this._handleScroll({component:this.getScrollable(),forceUpdateScrollPosition:!0,scrollOffset:{top:this._scrollTop,left:this._scrollLeft}})}))}_getDefaultTemplate(e){return e.command==="empty"?function(t){t.html("&nbsp;")}:Mm}renderFocusState(e){}_getDefaultGroupTemplate(e){const t=this.option("summary.texts");return function(i,n){const{data:s}=n;let o=`${n.column.caption}: ${n.text}`;const a=i.get(0);n.summaryItems&&n.summaryItems.length&&(o+=` ${y.getGroupRowSummaryText(n.summaryItems,t)}`),s&&(n.groupContinuedMessage&&n.groupContinuesMessage?o+=` (${n.groupContinuedMessage}. ${n.groupContinuesMessage})`:n.groupContinuesMessage?o+=` (${n.groupContinuesMessage})`:n.groupContinuedMessage&&(o+=` (${n.groupContinuedMessage})`)),e.encodeHtml?a.textContent=o:a.innerHTML=o}}_update(e){}_updateCell(e,t){Fo(t)&&(e.is(`.${this.addWidgetPrefix(J.groupRowContainer)}`)?e.parent():e).addClass("dx-group-cell"),super._updateCell.apply(this,arguments)}_getCellTemplate(e){const t=this,{column:i}=e;let n;return Fo(e)?n=i.groupCellTemplate||{allowRenderToDetachedContainer:!0,render:t._getDefaultGroupTemplate(i)}:(e.rowType==="data"||i.command)&&i.cellTemplate?n=i.cellTemplate:n={allowRenderToDetachedContainer:!0,render:t._getDefaultTemplate(i)},n}_createRow(e,t){const i=super._createRow.apply(this,arguments);if(e){const n=e.rowType==="group",s=e.rowType==="data";s&&i.addClass("dx-data-row"),s&&this.option("showRowLines")&&i.addClass("dx-row-lines"),this.option("showColumnLines")&&i.addClass("dx-column-lines"),e.visible===!1&&i.hide(),n&&(i.addClass("dx-group-row"),this.setAriaExpandedAttribute(i,e))}return i}_rowPrepared(e,t,i){t.rowType==="data"&&(this.option("rowAlternationEnabled")&&(this._isAltRow(i)&&e.addClass("dx-row-alt"),Aa({element:e.get(0),watch:t.watch,getter:()=>this._isAltRow(this._dataController.getRowByKey(i.key)),callBack:n=>{e.toggleClass("dx-row-alt",n)}})),this._setAriaRowIndex(t,e),Aa({element:e.get(0),watch:t.watch,getter:()=>t.rowIndex,callBack:()=>this._setAriaRowIndex(t,e)})),super._rowPrepared.apply(this,arguments)}_setAriaRowIndex(e,t){if(!t.is("tr"))return;const{component:i}=this,n=i.option("scrolling.mode")==="standard"&&!y.isVirtualRowRendering(i);let s=e.rowIndex+1;n?s=i.pageIndex()*i.pageSize()+s:s+=this._dataController.getRowIndexOffset(),this.setAria("rowindex",s,t)}setAriaExpandedAttribute(e,t){const i=t.isExpanded?this.localize("dxDataGrid-ariaExpandedRow"):this.localize("dxDataGrid-ariaCollapsedRow");this.setAria("roledescription",i,e)}_afterRowPrepared(e){const t=e.args[0],i=this._dataController,n=i.getVisibleRows()[t.rowIndex],s=this.option("integrationOptions.watchMethod");if(!t.data||t.rowType!=="data"||t.isNewRow||!this.option("twoWayBindingEnabled")||!s||!n)return;const o=s((()=>i.generateDataValues(t.data,t.columns)),(()=>{i.repaintRows([n.rowIndex],this.option("repaintChangesOnly"))}),{deep:!0,skipImmediate:!0});v.on(t.rowElement,ii,o)}_renderScrollable(e){const t=this,i=t.element();if(i.children().length||i.append("<div>"),(e||!t._loadPanel)&&t._renderLoadPanel(i,i.parent(),t._dataController.isLocalStore()),(e||!t.getScrollable())&&t._dataController.isLoaded()){const n=t.getColumns();let s=!0;for(let o=0;o<n.length;o++)if(!n[o].width&&!n[o].minWidth){s=!1;break}(t.option("columnAutoWidth")||t._hasHeight||s||t._columnsController._isColumnFixing())&&t._renderScrollableCore(i)}}_handleScroll(e){const t=this.option("rtlEnabled"),i=e.component.option("useNative");this._scrollTop=e.scrollOffset.top,this._scrollLeft=e.scrollOffset.left;let n=e.scrollOffset.left;t&&(this._scrollRight=Fa(e.component)-this._scrollLeft,i&&(n=-this._scrollRight),this.isScrollbarVisible(!0)||(this._scrollLeft=-1)),this.scrollChanged.fire(T({},e.scrollOffset,{left:n}),this.name)}_renderScrollableCore(e){const t=this._createScrollableOptions(),i=this._handleScroll.bind(this);t.onScroll=i,this._scrollable=this._createComponent(e,it,t),this._scrollableContainer=this._scrollable&&h(this._scrollable.container())}_renderLoadPanel(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return y.renderLoadPanel.apply(this,arguments)}_renderContent(e,t,i){return e.empty().append(t),this._findContentElement()}_updateContent(e,t,i){return this._contentChanges.push({newTableElement:e,change:t,isFixedTableRendering:i}),this.waitAsyncTemplates().done((()=>{const n=this._contentChanges;this._contentChanges=[],n.forEach((s=>{let{newTableElement:o,change:a,isFixedTableRendering:l}=s;const d=this.getTableElement(l),c=this._findContentElement(l),u=a==null?void 0:a.changeType,p=[],g=this.option("highlightChanges"),_=this.addWidgetPrefix("row-inserted-animation");u==="update"?(x(a.rowIndices,((f,C)=>{var I;const E=this._getRowElements(o).eq(f),D=(I=a.changeTypes)===null||I===void 0?void 0:I[f],k=a.items&&a.items[f];p.push((()=>{const A=this._getRowElements(d),F=A.eq(C);switch(D){case"update":if(k){var z;const ee=(z=a.columnIndices)===null||z===void 0?void 0:z[f];m(k.visible)&&k.visible!==F.is(":visible")?F.toggle(k.visible):ee?this._updateCells(F,E,ee,k):F.replaceWith(E)}break;case"insert":if(A.length)F.length?E.insertBefore(F):E.insertAfter(A.last());else if(d){const ee=E.is("tbody")?d:d.children("tbody");E.prependTo(ee)}g&&a.isLiveUpdate&&E.addClass(_);break;case"remove":F.remove()}}))})),x(p,(function(){this()})),o.remove()):(this.setTableElement(o,l),c.addClass(this.addWidgetPrefix("content")),this._setGridRole(c),this._renderContent(c,o,l))}))})).fail((()=>{this._contentChanges=[]}))}_getGridRoleName(){return"grid"}_setGridRole(e){var t;const i=!((t=this._dataController)!==null&&t!==void 0&&t.isEmpty()),n=this._getGridRoleName();e!=null&&e.length&&i&&this.setAria("role",n,e)}_createEmptyRow(e,t,i){const n=this;let s;const o=n._createRow(),a=t?this.getFixedColumns():this.getColumns();o.addClass(e).toggleClass("dx-column-lines",n.option("showColumnLines"));for(let l=0;l<a.length;l++)s=n._createCell({column:a[l],rowType:"freeSpace",columnIndex:l,columns:a}),Ee(i)&&s.css("height",i),o.append(s);return n.setAria("role","presentation",o),o}getFixedColumns(){throw new Error("Method not implemented.")}_appendEmptyRow(e,t,i){const n=this._getBodies(e),s=!n.length||t.is("tbody"),o=s?e:n;if(i==="top"){if(o.first().prepend(t),s){const a=o.children("colgroup");o.prepend(a)}}else o.last().append(t)}_renderFreeSpaceRow(e,t){let i=this._createEmptyRow(In);i=this._wrapRowIfNeed(e,i,(t==null?void 0:t.changeType)==="refresh"),this._appendEmptyRow(e,i)}_checkRowKeys(e){const t=this,i=t._getRows(e),n=t._dataController.store()&&t._dataController.store().key();n&&i.some((s=>{if(s.rowType==="data"&&s.key===void 0)return t._dataController.fireError("E1046",n),!0}))}_needUpdateRowHeight(e){return e>0&&!this._rowHeight}_getRowsHeight(e){return e=e||this._tableElement,e.children("tbody").children().not(".dx-virtual-row").not(`.${In}`).toArray().reduce(((i,n)=>i+re(n).height),0)}_updateRowHeight(){const e=this,t=e.getTableElement(),i=e._dataController.items().length;if(t&&e._needUpdateRowHeight(i)){const n=e._getRowsHeight(t);e._rowHeight=n/i}}_findContentElement(e){let t=this.element();const i=this.getScrollable();if(t)return i&&(t=h(i.content())),t.children().first()}_getRowElements(e){const t=super._getRowElements(e);return t&&t.not(`.${In}`)}_getFreeSpaceRowElements(e){const t=e||this.getTableElements();return t&&t.children("tbody").children(`.${In}`)}_getNoDataText(){return this.option("noDataText")}_rowClick(e){const t=this._dataController.items()[e.rowIndex]||{};this.executeAction("onRowClick",b({evaluate(i){return Pe(i)(t.data)}},e,t))}_rowDblClick(e){const t=this._dataController.items()[e.rowIndex]||{};this.executeAction("onRowDblClick",b({},e,t))}_getColumnsCountBeforeGroups(e){for(let t=0;t<e.length;t++)if(e[t].type==="groupExpand")return t;return 0}_getGroupCellOptions(e){const t=this._getColumnsCountBeforeGroups(e.columns),i=(e.row.groupIndex||0)+t;return{columnIndex:i,colspan:e.columns.length-i-1}}_needWrapRow(){return super._needWrapRow.apply(this,arguments)||!!this.option("dataRowTemplate")}_renderCells(e,t){t.row.rowType==="group"?this._renderGroupedCells(e,t):t.row.values&&super._renderCells(e,t)}_renderGroupedCells(e,t){const{row:i}=t;let n;const{columns:s}=t,{rowIndex:o}=i;let a;const l=this._getGroupCellOptions(t);for(let u=0;u<=l.columnIndex;u++)u===l.columnIndex&&s[u].allowCollapsing&&t.scrollingMode!=="infinite"?(a=!!i.isExpanded,n=s[u]):(a=null,n={command:"expand",cssClass:s[u].cssClass,fixed:s[u].fixed}),this._needRenderCell(u,t.columnIndices)&&this._renderCell(e,{value:a,row:i,rowIndex:o,column:n,columnIndex:u,columnIndices:t.columnIndices,change:t.change});const d=cn(this.option("rtlEnabled")),c=b({},s[l.columnIndex],{command:null,type:null,cssClass:null,width:null,showWhenGrouped:!1,alignment:d});l.colspan>1&&(c.colspan=l.colspan),this._needRenderCell(l.columnIndex+1,t.columnIndices)&&this._renderCell(e,{value:i.values[i.groupIndex],row:i,rowIndex:o,column:c,columnIndex:l.columnIndex+1,columnIndices:t.columnIndices,change:t.change})}_renderRows(e,t){const i=this,n=i.option("scrolling.mode");super._renderRows(e,b({scrollingMode:n},t)),i._checkRowKeys(t.change),i._renderFreeSpaceRow(e,t.change),i._hasHeight||i.updateFreeSpaceRowHeight(e)}_renderDataRowByTemplate(e,t,i){const{row:n}=t,s=b({columns:t.columns},n),o=this._createRow(n,"tbody");o.appendTo(e),this.renderTemplate(o,i,s,!0,t.change),this._rowPrepared(o,s,t.row)}_renderRow(e,t){const{row:i}=t,{rowTemplate:n}=this.option(),s=this.option("dataRowTemplate");i.rowType==="data"&&s?this._renderDataRowByTemplate(e,t,s):(i.rowType==="data"||i.rowType==="group")&&!m(i.groupIndex)&&n?this.renderTemplate(e,n,b({columns:t.columns},i),!0):super._renderRow(e,t)}_renderTable(e){const t=this,i=super._renderTable(e),n=function(){const s=t.getScrollable();s&&t.element().closest(oe().document).length&&(t.resizeCompleted.remove(n),s._visibilityChanged(!0))};return m(t.getTableElement())?t._renderScrollable():(t.setTableElement(i),t._renderScrollable(!0),t.resizeCompleted.add(n)),i}_createTable(){const e=super._createTable.apply(this,arguments);return(this.option().rowTemplate||this.option().dataRowTemplate)&&e.appendTo(this.component.$element()),e}_renderCore(e){const t=this.element();t.addClass(this.addWidgetPrefix("rowsview")).toggleClass(this.addWidgetPrefix("nowrap"),!this.option("wordWrapEnabled")),t.toggleClass("dx-empty",this._dataController.isEmpty()),this.setAria("role","presentation",t);const i=this._renderTable({change:e}),n=this._updateContent(i,e);return super._renderCore(e),this._lastColumnWidths=null,n}_getRows(e){return e&&e.items||this._dataController.items()}_getCellOptions(e){const t=this,{column:i}=e,{row:n}=e,{data:s}=n,o=n&&n.summaryCells,{value:a}=e,l=y.getDisplayValue(i,a,s,n.rowType),d=super._getCellOptions(e);if(d.value=a,d.oldValue=e.oldValue,d.displayValue=l,d.row=n,d.key=n.key,d.data=s,d.rowType=n.rowType,d.values=n.values,d.text=i.command?"":y.formatValue(l,i),d.rowIndex=n.rowIndex,d.summaryItems=o&&o[e.columnIndex],d.resized=i.resizedCallbacks,m(i.groupIndex)&&!i.command){const c=t.option("grouping.texts"),u=t.option("scrolling.mode");u!=="virtual"&&u!=="infinite"&&(d.groupContinuesMessage=s&&s.isContinuationOnNextPage&&c&&c.groupContinuesMessage,d.groupContinuedMessage=s&&s.isContinuation&&c&&c.groupContinuedMessage)}return d}_toggleDraggableSourceColumnClass(e,t,i,n){const s=this._columnsController,o=s.getColumns(),a=o&&o[i],l=a&&a.isBand&&a.index;x(e,((d,c)=>{if(!h(c).hasClass("dx-group-row"))for(let u=0;u<t.length&&!((Ee(l)&&s.isParentBandColumn(t[u].index,l)||t[u].index===i)&&(e.eq(d).children().eq(u).toggleClass(this.addWidgetPrefix(Jn.draggableColumn),n),!Ee(l)));u++);}))}_getDevicePixelRatio(){return oe().devicePixelRatio}renderNoDataText(){return y.renderNoDataText.apply(this,arguments)}getCellOptions(e,t){const i=this._dataController.items()[e];let n,s;return i&&(W(t)?s=this._columnsController.columnOption(t):s=this._columnsController.getVisibleColumns()[t],s&&(n=this._getCellOptions({value:s.calculateCellValue(i.data),rowIndex:i.rowIndex,row:i,column:s}))),n}getRow(e){if(e>=0){const t=this._getRowElements();if(t.length>e)return h(t[e])}}updateFreeSpaceRowHeight(e){const t=this._dataController,i=t.items(!0).length,n=this._findContentElement(),s=this._getFreeSpaceRowElements(e);if(s&&n&&t.totalCount()>=0){let o=!1;if(i>0)if(this._hasHeight)s.hide(),je((()=>{const a=this.getScrollbarWidth(!0),l=X(this.element())-a,d=Y(n),c=l-d>0,u=this._getRowsHeight(n.children().first()),p=e||this.getTableElements(),g=Math.ceil(parseFloat(p.css("borderTopWidth"))),_=this._getHeightCorrection(),f=l-u-g-_;c&&Re((()=>{s.css("height",f),o=!0,s.show()})),Re((()=>this._updateLastRowBorder(o)))}));else{const a=t.pageSize()-i,l=this.option("scrolling.mode");a>0&&t.pageCount()>1&&l!=="virtual"&&l!=="infinite"&&(Rs(s,a*this._rowHeight),o=!0),!o&&e?Rs(s,0):s.toggle(o),this._updateLastRowBorder(o)}else s.css("height",0),s.show(),this._updateLastRowBorder(!0)}}_getHeightCorrection(){const e=me.webkit&&this._getDevicePixelRatio()>=2,t=me.chrome&&me.version>=91,i=me.mozilla&&me.version>=70&&!this.option("showRowLines");return e||i||t?1:0}_columnOptionChanged(e){const{optionNames:t}=e;e.changeTypes.grouping||(t.width||t.visibleWidth)&&(super._columnOptionChanged(e),this._fireColumnResizedCallbacks())}getScrollable(){return this._scrollable}_handleDataChanged(e){const t=this;switch(e.changeType){case"refresh":case"prepend":case"append":case"update":t.render(null,e);break;default:t._update(e)}}publicMethods(){return["isScrollbarVisible","getTopVisibleRowData","getScrollbarWidth","getCellElement","getRowElement","getScrollable"]}contentWidth(){return H(this.element())-this.getScrollbarWidth()}getScrollbarWidth(e){const t=this._scrollableContainer&&this._scrollableContainer.get(0);let i=0;return t&&(e?(i=t.clientHeight?t.offsetHeight-t.clientHeight:0,i+=Bm(this)):i=t.clientWidth?t.offsetWidth-t.clientWidth:0),i>0?i:0}_fireColumnResizedCallbacks(){const e=this._lastColumnWidths||[],t=[],i=this.getColumns();for(let n=0;n<i.length;n++)t[n]=i[n].visibleWidth,i[n].resizedCallbacks&&!m(i[n].groupIndex)&&e[n]!==t[n]&&i[n].resizedCallbacks.fire(t[n]);this._lastColumnWidths=t}_updateLastRowBorder(e){this.option("showBorders")&&!e?this.element().addClass(Oa):this.element().removeClass(Oa)}_updateScrollable(){const e=it.getInstance(this.element());e&&(e.update(),this._updateHorizontalScrollPosition())}_updateHorizontalScrollPosition(){const e=this.getScrollable(),t=e&&e.scrollOffset().left;if(this.option("rtlEnabled")){const n=Fa(e);n-t!==this._scrollRight&&(this._scrollLeft=n-this._scrollRight)}this._scrollLeft>=0&&t!==this._scrollLeft&&e.scrollTo({x:this._scrollLeft})}_resizeCore(){const e=this;e._fireColumnResizedCallbacks(),e._updateRowHeight(),Re((()=>{e._renderScrollable(),e.renderNoDataText(),e.updateFreeSpaceRowHeight(),je((()=>{e._updateScrollable()}))}))}scrollTo(e){const t=this.element(),i=t&&it.getInstance(t);i&&i.scrollTo(e)}height(e){const t=this,i=this.element();if(arguments.length===0)return i?Y(i,!0):0;m(e)&&i&&(t.hasHeight(e!=="auto"),Rs(i,e))}hasHeight(e){if(arguments.length===0)return!!this._hasHeight;this._hasHeight=e}setLoading(e,t){const i=this;let n=i._loadPanel;const s=i._dataController,o=i.option("loadPanel")||{},a=s.isLoaded()?o.animation:null,l=i.element();if(pe()&&(!n&&t!==void 0&&s.isLocalStore()&&o.enabled==="auto"&&l&&(i._renderLoadPanel(l,l.parent()),n=i._loadPanel),n)){const d={message:t||o.text,animation:a,visible:e};e&&(d.position=y.calculateLoadPanelPosition(l)),clearTimeout(i._hideLoadingTimeoutID),n.option("visible")&&!e?i._hideLoadingTimeoutID=setTimeout((()=>{n.option(d)}),200):n.option(d)}}toggleDraggableColumnClass(e,t){const i=this._getRowElements().not(".dx-group-row")||[];this._toggleDraggableSourceColumnClass(i,this.getColumns(),e,t)}_getCellElementsCore(e){const t=super._getCellElementsCore.apply(this,arguments);if(t){const i=t.filter(".dx-group-cell").index();if(i>=0&&t.length>i+1)return t.slice(0,i+1)}return t}_getBoundaryVisibleItemIndex(e,t){const i=this;let n=0,s=0,o=0,a=i._scrollTop;const l=i._findContentElement(),d=l&&l.offset().top,c=this._dataController.items(),u=i.getTableElement();if(c.length&&u){const p=i._getRowElements(u).filter(":visible");if(!e){const g=Y(this._hasHeight?this.element():oe());a+=g}for(n=0;n<c.length;n++){s=o;const g=h(p).eq(n);if(g.length&&(o=g.offset(),o=(e?o.top:o.top+Y(g))-d,o>a)){n&&(t||2*a<Math.round(o+s))&&n--;break}}n&&n===c.length&&n--}return n}getTopVisibleItemIndex(e){return this._getBoundaryVisibleItemIndex(!0,e)}getBottomVisibleItemIndex(e){return this._getBoundaryVisibleItemIndex(!1,e)}getTopVisibleRowData(){const e=this.getTopVisibleItemIndex(),t=this._dataController.items();if(t[e])return t[e].data}_scrollToElement(e,t){const i=this.getScrollable();i&&i.scrollToElement(e,t)}optionChanged(e){const t=this;switch(super.optionChanged(e),e.name){case"wordWrapEnabled":case"showColumnLines":case"showRowLines":case"rowAlternationEnabled":case"rowTemplate":case"dataRowTemplate":case"twoWayBindingEnabled":t._invalidate(!0,!0),e.handled=!0;break;case"scrolling":t._rowHeight=null,t._tableElement=null,e.handled=!0;break;case"rtlEnabled":t._rowHeight=null,t._tableElement=null;break;case"loadPanel":t._tableElement=null,t._invalidate(!0,e.fullName!=="loadPanel.enabled"),e.handled=!0;break;case"noDataText":t.renderNoDataText(),e.handled=!0}}setAriaOwns(e,t,i){const n=this._findContentElement(),s=this.getTableElement();s!=null&&s.length&&this.setAria("owns",`${e??""} ${s.attr("id")??""} ${t??""}`.trim(),n)}dispose(){super.dispose(),clearTimeout(this._hideLoadingTimeoutID),this._scrollable&&this._scrollable.dispose()}setScrollerSpacing(e,t){}getFixedContentElement(){var e;const t=this.addWidgetPrefix("content-fixed");return(e=this.element())===null||e===void 0?void 0:e.children(`.${t}`)}_restoreErrorRow(e){}isElementInside(e){return e.closest(`.${this.addWidgetPrefix("rowsview")}`).is(this.element())}_renderIcons(e,t){return e}}const ES={defaultOptions:()=>({hoverStateEnabled:!1,scrolling:{useNative:"auto"},loadPanel:{enabled:"auto",text:w.format("Loading"),width:200,height:90,showIndicator:!0,indicatorSrc:"",showPane:!0},dataRowTemplate:null,columnAutoWidth:!1,noDataText:w.format("dxDataGrid-noDataText"),wordWrapEnabled:!1,showColumnLines:!0,showRowLines:!1,rowAlternationEnabled:!1,activeStateEnabled:!1,twoWayBindingEnabled:!0}),views:{rowsView:Nm}};class cr extends wp{_getPlainItems(){const e=this._getItems();return wt(e,(function i(n){return n.items?[n].concat(wt(n.items,i)):n})).flat()}static _stringifyItem(e){return JSON.stringify(e,((t,i)=>t==="template"?cr._getTemplateString(i):i))}static _getTemplateString(e){return typeof e=="object"&&e!==null?h(e).text():String(e)}}const Lm=["items"];class $m{constructor(){this._dataStructure=[],this._itemsCount=0,this._visibleItemsCount=0,this._indexByKey={}}_convertItemsToNodes(e,t){x(e,((i,n)=>{const s=m(t)?t:this._getParentId(n),o=this._convertItemToNode(n,s);this._dataStructure.push(o),this._checkForDuplicateId(o.internalFields.key),this._indexByKey[o.internalFields.key]=this._dataStructure.length-1,this._itemHasChildren(n)&&this._convertItemsToNodes(this._dataAccessors.getters.items(n),o.internalFields.key)}))}_checkForDuplicateId(e){if(m(this._indexByKey[String(e)]))throw se.Error("E1040",e)}_getParentId(e){return this._dataType==="plain"?this._dataAccessors.getters.parentKey(e):void 0}_itemHasChildren(e){if(this._dataType==="plain")return!1;const t=this._dataAccessors.getters.items(e);return!!(t!=null&&t.length)}_getUniqueKey(e){const t=this._dataAccessors.getters.key,i=t(e);return(i||i===0)&&Nn(i)?i:this.getItemsCount()}_convertItemToNode(e,t){this._itemsCount+=1,e.visible!==!1&&(this._visibleItemsCount+=1);const i=Jo(e,Lm);return T({internalFields:{disabled:this._dataAccessors.getters.disabled(e,{defaultValue:!1}),expanded:this._dataAccessors.getters.expanded(e,{defaultValue:!1}),selected:this._dataAccessors.getters.selected(e,{defaultValue:!1}),key:this._getUniqueKey(e),parentKey:m(t)?t:this._rootValue,item:this._makeObjectFromPrimitive(e),childrenKeys:[]}},i)}setChildrenKeys(){x(this._dataStructure,((e,t)=>{if(t.internalFields.parentKey===this._rootValue)return;const i=this.getParentNode(t);i&&i.internalFields.childrenKeys.push(t.internalFields.key)}))}_makeObjectFromPrimitive(e){if(Nn(e)){const t=e,i={};return this._dataAccessors.setters.key(i,t),i}return e}_convertToPublicNode(e,t){if(!e)return null;const i={text:this._dataAccessors.getters.display(e),key:e.internalFields.key,selected:e.internalFields.selected,expanded:e.internalFields.expanded,disabled:e.internalFields.disabled,parent:t??null,itemData:e.internalFields.item,children:[],items:[]};return i.parent&&(i.parent.children.push(i),i.parent.items.push(i)),i}convertToPublicNodes(e,t){if(!e.length)return[];const i=[];return x(e,((n,s)=>{const o=Nn(s)?this._getByKey(s):s;if(!o)return;const a=this._convertToPublicNode(o,t);a&&(a.children=this.convertToPublicNodes(o.internalFields.childrenKeys,a),i.push(a),o.internalFields.publicNode=a)})),i}setDataAccessors(e){this._dataAccessors=e}_getByKey(e){return this._dataStructure[this.getIndexByKey(e)]??null}getParentNode(e){return this._getByKey(e.internalFields.parentKey)}getByKey(e,t){return m(t)?(function(i,n){let s=null;return x(i,((o,a)=>{var l;const d=((l=a.internalFields)===null||l===void 0?void 0:l.key)??a.key;return(d==null?void 0:d.toString())===n.toString()?(s=a,!1):!0})),s})(e,t):null}getItemsCount(){return this._itemsCount}getVisibleItemsCount(){return this._visibleItemsCount}updateIndexByKey(){this._indexByKey={},x(this._dataStructure,((e,t)=>{this._checkForDuplicateId(t.internalFields.key),this._indexByKey[t.internalFields.key]=e}))}updateChildrenKeys(){this._indexByKey={},this.removeChildrenKeys(),this.updateIndexByKey(),this.setChildrenKeys()}removeChildrenKeys(){this._indexByKey={},x(this._dataStructure,((e,t)=>{t.internalFields.childrenKeys=[]}))}getIndexByKey(e){return this._indexByKey[e]}createPlainStructure(e,t,i){return this._itemsCount=0,this._visibleItemsCount=0,this._rootValue=t,this._dataType=i,this._indexByKey={},this._convertItemsToNodes(e),this.setChildrenKeys(),this._dataStructure}}const li="expanded",zt="selected",Hm="disabled";ms.setEditorClass(tr);class ur{constructor(e){this.options={dataAccessors:{},items:[],multipleSelection:!0,recursiveSelection:!1,recursiveExpansion:!1,rootValue:0,searchValue:"",dataType:"tree",searchMode:"contains",dataConverter:new $m,onNodeChanged:Ce,sort:null},this._selectedNodesKeys=[],this._expandedNodesKeys=[],this._dataStructure=[],this._initialDataStructure=[],b(this.options,e),this.options.dataConverter.setDataAccessors(this.options.dataAccessors),this._createInternalDataStructure(),this.getTreeNodes()}setOption(e,t){this.options[e]=t,e==="recursiveSelection"&&this._updateSelection()}_createInternalDataStructure(){this._initialDataStructure=this.options.dataConverter.createPlainStructure(this.options.items,this.options.rootValue,this.options.dataType),this._dataStructure=this.options.searchValue.length?this.search(this.options.searchValue):this._initialDataStructure,this.options.dataConverter._dataStructure=this._dataStructure,this._updateSelection(),this._updateExpansion()}_updateSelection(){this.options.recursiveSelection&&(this._setChildrenSelection(),this._setParentSelection()),this._selectedNodesKeys=this._updateNodesKeysArray(zt)}_updateExpansion(e){this.options.recursiveExpansion&&(e?this._updateOneBranch(e):this._setParentExpansion()),this._expandedNodesKeys=this._updateNodesKeysArray(li)}_updateNodesKeysArray(e){let t=[];return x(this._getDataBySelectionMode(),((i,n)=>{this._isNodeVisible(n)&&n.internalFields[e]&&(e===li||this.options.multipleSelection?t.push(n.internalFields.key):(t.length&&this.toggleSelection(t[0],!1,!0),t=[n.internalFields.key]))})),t}_getDataBySelectionMode(){return this.options.multipleSelection?this.getData():this.getFullData()}_isNodeVisible(e){return e.internalFields.item.visible!==!1}_getByKey(e,t){return e===this._dataStructure?this.options.dataConverter._getByKey(t):this.options.dataConverter.getByKey(e.filter(Boolean),t)}_setChildrenSelection(){x(this._dataStructure,((e,t)=>{if(!(t!=null&&t.internalFields.childrenKeys.length))return;const i=t.internalFields.selected;i&&this._toggleChildrenSelection(t,i)}))}_setParentSelection(){x(this._dataStructure,((e,t)=>{if(!t)return;this.options.dataConverter.getParentNode(t)&&t.internalFields.parentKey!==this.options.rootValue&&this._iterateParents(t,(n=>{const s=this._calculateSelectedState(n);this._setFieldState(n,zt,s)}))}))}_setParentExpansion(){x(this._dataStructure,((e,t)=>{t!=null&&t.internalFields.expanded&&this._updateOneBranch(t.internalFields.key)}))}_updateOneBranch(e){const t=this.getNodeByKey(e);this._iterateParents(t,(i=>{this._setFieldState(i,li,!0)}))}_iterateChildren(e,t,i,n){if(!B(i)||!e)return;const s=e.internalFields.key,o=n??[];s!==void 0&&!o.includes(s)&&(o.push(s),x(e.internalFields.childrenKeys,((a,l)=>{const d=this.getNodeByKey(l);i(d),d!=null&&d.internalFields.childrenKeys.length&&t&&this._iterateChildren(d,t,i,o)})))}_iterateParents(e,t,i){if(!e||e.internalFields.parentKey===this.options.rootValue||!B(t))return;const n=i??[],{key:s}=e.internalFields;if(!n.includes(s)){n.push(s);const o=this.options.dataConverter.getParentNode(e);o&&(t(o),o.internalFields.parentKey!==this.options.rootValue&&this._iterateParents(o,t,n))}}_calculateSelectedState(e){const t=e.internalFields.childrenKeys.length;let i=0,n=0,s=!1;for(let o=0;o<=t-1;o+=1){const a=this.getNodeByKey(e.internalFields.childrenKeys[o]),l=(a==null?void 0:a.internalFields.item.visible)===!1,d=a==null?void 0:a.internalFields.selected;l?n+=1:d?i+=1:d===void 0&&(i+=.5)}return i&&(s=i===t-n?!0:void 0),s}_toggleChildrenSelection(e,t){this._iterateChildren(e,!0,(i=>{i&&this._isNodeVisible(i)&&this._setFieldState(i,zt,t)}))}_setFieldState(e,t,i){e.internalFields[t]!==i&&(e.internalFields[t]=i,e.internalFields.publicNode&&(e.internalFields.publicNode[t]=i),this.options.dataAccessors.setters[t](e.internalFields.item,i),this.options.onNodeChanged(e))}_markChildren(e){x(e,((t,i)=>{const n=this.getIndexByKey(i),s=this.getNodeByKey(i);this._dataStructure[n]=null,s!=null&&s.internalFields.childrenKeys.length&&this._markChildren(s.internalFields.childrenKeys)}))}_removeNode(e){const t=this.getNodeByKey(e);this._dataStructure[this.getIndexByKey(e)]=null,t!=null&&t.internalFields.childrenKeys.length&&this._markChildren(t.internalFields.childrenKeys);let i=0;const n=b([],this._dataStructure);x(n,((s,o)=>{o||(this._dataStructure.splice(s-i,1),i+=1)}))}_addNode(e){const{dataConverter:t}=this.options,i=t._convertItemToNode(e,this.options.dataAccessors.getters.parentKey(e));this._dataStructure=this._dataStructure.concat(i),this._initialDataStructure=this._initialDataStructure.concat(i),t._dataStructure=t._dataStructure.concat(i)}_updateFields(){this.options.dataConverter.updateChildrenKeys(),this._updateSelection(),this._updateExpansion()}getSelectedNodesKeys(){return this._selectedNodesKeys}getExpandedNodesKeys(){return this._expandedNodesKeys}getData(){return this._dataStructure}getFullData(){return this._initialDataStructure}getNodeByItem(e){let t=null;return x(this._dataStructure,((i,n)=>(n==null?void 0:n.internalFields.item)===e?(t=n,!1):!0)),t}getNodesByItems(e){const t=[];return x(e,((i,n)=>{const s=this.getNodeByItem(n);s&&t.push(s)})),t}getNodeByKey(e,t){return this._getByKey(t??this._getDataBySelectionMode(),e)}getTreeNodes(){const t=this.getRootNodes().map((i=>i.internalFields.key));return this.options.dataConverter.convertToPublicNodes(t,null)}getItemsCount(){return this.options.dataConverter.getItemsCount()}getVisibleItemsCount(){return this.options.dataConverter.getVisibleItemsCount()}getPublicNode(e){return e==null?void 0:e.internalFields.publicNode}getRootNodes(){return this.getChildrenNodes(this.options.rootValue)}getChildrenNodes(e){return Xi(this._dataStructure,{langParams:this.options.langParams}).filter(["internalFields.parentKey",e]).toArray()}getIndexByKey(e){return this.options.dataConverter.getIndexByKey(e)}addItem(e){this._addNode(e),this._updateFields()}removeItem(e){this._removeNode(e),this._updateFields()}toggleSelection(e,t,i){const n=this._isSingleModeUnselect(t),s=i||n?this._initialDataStructure:this._dataStructure,o=this._getByKey(s,e);o&&(this._setFieldState(o,zt,t),this.options.recursiveSelection&&!i&&(t?this._setChildrenSelection():this._toggleChildrenSelection(o,t),this._setParentSelection())),this._selectedNodesKeys=this._updateNodesKeysArray(zt)}_isSingleModeUnselect(e){return!this.options.multipleSelection&&!e}toggleNodeDisabledState(e,t){const i=this.getNodeByKey(e);i&&this._setFieldState(i,Hm,t)}toggleSelectAll(e){if(!m(e))return;const t=this._selectedNodesKeys[this._selectedNodesKeys.length-1],i=this._isSingleModeUnselect(e)?this._initialDataStructure:this._dataStructure;x(i,((n,s)=>{s&&this._isNodeVisible(s)&&this._setFieldState(s,zt,e)})),this._selectedNodesKeys=this._updateNodesKeysArray(zt),!e&&this.options.selectionRequired&&this.toggleSelection(t,!0)}isAllSelected(){return this.getSelectedNodesKeys().length?this.getSelectedNodesKeys().length===this.getVisibleItemsCount()?!0:void 0:!1}toggleExpansion(e,t){const i=this.getNodeByKey(e);i&&(this._setFieldState(i,li,t),t&&this._updateExpansion(e)),this._expandedNodesKeys=this._updateNodesKeysArray(li)}isFiltered(e){return!this.options.searchValue.length||!!this._filterDataStructure(this.options.searchValue,[e]).length}static _createCriteria(e,t,i){const n=[];return Array.isArray(e)?(x(e,((s,o)=>{n.push([o,i,t],"or")})),n.pop(),n):[e,i,t]}_filterDataStructure(e,t){const i=this.options.searchExpr??this.options.dataAccessors.getters.display,n=bp(this.options.searchMode),s=ur._createCriteria(i,e,n),o=t??this._initialDataStructure;return Xi(o,{langParams:this.options.langParams}).filter(s).toArray()}search(e){let t=this._filterDataStructure(e);const{dataConverter:i}=this.options,n=(s,o)=>{const{length:a}=s;let l=o;for(;l<a;){const d=s[l];if(d.internalFields.parentKey===this.options.rootValue)l+=1;else{const c=i.getParentNode(d);if(!c)se.log("W1007",d.internalFields.parentKey,d.internalFields.key),l+=1;else if(c.internalFields.expanded||this._setFieldState(c,li,!0),s.includes(c))l+=1;else{s.splice(l,0,c),n(s,l);return}}}};return n(t,0),this.options.sort&&(t=kd.queryByOptions(Xi(t),{sort:this.options.sort,langParams:this.options.langParams}).toArray()),i._indexByKey={},x(t,((s,o)=>{o.internalFields.childrenKeys=[],i._indexByKey[o.internalFields.key]=s})),i._dataStructure=t,i.setChildrenKeys(),i._dataStructure}}class Rc extends yp{_getDefaultOptions(){return T({},super._getDefaultOptions(),{keyExpr:"id",displayExpr:"text",selectedExpr:"selected",disabledExpr:"disabled",itemsExpr:"items",hoverStateEnabled:!0,parentIdExpr:"parentId",expandedExpr:"expanded"})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:()=>G.real().deviceType==="desktop"&&!G.isSimulator(),options:{focusStateEnabled:!0}}])}_init(){super._init(),this._initAccessors(),this._initDataAdapter(),this._initDynamicTemplates()}_initDataSource(){var e;super._initDataSource(),(e=this._dataSource)===null||e===void 0||e.paginate(!1)}_initDataAdapter(){const e=this._createDataAdapterAccessors(),{items:t=[]}=this.option();this._dataAdapter=new ur(T({dataAccessors:{getters:e.getters,setters:e.setters},items:t},this._getDataAdapterOptions()))}_getDataAdapterOptions(){return{}}_getItemExtraPropNames(){return[]}_initDynamicTemplates(){const e=["text","html","items","icon"].concat(this._getItemExtraPropNames());this._templateManager.addDefaultTemplates({item:new ir(this._addContent.bind(this),e,this.option("integrationOptions.watchMethod"),{text:this._displayGetter,items:this._itemsGetter})})}_addContent(e,t){e.html(t.html).append(this._getIconContainer(t)).append(this._getTextContainer(t))}_getLinkContainer(e,t,i){const{linkAttr:n,url:s}=i,o=L(n)?n:{};return h("<a>").addClass("dx-item-url").attr(T({},o,{href:s})).append(e).append(t)}_clickByLink(e){e.addEventListener("click",(t=>{t.stopPropagation()}),{once:!0}),e.click()}_getIconContainer(e){if(!e.icon)return;const t=Ti(e.icon);if(t.is("img")){var i;const n=(i=this.NAME)!==null&&i!==void 0&&i.startsWith("dxPrivateComponent")?"":`${this.NAME} `;t.attr("alt",`${n}item icon`)}return t}_getTextContainer(e){return h("<span>").text(e.text)}_initAccessors(){x(this._getAccessors(),((e,t)=>{this._compileAccessor(t)})),this._compileDisplayGetter()}_getAccessors(){return["key","selected","items","disabled","parentId","expanded"]}_getChildNodes(e){const t=[];return x(e.internalFields.childrenKeys,((i,n)=>{var s;const o=(s=this._dataAdapter)===null||s===void 0?void 0:s.getNodeByKey(n);t.push(o)})),t}_hasChildren(e){var t;return!!(!(e==null||(t=e.internalFields)===null||t===void 0||(t=t.childrenKeys)===null||t===void 0)&&t.length)}_compileAccessor(e){const t=`_${e}Getter`,i=`_${e}Setter`,n=this.option(`${e}Expr`);if(!n){this[t]=Ce,this[i]=Ce;return}if(B(n)){this[i]=(s,o)=>{s[n()]=o},this[t]=s=>s[n()];return}this[t]=Pe(n),this[i]=Vd(n)}_createDataAdapterAccessors(){const e={getters:{},setters:{}};return x(this._getAccessors(),((t,i)=>{const n=`_${i}Getter`,s=`_${i}Setter`,o=i==="parentId"?"parentKey":i;e.getters[o]=this[n],e.setters[o]=this[s]})),e.getters.display=this._displayGetter??(t=>t.text),e}_initMarkup(){super._initMarkup(),this._addWidgetClass()}_addWidgetClass(){this._focusTarget().addClass(this._widgetClass())}_widgetClass(){return""}_renderItemFrame(e,t,i){const n=super._renderItemFrame(e,t,i);return n.toggleClass("dx-state-disabled",!!this._disabledGetter(t)),n}_optionChanged(e){switch(e.name){case"displayExpr":case"keyExpr":this._initAccessors(),this._initDynamicTemplates(),this.repaint();break;case"itemsExpr":case"selectedExpr":case"disabledExpr":case"expandedExpr":case"parentIdExpr":this._initAccessors(),this._initDataAdapter(),this.repaint();break;case"items":this._initDataAdapter(),super._optionChanged(e);break;default:super._optionChanged(e)}}}const Qe="dx-menu-item",Wm=`${Qe}-content`,Us=`${Qe}-selected`,zm=`${Qe}-wrapper`,Km=`${Qe}-expanded`,Gm=`${Qe}-has-text`,Um=`${Qe}-has-icon`,qm=`${Qe}-has-submenu`,Vc=`${Qe}-popout`,Ym=`${Vc}-container`,Oc=`${Qe}-text`,Pa={show:50},jm=`${Oc}-with-url`;class hr extends Rc{_getDefaultOptions(){return T({},super._getDefaultOptions(),{items:[],cssClass:"",activeStateEnabled:!0,showSubmenuMode:{name:"onHover",delay:{show:50,hide:300}},animation:{show:{type:"fade",from:0,to:1,duration:100},hide:{type:"fade",from:1,to:0,duration:100}},selectByClick:!1,focusOnSelectedItem:!1,keyExpr:null,_itemAttributes:{role:"menuitem"},useInkRipple:!1})}_itemDataKey(){return"dxMenuItemDataKey"}_itemClass(){return Qe}_setAriaSelectionAttribute(e,t){}_selectedItemClass(){return Us}_widgetClass(){return"dx-menu-base"}_focusTarget(){return this._itemContainer()}_clean(){this.option("focusedElement",null),super._clean()}_supportedKeys(){return T({},super._supportedKeys(),{space:()=>{const{focusedElement:e}=this.option(),t=h(e);!t.length||!this._isSelectionEnabled()||this.selectItem(t[0])},pageUp:Ce,pageDown:Ce})}_isSelectionEnabled(){const{selectionMode:e}=this.option();return e==="single"}_init(){super._init(),this._activeStateUnit=`.${Qe}`,this._renderSelectedItem(),this._initActions()}_getLinkContainer(e,t,i){const{linkAttr:n,url:s}=i;return e==null||e.addClass("dx-icon-with-url"),t==null||t.addClass(jm),super._getLinkContainer(e,t,{linkAttr:n,url:s})}_addContent(e,t){const{html:i,url:n}=t;if(n){e.html(i);const s=this._getLinkContainer(this._getIconContainer(t),this._getTextContainer(t),t);e.append(s)}else super._addContent(e,t);e.append(this._getPopoutContainer(t)),this._addContentClasses(t,e.parent())}_getTextContainer(e){const{text:t}=e;if(!t)return h();const i=h("<span>").addClass(Oc),n=ze(e)?t:String(e);return i.text(n)}_getItemExtraPropNames(){return["url","linkAttr"]}_getPopoutContainer(e){const{items:t}=e;if(!(t!=null&&t.length))return h();const i=h("<div>").addClass(Vc),n=h("<span>").addClass(Ym);return n.append(i),n}_getDataAdapterOptions(){return{rootValue:0,multipleSelection:!1,recursiveSelection:!1,recursiveExpansion:!1,searchValue:""}}_selectByItem(e){if(!e)return;const t=this._dataAdapter.getNodeByItem(e);t&&this._dataAdapter.toggleSelection(t.internalFields.key,!0)}_renderSelectedItem(){const e=this._dataAdapter.getSelectedNodesKeys(),t=e.length&&e[0],i=this.option("selectedItem");if(!t){this._selectByItem(i);return}const n=this._dataAdapter.getNodeByKey(t);if(!(!n||n.selectable===!1)){if(!i){this.option("selectedItem",n.internalFields.item);return}i!==n.internalFields.item&&(this._dataAdapter.toggleSelection(t,!1),this._selectByItem(i))}}_initActions(){}_initMarkup(){super._initMarkup();const{useInkRipple:e}=this.option();e&&this._renderInkRipple()}_renderInkRipple(){this._inkRipple=Md()}_toggleActiveState(e,t,i){if(super._toggleActiveState(e,t),!this._inkRipple)return;const n={element:e,event:i};t?this._inkRipple.showWave(n):this._inkRipple.hideWave(n)}_getShowSubmenuMode(){const{showSubmenuMode:e}=this.option(),t=L(e)?e.name:e;return this._isDesktopDevice()?t:"onClick"}_isDesktopDevice(){return G.real().deviceType==="desktop"}_initEditStrategy(){this._editStrategy=new cr(this)}_addCustomCssClass(e){const{cssClass:t}=this.option();t&&e.addClass(t)}_hoverStartHandler(e){const t=this._getItemElementByEventArgs(e);if(!(!t||this._isItemDisabled(t))&&(e.stopPropagation(),this._getShowSubmenuMode()==="onHover")){const i=this._getSubmenuDelay();i===0?this._showSubmenu(t):(clearTimeout(this._showSubmenusTimeout),this._showSubmenusTimeout=setTimeout(this._showSubmenu.bind(this,t),i))}}_getAvailableItems(e){return super._getAvailableItems(e).filter(((t,i)=>h(i).css("visibility")!=="hidden"))}_isItemDisabled(e){return this._disabledGetter(e.data(this._itemDataKey()))}_showSubmenu(e){this._addExpandedClass(e)}_addExpandedClass(e){h(e).addClass(Km)}_getSubmenuDelay(){const{showSubmenuMode:e}=this.option(),t=L(e)?e.delay:void 0;return m(t)?L(t)?t.show??Pa.show:t:Pa.show}_getItemElementByEventArgs(e){let t=h(e.target);if(t.hasClass(this._itemClass())||t.get(0)===e.currentTarget)return t;for(;!t.hasClass(this._itemClass());)if(t=t.parent(),t.hasClass("dx-submenu"))return null;return t}_hoverEndHandler(e){clearTimeout(this._showSubmenusTimeout)}_hasSubmenu(e){return!!(e!=null&&e.internalFields.childrenKeys.length)}_renderContentImpl(){this._renderItems(this._dataAdapter.getRootNodes())}_renderItems(e,t){if(!e.length)return;this.hasIcons=!1;const i=this._renderContainer(this.$element(),t==null?void 0:t[0]);let n=-1,s=-1;x(e,((o,a)=>{const l=a.visible!==!1;l&&n<0&&(n=o),n<o&&(a.beginGroup||o===s)&&(s=l?o:o+1),o===s&&n<o&&this._renderSeparator(i),this._renderItem(o,a,i)})),this.hasIcons||i.addClass("dx-menu-no-icons")}_renderContainer(e,t){const i=h("<ul>");return this.setAria("role","none",i),i.appendTo(e).addClass("dx-menu-items-container")}_createDOMElement(e){const t=h("<li>");return this.setAria("role","none",t),t.appendTo(e).addClass(zm)}_renderItem(e,t,i,n){var s;const{items:o=[]}=this.option(),a=n??this._createDOMElement(i);(s=o[e+1])!==null&&s!==void 0&&s.beginGroup&&a.addClass("dx-menu-last-group-item");const l=super._renderItem(e,t.internalFields.item,a);return t.internalFields.item===this.option("selectedItem")&&l.addClass(Us),l.attr("tabIndex",-1),this._hasSubmenu(t)&&this.setAria("haspopup","true",l),l}_renderItemFrame(e,t,i){const n=i.children(`.${Qe}`);return n.length?n:super._renderItemFrame(e,t,i)}_refreshItem(e,t){const i=this._dataAdapter.getNodeByItem(t);if(!i)return;const n=e.data(this._itemIndexKey()),s=e.closest("ul"),o=e.closest("li");this._renderItem(n,i,s,o)}_addContentClasses(e,t){const i=e.text?!!e.text.length:!1,n=!!e.icon,s=e.items?!!e.items.length:!1;t.toggleClass(Gm,i),t.toggleClass(Um,n),this.hasIcons||(this.hasIcons=n),t.toggleClass(qm,s)}_getItemContent(e){let t=super._getItemContent(e);return t.length||(t=e.children(`.${Wm}`)),t}_postprocessRenderItem(e){const t=h(e.itemElement),i=this._dataAdapter.getSelectedNodesKeys();if(!i.length||!this._selectedGetter(e.itemData)||!this._isItemSelectable(e.itemData)){this._setAriaSelectionAttribute(t,"false");return}const n=this._dataAdapter.getNodeByItem(e.itemData);n&&n.internalFields.key===i[0]?(t.addClass(this._selectedItemClass()),this._setAriaSelectionAttribute(t,"true")):this._setAriaSelectionAttribute(t,"false")}_isItemSelectable(e){return e.selectable!==!1}_renderSeparator(e){h("<li>").appendTo(e).addClass("dx-menu-separator")}_itemClickHandler(e){if(e._skipHandling)return;const t=this._createAction(this._updateSubmenuVisibilityOnClick.bind(this));this._itemDXEventHandler(e,"onItemClick",{},{beforeExecute:this._itemClick,afterExecute:t.bind(this)}),e._skipHandling=!0}_isUrlItem(e){return!!e&&"url"in e&&!!e.url}_itemClick(e){var t;const{event:i,itemData:n}=((t=e.args)===null||t===void 0?void 0:t[0])??{};if(!i)return;const s=this._getItemElementByEventArgs(i),o=s==null?void 0:s.find(".dx-item-url")[0];!this._isUrlItem(n)||!o||h(i.target).closest(".dx-item-url").length||this._clickByLink(o)}_updateSubmenuVisibilityOnClick(e){if(this._updateSelectedItemOnClick(e),this._getShowSubmenuMode()==="onClick"){var t;const i=(t=e.args)===null||t===void 0?void 0:t[0].itemElement;i&&this._addExpandedClass(i)}}_updateSelectedItemOnClick(e){const t=e.args?e.args[0]:e,{itemData:i}=t;if(!i||!this._isItemSelectAllowed(i))return;const n=this._dataAdapter.getSelectedNodesKeys(),s=n.length&&this._dataAdapter.getNodeByKey(n[0]);s&&this._toggleItemSelection(s,!1),!s||s.internalFields.item!==i?this.selectItem(i):(this._fireSelectionChangeEvent(null,this.option("selectedItem")),this._setOptionWithoutOptionChange("selectedItem",null))}_isItemSelectAllowed(e){const{selectByClick:t}=this.option(),i=this._isSelectionEnabled()&&t;return!this._isContainerEmpty()&&i&&this._isItemSelectable(e)&&!this._itemsGetter(e)}_isContainerEmpty(){return this._itemContainer().is(":empty")}_syncSelectionOptions(){return np()}_optionChanged(e){switch(e.name){case"showSubmenuMode":break;case"selectedItem":{const t=e.value?this._dataAdapter.getNodeByItem(e.value):null,i=this._dataAdapter.getSelectedNodesKeys()[0];if(t&&t.internalFields.key!==i){if(t.selectable===!1)break;const n=this._dataAdapter.getNodeByKey(i);i&&n&&this._toggleItemSelection(n,!1),this._toggleItemSelection(t,!0)}break}case"cssClass":case"position":case"selectByClick":case"animation":case"useInkRipple":this._invalidate();break;default:super._optionChanged(e)}}_toggleItemSelection(e,t){const i=this._getElementByItem(e.internalFields.item);i&&h(i).toggleClass(Us),this._dataAdapter.toggleSelection(e.internalFields.key,t)}_getElementByItem(e){let t=h();return x(this._itemElements(),((i,n)=>h(n).data(this._itemDataKey())!==e?!0:(t=n,!1))),t}_updateSelectedItems(){}_updateSelectedItem(e,t){(e||t)&&this._fireSelectionChangeEvent(e,t)}_fireSelectionChangeEvent(e,t){this._createActionByOption("onSelectionChanged",{excludeValidators:["disabled","readOnly"]})({addedItems:[e],removedItems:[t]})}selectItem(e){const t=(i=e,typeof i=="object"&&"nodeType"in i&&!!i.nodeType?this._getItemData(e):e);var i;const n=this._dataAdapter.getSelectedNodesKeys()[0],s=this.option("selectedItem"),o=this._dataAdapter.getNodeByItem(t);if(o&&o.internalFields.key!==n){const a=this._dataAdapter.getNodeByKey(n);n&&a&&this._toggleItemSelection(a,!1),this._toggleItemSelection(o,!0),this._updateSelectedItem(t,s),this._setOptionWithoutOptionChange("selectedItem",t)}}unselectItem(e){const t=e.nodeType?this._getItemData(e):e,i=this._dataAdapter.getNodeByItem(t),n=this.option("selectedItem");i!=null&&i.internalFields.selected&&(this._toggleItemSelection(i,!1),this._updateSelectedItem(null,n),this._setOptionWithoutOptionChange("selectedItem",null))}}hr.ItemClass=_s;const Xm="dx-menu-phone-overlay",ka=["onShowing","onShown","onSubmenuCreated","onHiding","onHidden","onPositioning","onLeftFirstItem","onLeftLastItem","onCloseRootSubmenu","onExpandLastSubmenu"],Zm=["up","down","first","last"],Ma=oe();class pr extends hr{getShowEvent(e){return L(e)?e.name===null?null:e.name??"dxcontextmenu":e??null}getShowDelay(e){return L(e)?e.delay??0:0}_getDefaultOptions(){return T({},super._getDefaultOptions(),{showEvent:"dxcontextmenu",hideOnOutsideClick:!0,position:{at:"top left",my:"top left"},onShowing:null,onShown:null,onSubmenuCreated:null,onHiding:null,onHidden:null,onPositioning:null,submenuDirection:"auto",visible:!1,target:void 0,onLeftFirstItem:null,onLeftLastItem:null,onCloseRootSubmenu:null,onExpandLastSubmenu:null,hideOnParentScroll:!0,visualContainer:Ma})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:()=>!pe(),options:{animation:null}}])}_initActions(){this._actions={},x(ka,((e,t)=>{this._actions[t]=this._createActionByOption(t)||Ce}))}_setOptionsByReference(){super._setOptionsByReference(),b(this._optionsByReference,{animation:!0,selectedItem:!0})}_focusInHandler(){}_itemContainer(){return this._overlay?this._overlay.$content():h()}_eventBindingTarget(){return this._itemContainer()}itemsContainer(){var e;return((e=this._overlay)===null||e===void 0?void 0:e.$content())??h()}_supportedKeys(){return T({},super._supportedKeys(),{space:()=>{const{focusedElement:e}=this.option(),t=h(e);this.hide(),!(!t.length||!this._isSelectionEnabled())&&this.selectItem(t[0])},escape:()=>{this.hide()}})}_getActiveItem(e){const t=this._getAvailableItems(),i=t.filter(".dx-state-focused"),n=t.filter(".dx-state-hover");return n.closest(".dx-menu-items-container").find(".dx-menu-item").index(i)>=0?i:n.length?n:super._getActiveItem()}_moveFocus(e){const t=this._getItemsByLocation(e),i=this._getActiveItem(!0),n=this.itemsContainer().find(".dx-state-hover"),{focusedElement:s,rtlEnabled:o}=this.option(),l=!!(h(s).length||n!=null&&n.length);let d;switch(e){case"up":if(d=l?this._prevItem(t):i,this._setFocusedElement(d),i.is(t.first())){var c,u;(c=(u=this._actions).onLeftFirstItem)===null||c===void 0||c.call(u,i)}break;case"down":if(d=l?this._nextItem(t):i,this._setFocusedElement(d),i.is(t.last())){var p,g;(p=(g=this._actions).onLeftLastItem)===null||p===void 0||p.call(g,i)}break;case"right":d=o?this._hideSubmenuHandler():this._expandSubmenuHandler(t,e),this._setFocusedElement(d);break;case"left":d=o?this._expandSubmenuHandler(t,e):this._hideSubmenuHandler(),this._setFocusedElement(d);break;case"first":d=t.first(),this._setFocusedElement(d);break;case"last":d=t.last(),this._setFocusedElement(d);break;default:return super._moveFocus(e)}}_setFocusedElement(e){e&&e.length!==0&&(this.option("focusedElement",$(e)),this._scrollToElement(e))}_scrollToElement(e){const t=e.closest(".dx-scrollable"),i=it.getInstance(t.get(0));i==null||i.scrollToElement(e)}_getItemsByLocation(e){const t=this._getActiveItem(!0);let i;return Zm.includes(e)&&(i=t.closest(".dx-menu-items-container").children().children()),i=this._getAvailableItems(i),i}_getAriaTarget(){return this.$element()}_refreshActiveDescendant(){if(m(this._overlay)){const e=this._overlay.$content();super._refreshActiveDescendant(e)}}_hideSubmenuHandler(){var e,t;const i=this._getActiveItem(!0),n=i.parents(".dx-menu-item-expanded").first();if(n.length)return this._hideSubmenusOnSameLevel(n),this._hideSubmenu(i.closest(".dx-submenu")),n;(e=(t=this._actions).onCloseRootSubmenu)===null||e===void 0||e.call(t,i)}_expandSubmenuHandler(e,t){var i,n;const s=this._getActiveItem(!0),o=this._getItemData(s),a=this._dataAdapter.getNodeByItem(o),l=this._hasSubmenu(a),d=s.children(".dx-submenu");if(l&&!s.hasClass("dx-state-disabled"))return(!d.length||d.css("visibility")==="hidden")&&this._showSubmenu(s),this._nextItem(this._getItemsByLocation(t));(i=(n=this._actions).onExpandLastSubmenu)===null||i===void 0||i.call(n,s)}_clean(){this._overlay&&(this._overlay.$element().remove(),this._overlay=null),this._detachShowContextMenuEvents(this._getTarget()),this._shownSubmenus=[],super._clean()}_initMarkup(){this.$element().addClass("dx-has-context-menu"),this._eventNamespace=`${this.NAME}${new Te}`,super._initMarkup()}_render(){super._render();const{visible:e}=this.option();this._renderVisibility(e),this._addWidgetClass()}_isTargetOutOfComponent(e){return!(h(e).closest(".dx-context-menu").length!==0)}_focusOutHandler(e){const{relatedTarget:t}=e;t&&this._isTargetOutOfComponent(t)&&this.hide(),super._focusOutHandler(e)}_renderContentImpl(){this._detachShowContextMenuEvents(this._getTarget()),this._showContextMenuEventHandler=this._createShowContextMenuEventHandler(),this._attachShowContextMenuEvents()}_attachKeyboardEvents(){!this._keyboardListenerId&&this._focusTarget().length&&super._attachKeyboardEvents()}_renderContextMenuOverlay(){if(this._overlay)return;const e=this._getOverlayOptions();this._overlay=this._createComponent(h("<div>").appendTo(this.$element()),wi,e);const t=this._overlay.$content();t.addClass("dx-context-menu"),this._addCustomCssClass(t),this._addPlatformDependentClass(t),this._attachContextMenuEvent()}preventShowingDefaultContextMenuAboveOverlay(){const e=this._itemContainer(),t=V(Ip,this._eventNamespace);v.off(e,t,".dx-submenu"),v.on(e,t,".dx-submenu",(i=>{i.stopPropagation(),i.preventDefault(),v.off(e,t,".dx-submenu")}))}_itemContextMenuHandler(e){super._itemContextMenuHandler(e),e.stopPropagation()}_addPlatformDependentClass(e){G.current().phone&&e.addClass(Xm)}_createShowContextMenuEventHandler(){const e=this._createAction((t=>{const{showEvent:i}=this.option(),n=this.getShowDelay(i);n?setTimeout((()=>this._show(t.event)),n):this._show(t.event)}),{validatingTargetName:"target"});return t=>e({event:t,target:h(t.currentTarget)})}_detachShowContextMenuEvents(e,t){const{showEvent:i}=this.option(),n=this.getShowEvent(t??i);if(!n)return;const s=W(e),o=V(n,this._eventNamespace);s?v.off(M.getDocument(),o,e,this._showContextMenuEventHandler):v.off(h(e),o,this._showContextMenuEventHandler)}_attachShowContextMenuEvents(){const{showEvent:e,disabled:t}=this.option(),i=this.getShowEvent(e);if(!i||t)return;const n=this._getTarget(),s=W(n),o=V(i,this._eventNamespace);s?v.on(M.getDocument(),o,n,this._showContextMenuEventHandler):v.on(n,o,this._showContextMenuEventHandler)}_hoverEndHandler(e){super._hoverEndHandler(e),e.stopPropagation()}_renderDimensions(){}_renderContainer(e,t){const i=t??this._itemContainer();e=h("<div>"),e.appendTo(i).addClass("dx-submenu").css("visibility",t?"hidden":"visible"),e.parent().hasClass("dx-overlay-content")||this._addCustomCssClass(e);const n=super._renderContainer(e);if(t)return n;const{width:s,height:o}=this.option();return s?n.css("minWidth",s):o?n.css("minHeight",o):n}_renderSubmenuItems(e,t){var i,n;this._renderItems(this._getChildNodes(e),t);const s=t.children(".dx-submenu");(i=(n=this._actions).onSubmenuCreated)===null||i===void 0||i.call(n,{itemElement:$(t),itemData:e.internalFields.item,submenuElement:$(s)}),this._initScrollable(s),this.setAria({role:"menu"},s)}_getOverlayOptions(){const{position:e,focusStateEnabled:t,animation:i,hideOnParentScroll:n,visualContainer:s,overlayContainer:o,boundaryOffset:a}=this.option();return{focusStateEnabled:t,animation:i,innerOverlay:!0,hideOnOutsideClick:l=>this._hideOnOutsideClickHandler(l),propagateOutsideClick:!0,hideOnParentScroll:n,deferRendering:!1,container:o,position:{at:e.at,my:e.my,of:this._getTarget(),collision:"flipfit",boundary:s,boundaryOffset:a},shading:!1,showTitle:!1,height:"auto",width:"auto",onShown:this._overlayShownActionHandler.bind(this),onHiding:this._overlayHidingActionHandler.bind(this),onHidden:this._overlayHiddenActionHandler.bind(this),visualContainer:s}}_overlayShownActionHandler(e){var t,i;(t=(i=this._actions).onShown)===null||t===void 0||t.call(i,e)}_overlayHidingActionHandler(e){var t,i;(t=(i=this._actions).onHiding)===null||t===void 0||t.call(i,e),e.cancel||(this._hideAllShownSubmenus(),this._setOptionWithoutOptionChange("visible",!1))}_overlayHiddenActionHandler(e){var t,i;(t=(i=this._actions).onHidden)===null||t===void 0||t.call(i,e)}_shouldHideOnOutsideClick(e){const{hideOnOutsideClick:t}=this.option();return B(t)?t(e):t}_hideOnOutsideClickHandler(e){if(!this._shouldHideOnOutsideClick(e))return!1;if(M.isDocument(e.target))return!0;const t=this._getActiveItemsContainer(e.target),i=this._getItemsContainers(),n=this._searchActiveItem(e.target),s=this.$element().parents(".dx-menu-item"),o=n[0]===s[0]&&!!n.length&&!!s.length;return this._isIncludeOverlay(t,i)&&!!n.length||o?(this._getShowSubmenuMode()==="onClick"&&this._hideAllShownChildSubmenus(n),!1):!0}_getActiveItemsContainer(e){return h(e).closest(".dx-menu-items-container")}_getItemsContainers(){var e;return((e=this._overlay)===null||e===void 0?void 0:e.$content().find(".dx-menu-items-container"))??h()}_searchActiveItem(e){return h(e).closest(".dx-menu-item").eq(0)}_isIncludeOverlay(e,t){let i=!1;return x(t,((n,s)=>{e.is(s)&&!i&&(i=!0)})),i}_hideAllShownChildSubmenus(e){const t=e.find(".dx-submenu"),i=b([],this._shownSubmenus);t.length>0&&x(i,((n,s)=>{const o=this._searchActiveItem(s.context).parent();o.parent().is(e.parent().parent())&&!o.is(e.parent())&&this._hideSubmenu(s)}))}_initScrollable(e){this._createComponent(e,it,{useKeyboard:!1,_onVisibilityChanged:t=>{t.scrollTo(0)}})}_setSubMenuHeight(e,t,i){const n=e.find(".dx-menu-items-container"),s=Y(n),o=this._getMaxHeight(t,!i),a=Math.min(s,o);e.css("height",i?a:"100%")}_getMaxUsableSpace(e,t,i){return t}_getMaxHeight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=Y(Ma),n=yo(e),s=M.getDocument(),o=L(e)&&"length"in e&&e.length&&e[0]===s;if(!n||o)return i;const a=e==null?void 0:e[0].getBoundingClientRect().top,l=Y(e);return(t?this._getMaxUsableSpace(a,i,l):Math.max(a+l,i-a))-10}_dimensionChanged(){this._shownSubmenus&&this._shownSubmenus.forEach((e=>{const t=e.closest(".dx-menu-item");this._setSubMenuHeight(e,t,!0),this._scrollToElement(t);const i=this._getSubmenuPosition(t);ei.setup(e,i)}))}_getSubmenuBorderWidth(){return Xp(Se())?1:0}_showSubmenu(e){const t=this._dataAdapter.getNodeByItem(this._getItemData(e));if(this._hideSubmenusOnSameLevel(e),!this._hasSubmenu(t))return;let i=e.children(".dx-submenu");const n=i.length;super._showSubmenu(e),t&&!n&&(this._renderSubmenuItems(t,e),i=e.children(".dx-submenu")),this._planPostRenderActions(i)}_setSubmenuVisible(e){if(!e)return;const t=e==null?void 0:e.closest(".dx-menu-item");this._setSubMenuHeight(e,t,!0),!this._isSubmenuVisible(e)&&t&&this._drawSubmenu(t)}_hideSubmenusOnSameLevel(e){const t=e.parent(".dx-menu-item-wrapper").siblings().find(".dx-menu-item-expanded");t.length&&(t.removeClass("dx-menu-item-expanded"),this._hideSubmenu(t.find(".dx-submenu")))}_isSubmenuVisible(e){return e.css("visibility")==="visible"}_drawSubmenu(e){var t;const{animation:i}=this.option(),n=i?i.show:{},s=e.children(".dx-submenu"),o=this._getSubmenuPosition(e);(t=this._overlay)!==null&&t!==void 0&&t.option("visible")&&(m(this._shownSubmenus)||(this._shownSubmenus=[]),this._shownSubmenus.includes(s)||this._shownSubmenus.push(s),n&&ve.stop(s.get(0),!1),ei.setup(s,o),n&&(ze(n.to)&&(n.to.position=o),this._animate(s.get(0),n)),s.css("visibility","visible"))}_animate(e,t){ve.animate(e,t)}_getSubmenuPosition(e){const{submenuDirection:t,rtlEnabled:i}=this.option(),n=t==null?void 0:t.toLowerCase(),o={collision:"flip",of:e.parent(".dx-menu-item-wrapper"),offset:{h:0,v:-1}};switch(n){case"left":o.at="left top",o.my="right top";break;case"right":o.at="right top",o.my="left top";break;default:i?(o.at="left top",o.my="right top"):(o.at="right top",o.my="left top")}return o}_updateSubmenuVisibilityOnClick(e){var t;if(!((t=e.args)!==null&&t!==void 0&&t.length))return;const{itemData:i,itemElement:n}=e.args[0];if(!i)return;const s=this._dataAdapter.getNodeByItem(i);if(!s)return;const o=h(n);let a=o.find(".dx-submenu");if(this._hasSubmenu(s)&&!a.length&&(this._renderSubmenuItems(s,o),a=o.find(".dx-submenu")),o.context===a.context&&a.css("visibility")==="visible")return;this._updateSelectedItemOnClick(e);const d=i&&i.closeMenuOnClick===!1;if(!(!i||i.disabled||d))if(a.length===0){var c;const u=h(o.parents(".dx-submenu")[0]);this._hideSubmenu(u),!e.canceled&&(c=this._overlay)!==null&&c!==void 0&&c.option("visible")&&this.option("visible",!1)}else this._shownSubmenus&&this._shownSubmenus.length>0&&this._shownSubmenus[0].is(a)&&this._hideSubmenu(a),this._showSubmenu(o)}_hideSubmenu(e){const t=this._shownSubmenus??[];x(t,((i,n)=>{(e.is(n)||Oh(e[0],n[0]))&&(n.parent().removeClass("dx-menu-item-expanded"),this._hideSubmenuCore(n))}))}_hideSubmenuCore(e){const t=(this._shownSubmenus??[]).indexOf(e),{animation:i}=this.option(),n=i?i.hide:null;t>=0&&(this._shownSubmenus??[]).splice(t,1),this._stopAnimate(e),n&&this._animate(e.get(0),n),e.css("visibility","hidden"),e.dxScrollable("instance").scrollTo(0),this.option("focusedElement",null)}_stopAnimate(e){ve.stop(e.get(0),!0)}_hideAllShownSubmenus(){var e;const t=b([],this._shownSubmenus);(((e=this._overlay)===null||e===void 0?void 0:e.$content().find(".dx-menu-item-expanded"))??h()).removeClass("dx-menu-item-expanded"),x(t,((n,s)=>{this._hideSubmenu(s)}))}_visibilityChanged(e){e&&this._renderContentImpl()}_optionChanged(e){const{name:t,value:i,previousValue:n}=e;if(ka.includes(t)){this._initActions();return}switch(t){case"visible":this._renderVisibility(i);break;case"disabled":case"position":case"submenuDirection":this._invalidate();break;case"showEvent":n&&this._detachShowContextMenuEvents(this._getTarget(),n),this._invalidate();break;case"target":n&&this._detachShowContextMenuEvents(n),this._invalidate();break;case"hideOnOutsideClick":case"hideOnParentScroll":case"visualContainer":break;default:super._optionChanged(e)}}_renderVisibility(e){return e?this._show():this._hide()}_toggleVisibility(){}_show(e){var t,i;const n={jQEvent:e};let s=S().reject().promise();if((t=(i=this._actions).onShowing)===null||t===void 0||t.call(i,n),n.cancel)return s;const o=this._positionContextMenu(e);if(o){var a,l,d;this._overlay||(this._renderContextMenuOverlay(),this._overlay.$content().addClass(this._widgetClass()),this._renderFocusState(),this._attachHoverEvents(),this._attachClickEvent(),this._renderItems(this._dataAdapter.getRootNodes()));const c=h((a=this._overlay)===null||a===void 0?void 0:a.content()).children(".dx-submenu");this._setOptionWithoutOptionChange("visible",!0),(l=this._overlay)===null||l===void 0||l.option({height:()=>this._getMaxHeight(o.of),maxHeight:()=>{const u=c.find(".dx-menu-items-container"),p=Y(u),g=this._getSubmenuBorderWidth();return p+2*g},position:o}),c.length&&this._setSubMenuHeight(c,o.of,!1),this._overlay&&(s=this._overlay.show()),e==null||e.stopPropagation(),this._setAriaAttributes(),(e==null||(d=e.originalEvent)===null||d===void 0?void 0:d.type)===Di.name&&this.preventShowingDefaultContextMenuAboveOverlay()}return s}_renderItems(e,t){var i;super._renderItems(e,t);const n=h((i=this._overlay)===null||i===void 0?void 0:i.content()).children(".dx-submenu");n.length&&this._initScrollable(n)}_setAriaAttributes(){var e;this._overlayContentId=`dx-${new Te}`,this.setAria("owns",this._overlayContentId),this.setAria({id:this._overlayContentId,role:"menu"},(e=this._overlay)===null||e===void 0?void 0:e.$content())}_cleanAriaAttributes(){this._overlay&&this.setAria("id",null,this._overlay.$content()),this.setAria("owns",void 0)}_getTarget(){const{target:e,position:t}=this.option();return e||(t==null?void 0:t.of)||h(M.getDocument())}_getContextMenuPosition(){const{position:e}=this.option();return T({},e,{of:this._getTarget()})}_positionContextMenu(e){let t=this._getContextMenuPosition();const i=this._isInitialOptionValue("position"),n=this._createActionByOption("onPositioning");e!=null&&e.preventDefault&&i&&(t.of=e);const s={position:t,event:e};return n(s),s.cancel?t=null:s.event&&(s.event.cancel=!0,e==null||e.preventDefault()),t}_refresh(){if(!pe())super._refresh();else if(this._overlay){const{position:e}=this._overlay.option();super._refresh(),this._overlay&&this._overlay.option("position",e)}else super._refresh()}_hide(){let e;return this._overlay&&(e=this._overlay.hide(),this._setOptionWithoutOptionChange("visible",!1)),this._cleanAriaAttributes(),this.option("focusedElement",null),e??S().reject().promise()}toggle(e){const{visible:t}=this.option();return this._renderVisibility(e??!t)}show(){return this.toggle(!0)}hide(){return this.toggle(!1)}_postProcessRenderItems(e){this._setSubmenuVisible(e)}}_e("dxContextMenu",pr);const Qm="dx-context-menu",Jm={columnHeadersView:"header",rowsView:"content",footerView:"footer",headerPanel:"toolbar"},e_=["columnHeadersView","rowsView","footerView","headerPanel"];class t_ extends j.ViewController{init(){this.createAction("onContextMenuPreparing")}getContextMenuItems(e){if(!e)return!1;const t=this,i=h(e.target);let n;return x(e_,(function(){const s=t.getView(this);if(!s)return;const o=s.element();if((o==null?void 0:o.is(i))||(o==null?void 0:o.find(i).length)){var l,d,c;const p=i.hasClass("dx-group-row")?i.find(".dx-group-cell").first():i.closest(".dx-row > td, .dx-row > tr"),g=p.parent(),_=s.getRowIndex(g),f=(l=p[0])===null||l===void 0?void 0:l.cellIndex,C=g.data("options"),I={event:e,targetElement:$(i),target:Jm[this],rowIndex:_,row:s._getRows()[_],columnIndex:f,column:C==null||(d=C.cells)===null||d===void 0||(d=d[f])===null||d===void 0?void 0:d.column};if(I.items=(c=s.getContextMenuItems)===null||c===void 0?void 0:c.call(s,I),t.executeAction("onContextMenuPreparing",I),t._contextMenuPrepared(I),n=I.items,n)return!1}})),n}_contextMenuPrepared(e){}}class i_ extends j.View{init(){super.init(),this._contextMenuController=this.getController("contextMenu")}_renderCore(){const e=this.element().addClass(Qm);this.setAria("role","presentation",e),this._createComponent(e,pr,{onPositioning:t=>{const{event:i}=t,n=t.component,s=this._contextMenuController.getContextMenuItems(i);s?(n.option("items",s),i.stopPropagation()):t.cancel=!0},onItemClick(t){var i,n;(i=t.itemData)===null||i===void 0||(n=i.onItemClick)===null||n===void 0||n.call(i,t)},cssClass:this.getWidgetContainerClass(),target:this.component.$element()})}}const TS={defaultOptions:()=>({onContextMenuPreparing:null}),controllers:{contextMenu:t_},views:{contextMenuView:i_}};class n_ extends j.ViewController{init(){this._resizingController=this.getController("resizing"),this._columnsController=this.getController("columns"),this._columnHeadersView=this.getView("columnHeadersView"),this._rowsView=this.getView("rowsView")}_createErrorRow(e,t){let i,n;const s=this._renderErrorMessage(e);return t?(i=h("<tr>").attr("role","row").addClass("dx-error-row"),n=h("<div>").addClass("dx-closebutton").addClass(this.addWidgetPrefix("action")),v.on(n,Q,this.createAction((o=>{var a,l;const d=o.event;let c;const u=h(d.currentTarget).closest(".dx-error-row").index();d.stopPropagation(),x(t,((p,g)=>{c=h(g).children("tbody").children("tr").eq(u),this.removeErrorRow(c)})),(a=this._resizingController)===null||a===void 0||(l=a.fireContentReadyAction)===null||l===void 0||l.call(a)}))),h("<td>").attr({colSpan:this._columnsController.getVisibleColumns().length,role:"gridcell"}).prepend(n).append(s).appendTo(i),i):s}_renderErrorMessage(e){const t=e.url?e.message.replace(e.url,""):e.message||e,i=h("<div>").attr("role","alert").attr("aria-roledescription",w.format("dxDataGrid-ariaError")).addClass("dx-error-message").text(t);return e.url&&h("<a>").attr("href",e.url).text(e.url).appendTo(i),i}renderErrorRow(e,t,i){var n,s;const o=this;let a,l;if(i)return i.find(".dx-error-message").remove(),a=o._createErrorRow(e),i.prepend(a),a;const d=t>=0||!o._columnHeadersView.isVisible()?o._rowsView:o._columnHeadersView,c=d.getTableElements();return x(c,((u,p)=>{if(a=o._createErrorRow(e,c),l=l||a,t>=0){const g=d._getRowElements(h(p)).eq(t);o.removeErrorRow(g.next()),a.insertAfter(g)}else{const g=h(p).children("tbody"),_=g.children("tr");o._columnHeadersView.isVisible()?(o.removeErrorRow(_.last()),h(p).append(a)):(o.removeErrorRow(_.first()),g.first().prepend(a))}})),(n=this._resizingController)===null||n===void 0||(s=n.fireContentReadyAction)===null||s===void 0||s.call(n),l}removeErrorRow(e){if(!e){const t=this._columnHeadersView&&this._columnHeadersView.element();if(e=t&&t.find(".dx-error-row"),!e||!e.length){const i=this._rowsView.element();e=i&&i.find(".dx-error-row")}}e&&e.hasClass("dx-error-row")&&e.remove()}optionChanged(e){e.name==="errorRowEnabled"?e.handled=!0:super.optionChanged(e)}}const s_=r=>class extends r{init(){super.init(),this.dataErrorOccurred.add(((e,t)=>{this.option("errorRowEnabled")&&this._errorHandlingController.renderErrorRow(e,void 0,t)})),this.changed.add((e=>{if(!(e&&e.changeType==="loadError")&&this._editingController&&!this._editingController.hasChanges()){var t,i;(t=this._errorHandlingController)===null||t===void 0||(i=t.removeErrorRow)===null||i===void 0||i.call(t)}}))}},DS={defaultOptions:()=>({errorRowEnabled:!0}),controllers:{errorHandling:n_},extenders:{controllers:{data:s_}}},o_={container:"dx-gridbase-a11y-status-container"},r_=r=>{let{statusText:e}=r;return h("<div>").text(e??"").addClass(o_.container).attr("role","status")},gr=["columnsSeparatorView","blockSeparatorView","trackerView","headerPanel","columnHeadersView","rowsView","footerView","columnChooserView","filterPanelView","pagerView","draggingHeaderView","contextMenuView","errorView","headerFilterView","filterBuilderView"],a_={a11yStatusContainer:"e2e-a11y-general-status-container"},Mi=function(r){return W(r)&&r.endsWith("%")},l_=function(r){return W(r)&&r.endsWith("px")},Fc=function(r,e){const t=r._rowsView.contentWidth(),i=r._getTotalWidth(e,t);return t-i},d_=function(r,e,t,i){return Fc(r,i.map(((n,s)=>s===e?t:n)))},c_=function(r,e){Cg(r,!0),y.setSelectionRange(r,e)};class u_ extends j.ViewController{callbackNames(){return["resizeCompleted"]}init(){this._prevContentMinHeight=null,this._dataController=this.getController("data"),this._columnsController=this.getController("columns"),this._columnHeadersView=this.getView("columnHeadersView"),this._adaptiveColumnsController=this.getController("adaptiveColumns"),this._editorFactoryController=this.getController("editorFactory"),this._footerView=this.getView("footerView"),this._rowsView=this.getView("rowsView"),this._gridView=this.getView("gridView")}_initPostRenderHandlers(){this._refreshSizesHandler||(this._refreshSizesHandler=e=>{let t=new S().resolve(null);const i=e==null?void 0:e.changeType,n=e==null?void 0:e.isDelayed,s=i&&i!=="updateSelection"&&i!=="updateFocusedRow"&&i!=="pageIndex"&&!n;this._dataController.changed.remove(this._refreshSizesHandler),this._checkSize()&&(t=this._refreshSizes(e)),s&&O(t).done((()=>{this._setAriaLabel(e),this.fireContentReadyAction()}))},this._dataController.changed.add((()=>{this._dataController.changed.add(this._refreshSizesHandler)})))}_refreshSizes(e){let t=new S().resolve(null);const i=e==null?void 0:e.changeType,n=e==null?void 0:e.isDelayed,s=this._dataController.items();if(!e||i==="refresh"||i==="prepend"||i==="append")n||(t=this.resize());else if(i==="update"){var o;if(((o=e.changeTypes)===null||o===void 0?void 0:o.length)===0)return t;(s.length>1||e.changeTypes[0]!=="insert")&&!(s.length===0&&e.changeTypes[0]==="remove")&&!e.needUpdateDimensions?(t=new S,this._waitAsyncTemplates().done((()=>{je((()=>Re((()=>je((()=>{this._setScrollerSpacing(),this._rowsView.resize(),t.resolve()}))))))})).fail(t.reject)):t=this.resize()}return t}fireContentReadyAction(){this.component._fireContentReadyAction()}_getWidgetAriaLabel(){return"dxDataGrid-ariaDataGrid"}_setAriaLabel(e){var t;let i="",n=[];const s=((t=this._columnsController)===null||t===void 0||(t=t._columns)===null||t===void 0?void 0:t.filter((c=>{let{visible:u}=c;return!!u})).length)??0,o=Math.max(0,this._dataController.totalItemsCount()),a=this._getWidgetAriaLabel();i=w.format(a,o,s);const l=w.format(this._expandableWidgetAriaId);n=[i],l&&n.push(l);const d=this.component.$element().children(".dx-gridbase-container");this.component.setAria("label",n.join(". "),d),e!=null&&e.isFirstRender||this._gridView.setWidgetA11yStatusText(i)}_getBestFitWidths(){var e;const t=this._rowsView,i=this._columnHeadersView;let n=t.getColumnWidths();if(!((e=n)!==null&&e!==void 0&&e.length)){var s;const o=i.getTableElement();i.setTableElement((s=t.getTableElement())===null||s===void 0?void 0:s.children(".dx-header")),n=i.getColumnWidths(),i.setTableElement(o)}return n}_setVisibleWidths(e,t){const i=this._columnsController;i.beginUpdate(),x(e,((n,s)=>{const o=i.getColumnId(s);i.columnOption(o,"visibleWidth",t[n])})),i.endUpdate()}_toggleBestFitModeForView(e,t,i){if(!e||!e.isVisible())return;const n=this._rowsView.getTableElements(),s=e.getTableElements();x(n,((o,a)=>{let l;const d=h(a),c=s.eq(o);c&&c.length&&(i?l=c.children("tbody").appendTo(d):l=d.children(`.${t}`).appendTo(c),l.toggleClass(t,i),l.toggleClass(this.addWidgetPrefix("best-fit"),i))}))}_toggleBestFitMode(e){const t=this._rowsView.getTableElement(),i=this._rowsView.getTableElements().eq(1);t&&(t.css("tableLayout",e?"auto":"fixed"),t.children("colgroup").css("display",e?"none":""),x(i.find("tr.dx-group-row"),((n,s)=>{h(s).css("display",e?"none":"")})),i.toggleClass(this.addWidgetPrefix("table-fixed"),!e),this._toggleBestFitModeForView(this._columnHeadersView,"dx-header",e),this._toggleBestFitModeForView(this._footerView,"dx-footer",e),this._needStretch()&&(t.get(0).style.width=e?"auto":""))}_toggleContentMinHeight(e){const t=this._rowsView.getScrollable(),i=this._rowsView._findContentElement();(t==null?void 0:t.option("useNative"))===!1&&(e===!0&&(this._prevContentMinHeight=i.get(0).style.minHeight),m(this._prevContentMinHeight)&&i.css({minHeight:e?y.getContentHeightLimit(me):this._prevContentMinHeight}))}_synchronizeColumns(){const e=this._columnsController,t=e.getVisibleColumns(),i=this.option("columnAutoWidth"),n=this.option("wordWrapEnabled"),s=t.some((_=>!m(_.width)));let o=this._needBestFit(),a=!1,l,d=!1,c=[],u,p;!o&&x(t,((_,f)=>{if(f.width==="auto")return o=!0,!1})),x(t,((_,f)=>{if(f.minWidth)return a=!0,!1})),this._setVisibleWidths(t,[]);const g=this.component.$element();o&&(u=M.getActiveElement(g.get(0)),p=y.getSelectionRange(u),this._toggleBestFitMode(!0),l=!0),this._toggleContentMinHeight(n),g&&g.get(0)&&this._maxWidth&&(delete this._maxWidth,g[0].style.maxWidth=""),je((()=>{o?(c=this._getBestFitWidths(),x(t,((_,f)=>{const C=e.getColumnId(f);e.columnOption(C,"bestFitWidth",c[_],!0)}))):a&&(c=this._getBestFitWidths()),x(t,(function(_){const{width:f}=this;f!=="auto"&&(m(f)?c[_]=Ee(f)||l_(f)?parseFloat(f):f:i||(c[_]=void 0))})),l&&(this._toggleBestFitMode(!1),l=!1,u&&u!==M.getActiveElement()&&(re(u).bottom<0||c_(u,p))),d=this._correctColumnWidths(c,t),i&&((function(){let _;x(t,((f,C)=>{C.type==="groupExpand"&&(_=c[f])})),x(t,((f,C)=>{C.type==="groupExpand"&&_&&(c[f]=_)}))})(),this._needStretch()&&this._processStretch(c,t)),Re((()=>{(o||d||s)&&this._setVisibleWidths(t,c),n&&this._toggleContentMinHeight(!1)}))}))}_needBestFit(){return this.option("columnAutoWidth")}_needStretch(){return this._columnsController.getVisibleColumns().some((e=>e.width==="auto"&&!e.command))}_getAverageColumnsWidth(e){const t=Fc(this,e),i=e.filter((n=>n===void 0)).length;return t/i}_correctColumnWidths(e,t){const i=this;let n,s=!1,o=!1,a=!1;const l=i.component.$element(),d=i._hasWidth;for(n=0;n<t.length;n++){const c=n,u=t[c],p=e[c]==="adaptiveHidden";let g=e[c];const{minWidth:_}=u;_&&(g===void 0?g=i._getAverageColumnsWidth(e):Mi(g)&&d_(i,c,_,e)<0&&(g=-1));const f=i._getRealColumnWidth(c,e.map(((C,I)=>c===I?g:C)));_&&!p&&f<_&&(e[c]=_,a=!0,n=-1),m(u.width)||(o=!0),Mi(u.width)&&(s=!0)}if(!o&&e.length){const c=i._rowsView.element(),u=i._rowsView.contentWidth(),p=i._rowsView.getScrollbarWidth(),g=i._getTotalWidth(e,u);if(g<u){const _=y.getLastResizableColumnIndex(t,e);if(_>=0&&(e[_]="auto",a=!0,d===!1&&!s)){const f=y.getComponentBorderWidth(this,c);i._maxWidth=g+p+f,l.css("maxWidth",i._maxWidth)}}}return a}_processStretch(e,t){const i=this._rowsView.contentWidth(),n=this._getTotalWidth(e,i),s={length:0};if(!e.length)return;x(t,(function(d){(this.width||e[d]==="adaptiveHidden")&&(s[d]=!0,s.length++)}));const o=i-n,a=Math.floor(o/(e.length-s.length));let l=o-a*(e.length-s.length);if(o>=0)for(let d=0;d<e.length;d++)s[d]||(e[d]+=a,l>0&&(l<1?(e[d]+=l,l=0):(e[d]++,l--)))}_getRealColumnWidth(e,t,i){let n=1;const s=t[e];if(!Mi(s))return parseFloat(s);const o=t.reduce(((c,u,p)=>Mi(u)?c+parseFloat(u):c),0),a=t.reduce(((c,u)=>!u||u==="adaptiveHidden"||Mi(u)?c:c+parseFloat(u)),0);i=i||this._rowsView.contentWidth();const l=i-a,d=o*i/100;return a>0&&d+a>=i&&(n=d>l?l/d:1),parseFloat(s)*i*n/100}_getTotalWidth(e,t){let i=0;for(let n=0;n<e.length;n++){const s=e[n];s&&s!=="adaptiveHidden"&&(i+=this._getRealColumnWidth(n,e,t))}return Math.ceil(i)}_getGroupElement(){return this.component.$element().children().get(0)}updateSize(e){const t=this,i=h(e),n=t.addWidgetPrefix("important-margin");if(t._hasHeight===void 0&&i&&i.is(":visible")&&H(i)){const s=i.children(`.${t.getWidgetContainerClass()}`);s.length&&s.detach(),t._hasHeight=!!X(i);const o=H(i);i.addClass(n),t._hasWidth=H(i)===o,i.removeClass(n),s.length&&s.appendTo(i)}}publicMethods(){return["resize","updateDimensions"]}_waitAsyncTemplates(){var e,t,i;return O((e=this._columnHeadersView)===null||e===void 0?void 0:e.waitAsyncTemplates(!0),(t=this._rowsView)===null||t===void 0?void 0:t.waitAsyncTemplates(!0),(i=this._footerView)===null||i===void 0?void 0:i.waitAsyncTemplates(!0))}resize(){if(this.component._requireResize)return new S().resolve();const e=new S;return this._waitAsyncTemplates().done((()=>{O(this.updateDimensions()).done(e.resolve).fail(e.reject)})).fail(e.reject),e.promise().done((()=>{this.resizeCompleted.fire()}))}updateDimensions(e){const t=this;if(t._initPostRenderHandlers(),!t._checkSize(e))return;const i=t._resizeDeferred,n=t._resizeDeferred=new S;return O(i).always((()=>{Re((()=>{t._dataController.isLoaded()&&t._synchronizeColumns(),t._resetGroupElementHeight(),je((()=>{Re((()=>{je((()=>{t._updateDimensionsCore()}))}))}))})).done(n.resolve).fail(n.reject)})),n.promise()}_resetGroupElementHeight(){const e=this._getGroupElement(),t=this._rowsView.getScrollable();e&&e.style.height&&(!t||!t.scrollTop())&&(e.style.height="")}_checkSize(e){const t=this.component.$element(),i=t.is(":visible"),n=this._lastWidth!==H(t)||this._lastHeight!==X(t)||this._devicePixelRatio!==oe().devicePixelRatio;return i&&(!e||n)}_setScrollerSpacingCore(){const e=this,t=e._rowsView.getScrollbarWidth(),i=e._rowsView.getScrollbarWidth(!0);Re((()=>{e._columnHeadersView&&e._columnHeadersView.setScrollerSpacing(t),e._footerView&&e._footerView.setScrollerSpacing(t),e._rowsView.setScrollerSpacing(t,i)}))}_setScrollerSpacing(){const e=this._rowsView.getScrollable(),t=this.option("scrolling.useNative")===!0;!e||t?Re((()=>{je((()=>{this._setScrollerSpacingCore()}))})):this._setScrollerSpacingCore()}_setAriaOwns(){var e,t,i;const n=(e=this._columnHeadersView)===null||e===void 0?void 0:e.getTableElement(),s=(t=this._footerView)===null||t===void 0?void 0:t.getTableElement();(i=this._rowsView)===null||i===void 0||i.setAriaOwns(n==null?void 0:n.attr("id"),s==null?void 0:s.attr("id"))}_updateDimensionsCore(){const e=this,t=e._dataController,i=e._rowsView,n=e.component.$element(),s=this._getGroupElement(),o=X(n),a=e.option("height")??n.get(0).style.height,l=!!a&&a!=="auto",d=parseInt(n.css("maxHeight")),c=d&&o>=d,u=s&&s.scrollHeight===s.offsetHeight;e.updateSize(n),Re((()=>{const p=e._hasHeight||!!d||l;if(i.hasHeight(p),this._setAriaOwns(),c&&!u&&h(s).css("height",d),!t.isLoaded()){i.setLoading(t.isLoading());return}je((()=>{e._updateLastSizes(n),e._setScrollerSpacing(),x(gr,((g,_)=>{const f=e.getView(_);f&&f.resize()})),this._editorFactoryController&&this._editorFactoryController.resize()}))}))}_updateLastSizes(e){this._lastWidth=H(e),this._lastHeight=X(e),this._devicePixelRatio=oe().devicePixelRatio}optionChanged(e){switch(e.name){case"width":case"height":this.component._renderDimensions(),this.resize();case"renderAsync":e.handled=!0;return;default:super.optionChanged(e)}}resetLastResizeTime(){}}class h_ extends j.ViewController{_scrollChangedHandler(e,t,i){for(let n=0;n<e.length;n++)e[n]&&e[n].name!==i&&e[n].scrollTo({left:t.left,top:t.top})}init(){const e=[this.getView("columnHeadersView"),this.getView("footerView"),this.getView("rowsView")];for(let t=0;t<e.length;t++){const i=e[t];i&&i.scrollChanged.add(this._scrollChangedHandler.bind(this,e))}}}class p_ extends j.View{init(){this._resizingController=this.getController("resizing"),this._dataController=this.getController("data")}_endUpdateCore(){this.component._requireResize&&(this.component._requireResize=!1,this._resizingController.resize())}getView(e){return this.component._views[e]}element(){return this._groupElement}optionChanged(e){const t=this;m(t._groupElement)&&e.name==="showBorders"?(t._groupElement.toggleClass(t.addWidgetPrefix("borders"),!!e.value),e.handled=!0):super.optionChanged(e)}_renderViews(e){const t=this;x(gr,((i,n)=>{const s=t.getView(n);s&&s.render(e)}))}_getTableRoleName(){return"group"}render(e){const t=!this._groupElement,i=this._groupElement||h("<div>").addClass(this.getWidgetContainerClass());i.addClass("dx-gridbase-container"),i.toggleClass(this.addWidgetPrefix("borders"),!!this.option("showBorders")),this.setAria("role","presentation",e),this.component.setAria("role",this._getTableRoleName(),i),this._rootElement=e||this._rootElement,t&&(this._groupElement=i,pe()&&this._resizingController.updateSize(e),i.appendTo(e)),this._a11yGeneralStatusElement||(this._a11yGeneralStatusElement=r_({}),this._a11yGeneralStatusElement.attr(a_.a11yStatusContainer,"true"),i.append(this._a11yGeneralStatusElement)),this._renderViews(i)}update(){const e=this,t=e._rootElement,i=e._groupElement;t&&i&&(this._resizingController.resize(),e._dataController.isLoaded()&&e._resizingController.fireContentReadyAction())}setWidgetA11yStatusText(e){var t;(t=this._a11yGeneralStatusElement)===null||t===void 0||t.text(e)}}const RS={defaultOptions:()=>({showBorders:!1,renderAsync:!1}),controllers:{resizing:u_,synchronizeScrolling:h_},views:{gridView:p_},VIEW_NAMES:gr};class g_{constructor(e){this._toolbar=e}_initMarkup(){}_updateMenuVisibility(){}_renderMenuItems(){}_renderItem(){}_getMenuItems(){}_getToolbarItems(){const{items:e=[]}=this._toolbar.option();return e}_getItemsWidth(){return this._toolbar._getSummaryItemsSize("width",this._toolbar._itemElements(),!0)}_arrangeItems(){const e=this._toolbar._$toolbarItemsContainer.find(".dx-toolbar-label").eq(0);if(!e.length)return;const t=H(this._toolbar.$element()),i=ge(e)-H(e);e.css("maxWidth",t-i)}_hideOverflowItems(){}_dimensionChanged(){}_itemOptionChanged(){}_optionChanged(){}}const m_="dx-toolbar-menu-action";class __ extends Sp{_init(){super._init(),this._activeStateUnit=".dx-toolbar-menu-action:not(.dx-toolbar-hidden-button-group)"}_initMarkup(){this._renderSections(),super._initMarkup(),this._setMenuRole()}_getSections(){return this._itemContainer().children()}_itemElements(){return this._getSections().children(this._itemSelector())}_renderSections(){const e=this._itemContainer();x(["before","center","after","menu"],((t,i)=>{const n=`_$${i}Section`;this[n]||(this[n]=h("<div>").addClass("dx-toolbar-menu-section")),this[n].appendTo(e)}))}_renderItems(e){super._renderItems(e),this._updateSections()}_setMenuRole(){this.$element().find(".dx-scrollview-content").attr("role","menu")}_updateSections(){const e=this.$element().find(".dx-toolbar-menu-section");e.removeClass("dx-toolbar-menu-last-section"),e.not(":empty").eq(-1).addClass("dx-toolbar-menu-last-section")}_renderItem(e,t,i,n){const s=this[`_$${t.location??"menu"}Section`],o=super._renderItem(e,t,s,n),a=this._getItemCssClasses(t);return o.addClass(a.join(" ")),o}_getItemCssClasses(e){const t=[],i=this._getActionableComponents();return this._getItemTemplateName({itemData:e})&&t.push("dx-toolbar-menu-custom"),(!e.location&&!e.widget||i.some((n=>n===e.widget)))&&t.push("dx-toolbar-menu-action"),e.widget==="dxButton"&&t.push("dx-toolbar-hidden-button"),e.widget==="dxButtonGroup"&&t.push("dx-toolbar-hidden-button-group"),e.cssClass&&t.push(e.cssClass),t}_getActionableComponents(){return["dxButton","dxButtonGroup"]}_getItemTemplateName(e){const t=super._getItemTemplateName(e),i=e.itemData;return(i==null?void 0:i.menuItemTemplate)??t}_dataSourceOptions(){return{paginate:!1}}_itemClickHandler(e,t,i){h(e.target).closest(".dx-toolbar-menu-action").length&&super._itemClickHandler(e,t,i)}_clean(){this._getSections().empty(),super._clean()}}const f_=["dxAutocomplete","dxButton","dxCheckBox","dxDateBox","dxMenu","dxSelectBox","dxTabs","dxTextBox","dxButtonGroup","dxDropDownButton"],C_=r=>{const e=r==null?void 0:r.data(),t=e==null?void 0:e.dxComponents,i=t==null?void 0:t[0];return i&&e[i]};function ns(r,e){var t;if(!r)return;const i=r._findItemElementByItem(e);if(!i.length)return;const n=r._getItemData(i),s=!!((t=n.options)!==null&&t!==void 0&&t.disabled||n.disabled||r.option("disabled")),{widget:o}=n;if(o&&f_.includes(o)){const c=i.find(o.toLowerCase().replace("dx",".dx-"));if(c.length){var a,l;const u=C_(c);if(!u)return;let p=(a=u._focusTarget)===null||a===void 0?void 0:a.call(u);if(o==="dxDropDownButton"){var d;p=(d=p)===null||d===void 0?void 0:d.find(".dx-buttongroup")}else p=p??h(u.element());const g=(l=n.options)===null||l===void 0?void 0:l.tabIndex;s?p.attr("tabIndex",-1):p.attr("tabIndex",g??0)}}}class v_ extends Lt{_supportedKeys(){var e;let t={};const{opened:i}=this.option();return(!i||!((e=this._list)!==null&&e!==void 0&&e.option("focusedElement")))&&(t=this._button._supportedKeys()),T({},super._supportedKeys(),t,{tab(){var n;(n=this._popup)===null||n===void 0||n.hide()}})}_getDefaultOptions(){return T({},super._getDefaultOptions(),{items:[],dataSource:null,itemTemplate:"item",activeStateEnabled:!0,hoverStateEnabled:!0,opened:!1,closeOnClick:!0,useInkRipple:!1,container:void 0,animation:{show:{type:"fade",from:0,to:1},hide:{type:"fade",to:0}}})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:()=>G.real().deviceType==="desktop"&&!G.isSimulator(),options:{focusStateEnabled:!0}},{device:()=>Cs(Se()),options:{useInkRipple:!0,animation:{show:{type:"pop",duration:200,from:{scale:0},to:{scale:1}},hide:{type:"pop",duration:200,from:{scale:1},to:{scale:0}}}}}])}_init(){super._init(),this.$element().addClass("dx-dropdownmenu"),this._initItemClickAction(),this._initButtonClickAction()}_initItemClickAction(){this._itemClickAction=this._createActionByOption("onItemClick",{})}_initButtonClickAction(){this._buttonClickAction=this._createActionByOption("onButtonClick",{})}_initTemplates(){this._templateManager.addDefaultTemplates({content:new Fh("content")}),super._initTemplates()}_initMarkup(){this._renderButton(),super._initMarkup()}_render(){super._render();const{opened:e}=this.option();this.setAria({haspopup:!0,expanded:e})}_renderContentImpl(){const{opened:e}=this.option();e&&this._renderPopup()}_clean(){var e,t;this._cleanFocusState(),(e=this._list)===null||e===void 0||e.$element().remove(),(t=this._popup)===null||t===void 0||t.$element().remove(),delete this._list,delete this._popup}_renderButton(){const e=this.$element().addClass("dx-dropdownmenu-button"),{useInkRipple:t}=this.option();this._button=this._createComponent(e,Ze,{icon:"overflow",template:"content",stylingMode:st(Se())?"text":"contained",useInkRipple:t,hoverStateEnabled:!1,focusStateEnabled:!1,onClick:i=>{var n;this.option("opened",!this.option("opened")),(n=this._buttonClickAction)===null||n===void 0||n.call(this,i)}})}_toggleActiveState(e,t){this._button._toggleActiveState(e[0],t)}_toggleMenuVisibility(e){var t,i;const n=e??!((t=this._popup)!==null&&t!==void 0&&t.option("visible"));e&&this._renderPopup(),(i=this._popup)===null||i===void 0||i.toggle(n),this.setAria("expanded",n)}_renderPopup(){if(this._$popup)return;this._$popup=h("<div>").appendTo(this.$element());const{rtlEnabled:e,container:t,animation:i}=this.option();this._popup=this._createComponent(this._$popup,ni,{onInitialized(n){const{component:s}=n;s.$wrapper().addClass("dx-dropdownmenu-popup-wrapper").addClass("dx-dropdownmenu-popup")},deferRendering:!1,preventScrollEvents:!1,contentTemplate:n=>this._renderList(n),_ignoreFunctionValueDeprecation:!0,maxHeight:()=>this._getMaxHeight(),position:{my:"top "+(e?"left":"right"),at:"bottom "+(e?"left":"right"),collision:"fit flip",offset:{v:3},of:this.$element()},animation:i,onOptionChanged:n=>{let{name:s,value:o}=n;s==="visible"&&this.option("opened",o)},container:t,autoResizeEnabled:!1,height:"auto",width:"auto",hideOnOutsideClick:n=>this._closeOutsideDropDownHandler(n),hideOnParentScroll:!0,shading:!1,dragEnabled:!1,showTitle:!1,fullScreen:!1,ignoreChildEvents:!1,_fixWrapperPosition:!0}),this._popup.registerKeyHandler("space",(n=>{this._popupKeyHandler(n)})),this._popup.registerKeyHandler("enter",(n=>{this._popupKeyHandler(n)})),this._popup.registerKeyHandler("escape",(n=>{var s;(s=this._popup)!==null&&s!==void 0&&s.$overlayContent().is(h(n.target))&&this.option("opened",!1)}))}_getMaxHeight(){var e;const t=this.$element(),i=((e=t.offset())===null||e===void 0?void 0:e.top)??0,n=Y(oe()),s=Math.max(i,n-i-Y(t));return Math.min(n,s-3-10)}_closeOutsideDropDownHandler(e){return!h(e.target).closest(this.$element()).length}_renderList(e){const t=h(e);t.addClass("dx-dropdownmenu-list");const{itemTemplate:i,onItemRendered:n}=this.option();this._list=this._createComponent(t,__,{dataSource:this._getListDataSource(),pageLoadMode:"scrollBottom",indicateLoading:!1,noDataText:"",itemTemplate:i,onItemClick:s=>{this._itemClickHandler(s)},tabIndex:-1,focusStateEnabled:!1,activeStateEnabled:!0,onItemRendered:n,_itemAttributes:{role:"menuitem"}})}_popupKeyHandler(e){h(e.target).closest(`.${m_}`).length&&this._closePopup()}_closePopup(){const{closeOnClick:e}=this.option();e&&this.option("opened",!1)}_itemClickHandler(e){var t;this._closePopup(),(t=this._itemClickAction)===null||t===void 0||t.call(this,e)}_itemOptionChanged(e,t,i){var n;(n=this._list)===null||n===void 0||n._itemOptionChanged(e,t,i),ns(this._list,e)}_getListDataSource(){const{dataSource:e,items:t=[]}=this.option();return e??t}_setListDataSource(){var e;(e=this._list)===null||e===void 0||e.option("dataSource",this._getListDataSource()),delete this._deferRendering}_getKeyboardListeners(){return super._getKeyboardListeners().concat([this._list])}_toggleVisibility(e){var t;super._toggleVisibility(e),(t=this._button)===null||t===void 0||t.option("visible",e)}_optionChanged(e){var t,i,n,s;const{name:o,value:a}=e;switch(o){case"items":case"dataSource":this.option("opened")?this._setListDataSource():this._deferRendering=!0;break;case"itemTemplate":(t=this._list)===null||t===void 0||t.option(o,this._getTemplate(a));break;case"onItemClick":this._initItemClickAction();break;case"onButtonClick":this._initButtonClickAction();break;case"useInkRipple":this._invalidate();break;case"focusStateEnabled":(i=this._list)===null||i===void 0||i.option(o,a),super._optionChanged(e);break;case"onItemRendered":(n=this._list)===null||n===void 0||n.option(o,a);break;case"opened":this._deferRendering&&this._setListDataSource(),this._toggleMenuVisibility(a),this._updateFocusableItemsTabIndex();break;case"closeOnClick":break;case"container":(s=this._popup)===null||s===void 0||s.option(o,a);break;case"disabled":this._list&&this._updateFocusableItemsTabIndex();break;default:super._optionChanged(e)}}_updateFocusableItemsTabIndex(){const{items:e=[]}=this.option();e.forEach((t=>ns(this._list,t)))}}const qs="dx-toolbar-item-invisible";class x_{constructor(e){this._restoreItems=[],this._toolbar=e}_initMarkup(){Re((()=>{this._renderOverflowMenu(),this._renderMenuItems()}))}_renderOverflowMenu(){if(!this._hasVisibleMenuItems())return;this._renderMenuButtonContainer();const e=h("<div>").appendTo(this._overflowMenuContainer()),t=this._toolbar._createActionByOption("onItemClick"),i=this._toolbar._getTemplateByOption("menuItemTemplate"),{disabled:n,menuContainer:s}=this._toolbar.option();this._menu=this._toolbar._createComponent(e,v_,{disabled:n,itemTemplate:()=>i,onItemClick:o=>{t(o)},container:s,onOptionChanged:o=>{let{name:a,value:l}=o;a==="opened"&&this._toolbar.option("overflowMenuVisible",l),a==="items"&&this._updateMenuVisibility(l)}})}renderMenuItems(){if(this._menu||this._renderOverflowMenu(),this._menu){this._menu.option("items",this._getMenuItems());const{items:e=[]}=this._menu.option();e.length||this._menu.option("opened",!1)}}_renderMenuButtonContainer(){this._$overflowMenuContainer=h("<div>").appendTo(this._toolbar._$afterSection).addClass("dx-toolbar-button").addClass("dx-toolbar-menu-container")}_overflowMenuContainer(){return this._$overflowMenuContainer}_updateMenuVisibility(e){const t=e??this._getMenuItems(),i=t.length&&this._hasVisibleMenuItems(t);this._toggleMenuVisibility(!!i)}_toggleMenuVisibility(e){this._overflowMenuContainer()&&this._overflowMenuContainer().toggleClass("dx-state-invisible",!e)}_renderMenuItems(){Re((()=>{this.renderMenuItems()}))}_dimensionChanged(){this.renderMenuItems()}_getToolbarItems(){const{items:e=[]}=this._toolbar.option();return e.filter((t=>!this._toolbar._isMenuItem(t)))}_getHiddenItems(){return this._toolbar._itemContainer().children(`.dx-toolbar-item-auto-hide.${qs}`).not(".dx-state-invisible")}_getMenuItems(){const{items:e=[]}=this._toolbar.option(),t=e.filter((s=>this._toolbar._isMenuItem(s))),i=this._getHiddenItems();return this._restoreItems=this._restoreItems??[],[...[].slice.call(i).map((s=>{const o=this._toolbar._getItemData(s),a=h(s),l=a.children();return T({menuItemTemplate:()=>(this._restoreItems.push({container:a,item:l}),h("<div>").addClass("dx-toolbar-item-auto-hide").append(l))},o)})),...t]}_hasVisibleMenuItems(e){const t=e??this._toolbar.option("items");let i=!1;const n=Pe("visible"),s=Pe("locateInMenu");return x(t,((o,a)=>{const l=n(a,{functionsAsIs:!0}),d=s(a,{functionsAsIs:!0});l!==!1&&(d==="auto"||d==="always")&&(i=!0)})),i}_arrangeItems(){this._toolbar._$centerSection.css({margin:"0 auto",float:"none"}),x(this._restoreItems??[],((t,i)=>{h(i.container).append(i.item)})),this._restoreItems=[];const e=H(this._toolbar.$element());return this._hideOverflowItems(e),e}_hideOverflowItems(e){const t=this._toolbar.$element().find(".dx-toolbar-item-auto-hide");if(!t.length)return;const i=e??H(this._toolbar.$element());h(t).removeClass(qs);let n=this._getItemsWidth();for(;t.length&&i<n;)t.eq(-1).addClass(qs),n=this._getItemsWidth(),[].splice.apply(t,[-1,1])}_getItemsWidth(){return this._toolbar._getSummaryItemsSize("width",[this._toolbar._$beforeSection,this._toolbar._$centerSection,this._toolbar._$afterSection])}_itemOptionChanged(e,t,i){if((t==="disabled"||t==="options.disabled")&&this._toolbar._isMenuItem(e)){var n;(n=this._menu)===null||n===void 0||n._itemOptionChanged(e,"disabled",i);return}this.renderMenuItems()}_renderItem(e,t){e.locateInMenu==="auto"&&t.addClass("dx-toolbar-item-auto-hide")}_optionChanged(e,t){var i,n,s,o,a;switch(e){case"disabled":(i=this._menu)===null||i===void 0||i.option(e,t);break;case"overflowMenuVisible":(n=this._menu)===null||n===void 0||n.option("opened",t);break;case"onItemClick":(s=this._menu)===null||s===void 0||s.option(e,t);break;case"menuContainer":(o=this._menu)===null||o===void 0||o.option("container",t);break;case"menuItemTemplate":(a=this._menu)===null||a===void 0||a.option("itemTemplate",t)}}}class Ac extends Ep{_getDefaultOptions(){return T({},super._getDefaultOptions(),{menuItemTemplate:"menuItem",overflowMenuVisible:!1,multiline:!1})}_isMultiline(){const{multiline:e}=this.option();return e}_dimensionChanged(e){e!=="height"&&(super._dimensionChanged(),this._layoutStrategy._dimensionChanged())}_initMarkup(){super._initMarkup(),this._updateFocusableItemsTabIndex(),this._layoutStrategy._initMarkup()}_renderToolbar(){super._renderToolbar(),this._renderLayoutStrategy()}_itemContainer(){return this._isMultiline()?this._$toolbarItemsContainer:super._itemContainer()}_renderLayoutStrategy(){this.$element().toggleClass("dx-toolbar-multiline",this._isMultiline()),this._layoutStrategy=this._isMultiline()?new g_(this):new x_(this)}_renderSections(){this._isMultiline()||super._renderSections()}_postProcessRenderItems(){this._layoutStrategy._hideOverflowItems(),this._layoutStrategy._updateMenuVisibility(),super._postProcessRenderItems(),this._layoutStrategy._renderMenuItems()}_renderItem(e,t,i,n){const s=super._renderItem(e,t,i,n);this._layoutStrategy._renderItem(t,s);const{widget:o,showText:a}=t;return o==="dxButton"&&a==="inMenu"&&s.toggleClass("dx-toolbar-text-auto-hide"),s}_getItemsWidth(){return this._layoutStrategy._getItemsWidth()}_getMenuItems(){return this._layoutStrategy._getMenuItems()}_getToolbarItems(){return this._layoutStrategy._getToolbarItems()}_arrangeItems(){if(this.$element().is(":hidden"))return;const e=this._layoutStrategy._arrangeItems();this._isMultiline()||super._arrangeItems(e)}_itemOptionChanged(e,t,i,n){this._isMenuItem(e)||super._itemOptionChanged(e,t,i,n),this._layoutStrategy._itemOptionChanged(e,t,i),(t==="disabled"||t==="options.disabled")&&ns(this,e),t==="location"&&this.repaint()}_updateFocusableItemsTabIndex(){this._getToolbarItems().forEach((e=>ns(this,e)))}_isMenuItem(e){return e.locateInMenu==="always"}_isToolbarItem(e){return e.location===void 0||e.locateInMenu==="never"}_optionChanged(e){const{name:t,value:i}=e;switch(this._layoutStrategy._optionChanged(t,i),t){case"menuContainer":case"menuItemTemplate":case"overflowMenuVisible":break;case"multiline":this._invalidate();break;case"disabled":super._optionChanged(e),this._updateFocusableItemsTabIndex();break;default:super._optionChanged(e)}}updateDimensions(){this._dimensionChanged()}}_e("dxToolbar",Ac);function w_(r,e,t){let i=r;return W(i)&&(i={name:i}),m(i.name)&&(m(e[i.name])?i=b(!0,{},e[i.name],i):t.includes(i.name)&&(i=T({},i,{visible:!1}))),b(!0,{},{location:"after"},i)}function Ba(r,e,t){if(!m(e))return r;const i={};return r.forEach((n=>{i[n.name]=n})),e.map((n=>w_(n,i,t)))}const Na=["addRowButton","applyFilterButton","columnChooserButton","exportButton","groupPanel","revertButton","saveButton","searchPanel"];class b_ extends xs{init(){super.init(),this._editingController=this.getController("editing"),this._headerFilterController=this.getController("headerFilter"),this.createAction("onToolbarPreparing",{excludeValidators:["disabled","readOnly"]})}_getToolbarItems(){return[]}_getButtonContainer(){return h("<div>").addClass(this.addWidgetPrefix("toolbar-button"))}_getToolbarButtonClass(e){const t=e?` ${e}`:"";return this.addWidgetPrefix("toolbar-button")+t}_getToolbarOptions(){const e=this.option("toolbar"),t={toolbarOptions:{items:this._getToolbarItems(),visible:e==null?void 0:e.visible,disabled:e==null?void 0:e.disabled,onItemRendered(n){const s=n.itemData.onItemRendered;s&&s(n)}}},i=e==null?void 0:e.items;if(t.toolbarOptions.items=Ba(t.toolbarOptions.items,i,Na),this.executeAction("onToolbarPreparing",t),t.toolbarOptions&&!m(t.toolbarOptions.visible)){const n=t.toolbarOptions.items;t.toolbarOptions.visible=!!(n!=null&&n.length)}return t.toolbarOptions}_renderCore(){if(this._toolbar)this._toolbar.option(this._toolbarOptions);else{const e=this.element();e.addClass(this.addWidgetPrefix("header-panel"));const t=w.format(this.component.NAME+"-ariaToolbar"),i=h("<div>").attr("aria-label",t).appendTo(e);this._toolbar=this._createComponent(i,Ac,this._toolbarOptions)}}_columnOptionChanged(){}_handleDataChanged(){this._requireReady&&this.render()}_isDisabledDefinedByUser(e){var t;const i=(t=this.option("toolbar"))===null||t===void 0?void 0:t.items,n=i==null?void 0:i.find((s=>(s==null?void 0:s.name)===e));return m(n==null?void 0:n.disabled)}render(){this._toolbarOptions=this._getToolbarOptions(),super.render.apply(this,arguments)}setToolbarItemDisabled(e,t){const i=this._toolbar,n=this._isDisabledDefinedByUser(e);if(!i||n)return;const o=(i.option("items")??[]).findIndex((l=>l.name===e));if(o<0)return;const a=i.option(`items[${o}]`);i.option(`items[${o}].disabled`,t),a.options&&i.option(`items[${o}].options.disabled`,t)}updateToolbarDimensions(){var e;(e=this._toolbar)===null||e===void 0||e.updateDimensions()}getHeaderPanel(){return this.element()}getHeight(){return this.getElementHeight()}optionChanged(e){if(e.name==="onToolbarPreparing"&&(this._invalidate(),e.handled=!0),e.name==="toolbar"){const s=sp(e.fullName),o=e.fullName.replace(/^toolbar\./,"");if(s.length===1||s[1]==="visible")this._invalidate();else if(s[1]==="items"){if(s.length===2)this._invalidate();else if(s.length===3){var t;const a=Ba(this._getToolbarItems(),[e.value],Na)[0];(t=this._toolbar)===null||t===void 0||t.option(o,a)}else if(s.length>=4){var i;(i=this._toolbar)===null||i===void 0||i.option(o,e.value)}}else{var n;(n=this._toolbar)===null||n===void 0||n.option(o,e.value)}e.handled=!0}super.optionChanged(e)}isVisible(){return!!(this._toolbarOptions&&this._toolbarOptions.visible)}allowDragging(e){return!1}hasGroupedColumns(){}getContextMenuItems(e){}}const y_=r=>class extends r{_updateDimensionsCore(){super._updateDimensionsCore.apply(this,arguments),this.getView("headerPanel").updateToolbarDimensions()}},VS={defaultOptions:()=>({}),views:{headerPanel:b_},extenders:{controllers:{resizing:y_}}};class OS extends Lt{_getDefaultOptions(){const e=super._getDefaultOptions();return x(this.getGridCoreHelper().modules,(function(){B(this.defaultOptions)&&b(!0,e,this.defaultOptions())})),e}_init(){this._activeStateUnit=".dx-row",super._init()}_setDeprecatedOptions(){super._setDeprecatedOptions(),b(this._deprecatedOptions,{"columnChooser.allowSearch":{since:"23.1",message:'Use the "columnChooser.search.enabled" option instead'},"columnChooser.searchTimeout":{since:"23.1",message:'Use the "columnChooser.search.timeout" option instead'}})}_clean(){}_optionChanged(e){this.getGridCoreHelper().callModuleItemsMethod(this,"optionChanged",[e]),e.handled||super._optionChanged(e)}_dimensionChanged(){this.updateDimensions(!0)}_visibilityChanged(e){e&&this.updateDimensions()}_renderContentImpl(){this.getView("gridView").update()}_renderContent(){const e=this;Re((()=>{e._renderContentImpl()}))}_dispose(){super._dispose(),this.getGridCoreHelper().callModuleItemsMethod(this,"dispose")}isReady(){return this.getController("data").isReady()}getController(e){return this._controllers[e]}getView(e){return this._views[e]}getGridCoreHelper(){}beginUpdate(){super.beginUpdate(),this.getGridCoreHelper().callModuleItemsMethod(this,"beginUpdate")}endUpdate(){this.getGridCoreHelper().callModuleItemsMethod(this,"endUpdate"),super.endUpdate()}}const I_=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/,Pc=function(r){r&&x(r,((e,t)=>{if(ze(t)||Array.isArray(t))Pc(t);else if(typeof t=="string"){const i=I_.exec(t);i&&(r[e]=new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],+i[6])))}}))},La=function(r){const e=r.type==="sessionStorage"?Ah():oe().localStorage;if(!e)throw new Error("E1007");return e},$a=function(r){return m(r.storageKey)?r.storageKey:"storage"};class kc extends j.ViewController{getDataController(){return this.getController("data")}getExportController(){return this.getController("export")}getColumnsController(){return this.getController("columns")}init(){return this._state={},this._isLoaded=!1,this._isLoading=!1,this._windowUnloadHandler=()=>{this._savingTimeoutID!==void 0&&this._saveState(this.state())},v.on(oe(),"visibilitychange",this._windowUnloadHandler),this}optionChanged(e){const t=this;e.name==="stateStoring"?(t.isEnabled()&&!t.isLoading()&&t.load(),e.handled=!0):super.optionChanged(e)}dispose(){clearTimeout(this._savingTimeoutID),v.off(oe(),"visibilitychange",this._windowUnloadHandler)}_loadState(){const e=this.option("stateStoring");if(e.type==="custom")return e.customLoad&&e.customLoad();try{return JSON.parse(La(e).getItem($a(e)))}catch(t){se.log("W1022","State storing",t.message)}}_saveState(e){const t=this.option("stateStoring");if(t.type==="custom"){t.customSave&&t.customSave(e);return}try{La(t).setItem($a(t),JSON.stringify(e))}catch(i){se.log(i.message)}}publicMethods(){return["state"]}isEnabled(){return this.option("stateStoring.enabled")}isLoaded(){return this._isLoaded}isLoading(){return this._isLoading}load(){this._isLoading=!0;const e=_t(this._loadState());return e.always((()=>{this._isLoaded=!0,this._isLoading=!1})).done((t=>{t!==null&&!nt(t)&&this.state(t)})),e}state(e){const t=this;if(!arguments.length)return b(!0,{},t._state);t._state=b({},e),Pc(t._state)}save(){const e=this;clearTimeout(e._savingTimeoutID),e._savingTimeoutID=setTimeout((()=>{e._saveState(e.state()),e._savingTimeoutID=void 0}),e.option("stateStoring.savingTimeout"))}}const FS={StateStoringController:kc},S_=r=>{const e=r.getView("pagerView"),t=r.getController("data"),i={allowedPageSizes:e?e.getPageSizes():void 0,filterPanel:{filterEnabled:r.option("filterPanel.filterEnabled")},filterValue:r.option("filterValue"),focusedRowKey:r.option("focusedRowEnabled")?r.option("focusedRowKey"):void 0};return b(i,t.getUserState())},E_=r=>{const e=r.getController("columns"),t=r.getController("selection"),i=r.getController("export"),n=r.getController("data");e&&e.columnsChanged.add((()=>{r.updateState({columns:e.getUserState()})})),t&&t.selectionChanged.add((s=>{r.updateState({selectedRowKeys:s.selectedRowKeys,selectionFilter:s.selectionFilter})})),n&&(r._initialPageSize=r.option("paging.pageSize"),r._initialFilterValue=r.option("filterValue"),n.changed.add((()=>{const s=S_(r);r.updateState(s)}))),i&&i.selectionOnlyChanged.add((()=>{r.updateState({exportSelectionOnly:i.selectionOnly()})}))},T_=(r,e)=>{var t;const i=r.getController("filterSync");if(!i)return null;if(e.filterValue!==void 0)return e.filterValue;const n=(t=i.getFilterValueFromColumns)===null||t===void 0?void 0:t.call(i,e.columns);if((n==null?void 0:n.length)>0)return n;const s=r.getController("columns").getColumns();return r._initialFilterValue??i.getFilterValueFromColumns(s)},D_=r=>class extends r{init(){super.init(),this._dataController.stateLoaded.add((()=>{if(this._dataController.isLoaded()&&!this._dataController.getDataSource()){this.setLoading(!1),this.renderNoDataText();const e=this.component.getView("columnHeadersView");e&&e.render(),this.component._fireContentReadyAction()}}))}},R_=r=>class extends r{init(){return super.init.apply(this,arguments),E_(this),this}isLoading(){return super.isLoading()||this.getDataController().isStateLoading()}state(e){const t=super.state.apply(this,arguments);return e!==void 0&&this.applyState(b(!0,{},e)),t}updateState(e){if(this.isEnabled()){const t=this.state(),i=b({},t,e),n=Ot(t),s=Ot(i);ae(n,s)||(e=b(!0,{},e),b(this._state,e),this.save())}else b(this._state,e)}applyState(e){var t;const{allowedPageSizes:i}=e,{searchText:n}=e,{selectedRowKeys:s}=e,{selectionFilter:o}=e,a=this.option("scrolling.mode"),l=a==="virtual"||a==="infinite",d=this.option("pager.visible")===!0&&this.option("pager.showPageSizeSelector"),c=(t=this.getView("rowsView"))===null||t===void 0?void 0:t.hasHeight();this.component.beginUpdate(),this.getColumnsController()&&this.getColumnsController().setUserState(e.columns),this.getExportController()&&this.getExportController().selectionOnly(e.exportSelectionOnly),this.option("selection.deferred")||this.option("selectedRowKeys",s||[]),this.option("selectionFilter",o),i&&this.option("pager.allowedPageSizes")==="auto"&&(this.option("pager").allowedPageSizes=i),this.option("focusedRowEnabled")&&(this.option("focusedRowIndex",-1),this.option("focusedRowKey",e.focusedRowKey??null)),this.component.endUpdate(),this.option("searchPanel.text",n||""),this.option("filterValue",T_(this,e)),this.option("filterPanel.filterEnabled",e.filterPanel?e.filterPanel.filterEnabled:!0),this.option("paging.pageIndex",(!l||c)&&e.pageIndex||0),this.option("paging.pageSize",(!l||d)&&m(e.pageSize)?e.pageSize:this._initialPageSize),this.getDataController()&&this.getDataController().reset()}},V_=r=>class extends r{_shouldReturnVisibleColumns(){return super._shouldReturnVisibleColumns.apply(this,arguments)&&(!this._stateStoringController.isEnabled()||this._stateStoringController.isLoaded())}},O_=r=>class extends r{dispose(){clearTimeout(this._restoreStateTimeoutID),super.dispose()}callbackNames(){return super.callbackNames().concat(["stateLoaded"])}_refreshDataSource(){if(this._stateStoringController.isEnabled()&&!this._stateStoringController.isLoaded()){clearTimeout(this._restoreStateTimeoutID);const e=new S;return this._restoreStateTimeoutID=setTimeout((()=>{this._stateStoringController.load().always((()=>{this._restoreStateTimeoutID=null})).done((()=>{super._refreshDataSource(),this.stateLoaded.fire(),e.resolve()})).fail((t=>{this.stateLoaded.fire(),this._handleLoadError(t||"Unknown error"),e.reject()}))})),e.promise()}this.isStateLoading()||super._refreshDataSource()}isLoading(){return super.isLoading()||this._stateStoringController.isLoading()}isStateLoading(){return m(this._restoreStateTimeoutID)}isLoaded(){return super.isLoaded()&&!this.isStateLoading()}},F_=r=>class extends r{_fireSelectionChanged(e){const t=this.option("selection.deferred");this._stateStoringController.isLoading()&&t||super._fireSelectionChanged.apply(this,arguments)}},AS={defaultOptions:()=>({stateStoring:{enabled:!1,storageKey:null,type:"localStorage",customLoad:null,customSave:null,savingTimeout:2e3}}),controllers:{stateStoring:kc},extenders:{views:{rowsView:D_},controllers:{stateStoring:R_,columns:V_,data:O_,selection:F_}}},A_="dx-select-checkboxes-hidden",rt="selection.showCheckBoxesMode",Zi="selection.mode",Mc=function(r,e){const t=r.getView("rowsView"),i=r.getController("selection"),n=h(e.target).closest(".dx-data-row"),s=t.getRowIndex(n);s<0||(r.option(rt)==="onLongTap"?i.isSelectionWithCheckboxes()?i.stopSelectionWithCheckboxes():i.startSelectionWithCheckboxes():(r.option(rt)==="onClick"&&i.startSelectionWithCheckboxes(),r.option(rt)!=="always"&&i.changeItemSelection(s,{control:!0})))},P_=function(r,e){let t=0;const i=r._dataController.store(),n=i==null?void 0:i.key(),s=Array.isArray(n);if(!e.length)return!1;if(s&&Array.isArray(e[0])&&e[1]==="and"){for(let o=0;o<e.length;o++)if(Array.isArray(e[o])){if(e[o][0]!==n[t]||e[o][1]!=="=")return!0;t++}return!1}return n!==e[0]},k_=(r,e)=>{const{component:t}=e,i=t.getView("rowsView");t.option("renderAsync")&&!t.option("selection.deferred")&&(e.value=t.isRowSelected(e.row.key)),i.renderSelectCheckBoxContainer(h(r),e)},M_=(r,e)=>{const{column:t}=e,i=h(r),n=e.component.getView("columnHeadersView");i.addClass("dx-editor-cell"),n._renderSelectAllCheckBox(i,t),n._attachSelectAllCheckBoxClickEvent(i)};class B_ extends j.Controller{init(){const{deferred:e,selectAllMode:t,mode:i}=this.option("selection")??{};this.option("scrolling.mode")==="infinite"&&!e&&i==="multiple"&&t==="allPages"&&se.log("W1018"),this._dataController=this.getController("data"),this._columnsController=this.getController("columns"),this._stateStoringController=this.getController("stateStoring"),this._selectionMode=i,this._isSelectionWithCheckboxes=!1,this._selection=this._createSelection(),this._updateSelectColumn(),this.createAction("onSelectionChanged",{excludeValidators:["disabled","readOnly"]}),this._dataPushedHandler||(this._dataPushedHandler=this._handleDataPushed.bind(this),this._dataController.pushed.add(this._dataPushedHandler))}_handleDataPushed(e){this._deselectRemovedOnPush(e),this._updateSelectedOnPush(e)}_deselectRemovedOnPush(e){const t=this.option("selection.deferred");let i=e.filter((n=>n.type==="remove")).map((n=>n.key));if(t){const n=this._dataController.items().filter((s=>s.isSelected)).map((s=>s.key));i=i.filter((s=>n.find((o=>ae(o,s)))))}i.length&&this.deselectRows(i)}_updateSelectedOnPush(e){if(this.option("selection.deferred"))return;const i=e.filter((s=>s.type==="update")),n=this.getSelectedRowsData();$n({keyInfo:this._selection.options,data:n,changes:i})}_getSelectionConfig(){const e=this._dataController,t=this._columnsController,i=this.option("selection")??{},{deferred:n}=i,s=this.option("scrolling.mode"),o=s==="virtual"||s==="infinite",a=this.option("selection.allowSelectAll"),l=this.option("scrolling.legacyMode");return{selectedKeys:this.option("selectedRowKeys"),mode:this._selectionMode,deferred:n,alwaysSelectByShift:i.alwaysSelectByShift,maxFilterLengthInRequest:i.maxFilterLengthInRequest,selectionFilter:this.option("selectionFilter"),ignoreDisabledItems:!0,isVirtualPaging:o,sensitivity:this.option("selection.sensitivity"),allowLoadByRange(){const d=t.getGroupColumns().length>0;return o&&!l&&!d&&a&&!n},key:()=>e==null?void 0:e.key(),keyOf:d=>e==null?void 0:e.keyOf(d),dataFields(){var d;return(d=e.dataSource())===null||d===void 0?void 0:d.select()},load(d){var c;return((c=e.dataSource())===null||c===void 0?void 0:c.load(d))||new S().resolve([])},plainItems:d=>e.items(!0),isItemSelected:d=>d.selected,isSelectableItem:d=>(d==null?void 0:d.rowType)==="data"&&!d.isNewRow,getItemData:d=>m(d==null?void 0:d.rowType)?(d==null?void 0:d.oldData)||(d==null?void 0:d.data):d,filter:()=>e.getCombinedFilter(n),totalCount:()=>e.totalCount(),getLoadOptions(d,c,u){var p;const{sort:g,filter:_}=((p=e.dataSource())===null||p===void 0?void 0:p.lastLoadOptions())??{};let f=Math.min(d,c),C=Math.max(d,c);m(u)&&(f=Math.min(u,f),C=Math.max(u,C));const I=C-f+1;return{skip:f,take:I,filter:_,sort:g}},onSelectionChanged:this._updateSelectedItems.bind(this)}}_updateSelectColumn(){const e=this._columnsController,t=this.isSelectColumnVisible();e.addCommandColumn({type:"selection",command:"select",visible:t,visibleIndex:-1,dataType:"boolean",alignment:"center",cssClass:"dx-command-select",width:"auto",cellTemplate:k_,headerCellTemplate:M_}),e.columnOption("command:select","visible",t)}_createSelection(){const e=this._getSelectionConfig();return new Tp(e)}_fireSelectionChanged(e){const t=this.option("selection.deferred")?{selectionFilter:this.option("selectionFilter")}:{selectedRowKeys:this.option("selectedRowKeys")};this.selectionChanged.fire(t),e&&this.executeAction("onSelectionChanged",e)}_updateCheckboxesState(e){const{isDeferredMode:t}=e,{selectionFilter:i}=e,{selectedItemKeys:n}=e,{removedItemKeys:s}=e;this.option(rt)==="onClick"&&((t?i&&P_(this,i):n.length>1)?this.startSelectionWithCheckboxes():(t?i&&!i.length:n.length===0&&s.length)&&this.stopSelectionWithCheckboxes())}_updateSelectedItems(e){const t=this;let i;const n=t.option("selection.deferred"),s=t._selection.selectionFilter(),o=t._dataController,a=o.items(!0),l=o.items();if(!a)return;const d=t.isSelectionWithCheckboxes(),c=t.getChangedItemIndexes(a),u=t.getChangedItemIndexes(l);t._updateCheckboxesState({selectedItemKeys:e.selectedItemKeys,removedItemKeys:e.removedItemKeys,selectionFilter:s,isDeferredMode:n}),(c.length||d!==t.isSelectionWithCheckboxes())&&o.updateItems({changeType:"updateSelection",itemIndexes:u}),n?(t.option("selectionFilter",s),i={}):(e.addedItemKeys.length||e.removedItemKeys.length)&&(t._selectedItemsInternalChange=!0,t.option("selectedRowKeys",e.selectedItemKeys.slice(0)),t._selectedItemsInternalChange=!1,i={selectedRowsData:e.selectedItems.slice(0),selectedRowKeys:e.selectedItemKeys.slice(0),currentSelectedRowKeys:e.addedItemKeys.slice(0),currentDeselectedRowKeys:e.removedItemKeys.slice(0)}),t._fireSelectionChanged(i)}getChangedItemIndexes(e){const t=this,i=[],n=this.option("selection.deferred");for(let s=0,{length:o}=e;s<o;s++){const a=e[s],l=t.isRowSelected(n?a.data:a.key);t._selection.isDataItem(a)&&a.isSelected!==l&&i.push(s)}return i}callbackNames(){return["selectionChanged"]}optionChanged(e){var t;super.optionChanged(e);const i=!!((t=this._selection)!==null&&t!==void 0&&t.options);switch(e.name){case"selection":{const n=this._selectionMode;if(this.init(),i&&e.fullName==="selection.sensitivity"&&(this._selection.options.sensitivity=e.value),e.fullName!=="selection.showCheckBoxesMode"){const s=this._selectionMode;let o=this.option("selectedRowKeys");n!==s&&(s==="single"?o.length>1&&(o=[o[0]]):s!=="multiple"&&(o=[])),this.selectRows(o).always((()=>{this._fireSelectionChanged()}))}this._columnsController.updateColumns(),e.handled=!0;break}case"selectionFilter":this._selection.selectionFilter(e.value),e.handled=!0;break;case"selectedRowKeys":{const n=e.value||[];Array.isArray(n)&&!this._selectedItemsInternalChange&&(this.component.getDataSource()||!n.length)&&this.selectRows(n),e.handled=!0;break}}}publicMethods(){return["selectRows","deselectRows","selectRowsByIndexes","getSelectedRowKeys","getSelectedRowsData","clearSelection","selectAll","deselectAll","startSelectionWithCheckboxes","stopSelectionWithCheckboxes","isRowSelected"]}isRowSelected(e){return this._selection.isItemSelected(e)}isSelectColumnVisible(){return this.option(Zi)==="multiple"&&(this.option(rt)==="always"||this.option(rt)==="onClick"||this._isSelectionWithCheckboxes)}_isOnePageSelectAll(){return this.option("selection.selectAllMode")==="page"}isSelectAll(){return this._selection.getSelectAllState(this._isOnePageSelectAll())}selectAll(){return this.option(rt)==="onClick"&&this.startSelectionWithCheckboxes(),this._selection.selectAll(this._isOnePageSelectAll())}deselectAll(){return this._selection.deselectAll(this._isOnePageSelectAll())}clearSelection(){return this.selectedItemKeys([])}refresh(){const e=this.option("selectedRowKeys")??[];return!this.option("selection.deferred")&&e.length?this.selectedItemKeys(e):new S().resolve().promise()}selectedItemKeys(e,t,i,n){return this._selection.selectedItemKeys(e,t,i,n)}getSelectedRowKeys(e){return this._selection.getSelectedItemKeys()}selectRows(e,t){return this.selectedItemKeys(e,t)}deselectRows(e){return this.selectedItemKeys(e,!0,!0)}selectRowsByIndexes(e){const t=this._dataController.items(),i=[];return Array.isArray(e)||(e=Array.prototype.slice.call(arguments,0)),x(e,(function(){const n=t[this];n&&n.rowType==="data"&&i.push(n.key)})),this.selectRows(i)}getSelectedRowsData(e){return this._selection.getSelectedItems()}loadSelectedItemsWithFilter(){return this._selection.loadSelectedItemsWithFilter()}changeItemSelection(e,t,i){t=t||{},this.isSelectionWithCheckboxes()&&(t.control=!0);const n=e+this._dataController.getRowIndexOffset()-this._dataController.getRowIndexOffset(!0);return this._selection.changeItemSelection(n,t,i)}focusedItemIndex(e){const t=this;if(m(e))t._selection._focusedItemIndex=e;else return t._selection._focusedItemIndex}isSelectionWithCheckboxes(){return this.option(Zi)==="multiple"&&(this.option(rt)==="always"||this._isSelectionWithCheckboxes)}startSelectionWithCheckboxes(){const e=this;return e.option(Zi)==="multiple"&&!e.isSelectionWithCheckboxes()?(e._isSelectionWithCheckboxes=!0,e._updateSelectColumn(),!0):!1}stopSelectionWithCheckboxes(){const e=this;return e._isSelectionWithCheckboxes?(e._isSelectionWithCheckboxes=!1,e._updateSelectColumn(),!0):!1}}const N_=r=>class extends r{init(){const e=this.option("selection.deferred");super.init.apply(this,arguments),e&&this._selectionController._updateCheckboxesState({isDeferredMode:!0,selectionFilter:this.option("selectionFilter")})}_loadDataSource(){const e=this;return super._loadDataSource().always((()=>{e._selectionController.refresh()}))}_processDataItem(e,t){const i=this._selectionController.isSelectColumnVisible(),n=t.isDeferredSelection=t.isDeferredSelection===void 0?this.option("selection.deferred"):t.isDeferredSelection,s=super._processDataItem.apply(this,arguments);if(s.isSelected=this._selectionController.isRowSelected(n?s.data:s.key),i&&s.values){for(let o=0;o<t.visibleColumns.length;o++)if(t.visibleColumns[o].command==="select"){s.values[o]=s.isSelected;break}}return s}refresh(e){const t=new S;return super.refresh(e).done((()=>{if(L(e)&&!e.selection){t.resolve();return}this._selectionController.refresh().done(t.resolve).fail(t.reject)})).fail(t.reject),t.promise()}_handleDataChanged(e){const t=this.hasLoadOperation();super._handleDataChanged.apply(this,arguments),t&&!this._repaintChangesOnly&&this._selectionController.focusedItemIndex(-1)}_applyChange(e){if(e&&e.changeType==="updateSelection"){e.items.forEach(((t,i)=>{const n=this._items[i];n&&(n.isSelected=t.isSelected,n.values=t.values)}));return}return super._applyChange.apply(this,arguments)}_endUpdateCore(){const e=this._changes;if(e.length>1&&e.every((i=>i.changeType==="updateSelection"))){const i=e.map((n=>n.itemIndexes||[])).reduce(((n,s)=>n.concat(s)));this._changes=[{changeType:"updateSelection",itemIndexes:i}]}super._endUpdateCore.apply(this,arguments)}},L_=r=>class extends r{_contextMenuPrepared(e){const t=e.event;t.originalEvent&&t.originalEvent.type!=="dxhold"||e.items&&e.items.length>0||Mc(this,t)}},$_=r=>class extends r{init(){super.init(),this._selectionController.selectionChanged.add(this._updateSelectAllValue.bind(this))}_isSelectAllCheckBoxVisible(){const e=this._dataController.isEmpty(),t=this.option("selection.allowSelectAll"),i=this._selectionController.isSelectAll();return!e&&(t||i!==!1)}_updateSelectAllValue(){const e=this.element(),t=e==null?void 0:e.find(".dx-select-checkbox");if(e&&t.length&&this.option("selection.mode")==="multiple"){const i=this._selectionController.isSelectAll(),n=this._isSelectAllCheckBoxVisible();t.dxCheckBox("instance").option({visible:n,value:i})}}_handleDataChanged(e){super._handleDataChanged(e),(!e||e.changeType==="refresh"||e.repaintChangesOnly&&e.changeType==="update")&&this.waitAsyncTemplates().done((()=>{this._updateSelectAllValue()}))}_renderSelectAllCheckBox(e,t){const i=this._createSelectAllCheckboxElement(t);return i.appendTo(e),i}_createSelectAllCheckboxElement(e){const t=h("<div>").addClass("dx-select-checkbox");return this.setAria("label",w.format("dxDataGrid-ariaSelectAll"),t),this._editorFactoryController.createEditor(t,b({},e,{parentType:"headerRow",dataType:"boolean",value:this._selectionController.isSelectAll(),editorOptions:{visible:this._isSelectAllCheckBoxVisible()},tabIndex:this.option("useLegacyKeyboardNavigation")?-1:this.option("tabIndex")||0,setValue:(i,n)=>{const s=this.option("selection.allowSelectAll");n.component.option("visible",s||n.component.option("value")!==!1),!(!n.event||this._selectionController.isSelectAll()===i)&&(n.value&&!s?n.component.option("value",!1):n.value?this._selectionController.selectAll():this._selectionController.deselectAll(),n.event.preventDefault())}})),t}_attachSelectAllCheckBoxClickEvent(e){v.on(e,Q,this.createAction((t=>{const{event:i}=t;if(!this._isSelectAllCheckBoxVisible()){i.preventDefault();return}h(i.target).closest(".dx-select-checkbox").length||v.trigger(h(i.currentTarget).children(".dx-select-checkbox"),Q),i.preventDefault()})))}},H_=r=>class extends r{renderSelectCheckBoxContainer(e,t){t.rowType==="data"&&!t.row.isNewRow?(e.addClass("dx-editor-cell"),this._attachCheckBoxClickEvent(e),this._renderSelectCheckBox(e,t)):y.setEmptyText(e)}_renderSelectCheckBox(e,t){const i=h("<div>").addClass("dx-select-checkbox").appendTo(e);return this.setAria("label",w.format("dxDataGrid-ariaSelectRow"),i),this._editorFactoryController.createEditor(i,b({},t.column,{parentType:"dataRow",dataType:"boolean",lookup:null,value:t.value,setValue(n,s){var o;(s==null||(o=s.event)===null||o===void 0?void 0:o.type)==="keydown"&&v.trigger(s.element,Q,s)},row:t.row})),i}_attachCheckBoxClickEvent(e){v.on(e,Q,this.createAction((function(t){const{event:i}=t,n=this.getRowIndex(h(i.currentTarget).closest(".dx-row"));n>=0&&(this._selectionController.startSelectionWithCheckboxes(),this._selectionController.changeItemSelection(n,{shift:i.shiftKey}),h(i.target).closest(".dx-select-checkbox").length&&this._dataController.updateItems({changeType:"updateSelection",itemIndexes:[n]}))})))}_update(e){const t=this,i=t.getTableElements();e.changeType==="updateSelection"?i.length>0&&(x(i,((n,s)=>{x(e.itemIndexes||[],((o,a)=>{let l;if(e.items[a]&&(l=t._getRowElements(h(s)).eq(a),l.length)){const{isSelected:d}=e.items[a];l.toggleClass("dx-selection",d===void 0?!1:d).find(".dx-select-checkbox").dxCheckBox("option","value",d),t.setAria("selected",d,l)}}))})),t._updateCheckboxesClass()):super._update(e)}_createTable(){const e=this,t=e.option("selection.mode"),i=super._createTable.apply(e,arguments);return t!=="none"&&((e.option(rt)==="onLongTap"||!hs.touch)&&v.on(i,V(Di.name,"dxDataGridRowsView"),".dx-data-row",e.createAction((n=>{Mc(e.component,n.event),n.event.stopPropagation()}))),v.on(i,"mousedown selectstart",e.createAction((n=>{const{event:s}=n;s.shiftKey&&s.preventDefault()})))),i}_createRow(e){const t=super._createRow.apply(this,arguments);if(e){const{isSelected:i}=e;i&&t.addClass("dx-selection"),this.option(Zi)!=="none"&&this.setAria("selected",i,t)}return t}_rowClickForTreeList(e){super._rowClick(e)}_rowClick(e){const t=this,i=e.event,n=h(i.target).closest(".dx-selection-disabled").length;t.isClickableElement(h(i.target))||(!n&&(t.option(Zi)!=="multiple"||t.option(rt)!=="always")&&t._selectionController.changeItemSelection(e.rowIndex,{control:Ae(i),shift:i.shiftKey})&&(i.preventDefault(),e.handled=!0),super._rowClick(e))}isClickableElement(e){return!!e.closest(".dx-command-select").length}_renderCore(e){const t=super._renderCore(e);return this._updateCheckboxesClass(),t}_updateCheckboxesClass(){const e=this.getTableElements(),t=this._selectionController.isSelectColumnVisible()&&!this._selectionController.isSelectionWithCheckboxes();x(e,((i,n)=>{h(n).toggleClass(A_,t)}))}},PS={defaultOptions:()=>({selection:{mode:"none",showCheckBoxesMode:"onClick",allowSelectAll:!0,selectAllMode:"allPages",deferred:!1,maxFilterLengthInRequest:1500,alwaysSelectByShift:!1},selectionFilter:[],selectedRowKeys:[]}),controllers:{selection:B_},extenders:{controllers:{data:N_,contextMenu:L_},views:{columnHeadersView:$_,rowsView:H_}}},Ke="dx-treeview",Fe=`${Ke}-node`,ut=`${Fe}-container`,Ys=`${Fe}-loadindicator`,yt=`${Fe}-container-opened`,Bi=`${Fe}-is-leaf`,ye=`${Ke}-item`,W_=`${ye}-with-checkbox`,z_=`${ye}-with-custom-expander-icon`,K_=`${Ke}-custom-expander-icon-item-container`,G_=`${ye}-without-checkbox`,U_=`${ye}-data`,Ni=`${Ke}-toggle-item-visibility`,js=`${Ke}-custom-collapse-icon`,Xs=`${Ke}-custom-expand-icon`,q_=`${Ke}-loadindicator`,Y_=`${Ke}-loadindicator-wrapper`,Ha=`${Ke}-toggle-item-visibility-opened`,Sn=`${Ke}-select-all-item`,En="data-item-id",j_=`${Ke}-root-node`,X_=`${Ke}-expander-icon-stub`;class Z_ extends Rc{_supportedKeys(){const e=n=>{const{focusedElement:s}=this.option(),o=h(s);if(!o.length)return;n.target=o.get(0),n.currentTarget=o.get(0),this._processItemClick(n,o.children(`.${ye}`));const{expandEvent:a}=this.option();this._getEventNameByOption(a)===V(Q,"dxTreeView_expand")&&this._expandEventHandler(n)},t=n=>{n.preventDefault();const{focusedElement:s}=this.option(),o=h(s),a=this._getCheckBoxInstance(o),{disabled:l,value:d}=a.option();if(!l){const c=d;this._updateItemSelection(!c,o.find(`.${ye}`).get(0),n)}},i=(n,s)=>{const{expandAllEnabled:o}=this.option();if(!o)return;s.preventDefault();const{focusedElement:a}=this.option(),l=h(a);if(!l.length)return;const d=this._getItemData(l.find(`.${ye}`));this._toggleExpandedNestedItems([d],n)};return T({},super._supportedKeys(),{enter:this._showCheckboxes()?t:e,space:this._showCheckboxes()?t:e,asterisk:n=>{i(!0,n)},minus:n=>{i(!1,n)}})}_toggleExpandedNestedItems(e,t){if(e)for(let i=0,n=e.length;i<n;i+=1){const s=e[i],o=this._dataAdapter.getNodeByItem(s);this._toggleExpandedState(o,t),this._toggleExpandedNestedItems(s.items,t)}}_getNodeElement(e,t){const i=this._encodeString(e.internalFields.key);if(t)return t.$nodeByKey||(t.$nodeByKey={},this.$element().find(`.${Fe}`).each(((o,a)=>{const l=h(a),d=l.attr(En);return t.$nodeByKey[d]=l,!0}))),t.$nodeByKey[i]||h();const n=this.$element().get(0).querySelector(`[${En}="${i}"]`);return h(n)}_widgetClass(){return Ke}_getDefaultOptions(){const e=T({},super._getDefaultOptions(),{animationEnabled:!0,dataStructure:"tree",deferRendering:!0,expandAllEnabled:!1,hasItemsExpr:"hasItems",selectNodesRecursive:!0,expandNodesRecursive:!0,showCheckBoxesMode:"none",expandIcon:null,collapseIcon:null,selectAllText:w.format("dxList-selectAll"),onItemSelectionChanged:null,onItemExpanded:null,onItemCollapsed:null,scrollDirection:"vertical",useNativeScrolling:!0,virtualModeEnabled:!1,rootValue:0,focusStateEnabled:!1,selectionMode:"multiple",expandEvent:"dblclick",selectByClick:!1,createChildren:null,onSelectAllValueChanged:null,_supportItemUrl:!1});return b(!0,e,{integrationOptions:{useDeferUpdateForTemplates:!1}})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:()=>!hs.nativeScrolling,options:{useNativeScrolling:!1}}])}_initSelectedItems(){}_syncSelectionOptions(){return S().resolve().promise()}_fireSelectionChanged(){this._createActionByOption("onSelectionChanged",{excludeValidators:["disabled","readOnly"]})()}_createSelectAllValueChangedAction(){this._selectAllValueChangedAction=this._createActionByOption("onSelectAllValueChanged",{excludeValidators:["disabled","readOnly"]})}_fireSelectAllValueChanged(e){var t;(t=this._selectAllValueChangedAction)===null||t===void 0||t.call(this,{value:e})}_checkBoxModeChange(e,t){var i;const{searchEnabled:n}=this.option(),s=this._selectAllEnabled(t),o=this._itemContainer(n,s);if(this._detachClickEvent(o),this._detachExpandEvent(o),t==="none"||e==="none")return;const a=(i=this._$selectAllItem)===null||i===void 0?void 0:i.length;switch(e){case"selectAll":a||(this._createSelectAllValueChangedAction(),this._renderSelectAllItem());break;case"normal":if(a){var l;(l=this._$selectAllItem)===null||l===void 0||l.remove(),delete this._$selectAllItem}}}_removeSelection(){x(this._dataAdapter.getFullData(),((e,t)=>{this._hasChildren(t)&&this._dataAdapter.toggleSelection(t.internalFields.key,!1,!0)}))}_optionChanged(e){const{name:t,value:i,previousValue:n}=e;switch(t){case"selectAllText":this._$selectAllItem&&this._$selectAllItem.dxCheckBox("instance").option("text",i);break;case"showCheckBoxesMode":this._checkBoxModeChange(i,n),this._invalidate();break;case"scrollDirection":this.getScrollable().option("direction",i);break;case"useNativeScrolling":this.getScrollable().option("useNative",i);break;case"items":delete this._$selectAllItem,super._optionChanged(e);break;case"dataSource":super._optionChanged(e),this._initDataAdapter(),this._filter={};break;case"hasItemsExpr":this._initAccessors(),this.repaint();break;case"expandEvent":this._attachExpandEvent();break;case"deferRendering":case"dataStructure":case"rootValue":case"createChildren":case"expandNodesRecursive":case"onItemSelectionChanged":case"onItemExpanded":case"onItemCollapsed":case"expandAllEnabled":case"animationEnabled":case"virtualModeEnabled":case"selectByClick":case"_supportItemUrl":break;case"selectionMode":this._initDataAdapter(),super._optionChanged(e);break;case"onSelectAllValueChanged":this._createSelectAllValueChangedAction();break;case"selectNodesRecursive":this._dataAdapter.setOption("recursiveSelection",e.value??!1),this.repaint();break;case"expandIcon":case"collapseIcon":this.repaint();break;default:super._optionChanged(e)}}_initDataSource(){this._useCustomChildrenLoader()?this._loadChildrenByCustomLoader(null).done((e=>{e!=null&&e.length&&this.option("items",e)})):(super._initDataSource(),this._isVirtualMode()&&this._initVirtualMode())}_initVirtualMode(){const e=this._filter;if(e.custom||(e.custom=this._dataSource.filter()),!e.internal){const{parentIdExpr:t,rootValue:i}=this.option();e.internal=[t,i]}}_useCustomChildrenLoader(){const{createChildren:e}=this.option();return B(e)&&this._isDataStructurePlain()}_loadChildrenByCustomLoader(e){const{createChildren:t}=this.option(),i=t==null?void 0:t.call(this,e);return Array.isArray(i)?S().resolve(i).promise():i&&B(i.then)?_t(i):S().resolve([]).promise()}_combineFilter(){var e;return(e=this._filter.custom)!==null&&e!==void 0&&e.length?[this._filter.custom,this._filter.internal]:this._filter.internal}_dataSourceLoadErrorHandler(){this._renderEmptyMessage()}_init(){this._filter={},super._init(),this._activeStateUnit=`.${ye}`,this._initStoreChangeHandlers()}_dataSourceChangedHandler(e){const{items:t=[]}=this.option();this._initialized&&this._isVirtualMode()&&t.length||this.option("items",e)}_removeTreeViewLoadIndicator(){this._treeViewLoadIndicator&&(this._treeViewLoadIndicator.remove(),this._treeViewLoadIndicator=null)}_createTreeViewLoadIndicator(){return this._treeViewLoadIndicator=h("<div>").addClass(q_),this._createComponent(this._treeViewLoadIndicator,yi,{}),this._treeViewLoadIndicator}_dataSourceLoadingChangedHandler(e){let t;if(this._isVirtualMode()&&(t=this._combineFilter(),this._dataSource.filter(t)),e&&!this._dataSource.isLoaded()){this.option("items",[]);const i=h("<div>").addClass(Y_);this._createTreeViewLoadIndicator().appendTo(i),this.itemsContainer().append(i),this._isVirtualMode()&&this._dataSource.filter()!==t&&this._dataSource.filter([])}else this._removeTreeViewLoadIndicator()}_initStoreChangeHandlers(){var e;const{dataStructure:t}=this.option();t==="plain"&&((e=this._dataSource)===null||e===void 0||e.store().on("inserted",(i=>{const{items:n=[]}=this.option();this.option().items=n.concat(i),this._dataAdapter.addItem(i),this._dataAdapter.isFiltered(i)&&this._updateLevel(this._parentIdGetter(i))})).on("removed",(i=>{const n=this._dataAdapter.getNodeByKey(i);if(m(n)){const{items:s=[]}=this.option(),o=this._dataAdapter.getIndexByKey(n.internalFields.key);s[o]=0,this._markChildrenItemsToRemove(n),this._removeItems(),this._dataAdapter.removeItem(i),this._updateLevel(this._parentIdGetter(n))}})))}_markChildrenItemsToRemove(e){const t=e==null?void 0:e.internalFields.childrenKeys;x(t,((i,n)=>{const{items:s=[]}=this.option(),o=this._dataAdapter.getIndexByKey(n);s[o]=0,this._markChildrenItemsToRemove(this._dataAdapter.getNodeByKey(n))}))}_removeItems(){const e=b(!0,[],this.option("items"));let t=0;x(e,((i,n)=>{n||(this.option("items").splice(i-t,1),t+=1)}))}_updateLevel(e){const t=this._getContainerByParentKey(e);this._renderNodes(this._dataAdapter.getChildrenNodes(e),t)}_getOldContainer(e){if(e.length)return e.children(`.${ut}`);const t=this.getScrollable();return t?h(t.content()).children():h()}_getContainerByParentKey(e){const t=this._dataAdapter.getNodeByKey(e),i=t?this._getNodeElement(t):h();this._getOldContainer(i).remove();const n=this._renderNodeContainer(i);if(this._isRootLevel(e)){const s=this.getScrollable();s||this._renderScrollableContainer(),h(s.content()).append(n)}return n}_isRootLevel(e){const{rootValue:t}=this.option();return e===t}_getAccessors(){const e=super._getAccessors();return e.push("hasItems"),e}_getDataAdapterOptions(){var e,t,i;const{rootValue:n,expandNodesRecursive:s=!0,selectionRequired:o=!1,dataStructure:a="tree"}=this.option();return{rootValue:n,multipleSelection:!this._isSingleSelection(),recursiveSelection:this._isRecursiveSelection(),recursiveExpansion:s,searchValue:"",selectionRequired:o,dataType:a,sort:(e=this._dataSource)===null||e===void 0?void 0:e.sort(),langParams:(t=this._dataSource)===null||t===void 0||(i=t.loadOptions)===null||i===void 0||(i=i.call(t))===null||i===void 0?void 0:i.langParams}}_initMarkup(){this._renderScrollableContainer(),this._renderEmptyMessage(this._dataAdapter.getRootNodes()),super._initMarkup(),this._setAriaRole()}_setAriaRole(){const{items:e}=this.option();e!=null&&e.length&&this.setAria({role:"tree"})}_renderContentImpl(){const e=this._renderNodeContainer();h(this.getScrollable().content()).append(e);const{items:t}=this.option();t!=null&&t.length&&(this._renderNodes(this._dataAdapter.getRootNodes(),e),this._attachExpandEvent(),this._selectAllEnabled()&&(this._createSelectAllValueChangedAction(),this._renderSelectAllItem(e)))}_isVirtualMode(){const{virtualModeEnabled:e,dataSource:t}=this.option();return!!e&&this._isDataStructurePlain()&&!!t}_isDataStructurePlain(){const{dataStructure:e}=this.option();return e==="plain"}_fireContentReadyAction(){const e=this.getDataSource(),t=e&&!e.isLoaded()||this._skipContentReadyAndItemExpanded,i=this.getScrollable();i&&pe()&&i.update(),t||super._fireContentReadyAction(),i&&pe()&&i.update()}_renderScrollableContainer(){const{useNativeScrolling:e,scrollDirection:t}=this.option();this._scrollable=this._createComponent(h("<div>").appendTo(this.$element()),it,{useNative:e,direction:t,useKeyboard:!1})}_renderNodeContainer(e){const t=h("<ul>").addClass(ut);if(this.setAria("role","group",t),e!=null&&e.length){const i=this._getItemData(e.children(`.${ye}`));this._expandedGetter(i)&&t.addClass(yt),t.appendTo(e)}return t}_createDOMElement(e,t){var i,n;const s=h("<li>").addClass(Fe).attr(En,this._encodeString(t.internalFields.key)).prependTo(e),o={role:"treeitem",label:((i=this._displayGetter)===null||i===void 0?void 0:i.call(this,t.internalFields.item))??"",level:this._getLevel(e)};return!!(t!=null&&(n=t.internalFields)!==null&&n!==void 0&&(n=n.childrenKeys)!==null&&n!==void 0&&n.length)&&(o.expanded=t.internalFields.expanded??!1),this.setAria(o,s),s}_getLevel(e){const t=e.parent();return t.hasClass("dx-scrollable-content")?1:parseInt(t.attr("aria-level")??"0",10)+1}_showCheckboxes(){const{showCheckBoxesMode:e}=this.option();return e!=="none"}_hasCustomExpanderIcons(){const{expandIcon:e,collapseIcon:t}=this.option();return!!e||!!t}_selectAllEnabled(e){const{showCheckBoxesMode:t}=this.option();return(e??t)==="selectAll"&&!this._isSingleSelection()}_renderNodes(e,t){const i=e.length-1;for(let n=i;n>=0;n-=1)this._renderItem(n,e[n],t);this._renderedItemsCount+=e.length}_renderItem(e,t,i){const n=this._createDOMElement(i,t),s=t.internalFields,o=this._showCheckboxes();return n.addClass(o?W_:G_),n.toggleClass("dx-state-invisible",s.item.visible===!1),this._hasCustomExpanderIcons()&&(n.addClass(z_),i.addClass(K_)),this.setAria("selected",s.selected,n),this._toggleSelectedClass(n,s.selected),s.disabled&&this.setAria("disabled",s.disabled,n),super._renderItem(this._renderedItemsCount+e,s.item,n),this._getNode(t.internalFields.parentKey)||n.addClass(j_),s.item.visible!==!1&&this._renderChildren(n,t),n}_setAriaSelectionAttribute(){}_renderChildren(e,t){if(!this._hasChildren(t)){this._addLeafClass(e),h("<div>").addClass(X_).appendTo(this._getItem(e));return}this._hasCustomExpanderIcons()?this._renderCustomExpanderIcons(e,t):this._renderDefaultExpanderIcons(e,t),this._shouldRenderSublevel(t.internalFields.expanded)&&this._loadSublevel(t).done((i=>{this._renderSublevel(e,this._getActualNode(t),i)}))}_shouldRenderSublevel(e){const{deferRendering:t}=this.option();return e||!t}_getActualNode(e){return this._dataAdapter.getNodeByKey(e.internalFields.key)}_hasChildren(e){return this._isVirtualMode()||this._useCustomChildrenLoader()?this._hasItemsGetter(e.internalFields.item)!==!1:super._hasChildren(e)}_loadSublevel(e){const t=S(),i=this._getChildNodes(e);return i.length?t.resolve(i):this._loadNestedItems(e).done((n=>{t.resolve(this._dataAdapter.getNodesByItems(n))})),t.promise()}_getItemExtraPropNames(){return["url","linkAttr"]}_addContent(e,t){const{html:i,url:n}=t,{_supportItemUrl:s}=this.option();if(s&&n){e.html(i);const o=this._getLinkContainer(this._getIconContainer(t),this._getTextContainer(t),t);e.append(o)}else super._addContent(e,t)}_postprocessRenderItem(e){const{itemData:t,itemElement:i}=e;this._showCheckboxes()&&this._renderCheckBox(i,this._getNode(t)),super._postprocessRenderItem(e)}_renderSublevel(e,t,i){const n=this._renderNodeContainer(e),s=new Set(t.internalFields.childrenKeys),o=i.filter((a=>s.has(a.internalFields.key)));if(this._renderNodes(o,n),o.length&&!t.internalFields.selected){const a=o[0];this._updateParentsState(a,this._getNodeElement(a))}this._normalizeIconState(e,o.length),t.internalFields.expanded&&n.addClass(yt)}_executeItemRenderAction(e,t,i){const n=this._getNode(i);this._getItemRenderAction()({itemElement:i,itemIndex:e,itemData:t,node:this._dataAdapter.getPublicNode(n)})}_addLeafClass(e){e.addClass(Bi)}_expandEventHandler(e){h(e.currentTarget.parentNode).hasClass(Bi)||this._toggleExpandedState(e.currentTarget,void 0,e)}_attachExpandEvent(){const{expandEvent:e}=this.option(),t=this._getEventNameByOption(e),i=this._itemContainer();this._detachExpandEvent(i),v.on(i,t,this._itemSelector(),this._expandEventHandler.bind(this))}_detachExpandEvent(e){v.off(e,".dxTreeView_expand",this._itemSelector())}_getEventNameByOption(e){return V(e==="click"?Q:mn,"dxTreeView_expand")}_getNode(e){if(!m(e))return null;if(Nn(e))return this._dataAdapter.getNodeByKey(e);if(ze(e)&&"internalFields"in e)return e;const t=h(e).get(0);return t?M.isElementNode(t)?this._getNodeByElement(t):this._dataAdapter.getNodeByItem(t):null}_getNodeByElement(e){const i=h(e).closest(`.${Fe}`).attr(En);if(!m(i))return null;const n=this._decodeString(i);return this._dataAdapter.getNodeByKey(n)}_toggleExpandedState(e,t,i){const n=this._getNode(e);if(!n)return S().reject().promise();if(n.internalFields.disabled)return S().reject().promise();const s=n.internalFields.expanded;if(s===t)return S().resolve().promise();if(this._hasChildren(n)){const a=this._getNodeElement(n);if(a.find(`.${Ys}:not(.dx-state-invisible)`).length)return S().reject().promise();!s&&!this._nodeHasRenderedChildren(a)&&this._createLoadIndicator(a)}const o=t??!s;return this._dataAdapter.toggleExpansion(n.internalFields.key,o),this._updateExpandedItemsUI(n,o,i)}_nodeHasRenderedChildren(e){return e.children(`.${ut}`).not(":empty").length}_getItem(e){return e.children(`.${ye}`).eq(0)}_createLoadIndicator(e){const t=this._getItem(e);this._createComponent(h("<div>").addClass(Ys),yi,{}).$element().appendTo(t),t.children(`.${Ni},.${Xs}`).hide()}_renderExpanderIcon(e,t,i,n){i.appendTo(this._getItem(e)),i.addClass(n),t.internalFields.disabled&&i.addClass("dx-state-disabled"),this._renderToggleItemVisibilityIconClick(i,t)}_renderDefaultExpanderIcons(e,t){const i=this._getItem(e),n=h("<div>").addClass(Ni).appendTo(i);t.internalFields.expanded&&(n.addClass(Ha),e.parent().addClass(yt)),t.internalFields.disabled&&n.addClass("dx-state-disabled"),this._renderToggleItemVisibilityIconClick(n,t)}_renderCustomExpanderIcons(e,t){const{expandIcon:i,collapseIcon:n}=this.option(),s=Ti(i??n)??h(),o=Ti(n??i)??h();this._renderExpanderIcon(e,t,s,Xs),this._renderExpanderIcon(e,t,o,js);const a=t.internalFields.expanded;a&&e.parent().addClass(yt),this._toggleCustomExpanderIcons(s,o,a)}_renderToggleItemVisibilityIconClick(e,t){const i=V(Q,this.NAME);v.off(e,i),v.on(e,i,(n=>(this._toggleExpandedState(t.internalFields.key,void 0,n),!1)))}_toggleCustomExpanderIcons(e,t,i){t.toggle(i),e.toggle(!i)}_updateExpandedItemsUI(e,t,i){const n=this._getNodeElement(e),s=!n.length||t&&n.is(":hidden"),{expandNodesRecursive:o}=this.option();if(o&&s){const c=this._getNode(e.internalFields.parentKey);c&&this._updateExpandedItemsUI(c,t,i)}if(!this._hasCustomExpanderIcons())this._getItem(n).children(`.${Ni}`).toggleClass(Ha,t);else if(this._nodeHasRenderedChildren(n)){const c=this._getItem(n),u=c.children(`.${Xs}`),p=c.children(`.${js}`);this._toggleCustomExpanderIcons(u,p,t)}const a=n.children(`.${ut}`),l=a.length>0,d=S();return!t||l&&!a.is(":empty")?(this._animateNodeContainer(e,t,i,d),d.promise()):e.internalFields.childrenKeys.length===0&&(this._isVirtualMode()||this._useCustomChildrenLoader())?(this._loadNestedItemsWithUpdate(e,t,i,d),d.promise()):(this._renderSublevel(n,e,this._getChildNodes(e)),this._fireContentReadyAction(),this._animateNodeContainer(e,t,i,d),d.promise())}_loadNestedItemsWithUpdate(e,t,i,n){const s=this._getNodeElement(e);this._loadNestedItems(e).done((o=>{const a=this._getActualNode(e);if(this._renderSublevel(s,a,this._dataAdapter.getNodesByItems(o)),!(o!=null&&o.length)){n.resolve();return}this._fireContentReadyAction(),this._animateNodeContainer(a,t,i,n)}))}_loadNestedItems(e){if(this._useCustomChildrenLoader()){const i=this._dataAdapter.getPublicNode(e);return this._loadChildrenByCustomLoader(i).done((n=>{this._areNodesExists(n)||this._appendItems(n)}))}if(!this._isVirtualMode())return S().resolve([]).promise();const{parentIdExpr:t}=this.option();return this._filter.internal=[t,e.internalFields.key],this._dataSource.filter(this._combineFilter()),this._dataSource.load().done((i=>{this._areNodesExists(i)||this._appendItems(i)}))}_areNodesExists(e){const t=this.keyOf(e[0]),i=this._dataAdapter.getFullData();return!!this._dataAdapter.getNodeByKey(t,i)}_appendItems(e){const{items:t=[]}=this.option();this.option().items=t.concat(e),this._initDataAdapter()}_animateNodeContainer(e,t,i,n){const s=this._getNodeElement(e),o=s.children(`.${ut}`);e&&n&&o.length===0&&n.resolve(),o.addClass(yt);const a=X(o),{animationEnabled:l}=this.option();ve.stop(o.get(0),!0),ve.animate(o.get(0),{type:"custom",duration:l?400:0,from:{maxHeight:t?0:a},to:{maxHeight:t?a:0},complete:()=>{o.css("maxHeight","none"),o.toggleClass(yt,t),this.setAria("expanded",t,s),this.getScrollable().update(),this._fireExpandedStateUpdatedEvent(t,e,i),n&&n.resolve()}})}_fireExpandedStateUpdatedEvent(e,t,i){if(!this._hasChildren(t)||this._skipContentReadyAndItemExpanded)return;const n=e?"onItemExpanded":"onItemCollapsed";if(m(i))this._itemDXEventHandler(i,n,{node:this._dataAdapter.getPublicNode(t)});else{const s=this._getNodeElement(t),o={event:i,node:this._dataAdapter.getPublicNode(t)};this._itemEventHandler(s,n,o)}}_normalizeIconState(e,t){const i=e.find(`.${Ys}`);if(i.length){var n;(n=yi.getInstance(i))===null||n===void 0||n.option("visible",!1)}const o=this._getItem(e).children(`.${js},.${Ni}`);if(t){o.show();return}o.removeClass(Ni),e.addClass(Bi)}_emptyMessageContainer(){const e=this.getScrollable();return e?h(e.content()):super._emptyMessageContainer()}_renderContent(){const{items:e}=this.option();e!=null&&e.length&&(this._contentAlreadyRendered=!0),super._renderContent()}_renderSelectAllItem(e){const{selectAllText:t,focusStateEnabled:i}=this.option(),n=e??this.$element().find(`.${ut}`).first();this._$selectAllItem=h("<div>").addClass(Sn);const s=this._dataAdapter.isAllSelected();this._createComponent(this._$selectAllItem,So,{value:s,elementAttr:{"aria-label":w.format("dxList-selectAll")},text:t,focusStateEnabled:i,onValueChanged:o=>{this._onSelectAllCheckboxValueChanged(o)},onInitialized:o=>{const{component:a}=o;a.registerKeyHandler("enter",(()=>{const{value:l}=a.option();a.option("value",!l)}))}}),this._toggleSelectedClass(this._$selectAllItem,s),n.before(this._$selectAllItem)}_onSelectAllCheckboxValueChanged(e){this._toggleSelectAll(e),this._fireSelectAllValueChanged(e.value)}_toggleSelectAll(e){this._dataAdapter.toggleSelectAll(e.value),this._updateItemsUI(),this._fireSelectionChanged()}_renderCheckBox(e,t){const i=h("<div>").appendTo(e);this._createComponent(i,So,{value:t==null?void 0:t.internalFields.selected,onValueChanged:n=>{this._changeCheckboxValue(n)},focusStateEnabled:!1,elementAttr:{"aria-label":w.format("CheckState")},disabled:this._disabledGetter(t)})}_toggleSelectedClass(e,t){e.toggleClass("dx-state-selected",!!t)}_toggleNodeDisabledState(e,t){const i=this._getNodeElement(e),n=i.find(`.${ye}`).eq(0);this._dataAdapter.toggleNodeDisabledState(e.internalFields.key,t),n.toggleClass("dx-state-disabled",!!t),this._showCheckboxes()&&this._getCheckBoxInstance(i).option("disabled",!!t)}_itemOptionChanged(e,t,i){const n=this._dataAdapter.getNodeByItem(e),{disabledExpr:s}=this.option();n&&t===s&&this._toggleNodeDisabledState(n,!!i)}_changeCheckboxValue(e){const t=h(e.element).closest(`.${Fe}`),i=this._getItem(t),n=this._getItemData(i),s=this._getNodeByElement(i),{value:o}=e;s&&s.internalFields.selected===o||this._updateItemSelection(o,n,e.event)}_isSingleSelection(){const{selectionMode:e}=this.option();return e==="single"}_isRecursiveSelection(){const{selectionMode:e,selectNodesRecursive:t}=this.option();return!!t&&e!=="single"}_isLastSelectedBranch(e,t,i){const n=t.indexOf(e.key);return n>=0&&t.splice(n,1),i&&x(e.children,((s,o)=>{this._isLastSelectedBranch(o,t,!0)})),e.parent&&this._isLastSelectedBranch(e.parent,t),t.length===0}_isLastRequired(e){const{selectionRequired:t}=this.option(),i=this._isSingleSelection(),n=this.getSelectedNodeKeys();return t?i?n.length===1:this._isLastSelectedBranch(e.internalFields.publicNode,n.slice(),!0):!1}_updateItemSelection(e,t,i){const n=this._getNode(t);if(!n||n.visible===!1)return!1;if(n.internalFields.selected===e)return!0;if(!e&&this._isLastRequired(n)){if(this._showCheckboxes()){const a=this._getNodeElement(n);this._getCheckBoxInstance(a).option("value",!0)}return!1}if(e&&this._isSingleSelection()){const a=this.getSelectedNodeKeys();x(a,((l,d)=>{this._dataAdapter.toggleSelection(d,!1),this._updateItemsUI(),this._fireItemSelectionChanged(this._getNode(d))}))}this._dataAdapter.toggleSelection(n.internalFields.key,e);const s=this._dataAdapter.isAllSelected(),o=this._selectAllEnabled()&&this._$selectAllItem.dxCheckBox("instance").option("value")!==s;return this._updateItemsUI(),this._fireItemSelectionChanged(n,i),this._fireSelectionChanged(),o&&this._fireSelectAllValueChanged(s),!0}_fireItemSelectionChanged(e,t){const i=t??this._findItemElementByItem(e.internalFields.item);(t?this._itemDXEventHandler:this._itemEventHandler).call(this,i,"onItemSelectionChanged",{node:this._dataAdapter.getPublicNode(e),itemData:e==null?void 0:e.internalFields.item})}_getCheckBoxInstance(e){return this._getItem(e).children(".dx-checkbox").dxCheckBox("instance")}_updateItemsUI(){const e={};if(x(this._dataAdapter.getData(),((t,i)=>{const n=this._getNodeElement(i,e),s=i.internalFields.selected;n.length&&(this._toggleSelectedClass(n,s),this.setAria("selected",s,n),this._showCheckboxes()&&this._getCheckBoxInstance(n).option("value",s))})),this._selectAllEnabled()){const t=this._$selectAllItem.dxCheckBox("instance");t.option("onValueChanged",void 0),t.option("value",this._dataAdapter.isAllSelected()),t.option("onValueChanged",this._onSelectAllCheckboxValueChanged.bind(this))}}_updateParentsState(e,t){if(!t||!e)return;const i=this._dataAdapter.getNodeByKey(e.internalFields.parentKey),n=h(t.parents(`.${Fe}`)[0]);if(this._showCheckboxes()){var s;const a=i==null?void 0:i.internalFields.selected;(s=this._getCheckBoxInstance(n))===null||s===void 0||s.option("value",a),this._toggleSelectedClass(n,a)}const{rootValue:o}=this.option();(i==null?void 0:i.internalFields.parentKey)!==o&&this._updateParentsState(i,n)}_itemEventHandlerImpl(e,t,i){const n=h(e).closest(`.${Fe}`).children(`.${ye}`);return t(b(this._extendActionArgs(n),i))}_itemContextMenuHandler(e){this._createEventHandler("onItemContextMenu",e)}_itemHoldHandler(e){this._createEventHandler("onItemHold",e)}_createEventHandler(e,t){const i=this._getNodeByElement(t.currentTarget);this._itemDXEventHandler(t,e,{node:this._dataAdapter.getPublicNode(i)})}_itemClass(){return ye}_itemDataKey(){return U_}_attachClickEvent(){const e=this._itemContainer();this._detachClickEvent(e);const{clickEventNamespace:t,itemSelector:i,pointerDownEventNamespace:n,nodeSelector:s}=this._getItemClickEventData();v.on(e,t,i,(o=>{h(o.target).hasClass("dx-checkbox-icon")||h(o.target).hasClass("dx-checkbox")||this._processItemClick(o,h(o.currentTarget))})),v.on(e,n,s,(o=>{this._itemPointerHandler(o)}))}_detachClickEvent(e){const{clickEventNamespace:t,itemSelector:i,pointerDownEventNamespace:n,nodeSelector:s}=this._getItemClickEventData();v.off(e,t,i),v.off(e,n,s)}_getItemClickEventData(){const e=`.${this._itemClass()}`,t=`.${Fe}, .${Sn}`,i=V(Q,this.NAME),n=V(Z.down,this.NAME);return{clickEventNamespace:i,itemSelector:e,pointerDownEventNamespace:n,nodeSelector:t}}_itemClick(e){const{event:t,itemData:i}=e,s=((t==null?void 0:t.target[0])||(t==null?void 0:t.target)).getElementsByClassName("dx-item-url")[0];i.url&&s&&this._clickByLink(s)}_processItemClick(e,t){const i=this._getItemData(t),n=this._getNodeByElement(t);if(!n)return;this._itemDXEventHandler(e,"onItemClick",{node:this._dataAdapter.getPublicNode(n)},{beforeExecute:o=>{this._itemClick(o.args[0])}});const{selectByClick:s}=this.option();s&&!e.isDefaultPrevented()&&this._updateItemSelection(!n.internalFields.selected,i,e)}_updateSelectionToFirstItem(e,t){let i=t;for(;i>=0;){const n=h(e[i]);this._updateItemSelection(!0,n.find(`.${ye}`).get(0)),i-=1}}_updateSelectionToLastItem(e,t){const{length:i}=e;let n=t;for(;n<i;){const s=h(e[n]);this._updateItemSelection(!0,s.find(`.${ye}`).get(0)),n+=1}}focus(){const{items:e=[]}=this.option();if(this._selectAllEnabled()&&e.length){v.trigger(this._$selectAllItem,"focus");return}super.focus()}_focusInHandler(e){this._updateFocusState(e,!0);const t=h(e.target).hasClass(Sn);if(t||this.option("focusedElement")){clearTimeout(this._setFocusedItemTimeout),this._setFocusedItemTimeout=setTimeout((()=>{const{focusedElement:n}=this.option(),s=t?$(h(this._$selectAllItem)):h(n);this._setFocusedItem(h(s))}));return}const i=this._getActiveItem();this.option("focusedElement",$(i.closest(`.${Fe}`)))}_itemPointerHandler(e){const{focusStateEnabled:t}=this.option();if(!t)return;const i=h(e.target).closest(`.${Fe}, .${Sn}`);if(!i.length)return;const n=i.hasClass("dx-state-disabled")?null:i;this.option("focusedElement",$(n))}_findNonDisabledNodes(e){return e.not(`:has(>.${ye}.dx-state-disabled)`)}_moveFocus(e,t){const{rtlEnabled:i}=this.option(),n=i?"right":"left",s=i?"left":"right";this.$element().find(`.${ut}`).each(((a,l)=>(ve.stop(l,!0),!0)));const o=this._nodeElements();if(o!=null&&o.length)switch(e){case"up":{const a=this._prevItem(o);this.option("focusedElement",$(a));const l=this._getNodeItemElement(a);this.getScrollable().scrollToElement(l),t.shiftKey&&this._showCheckboxes()&&this._updateItemSelection(!0,l);break}case"down":{const a=this._nextItem(o);this.option("focusedElement",$(a));const l=this._getNodeItemElement(a);this.getScrollable().scrollToElement(l),t.shiftKey&&this._showCheckboxes()&&this._updateItemSelection(!0,l);break}case"first":{const a=o.first();t.shiftKey&&this._showCheckboxes()&&this._updateSelectionToFirstItem(o,o.index(this._prevItem(o))),this.option("focusedElement",$(a)),this.getScrollable().scrollToElement(this._getNodeItemElement(a));break}case"last":{const a=o.last();t.shiftKey&&this._showCheckboxes()&&this._updateSelectionToLastItem(o,o.index(this._nextItem(o))),this.option("focusedElement",$(a)),this.getScrollable().scrollToElement(this._getNodeItemElement(a));break}case s:this._expandFocusedContainer();break;case n:this._collapseFocusedContainer();break;default:super._moveFocus(e,t)}}_getNodeItemElement(e){return e.find(`.${ye}`).get(0)}_nodeElements(){return this.$element().find(`.${Fe}`).not(":hidden")}_expandFocusedContainer(){const{focusedElement:e}=this.option(),t=h(e);if(!t.length||t.hasClass(Bi))return;if(t.find(`.${ut}`).eq(0).hasClass(yt)){const s=this._nextItem(this._findNonDisabledNodes(this._nodeElements()));this.option("focusedElement",$(s)),this.getScrollable().scrollToElement(this._getNodeItemElement(s));return}const n=this._getNodeByElement(this._getItem(t));this._toggleExpandedState(n,!0)}_getClosestNonDisabledNode(e){let t=e;do t=t.parent().closest(`.${Fe}`);while(t.length&&(i=t,i.children(`.${ye}.dx-state-disabled`).length>0));var i;return t}_collapseFocusedContainer(){const{focusedElement:e}=this.option(),t=h(e);if(!t.length)return;const i=t.find(`.${ut}`).eq(0);if(!t.hasClass(Bi)&&i.hasClass(yt)){const n=this._getNodeByElement(this._getItem(t));this._toggleExpandedState(n,!1)}else{const n=this._getClosestNonDisabledNode(t);n.length&&this.option("focusedElement",$(n)),this.getScrollable().scrollToElement(this._getNodeItemElement(n))}}_encodeString(e){return W(e)?encodeURI(e):e}_decodeString(e){return W(e)?decodeURI(e):e}getScrollable(){return this._scrollable}updateDimensions(){const e=S(),t=this.getScrollable();return t?t.update().done((()=>{e.resolveWith(this)})):e.resolveWith(this),e.promise()}selectItem(e){return this._updateItemSelection(!0,e)}unselectItem(e){return this._updateItemSelection(!1,e)}expandItem(e){return this._toggleExpandedState(e,!0)}collapseItem(e){return this._toggleExpandedState(e,!1)}getNodes(){return this._dataAdapter.getTreeNodes()}getSelectedNodes(){return this.getSelectedNodeKeys().map((e=>{const t=this._dataAdapter.getNodeByKey(e);return this._dataAdapter.getPublicNode(t)}))}getSelectedNodeKeys(){return this._dataAdapter.getSelectedNodesKeys()}selectAll(){this._selectAllEnabled()?this._$selectAllItem.dxCheckBox("instance").option("value",!0):this._toggleSelectAll({value:!0})}unselectAll(){this._selectAllEnabled()?this._$selectAllItem.dxCheckBox("instance").option("value",!1):this._toggleSelectAll({value:!1})}_allItemsExpandedHandler(){this._skipContentReadyAndItemExpanded=!1,this._fireContentReadyAction()}expandAll(){const e=this._dataAdapter.getData(),t=[];this._skipContentReadyAndItemExpanded=!0,e.forEach((i=>t.push(this._toggleExpandedState((i==null?void 0:i.internalFields.key)??null,!0)))),Promise.allSettled(t).then((()=>{var i;return(i=this._allItemsExpandedHandler)===null||i===void 0?void 0:i.call(this)}))}collapseAll(){x(this._dataAdapter.getExpandedNodesKeys(),((e,t)=>{this._toggleExpandedState(t,!1)}))}scrollToItem(e){const t=this._getNode(e);if(!t)return S().reject().promise();const i=[];let n=t.internalFields.publicNode.parent;for(;n!=null;)n.expanded||i.push(n.key),n=n.parent;const s=S();return this._expandNodes(i.reverse()).always((()=>{const o=this._getNodeElement(t);o!=null&&o.length?(this.scrollToElementTopLeft(o[0]),s.resolve()):s.reject()})),s.promise()}scrollToElementTopLeft(e){const t=this.getScrollable(),{scrollDirection:i,rtlEnabled:n}=this.option(),s={top:0,left:0},o=Dp(Rp,e);if(i!==Eo){const a=h(t.container()).get(0);s.left=n?o.left+e.offsetWidth-a.clientWidth:o.left}i!==Bd&&(s.top=o.top),t.scrollTo(s)}_expandNodes(e){if(!e||e.length===0)return S().resolve().promise();const t=S(),i=e.map((n=>this.expandItem(n)));return O.apply(h,i).done((()=>t.resolve())).fail((()=>t.reject())),t.promise()}_dispose(){super._dispose(),clearTimeout(this._setFocusedItemTimeout),this._allItemsExpandedHandler=null}}ms.setEditorClass(tr);class _n extends Z_{_getDefaultOptions(){return T({},super._getDefaultOptions(),{searchValue:"",searchEnabled:!1,searchEditorOptions:{}})}_getSearchBoxControllerOptions(){const{tabIndex:e,searchEnabled:t,searchValue:i,searchTimeout:n,searchEditorOptions:s}=this.option();return{tabIndex:e,searchEnabled:t,searchValue:i,searchTimeout:n,searchEditorOptions:s,onValueChanged:o=>{this.option("searchValue",o)}}}_init(){this._searchBoxController=new ms,super._init()}_initMarkup(){this._searchBoxController.render("dx-treeview",this.$element(),this._getSearchBoxControllerOptions(),this._createComponent.bind(this)),super._initMarkup()}_getAriaTarget(){const{searchEnabled:e}=this.option();return e?this._itemContainer(!0):super._getAriaTarget()}getSearchBoxController(){return this._searchBoxController}_optionChanged(e){const{name:t}=e;switch(t){case"searchEnabled":case"searchEditorOptions":this._invalidate();break;case"searchValue":this._showCheckboxes()&&this._isRecursiveSelection()&&this._removeSelection(),this._initDataAdapter(),this._updateSearch(),this._repaintContainer(),this.option("focusedElement",null);break;case"searchExpr":this._initDataAdapter(),this.repaint();break;case"searchMode":{const{expandNodesRecursive:i}=this.option();i?this._updateDataAdapter():this._initDataAdapter(),this.repaint();break}case"searchTimeout":break;default:super._optionChanged(e)}}_updateDataAdapter(){this._setOptionWithoutOptionChange("expandNodesRecursive",!1),this._initDataAdapter(),this._setOptionWithoutOptionChange("expandNodesRecursive",!0)}_getDataAdapterOptions(){const{searchValue:e="",searchMode:t="contains",searchExpr:i}=this.option();return T({},super._getDataAdapterOptions(),{searchValue:e,searchMode:t,searchExpr:i})}_getNodeContainer(){return this.$element().find(".dx-treeview-node-container").first()}_updateSearch(){var e;const t=this._getSearchBoxControllerOptions();(e=this._searchBoxController)===null||e===void 0||e.updateEditorOptions(t)}_repaintContainer(){const e=this._getNodeContainer();let t=[];e.length&&(e.empty(),t=this._dataAdapter.getRootNodes(),this._renderEmptyMessage(t),this._renderNodes(t,e),this._fireContentReadyAction())}_updateFocusState(e,t){this.option("searchEnabled")&&this._toggleFocusClass(t,this.$element()),super._updateFocusState(e,t)}_focusTarget(){const{searchEnabled:e}=this.option();return this._itemContainer(e)}focus(){if(!this.option("focusedElement")&&this.option("searchEnabled")){var e;(e=this._searchBoxController)===null||e===void 0||e.focus();return}super.focus()}_cleanItemContainer(){var e;(e=this._searchBoxController)===null||e===void 0||e.remove(),this.$element().empty()}_itemContainer(e,t){const i=t??this._selectAllEnabled(),{items:n=[]}=this.option();return i&&n.length?this._getNodeContainer():this._scrollable&&e?h(this._scrollable.content()):super._itemContainer()}_addWidgetClass(){this.$element().addClass(this._widgetClass())}_cleanAria(){const e=this.$element();this.setAria({role:null,activedescendant:null},e),e.attr("tabIndex",null)}_refresh(){var e;(e=this._searchBoxController)===null||e===void 0||e.resolveValueChange(),super._refresh()}_clean(){this._cleanAria(),super._clean()}dispose(){var e;(e=this._searchBoxController)===null||e===void 0||e.dispose(),super.dispose()}}_e("dxTreeView",_n);const Q_={columnChooser:{enabled:!1,search:{enabled:!1,timeout:500,editorOptions:{}},selection:{allowSelectAll:!1,selectByClick:!1,recursive:!1},position:void 0,sortOrder:void 0,mode:"dragAndDrop",width:250,height:260,title:w.format("dxDataGrid-columnChooserTitle"),emptyPanelText:w.format("dxDataGrid-columnChooserEmptyText"),container:void 0}},J_="column-chooser-mode-drag",ef="column-chooser-mode-select",tf=["showInColumnChooser","caption","allowHiding","visible","cssClass","ownerBand"],nf=function(r,e){const t=[],i=r.isSelectMode(),n=r.option("columnChooser.selection.recursive");return e.length&&x(e,((s,o)=>{const a={text:o.caption,cssClass:o.cssClass,allowHiding:o.allowHiding,expanded:!0,id:o.index,disabled:o.allowHiding===!1,parentId:m(o.ownerBand)?o.ownerBand:null},l=n&&o.hasColumns;i&&!l&&(a.selected=o.visible),t.push(a)})),t};class sf extends j.ViewController{init(){super.init(),this._rowsView=this.getView("rowsView")}renderShowColumnChooserButton(e){const t=this,i=t.addWidgetPrefix("column-chooser-button"),n=t.option("columnChooser.enabled"),s=e.find(`.${i}`);let o;n?s.length?s.show():(o=h("<div>").addClass(i).appendTo(e),t._createComponent(o,Ze,{icon:"column-chooser",onClick(){t.getView("columnChooserView").showColumnChooser()},hint:t.option("columnChooser.title"),integrationOptions:{}})):s.hide()}getPosition(){var e;const t=this.option("columnChooser.position");return m(t)?t:{my:"right bottom",at:"right bottom",of:(e=this._rowsView)===null||e===void 0?void 0:e.element(),collision:"fit",offset:"-2 -2",boundaryOffset:"2 2"}}}class of extends xs{optionChanged(e){e.name==="columnChooser"?(this._initializePopupContainer(),this.render(null,"full")):super.optionChanged(e)}publicMethods(){return["showColumnChooser","hideColumnChooser"]}_resizeCore(){}_isWinDevice(){return!!G.real().win}_initializePopupContainer(){const e=this,t=e.addWidgetPrefix("column-chooser"),i=e.element().addClass(t),n=e.option("columnChooser"),s=this._columnChooserController.getPosition(),o={visible:!1,shading:!1,showCloseButton:!0,dragEnabled:!0,resizeEnabled:!0,wrapperAttr:{class:t},toolbarItems:[{text:n.title,toolbar:"top",location:"before"}],position:s,width:n.width,height:n.height,rtlEnabled:e.option("rtlEnabled"),onHidden(){e._isWinDevice()&&h("body").removeClass(e.addWidgetPrefix("notouch-action"))},container:n.container,_loopFocus:!0};m(this._popupContainer)?this._popupContainer.option(o):(e._popupContainer=e._createComponent(i,ni,o),e._popupContainer.on("optionChanged",(a=>{a.name==="visible"&&e.renderCompleted.fire()}))),this.setPopupAttributes()}setPopupAttributes(){const e=this.isSelectMode(),t=this._columnsController.isBandColumnsUsed();this._popupContainer.setAria({role:"dialog",label:w.format("dxDataGrid-columnChooserTitle")}),this._popupContainer.$wrapper().toggleClass(this.addWidgetPrefix(J_),!e).toggleClass(this.addWidgetPrefix(ef),e),this._popupContainer.$content().addClass(this.addWidgetPrefix("column-chooser-list")),e&&!t&&this._popupContainer.$content().addClass(this.addWidgetPrefix("column-chooser-plain"))}_renderCore(e){if(this._popupContainer){const t=!this.isSelectMode();!this._columnChooserList||e==="full"?this._renderTreeView():t&&this._updateItems()}}_renderTreeView(){var e,t,i;const n=this,s=this._popupContainer.$content(),o=this.option("columnChooser"),a=this.isSelectMode(),l=m(o.allowSearch)?o.allowSearch:(e=o.search)===null||e===void 0?void 0:e.enabled,d=m(o.searchTimeout)?o.searchTimeout:(t=o.search)===null||t===void 0?void 0:t.timeout,c={dataStructure:"plain",activeStateEnabled:!0,focusStateEnabled:!0,hoverStateEnabled:!0,itemTemplate:"item",showCheckBoxesMode:"none",rootValue:null,searchEnabled:l,searchTimeout:d,searchEditorOptions:(i=o.search)===null||i===void 0?void 0:i.editorOptions};if(this._isWinDevice()&&(c.useNativeScrolling=!1),b(c,a?this._prepareSelectModeConfig():this._prepareDragModeConfig()),this._columnChooserList)c.searchEnabled||(c.searchValue=""),this._columnChooserList.option(c),this._updateItems();else{this._columnChooserList=this._createComponent(s,_n,c),this._updateItems();let u=0;this._columnChooserList.on("optionChanged",(p=>{u=p.component.getScrollable().scrollTop()})),this._columnChooserList.on("contentReady",(p=>{je((()=>{p.component.getScrollable().scrollTo({y:u}),n.renderCompleted.fire()}))}))}}_prepareDragModeConfig(){return{noDataText:this.option("columnChooser").emptyPanelText,activeStateEnabled:!1,hoverStateEnabled:!1,itemTemplate(t,i,n){h(n).text(t.text).parent().addClass(t.cssClass).addClass("dx-column-chooser-item")}}}_prepareSelectModeConfig(){const e=this,t=this.option("columnChooser.selection")??{};let i=!1;return{selectByClick:t.selectByClick,selectNodesRecursive:t.recursive,showCheckBoxesMode:t.allowSelectAll?"selectAll":"normal",onSelectionChanged:n=>{if(i)return;const s=(o=>{const a=(l,d)=>l.reduce(((c,u)=>(c.push(u),u.children.length&&a(u.children,c),c)),d);return a(o,[])})(n.component.getNodes());n.component.beginUpdate(),i=!0,((o,a)=>{a.filter((l=>l.itemData.allowHiding===!1)).forEach((l=>o.component.selectItem(l.key)))})(n,s),n.component.endUpdate(),i=!1,e.component.beginUpdate(),this._isUpdatingColumnVisibility=!0,(o=>{o.forEach((a=>{const l=a.itemData.id,d=a.selected!==!1;e._columnsController.columnOption(l,"visible",d)}))})(s),e.component.endUpdate(),this._isUpdatingColumnVisibility=!1}}}_updateItems(){const e=this.isSelectMode(),t=this._columnsController.getChooserColumns(e),i=nf(this,t);this._columnChooserList.option("items",i)}_updateItemsSelection(e){const t=e==null?void 0:e.map((i=>this._columnsController.columnOption(i)));this._columnChooserList.beginUpdate(),t==null||t.forEach((i=>{let{visible:n,index:s}=i;n?this._columnChooserList.selectItem(s):this._columnChooserList.unselectItem(s)})),this._columnChooserList.endUpdate()}_columnOptionChanged(e){super._columnOptionChanged(e);const{optionNames:t}=e,i=this.isSelectMode(),n=this.isColumnVisibilityOnlyUpdated(t),s=this._isUpdatingColumnVisibility&&n;if(!i||!this._columnChooserList||s)return;const o=m(e.columnIndex)?[e.columnIndex]:e.columnIndices;(tf.some((d=>t[d]))||e.changeTypes.columns&&t.all)&&(this._updateItemsSelection(o),n||this._updateItems())}isColumnVisibilityOnlyUpdated(e){const t=Object.keys(e??{}).filter((i=>i!=="length"));return t.length===1&&t[0]==="visible"}getColumnElements(){var e;const t=[],i=this.isSelectMode(),n=this._columnsController.getChooserColumns(i),s=(e=this._popupContainer)===null||e===void 0?void 0:e.$content(),o=s==null?void 0:s.find(".dx-treeview-node");return o&&n.forEach((a=>{const l=o.filter(`[data-item-id = '${a.index}']`),d=l.length?l.children(".dx-column-chooser-item").get(0):null;t.push(d)})),h(t)}getName(){return"columnChooser"}getColumns(){return this._columnsController.getChooserColumns()}allowDragging(e){const t=this._columnsController.isParentColumnVisible(e.index),i=!e.visible&&e.allowHiding;return this.isColumnChooserVisible()&&t&&i}allowColumnHeaderDragging(e){return!this.isSelectMode()&&this.isColumnChooserVisible()&&e.allowHiding}getBoundingRect(){var e;const t=(e=this._popupContainer)===null||e===void 0?void 0:e.$overlayContent();if(t!=null&&t.is(":visible")){const i=t.offset();return{left:i.left,top:i.top,right:i.left+ge(t),bottom:i.top+Y(t)}}return null}showColumnChooser(){this._popupContainer||(this._initializePopupContainer(),this.render()),this._popupContainer.show(),this._isWinDevice()&&h("body").addClass(this.addWidgetPrefix("notouch-action"))}hideColumnChooser(){this._popupContainer&&this._popupContainer.hide()}isColumnChooserVisible(){const e=this._popupContainer;return e==null?void 0:e.option("visible")}isSelectMode(){return this.option("columnChooser.mode")==="select"}hasHiddenColumns(){const e=this.option("columnChooser.enabled"),t=this.getColumns().filter((i=>!i.visible));return e&&t.length}}const rf=r=>class extends r{_getToolbarItems(){const e=super._getToolbarItems();return this._appendColumnChooserItem(e)}_appendColumnChooserItem(e){const t=this;if(t.option("columnChooser.enabled")){const n=function(){t.component.getView("columnChooserView").showColumnChooser()},s=function(l){h(l.element).addClass(t._getToolbarButtonClass(t.addWidgetPrefix("column-chooser-button")))},o=t.option("columnChooser.title"),a={widget:"dxButton",options:{icon:"column-chooser",onClick:n,hint:o,text:o,onInitialized:s,elementAttr:{"aria-haspopup":"dialog"}},showText:"inMenu",location:"after",name:"columnChooserButton",locateInMenu:"auto",sortIndex:40};e.push(a)}return e}optionChanged(e){e.name==="columnChooser"?(this._invalidate(),e.handled=!0):super.optionChanged(e)}},af=r=>class extends r{allowMoveColumn(e,t,i,n){return this.option("columnChooser.mode")==="select"&&n==="columnChooser"?!1:super.allowMoveColumn(e,t,i,n)}},lf=r=>class extends r{allowDragging(e){const t=!this._columnChooserView.isSelectMode(),i=this._columnChooserView.isColumnChooserVisible();return t&&i&&e.allowHiding||super.allowDragging(e)}},kS={defaultOptions:()=>Q_,controllers:{columnChooser:sf},views:{columnChooserView:of},extenders:{views:{headerPanel:rf,columnHeadersView:lf},controllers:{columns:af}}},Xe={detailRow:"dx-master-detail-row",detailCell:"dx-master-detail-cell",detailContainer:"master-detail-container",cellFocusDisabledClass:"dx-cell-focus-disabled",rowLines:"dx-row-lines"};function Ao(r){const e=r==null?void 0:r.rowType;return e==="detail"||e==="detailAdaptive"}const df=r=>class extends r{_getExpandColumnsCore(){const e=super._getExpandColumnsCore();return this.option("masterDetail.enabled")&&e.push({type:"detailExpand",cellTemplate:y.getExpandCellTemplate()}),e}},Zs=function(r){r._expandedItems=[],r._isExpandAll=r.option("masterDetail.autoExpandAll")},cf=r=>class extends r{init(){Zs(this),super.init()}expandAll(e){const t=this;e<0?(t._isExpandAll=!0,t._expandedItems=[],t.updateItems()):super.expandAll.apply(t,arguments)}collapseAll(e){const t=this;e<0?(t._isExpandAll=!1,t._expandedItems=[],t.updateItems()):super.collapseAll.apply(t,arguments)}isRowExpandedHack(){return super.isRowExpanded.apply(this,arguments)}isRowExpanded(e){const t=this,i=y.getIndexByKey(e,t._expandedItems);return Array.isArray(e)?super.isRowExpanded.apply(t,arguments):!!(t._isExpandAll^(i>=0&&t._expandedItems[i].visible))}_getRowIndicesForExpand(e){const t=this.getRowIndexByKey(e);return[t,t+1]}_changeRowExpandCore(e){const t=this;let i;if(Array.isArray(e))i=super._changeRowExpandCore.apply(t,arguments);else{const n=y.getIndexByKey(e,t._expandedItems);if(n>=0){const{visible:s}=t._expandedItems[n];t._expandedItems[n].visible=!s}else t._expandedItems.push({key:e,visible:!0});t.updateItems({changeType:"update",rowIndices:t._getRowIndicesForExpand(e)}),i=new S().resolve()}return i}_processDataItemHack(){return super._processDataItem.apply(this,arguments)}_processDataItem(e,t){const i=super._processDataItem.apply(this,arguments);return i.isExpanded=this.isRowExpanded(i.key),t.detailColumnIndex===void 0&&(t.detailColumnIndex=-1,x(t.visibleColumns,((n,s)=>{if(s.command==="expand"&&!m(s.groupIndex))return t.detailColumnIndex=n,!1}))),t.detailColumnIndex>=0&&(i.values[t.detailColumnIndex]=i.isExpanded),i}_processItemsHack(){return super._processItems.apply(this,arguments)}_processItems(e,t){const i=this,{changeType:n}=t,s=[];return e=super._processItems.apply(i,arguments),n==="loadingAll"?e:(n==="refresh"&&(i._expandedItems=bi(i._expandedItems,(o=>o.visible))),x(e,((o,a)=>{s.push(a);const l=y.getIndexByKey(a.key,i._expandedItems);a.rowType==="data"&&(a.isExpanded||l>=0)&&!a.isNewRow&&s.push({visible:a.isExpanded,rowType:"detail",key:a.key,data:a.data,values:[]})})),s)}optionChanged(e){const t=this;let i,n;if(e.name==="masterDetail"){switch(e.name="dataSource",e.fullName){case"masterDetail":{const s=e.value||{},o=e.previousValue||{};i=s.enabled!==o.enabled,n=s.autoExpandAll!==o.autoExpandAll;break}case"masterDetail.template":Zs(t);break;case"masterDetail.enabled":i=!0;break;case"masterDetail.autoExpandAll":n=!0}(i||n)&&Zs(t)}super.optionChanged(e)}},uf=r=>class extends r{fireContentReadyAction(){super.fireContentReadyAction.apply(this,arguments),this._updateParentDataGrids(this.component.$element())}_updateParentDataGrids(e){const t=e.closest(`.${Xe.detailRow}`);t.length&&O(this._updateMasterDataGrid(t,e)).done((()=>{this._updateParentDataGrids(t.parent())}))}_updateMasterDataGrid(e,t){const i=h(e).data("options"),n=h(e).closest(`.${this.getWidgetContainerClass()}`).parent().data("dxDataGrid");if(i&&n)return this._updateMasterDataGridCore(n,i)}_updateMasterDataGridCore(e,t){var i,n;const s=S();if((i=e.getView("rowsView"))!==null&&i!==void 0&&(n=i.isFixedColumns)!==null&&n!==void 0&&n.call(i))this._updateFixedMasterDetailGrids(e,t.rowIndex,h(t.rowElement)).done(s.resolve);else{if(e.option("scrolling.useNative")===!0){e.updateDimensions().done((()=>s.resolve(!0)));return}const o=e.getScrollable();o?o==null||o.update().done((()=>s.resolve())):s.resolve()}return s.promise()}_updateFixedMasterDetailGrids(e,t,i){const n=S(),s=h(e.getRowElement(t)),o=h(e.getView("rowsView").getTableElements()),a=(s==null?void 0:s.length)===2&&X(s.eq(0))!==X(s.eq(1)),l=(o==null?void 0:o.length)===2&&X(o.eq(0))!==X(o.eq(1));if(a||l){const d=H(i);return e.updateDimensions().done((()=>{const c=this.option("columnAutoWidth")&&e.option("scrolling.useNative")===!0,u=c&&d!==H(i);c&&u?this.updateDimensions().done((()=>n.resolve(!0))):n.resolve(!0)})),n.promise()}return S().resolve()}_toggleBestFitMode(e){if(super._toggleBestFitMode.apply(this,arguments),!this.option("masterDetail.template"))return;const i=this._rowsView.getTableElement();if(i){const n=`.${this.addWidgetPrefix(Xe.detailContainer)}, .${Xe.detailCell}`;i.find(n).css("maxWidth",e?0:"")}}},hf=r=>class extends r{_getCellTemplate(e){const t=this,{column:i}=e,n=this._editingController,s=n&&n.isEditRow(e.rowIndex);let o;return i.command==="detail"&&!s?o=t.option("masterDetail.template")||{allowRenderToDetachedContainer:!1,render:t._getDefaultTemplate(i)}:o=super._getCellTemplate.apply(t,arguments),o}_createRow(e){const t=super._createRow.apply(this,arguments);if(Ao(e)){const n=this.option("showRowLines");t.addClass(Xe.detailRow).toggleClass(Xe.rowLines,n),m(e.visible)&&t.toggle(e.visible)}return t}_renderCells(e,t){const{row:i}=t;Ao(i)?this._needRenderCell(0,t.columnIndices)&&this._renderMasterDetailCell(e,i,t):super._renderCells.apply(this,arguments)}_renderMasterDetailCell(e,t,i){const n=this._columnsController.getVisibleColumns(),s=this._renderCell(e,{value:null,row:t,rowIndex:t.rowIndex,column:{command:"detail"},columnIndex:0,change:i.change});return s.addClass(Xe.cellFocusDisabledClass).addClass(Xe.detailCell).attr("colSpan",n.length),t.isEditing||s.attr("aria-roledescription",w.format("dxDataGrid-masterDetail")),s}},MS={defaultOptions:()=>({masterDetail:{enabled:!1,autoExpandAll:!1,template:null}}),extenders:{controllers:{columns:df,data:cf,resizing:uf},views:{rowsView:hf}}};_e("dxTextEditor",Nd);const pf="dx-numberbox-spin",gf="dx-numberbox-spin-button",Bc="dxNumberBox",Wa=V(Z.up,Bc),za=V(Z.cancel,Bc);class di extends Lt{_getDefaultOptions(){return T({},super._getDefaultOptions(),{direction:"up",onChange:null,activeStateEnabled:!0,hoverStateEnabled:!0})}_initMarkup(){super._initMarkup();const{direction:e}=this.option(),t=`${pf}-${e}`;this.$element().addClass(gf).addClass(t),this._spinIcon=h("<div>").addClass(`${t}-icon`).appendTo(this.$element())}_render(){super._render();const e=V(Z.down,this.NAME),t=this.$element();v.off(t,e),v.on(t,e,this._spinDownHandler.bind(this)),this._spinChangeHandler=this._createActionByOption("onChange")}_spinDownHandler(e){e.preventDefault(),this._clearTimer(),v.on(this.$element(),Di.name,(()=>{this._feedBackDeferred=S(),Ph(this._feedBackDeferred),this._spinChangeHandler({event:e}),this._holdTimer=setInterval(this._spinChangeHandler,100,{event:e})}));const t=M.getDocument();v.on(t,Wa,this._clearTimer.bind(this)),v.on(t,za,this._clearTimer.bind(this)),this._spinChangeHandler({event:e})}_dispose(){this._clearTimer(),super._dispose()}_clearTimer(){v.off(this.$element(),Di.name);const e=M.getDocument();v.off(e,Wa),v.off(e,za),this._feedBackDeferred&&this._feedBackDeferred.resolve(),this._holdTimer&&clearInterval(this._holdTimer)}_optionChanged(e){switch(e.name){case"onChange":case"direction":this._invalidate();break;default:super._optionChanged(e)}}}const mf="dx-numberbox-spin",_f="dx-numberbox-spin-container",ff="dx-numberbox-spin-touch-friendly";class Cf extends Vp{_attachEvents(e,t){const{editor:i}=this,n=V(Z.down,i.NAME),s=t.children(),o=i._createAction((a=>i._spinButtonsPointerDownHandler(a)));v.off(t,n),v.on(t,n,(a=>o({event:a}))),di.getInstance(s.eq(0)).option("onChange",(a=>i._spinUpChangeHandler(a))),di.getInstance(s.eq(1)).option("onChange",(a=>i._spinDownChangeHandler(a)))}_create(){const{editor:e}=this,t=h("<div>").addClass(_f),i=h("<div>").appendTo(t),n=h("<div>").appendTo(t),s=this._getOptions();return this._addToContainer(t),e._createComponent(i,di,b({direction:"up"},s)),e._createComponent(n,di,b({direction:"down"},s)),this._legacyRender(e.$element(),this._isTouchFriendly(),s.visible),{instance:t,$element:t}}_getOptions(){const{editor:e}=this,t=this._isVisible(),i=e.option("disabled");return{visible:t,disabled:i}}_isVisible(){const{editor:e}=this;return super._isVisible()&&e.option("showSpinButtons")}_isTouchFriendly(){const{editor:e}=this;return e.option("showSpinButtons")&&e.option("useLargeSpinButtons")}_legacyRender(e,t,i){e.toggleClass(ff,t),e.toggleClass(mf,i)}update(){if(super.update()){const{editor:t,instance:i}=this,n=t.$element(),s=this._isVisible(),o=this._isTouchFriendly(),a=i.children(),l=di.getInstance(a.eq(0)),d=di.getInstance(a.eq(1)),c=this._getOptions();l.option(c),d.option(c),this._legacyRender(n,o,s)}}}const vf=Math,xf="dx-numberbox",wf=["tab","del","backspace","leftArrow","rightArrow","home","end","enter"];class bf extends Nd{_supportedKeys(){return T({},super._supportedKeys(),{upArrow(e){Ae(e)||(e.preventDefault(),e.stopPropagation(),this._spinUpChangeHandler(e))},downArrow(e){Ae(e)||(e.preventDefault(),e.stopPropagation(),this._spinDownChangeHandler(e))},enter(){}})}_getDefaultOptions(){return T({},super._getDefaultOptions(),{value:0,min:void 0,max:void 0,step:1,showSpinButtons:!1,useLargeSpinButtons:!0,mode:"text",invalidValueMessage:w.format("dxNumberBox-invalidValueMessage"),buttons:void 0})}_useTemplates(){return!1}_getDefaultButtons(){return super._getDefaultButtons().concat([{name:"spins",Ctor:Cf}])}_isSupportInputMode(){const e=parseFloat(me.version);return me.chrome&&e>=66||me.safari&&e>=12}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:()=>G.real().generic&&!G.isSimulator(),options:{useLargeSpinButtons:!1}},{device:(function(){return G.real().deviceType!=="desktop"&&!this._isSupportInputMode()}).bind(this),options:{mode:"number"}}])}_initMarkup(){this._renderSubmitElement(),this.$element().addClass(xf),super._initMarkup(),this._toggleTabIndex()}_getDefaultAttributes(){const e=super._getDefaultAttributes();return e.inputmode="decimal",e}_renderContentImpl(){this.option("isValid")&&this._validateValue(this.option("value")),this.setAria("role","spinbutton")}_renderSubmitElement(){this._$submitElement=h("<input>").attr("type","hidden").appendTo(this.$element()),this._setSubmitValue(this.option("value"))}_setSubmitValue(e){this._getSubmitElement().val(op(e))}_getSubmitElement(){return this._$submitElement}_keyPressHandler(e){super._keyPressHandler();const t=vo(e);if(!/[\d.,eE\-+]/.test(t)){const n=Ie(e);if(Ae(e)||n&&wf.includes(n))return;e.preventDefault();return}this._keyPressed=!0}_hasMouseWheelHandler(){return!0}_onMouseWheel(e){e.delta>0?this._spinValueChange(1,e):this._spinValueChange(-1,e)}_renderValue(){const e=this._input().val(),t=this.option("value");(!e.length||Number(e)!==t)&&(this._forceValueRender(),this._toggleEmptinessEventHandler());const i=m(t)?null:w.format("dxNumberBox-noDataText");return this.setAria({valuenow:We(t,""),valuetext:i}),this.option("text",this._input().val()),this._updateButtons(),S().resolve()}_forceValueRender(){const e=this.option("value"),t=Number(e),i=isNaN(t)?"":this._applyDisplayValueFormatter(e);this._renderDisplayText(i)}_applyDisplayValueFormatter(e){const{displayValueFormatter:t}=this.option();return t==null?void 0:t(e)}_renderProps(){this._input().prop({min:this.option("min"),max:this.option("max"),step:this.option("step")}),this.setAria({valuemin:We(this.option("min"),""),valuemax:We(this.option("max"),"")})}_spinButtonsPointerDownHandler(){const e=this._input();!this.option("useLargeSpinButtons")&&M.getActiveElement()!==e[0]&&v.trigger(e,"focus")}_spinUpChangeHandler(e){this.option("readOnly")||this._spinValueChange(1,e.event||e)}_spinDownChangeHandler(e){this.option("readOnly")||this._spinValueChange(-1,e.event||e)}_spinValueChange(e,t){const i=parseFloat(this.option("step"));if(i===0)return;let n=parseFloat(this._normalizeInputValue())||0;n=this._correctRounding(n,i*e);const s=this.option("min"),o=this.option("max");m(s)&&(n=Math.max(s,n)),m(o)&&(n=Math.min(o,n)),this._saveValueChangeEvent(t),this.option("value",n)}_correctRounding(e,t){const i=/[,.](.*)/,n=i.test(e),s=i.test(t);if(n||s){const o=n?i.exec(e)[0].length:0,a=s?i.exec(t)[0].length:0,l=vf.max(o,a);return e=this._round(e+t,l),e}return e+t}_round(e,t){t=t||0;const i=10**t;return e*=i,e=Math.round(e)/i,e}_renderValueChangeEvent(){super._renderValueChangeEvent();const e=V("focusout","NumberBoxForceValueChange");v.off(this.element(),e),v.on(this.element(),e,this._forceRefreshInputValue.bind(this))}_forceRefreshInputValue(){const{mode:e}=this.option();if(e==="number")return;const t=this._input(),i=this._applyDisplayValueFormatter(this.option("value"));t.val(null),t.val(i)}_valueChangeEventHandler(e){const t=this._input(),i=this._normalizeText(),n=this._parseValue(i),s=i!=="."&&i!=="-";if(this._isValueValid()&&!this._validateValue(n)){t.val(this._applyDisplayValueFormatter(n));return}s&&super._valueChangeEventHandler(e,isNaN(n)?null:n),this._applyValueBoundaries(i,n),this.validationRequest.fire({value:n,editor:this})}_applyValueBoundaries(e,t){const i=this._isValueIncomplete(e),n=this._isValueInRange(e);!i&&!n&&t!==null&&Number(e)!==t&&this._input().val(this._applyDisplayValueFormatter(t))}_replaceCommaWithPoint(e){return e.replace(",",".")}_inputIsInvalid(){const{mode:e}=this.option(),t=e==="number",i=this._input().get(0).validity;return t&&(i==null?void 0:i.badInput)}_renderDisplayText(e){this._inputIsInvalid()||super._renderDisplayText(e)}_isValueIncomplete(e){return/(^-$)|(^-?\d*\.$)|(\d+e-?$)/i.test(e)}_isValueInRange(e){return Jt(e,this.option("min"),this.option("max"))}_isNumber(e){return this._parseValue(e)!==null}_validateValue(e){const t=this._normalizeText(),i=this._isValueValid();let n=!0;const s=this._isNumber(t);return isNaN(Number(e))&&(n=!1),!e&&i?n=!0:!s&&!i&&(n=!1),this.option({isValid:n,validationError:n?null:{editorSpecific:!0,message:this.option("invalidValueMessage")}}),n}_normalizeInputValue(){return this._parseValue(this._normalizeText())}_normalizeText(){const e=this._input().val().trim();return this._replaceCommaWithPoint(e)}_parseValue(e){const t=parseFloat(e);return isNaN(t)?null:At(t,this.option("min"),this.option("max"))}_clearValue(){this._inputIsInvalid()&&(this._input().val(""),this._validateValue()),super._clearValue()}clear(){this.option("value")===null?(this.option("text",""),this._input().length&&this._renderValue()):this.option("value",null)}_optionChanged(e){switch(e.name){case"value":this._validateValue(e.value),this._setSubmitValue(e.value),super._optionChanged(e),this._resumeValueChangeAction();break;case"step":this._renderProps();break;case"min":case"max":this._renderProps(),this.option("value",this._parseValue(this.option("value")));break;case"showSpinButtons":case"useLargeSpinButtons":this._updateButtons(["spins"]);break;case"invalidValueMessage":break;default:super._optionChanged(e)}}}const zn=function(r){let e=0,t=0;for(let i=0;i<r.length;++i)if(r[i]==="'"&&e++,r[i]==="."&&(++t,e%2===0))return{occurrence:t,index:i};return{occurrence:1,index:-1}},Po=function(r,e,t){let i=-1;for(;t--&&i++<r.length;)i=r.indexOf(e,i);return i},ko=function(r,e){return e===-1?[r]:[r.slice(0,e),r.slice(e+1)]},yf=function(r,e){return r&&rp(r/100,e)},ss=function(r,e){if(typeof e=="string"){const t=e.split(";"),i=le.getSign(r,e);t[1]=t[1]||`-${t[0]}`,e=t[i<0?1:0],e=(a=>a.replace(/'([^']*)'/g,(l=>l.split("").map((()=>" ")).join("").substr(2))))(e);const s=/^[^#0.,]*/.exec(e)[0].length,o=/[^#0.,]*$/.exec(e)[0].length;return{start:s,end:r.length-o}}return{start:0,end:r.length}},Ka=function(r,e){const t=le.getDecimalSeparator(),i=new RegExp(`[^0-9${Ln(t)}]`,"g");return e.slice(0,r).replace(i,"").length},Ga=function(r){return r.split("").reverse().join("")},Ua=function(r,e){if(!r)return-1;const t=/[0-9]/g;let i=1,n=null,s=t.exec(e);for(;s;){if(n=s.index,i>=r)return n;i++,s=t.exec(e)}return n===null?e.length:n},If=function(r){return r.replace(/[^0-9e]+$/,"")},Zt=function(r,e){return r.start===void 0&&(r={start:r,end:r}),{start:r.start+e,end:r.end+e}},Sf=function(r,e,t,i){t=Zt(t,0);const n=le.getDecimalSeparator(),s=Ef(r),o=zn(i).occurrence,a=s?0:Po(r,n,o),l=Po(e,n,o),d=ko(r,a),c=ko(e,l);if(a!==-1&&t.start>a){const I=t.start-a-1,E=Ka(I,d[1]),D=c[1]?l+1+Ua(E,c[1])+1:e.length;return Vt(D,e,i)}const p=If(c[0]),g=d[0].length-t.start,_=Ka(g,Ga(d[0])),f=Ua(_,Ga(p)),C=p.length-(f+1);return Vt(C,e,i)};function Ef(r){return r.length===1&&!!r.match(/^[,.][0-9]*$/g)}const Tf=function(r,e,t){r=Zt(r,0);const i=Vt(r,e,t);return r.start>=i.start&&r.end<=i.end};function Vt(r,e,t){r=Zt(r,0);const i=ss(e,t);return{start:At(r.start,i.start,i.end),end:At(r.end,i.start,i.end)}}const Df=function(r,e,t){const i=ss(r,t);return ss(e,t).start-i.start};class os extends bf{_getDefaultOptions(){return T({},super._getDefaultOptions(),{useMaskBehavior:!0,format:null})}_isDeleteKey(e){return e==="del"}_supportedKeys(){return this._useMaskBehavior()?T({},super._supportedKeys(),{minus:this._revertSign.bind(this),del:this._removeHandler.bind(this),backspace:this._removeHandler.bind(this),leftArrow:this._arrowHandler.bind(this,-1),rightArrow:this._arrowHandler.bind(this,1),home:this._moveCaretToBoundaryEventHandler.bind(this,1),enter:this._updateFormattedValue.bind(this),end:this._moveCaretToBoundaryEventHandler.bind(this,-1)}):super._supportedKeys()}_getTextSeparatorIndex(e){const t=le.getDecimalSeparator(),i=zn(this.option("format")).occurrence;return Po(e,t,i)}_focusInHandler(e){this._preventNestedFocusEvent(e)||(this.clearCaretTimeout(),this._caretTimeout=setTimeout((()=>{this._caretTimeout=void 0;const t=this._caret();if(t.start===t.end&&this._useMaskBehavior()){const i=this._getInputVal(),n=this._getTextSeparatorIndex(i);n>=0?this._caret({start:n,end:n}):this._moveCaretToBoundaryEventHandler(-1,e)}}),0)),super._focusInHandler(e)}_focusOutHandler(e){const t=!this._preventNestedFocusEvent(e);t&&(this._focusOutOccurs=!0,this._useMaskBehavior()&&this._updateFormattedValue()),super._focusOutHandler(e),t&&(this._focusOutOccurs=!1)}_hasValueBeenChanged(e){const t=this._getFormatPattern(),i=this.option("value");return(this._format(i,t)||"")!==e}_updateFormattedValue(){const e=this._getInputVal();if(this._hasValueBeenChanged(e)){this._updateParsedValue(),this._adjustParsedValue(),this._setTextByParsedValue();const{value:t}=this.option();this._parsedValue!==t&&v.trigger(this._input(),"change")}}_arrowHandler(e,t){if(!this._useMaskBehavior())return;const i=this._getInputVal(),n=this._getFormatPattern();let s=Zt(this._caret(),e);Tf(s,i,n)||(s=e===1?s.end:s.start,t.preventDefault(),this._caret(Vt(s,i,n)))}_moveCaretToBoundary(e){const t=ss(this._getInputVal(),this._getFormatPattern()),i=Zt(e===1?t.start:t.end,0);this._caret(i)}_moveCaretToBoundaryEventHandler(e,t){!this._useMaskBehavior()||t!=null&&t.shiftKey||(this._moveCaretToBoundary(e),t==null||t.preventDefault())}_shouldMoveCaret(e,t){const i=le.getDecimalSeparator(),n=e.charAt(t.end)===i;return(this._lastKey===i||this._lastKey==="."||this._lastKey===",")&&n}_getInputVal(){return le.convertDigits(this._input().val(),!0)}_keyboardHandler(e){if(this.clearCaretTimeout(),this._lastKey=le.convertDigits(vo(e),!0),this._lastKeyName=Ie(e),!this._shouldHandleKey(e.originalEvent))return super._keyboardHandler(e);const t=this._getInputVal(),i=this._caret();let n;this._lastKeyName==="minus"?n="":n=e.which===110?le.getDecimalSeparator():this._lastKey;const s=this._tryParse(t,i,n);return this._shouldMoveCaret(t,i)&&(this._moveCaret(1),e.originalEvent.preventDefault()),s===void 0?this._lastKeyName!=="minus"&&e.originalEvent.preventDefault():this._parsedValue=s,super._keyboardHandler(e)}_keyPressHandler(e){this._useMaskBehavior()||super._keyPressHandler(e)}_removeHandler(e){const t=this._caret(),i=this._getInputVal();let{start:n}=t,{end:s}=t;this._lastKey=vo(e),this._lastKeyName=Ie(e);const o=this._isDeleteKey(this._lastKeyName),a=!o;if(n===s){const u=n;if(a&&u>0||o&&u<i.length)o&&s++,a&&n--;else{e.preventDefault();return}}const l=i.slice(n,s);if(this._isStub(l)){this._moveCaret(o?1:-1),(this._parsedValue<0||1/this._parsedValue===-1/0)&&(this._revertSign(e),this._setTextByParsedValue(),this.option("valueChangeEvent").split(" ").includes("input")&&v.trigger(this._input(),"input")),e.preventDefault();return}const d=le.getDecimalSeparator();if(l===d){const u=i.indexOf(d);this._isNonStubAfter(u+1)&&(this._moveCaret(o?1:-1),e.preventDefault());return}if(s-n<i.length&&this._replaceSelectedText(i,{start:n,end:s},"").search(/[0-9]/)<0&&this._isValueInRange(0)){this._parsedValue=this._parsedValue<0||1/this._parsedValue===-1/0?-0:0;return}const c=this._tryParse(i,{start:n,end:s},"");c===void 0?e.preventDefault():this._parsedValue=c}_isPercentFormat(){return this._getFormatPattern().replace(/'[^']+'/g,"").indexOf("%")!==-1}_parse(e,t){const i=this.option("format"),n=B(i.parser),s=n?i.parser:le.parse;let o=0;if(!n){const a=zn(t).index,l=this._getTextSeparatorIndex(e),d=a!==-1?a:t.length,c=l!==-1?l:e.length;c>d&&t.indexOf("#")===-1&&(o=c-d)}return e=e.substr(o),s(e,t)}_format(e,t){const i=this.option("format"),n=(i==null?void 0:i.formatter)||i,s=B(n)?n:le.format;return e===null?"":s(e,t)}_getFormatPattern(){return this._currentFormat||this._updateFormat(),this._currentFormat}_updateFormat(){const{format:e}=this.option(),t=B(e==null?void 0:e.parser),i=W(e)&&(e.includes("0")||e.includes("#")),n=e==="exponential"||(e==null?void 0:e.type)==="exponential",s=t||i||n;this._currentFormat=s?e:ap((o=>{const a=this._format(o,e);return le.convertDigits(a,!0)}))}_getFormatForSign(e){const t=this._getFormatPattern();if(W(t)){const n=t.split(";"),s=le.getSign(e,t);return n[1]=n[1]||`-${n[0]}`,s<0?n[1]:n[0]}return le.getSign(e)<0?"-":""}_removeStubs(e,t){const i=this._getFormatForSign(e),n=le.getThousandsSeparator(),s=this._getStubs(i);let o=e;if(s.length){const a=s[0],l=new RegExp(`(${Ln(s[1]||"")})$`,"g"),d=new RegExp(`[-${Ln(t?"":n)}]`,"g");o=o.replace(a,"").replace(l,"").replace(d,"")}return o}_getStubs(e){const t=/[^']([#0.,]+)/g.exec(e),i=t&&t[0].trim();return e.split(i).map((n=>n.replace(/'/g,"")))}_truncateToPrecision(e,t){if(m(e)){const i=e.toString(),n=i.indexOf(".");if(i&&n>-1){const s=parseFloat(i.substr(0,n+t+1));return isNaN(s)?e:s}}return e}_tryParse(e,t,i){const n=t.start!==t.end,s=n&&t.start===0&&t.end===e.length,o=le.getDecimalSeparator();if(s&&i===o)return 0;const a=this._replaceSelectedText(e,t,i),l=this._getFormatPattern();let d=this._getParsedValue(a,l);const c=!l.parser&&this._getPrecisionLimits(a).max,u=d!==this._parsedValue,p=i===o&&c===0,g=!n&&!u&&i!=="-"&&this._isStub(i);if(p||g||(this._removeStubs(a)===""&&(d=Math.abs(0*this._parsedValue)),isNaN(d)))return;const _=d===null?this._parsedValue:d;if(d=c?this._truncateToPrecision(_,c):d,!l.parser&&this._isPercentFormat()){const f=this._getIntervalFromPrecision(c);return yf(d,f)}return d}_getIntervalFromPrecision(e){return e<1?1:10**-e}_getParsedValue(e,t){const i=le.getSign(e,(t==null?void 0:t.formatter)||t),n=this._removeStubs(e,!0),s=this._parse(n,t),o=s<0?-1:1;return Ee(s)&&i!==o?i*s:s}_isValueIncomplete(e){if(!this._useMaskBehavior())return super._isValueIncomplete(e);const t=this._caret(),i=le.getDecimalSeparator(),n=this._getTextSeparatorIndex(e),s=n>=0&&n<t.start,o=this._removeStubs(e,!0).split(i);if(!s||o.length!==2)return!1;const a=o[1].length,d=!!this._getFormatPattern().parser,c=!d&&this._getPrecisionLimits(this._getFormatPattern()),u=d?!0:Jt(a,c.min,c.max),p=o[1].charAt(a-1)==="0";return u&&(p||!a)}_isValueInRange(e){const t=We(this.option("min"),-1/0),i=We(this.option("max"),1/0);return Jt(e,t,i)}_setInputText(e){const t=le.convertDigits(e,!0),i=Sf(this._getInputVal(),t,this._caret(),this._getFormatPattern());this._input().val(e),this._toggleEmptinessEventHandler(),this._formattedValue=e,this._focusOutOccurs||this._caret(i)}_useMaskBehavior(){const{useMaskBehavior:e}=this.option();return!!this.option("format")&&e}_renderInputType(){const{mode:e}=this.option(),t=e==="number",i=G.real().deviceType==="desktop";this._useMaskBehavior()&&t?this._setInputType(i||this._isSupportInputMode()?"text":"tel"):super._renderInputType()}_isChar(e){return W(e)&&e.length===1}_moveCaret(e){if(!e)return;const t=Zt(this._caret(),e),i=Vt(t,this._getInputVal(),this._getFormatPattern());this._caret(i)}_shouldHandleKey(e){const t=Ie(e),i=Ae(e)||e.altKey||e.shiftKey||!this._isChar(t),n=t==="minus";return this._useMaskBehavior()&&!i&&!n}_renderInput(){super._renderInput(),this._renderFormatter()}_renderFormatter(){this._clearCache(),this._detachFormatterEvents(),this._useMaskBehavior()&&this._attachFormatterEvents()}_detachFormatterEvents(){v.off(this._input(),".dxNumberFormatter")}_isInputFromPaste(e){var t;const i=(t=e.originalEvent)===null||t===void 0?void 0:t.inputType;return m(i)?i==="insertFromPaste":this._isValuePasted}_attachFormatterEvents(){const e=this._input();v.on(e,V("input","dxNumberFormatter"),(t=>{this._formatValue(t),this._isValuePasted=!1})),v.on(e,V("dxclick","dxNumberFormatter"),(()=>{this._caretTimeout||(this._caretTimeout=setTimeout((()=>{this._caretTimeout=void 0,this._caret(Vt(this._caret(),this._getInputVal(),this._getFormatPattern()))}),0))})),v.on(e,mn,(()=>{this.clearCaretTimeout()}))}clearCaretTimeout(){clearTimeout(this._caretTimeout),this._caretTimeout=void 0}_forceRefreshInputValue(){if(!this._useMaskBehavior())return super._forceRefreshInputValue()}_isNonStubAfter(e){const t=this._getInputVal().slice(e);return t&&!this._isStub(t,!0)}_isStub(e,t){const n=`^[^0-9${Ln(le.getDecimalSeparator())}]+$`;return new RegExp(n,"g").test(e)&&(t||this._isChar(e))}_parseValue(e){return this._useMaskBehavior()?this._parsedValue:super._parseValue(e)}_getPrecisionLimits(e){const t=this._getFormatForSign(e),i=zn(t).index,n=(ko(t,i)[1]||"").replace(/[^#0]/g,""),s=n.replace(/^(0*)#*/,"$1").length,o=n.length;return{min:s,max:o}}_revertSign(e){if(!this._useMaskBehavior())return;const t=this._caret();if(t.start!==t.end){if(Ie(e)==="minus"){this._applyRevertedSign(e,t,!0);return}this._caret(Vt(0,this._getInputVal(),this._getFormatPattern()))}this._applyRevertedSign(e,t)}_applyRevertedSign(e,t,i){const n=-1*We(this._parsedValue,null);if((this._isValueInRange(n)||n===0)&&(this._parsedValue=n,i)){const s=this._getFormatPattern(),o=this._getInputVal();this._setTextByParsedValue(),e.preventDefault();const a=this._getInputVal(),l=Df(o,a,s);t=Zt(t,l);const d=Vt(t,a,s);this._caret(d)}}_removeMinusFromText(e,t){return this._lastKeyName==="minus"&&e.charAt(t.start-1)==="-"?this._replaceSelectedText(e,{start:t.start-1,end:t.start},""):e}_setTextByParsedValue(){const e=this._getFormatPattern(),t=this._parseValue(),i=this._format(t,e)||"";this._setInputText(i)}_formatValue(e){let t=this._getInputVal();const i=this._caret(),n=this._removeMinusFromText(t,i),s=n!==t;if(t=n,!this._isInputFromPaste(e)&&this._isValueIncomplete(n)){this._formattedValue=t,s&&this._setTextByParsedValue();return}if(le.convertDigits(this._formattedValue,!0)!==t){const a=this._tryParse(t,i,"");m(a)&&(this._parsedValue=a)}this._setTextByParsedValue()}_renderDisplayText(){this._useMaskBehavior()?this._toggleEmptinessEventHandler():super._renderDisplayText.apply(this,arguments)}_renderValue(){if(this._useMaskBehavior()){const{value:e}=this.option();this._parsedValue=e,this._setTextByParsedValue()}return super._renderValue()}_updateParsedValue(){const e=this._getInputVal();this._parsedValue=this._tryParse(e,this._caret())}_adjustParsedValue(){if(!this._useMaskBehavior())return;const t=this._removeStubs(this._getInputVal())?this._parseValue():null;if(!Ee(t)){this._parsedValue=t;return}this._parsedValue=At(t,this.option("min"),this.option("max"))}_valueChangeEventHandler(e){if(!this._useMaskBehavior())return super._valueChangeEventHandler(e);const t=this._caret();this._saveValueChangeEvent(e),this._lastKey=null,this._lastKeyName=null,this._updateParsedValue(),this._adjustParsedValue(),this.option("value",this._parsedValue),t&&this._caret(t)}_optionChanged(e){switch(e.name){case"format":case"useMaskBehavior":this._renderInputType(),this._updateFormat(),this._renderFormatter(),this._renderValue(),this._refreshValueChangeEvent(),this._refreshEvents();break;case"min":case"max":this._adjustParsedValue(),super._optionChanged(e);break;default:super._optionChanged(e)}}_clearCache(){delete this._formattedValue,delete this._lastKey,delete this._lastKeyName,delete this._parsedValue,delete this._focusOutOccurs,clearTimeout(this._caretTimeout),delete this._caretTimeout}_clean(){this._clearCache(),super._clean()}}_e("dxNumberBox",os);const Nc="dxSwipeable",Rf={onStart:Ap,onUpdated:Fp,onEnd:Op,onCancel:"dxswipecancel"};class rs extends ps{_getDefaultOptions(){return T({},super._getDefaultOptions(),{elastic:!0,immediate:!1,immediateTimeout:180,direction:"horizontal",itemSizeFunc:null,onStart:null,onUpdated:null,onEnd:null,onCancel:null})}_render(){super._render(),this.$element().addClass("dx-swipeable"),this._attachEventHandlers()}_attachEventHandlers(){if(this._detachEventHandlers(),this.option("disabled"))return;const{NAME:e}=this;this._createEventData(),x(Rf,((t,i)=>{const n=this._createActionByOption(t,{context:this}),s=V(i,e);v.on(this.$element(),s,this._eventData,(o=>n({event:o})))}))}_createEventData(){this._eventData={elastic:this.option("elastic"),itemSizeFunc:this.option("itemSizeFunc"),direction:this.option("direction"),immediate:this.option("immediate"),immediateTimeout:this.option("immediateTimeout")}}_detachEventHandlers(){v.off(this.$element(),`.${Nc}`)}_optionChanged(e){switch(e.name){case"disabled":case"onStart":case"onUpdated":case"onEnd":case"onCancel":case"elastic":case"immediate":case"itemSizeFunc":case"direction":this._detachEventHandlers(),this._attachEventHandlers();break;case"rtlEnabled":break;default:super._optionChanged(e)}}_useTemplates(){return!1}}kh(rs,Nc);class mr{constructor(e){this.calendar=e}dateValue(e,t){this.calendar._dateValue(e,t)}skipNavigate(){this.calendar._skipNavigate=!0}updateAriaSelected(e,t){this.calendar._updateAriaSelected(e,t);const{currentDate:i=new Date}=this.calendar.option();e[0]&&i.getTime()===e[0].getTime()&&this.calendar._updateAriaId(e[0])}processValueChanged(e,t){var i,n;let s=e,o=t;m(s)&&!Array.isArray(s)&&(s=[s]),m(o)&&!Array.isArray(o)&&(o=[o]),s=((i=s)===null||i===void 0?void 0:i.map((a=>this._convertToDate(a))))??[],o=((n=o)===null||n===void 0?void 0:n.map((a=>this._convertToDate(a))))??[],this._updateViewsValue(s.filter((a=>a!==null))),this.updateAriaSelected(s,o),this._currentDateChanged||this.calendar._initCurrentDate(),this._currentDateChanged=!1}_isDateDisabled(e){const t=this.calendar._getDateOption("min"),i=this.calendar._getDateOption("max"),n=m(t)&&e<t&&!R.sameDate(t,e),s=m(i)&&e>i&&!R.sameDate(i,e);return this.calendar._view.isDateDisabled(e)||n||s}_getLowestDateInArray(e){return e.length?new Date(Math.min(...e.map((t=>(t==null?void 0:t.getTime())??1/0)))):null}_convertToDate(e){return this.calendar._convertToDate(e)}_isMaxZoomLevel(){return this.calendar._isMaxZoomLevel()}_updateViewsOption(e,t){this.calendar._updateViewsOption(e,t)}_updateViewsValue(e){this._updateViewsOption("value",e)}_updateCurrentDate(e){this.calendar.option("currentDate",e??new Date)}_shouldHandleWeekNumberClick(){const{selectionMode:e,selectWeekOnClick:t}=this.calendar.option();return t===!0&&e!=="single"}}class Vf extends mr{constructor(e){super(e),this.NAME="MultiSelection"}dateOption(e){return e==="value"?this.calendar._getDateOption("value"):this.calendar._getDateOption(e)}getViewOptions(){return{value:this.dateOption("value"),range:[],selectionMode:"multiple",onWeekNumberClick:this._shouldHandleWeekNumberClick()?this._weekNumberClickHandler.bind(this):null}}selectValue(e,t){const i=[...this.dateOption("value")],n=i.findIndex((s=>(s==null?void 0:s.toDateString())===e.toDateString()));n>-1?i.splice(n,1):i.push(e),this.skipNavigate(),this._updateCurrentDate(e),this._currentDateChanged=!0,this.dateValue(i,t)}updateAriaSelected(e,t){const i=e??this.dateOption("value"),n=t??[];super.updateAriaSelected(i,n)}getDefaultCurrentDate(){const t=this.dateOption("value").filter((i=>i!==null));return this._getLowestDateInArray(t)}restoreValue(){this.calendar.option("value",[])}_weekNumberClickHandler(e){let{rowDates:t,event:i}=e;const n=t.filter((s=>!this._isDateDisabled(s)));this.dateValue(n,i)}}class Of extends Lt{_getDefaultOptions(){return T({},super._getDefaultOptions(),{onClick:void 0,onCaptionClick:void 0,type:"normal",stylingMode:"outlined",text:""})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:()=>Fi(Se()),options:{type:"default",stylingMode:"text"}},{device:()=>st(Se()),options:{type:"normal",stylingMode:"text"}}])}_init(){super._init(),this._initActions()}_initActions(){this._clickAction=this._createActionByOption("onClick"),this._captionClickAction=this._createActionByOption("onCaptionClick")}_initMarkup(){super._initMarkup(),h(this.element()).addClass("dx-calendar-navigator"),this._renderButtons(),this._renderCaption()}_renderButtons(){const{rtlEnabled:e,type:t,stylingMode:i,focusStateEnabled:n}=this.option();this._prevButton=this._createComponent(h("<div>"),Ze,{focusStateEnabled:n,icon:e?"chevronright":"chevronleft",onClick:l=>{var d;(d=this._clickAction)===null||d===void 0||d.call(this,{direction:-1,event:l})},type:t,stylingMode:i,integrationOptions:{}});const s=h(this._prevButton.element()).addClass("dx-calendar-navigator-previous-view").addClass("dx-calendar-navigator-previous-month");this._nextButton=this._createComponent(h("<div>"),Ze,{focusStateEnabled:n,icon:e?"chevronleft":"chevronright",onClick:l=>{var d;(d=this._clickAction)===null||d===void 0||d.call(this,{direction:1,event:l})},type:t,stylingMode:i,integrationOptions:{}});const o=h(this._nextButton.element()).addClass("dx-calendar-navigator-next-view").addClass("dx-calendar-navigator-next-month");this._caption=this._createComponent(h("<div>").addClass("dx-calendar-caption-button"),Ze,{focusStateEnabled:n,onClick:l=>{var d;(d=this._captionClickAction)===null||d===void 0||d.call(this,{event:l})},type:t,stylingMode:i,template:(l,d)=>{const{text:c}=this.option();c.split(" - ").forEach((p=>{h(d).append(h("<span>").addClass("dx-button-text").text(p))}))},integrationOptions:{}});const a=this._caption.$element();this.$element().append(s).append(a).append(o)}_renderCaption(){var e;const{text:t}=this.option();(e=this._caption)===null||e===void 0||e.option("text",t)}toggleButton(e,t){const i=`_${e}Button`,n=this[i];n&&(n.option("disabled",t),n.$element().toggleClass("dx-calendar-disabled-navigator-link",t))}_optionChanged(e){const{name:t}=e;t==="text"?this._renderCaption():super._optionChanged(e)}}class Ff extends mr{constructor(e){super(e),this.NAME="RangeSelection"}dateOption(e){return e==="value"?this.calendar._getDateOption("value")||null:this.calendar._getDateOption(e)}getViewOptions(){const e=this._getValue(),t=this._getDaysInRange(e[0],e[1]);return{value:e,range:t,selectionMode:"range",onCellHover:this._cellHoverHandler.bind(this),onWeekNumberClick:this._shouldHandleWeekNumberClick()?this._weekNumberClickHandler.bind(this):null}}selectValue(e,t){const[i,n]=this._getValue();this.skipNavigate(),this._updateCurrentDate(e),this._currentDateChanged=!0;const{allowChangeSelectionOrder:s,currentSelection:o}=this.calendar.option();if(s===!0){this.calendar._valueSelected=!0;const a=this.calendar._convertToDate(e);o==="startDate"?a>(this.calendar._convertToDate(n)??new Date(0))?this.dateValue([e,null],t):this.dateValue([e,n],t):a>=(this.calendar._convertToDate(i)??new Date(0))?this.dateValue([i,e],t):this.dateValue([e,null],t)}else!i||n?this.dateValue([e,null],t):this.dateValue(i<e?[i,e]:[e,i],t)}updateAriaSelected(e,t){const i=e??this._getValue(),n=t??[];super.updateAriaSelected(i,n)}processValueChanged(e,t){super.processValueChanged(e,t);const i=this._getRange();this._updateViewsOption("range",i)}getDefaultCurrentDate(){const{allowChangeSelectionOrder:e,currentSelection:t}=this.calendar.option(),i=this.dateOption("value");if(e){if(t==="startDate"&&i[0])return i[0];if(t==="endDate"&&i[1])return i[1]}const n=i.filter((s=>s!==null));return this._getLowestDateInArray(n)}restoreValue(){this.calendar.option("value",[null,null])}_getValue(){const e=this.dateOption("value");if(!e.length)return e;let[t,i]=e;return t&&i&&t>i&&([t,i]=[i,t]),[t,i]}_getRange(){const[e,t]=this._getValue();return this._getDaysInRange(e,t)}_getDaysInRange(e,t){if(!e||!t)return[];const{currentDate:i,viewsCount:n}=this.calendar.option(),s=this.calendar._isAdditionalViewDate(i),o=R.getFirstMonthDate(i,s?-2:-1),a=R.getLastMonthDate(i,s?1:n),l=new Date(Math.max(o.getTime(),e.getTime())),d=new Date(Math.min(a.getTime(),t.getTime()));return[...R.getDatesOfInterval(l,d,864e5),d]}_cellHoverHandler(e){const t=this._isMaxZoomLevel(),[i,n]=this._getValue(),{allowChangeSelectionOrder:s,currentSelection:o}=this.calendar.option();if(t){if(i&&!n&&!(s&&o==="startDate")){if(e.value>i){this._updateViewsOption("hoveredRange",this._getDaysInRange(i,e.value));return}}else if(!i&&n&&!(s&&o==="endDate")){if(e.value<n){this._updateViewsOption("hoveredRange",this._getDaysInRange(e.value,n));return}}else if(i&&n){if(o==="startDate"&&e.value<i){this._updateViewsOption("hoveredRange",this._getDaysInRange(e.value,i));return}if(o==="endDate"&&e.value>n){this._updateViewsOption("hoveredRange",this._getDaysInRange(n,e.value));return}}this._updateViewsOption("hoveredRange",[])}}_weekNumberClickHandler(e){let{rowDates:t,event:i}=e;const n=t.filter((o=>!this._isDateDisabled(o))),s=n.length?[n[0],n[n.length-1]]:[null,null];this.dateValue(s,i)}}class Af extends mr{constructor(e){super(e),this.NAME="SingleSelection"}dateOption(e){return e==="value"?this.calendar._getDateOption("value"):this.calendar._getDateOption(e)}getViewOptions(){return{value:this.dateOption("value")??void 0,range:[],selectionMode:"single"}}selectValue(e,t){this.skipNavigate(),this.dateValue(e,t)}updateAriaSelected(e,t){const i=e??[this.dateOption("value")],n=t??[];super.updateAriaSelected(i,n)}getDefaultCurrentDate(){return this.dateOption("value")}restoreValue(){this.calendar.option("value",null)}_updateViewsValue(e){this._updateViewsOption("value",e[0])}}const qa="td:not(.dx-calendar-week-number-cell)",Qs=V(Q,"dxCalendar"),Ya=V(Mh,"dxCalendar"),Pf={month:w.format("dxCalendar-currentDay"),year:w.format("dxCalendar-currentMonth"),decade:w.format("dxCalendar-currentYear"),century:w.format("dxCalendar-currentYearRange")},Kt={single:"single",multiple:"multiple",range:"range"};class ys extends Lt{_getViewName(){return"base"}_getDefaultOptions(){return T({},super._getDefaultOptions(),{date:new Date,focusStateEnabled:!1,cellTemplate:null,disabledDates:null,onCellClick:null,onCellHover:null,onWeekNumberClick:null,rowCount:3,colCount:4,allowValueSelection:!0,_todayDate:()=>new Date})}_initMarkup(){super._initMarkup(),this._renderImpl()}_renderImpl(){this.$element().append(this._createTable()),this._createDisabledDatesHandler(),this._renderBody(),this._renderContouredDate(),this._renderValue(),this._renderRange(),this._renderEvents(),this._updateTableAriaLabel()}_getLocalizedWidgetName(){return w.format("dxCalendar-ariaWidgetName")}_getSingleModeAriaLabel(){const{value:e}=this.option(),t=this._getLocalizedWidgetName(),i=P.format(e,"date"),n=w.format("dxCalendar-selectedDate",i);return`${t}. ${n}`}_getRangeModeAriaLabel(){const{value:e}=this.option(),t=this._getLocalizedWidgetName(),[i,n]=e,s=P.format(i,"date"),o=P.format(n,"date"),a=i&&n?w.format("dxCalendar-selectedDateRange",s,o):w.format("dxCalendar-selectedDate",s??o);return`${t}. ${a}`}_getMultipleModeAriaLabel(){const e=this._getLocalizedWidgetName(),t=this._getMultipleRangesText();return`${e}. ${t}`}_getMultipleRangesText(){const{value:e}=this.option(),t=e,i=R.getRangesByDates(t.map((a=>new Date(a))));if(i.length>2)return w.format("dxCalendar-selectedDateRangeCount",i.length);const n=w.format("dxCalendar-selectedDates"),s=i.map((a=>this._getRangeText(a))).join(", ");return`${n}: ${s}`}_getRangeText(e){const[t,i]=e,n=P.format(t,"date"),s=P.format(i,"date");return`${t&&i?w.format("dxCalendar-selectedMultipleDateRange",n,s):n}`}_getTableAriaLabel(){const{value:e,selectionMode:t}=this.option();if(!e||Array.isArray(e)&&!e.filter(Boolean).length)return this._getLocalizedWidgetName();switch(t){case Kt.single:return this._getSingleModeAriaLabel();case Kt.range:return this._getRangeModeAriaLabel();case Kt.multiple:return this._getMultipleModeAriaLabel();default:return this._getSingleModeAriaLabel()}}_updateTableAriaLabel(){const e=this._getTableAriaLabel();this.setAria({label:e},this._$table)}_createTable(){return this._$table=h("<table>"),this.setAria({role:"grid"},this._$table),this._$table}_renderBody(){this.$body=h("<tbody>").appendTo(this._$table);const e={cellDate:this._getFirstCellData(),prevCellDate:null,row:void 0},{rowCount:t,colCount:i}=this.option();for(let n=0,s=t;n<s;n+=1){e.row=this._createRow();for(let o=0,a=i;o<a;o+=1)this._renderCell(e,o);this._renderWeekNumberCell(e)}}_renderWeekNumberCell(e){}_createRow(){const e=M.createElement("tr");return this.setAria("role","row",h(e)),this.$body.get(0).appendChild(e),e}_createCell(e,t){const i=M.createElement("td"),n=h(i);return i.className=this._getClassNameByDate(e,t),i.setAttribute("data-value",fe.serializeDate(e,R.getShortDateFormat())),us(i,"dxDateValueKey",e),this.setAria({role:"gridcell",selected:!1,label:this.getCellAriaLabel(e)},n),{cell:i,$cell:n}}_renderCell(e,t){const{cellDate:i,prevCellDate:n,row:s}=e;n&&R.fixTimezoneGap(n,i),e.prevCellDate=i;const{cell:o,$cell:a}=this._createCell(i,t),{cellTemplate:l}=this.option();h(s).append(o),l?l.render(this._prepareCellTemplateData(i,t,a)):o.innerHTML=this._getCellText(i),e.cellDate=this._getNextCellData(i)}_getClassNameByDate(e,t){let i="dx-calendar-cell";this._isTodayCell(e)&&(i+=" dx-calendar-today"),(this._isDateOutOfRange(e)||this.isDateDisabled(e))&&(i+=" dx-calendar-empty-cell"),this._isOtherView(e)&&(i+=" dx-calendar-other-view");const{selectionMode:n}=this.option();if(n===Kt.range){t===0&&(i+=" dx-calendar-cell-start-in-row");const{colCount:s}=this.option();t===s-1&&(i+=" dx-calendar-cell-end-in-row"),this._isStartDayOfMonth(e)&&(i+=" dx-calendar-cell-start"),this._isEndDayOfMonth(e)&&(i+=" dx-calendar-cell-end")}return i}_prepareCellTemplateData(e,t,i){const n=e instanceof Date,s=n?this._getCellText(e):e,o=n?e:void 0,a=this._getViewName();return{model:{text:s,date:o,view:a},container:$(i),index:t}}_renderEvents(){this._createCellClickAction(),v.off(this._$table,Qs),v.on(this._$table,Qs,qa,(t=>{h(t.currentTarget).hasClass("dx-calendar-empty-cell")||this._cellClickAction({event:t,value:h(t.currentTarget).data("dxDateValueKey")})}));const{selectionMode:e}=this.option();v.off(this._$table,Ya),e===Kt.range&&(this._createCellHoverAction(),v.on(this._$table,Ya,qa,(t=>{h(t.currentTarget).hasClass("dx-calendar-empty-cell")||this._cellHoverAction({event:t,value:h(t.currentTarget).data("dxDateValueKey")})}))),e!==Kt.single&&(this._createWeekNumberCellClickAction(),v.on(this._$table,Qs,".dx-calendar-week-number-cell",(t=>{const i=h(t.currentTarget).closest("tr"),n=i.find(".dx-calendar-cell").first().data("dxDateValueKey"),s=i.find(".dx-calendar-cell").last().data("dxDateValueKey"),o=[...R.getDatesOfInterval(n,s,864e5),s];this._weekNumberCellClickAction({event:t,rowDates:o})})))}_createCellClickAction(){this._cellClickAction=this._createActionByOption("onCellClick")}_createCellHoverAction(){this._cellHoverAction=this._createActionByOption("onCellHover")}_createWeekNumberCellClickAction(){this._weekNumberCellClickAction=this._createActionByOption("onWeekNumberClick")}_createDisabledDatesHandler(){const{disabledDates:e}=this.option();this._disabledDatesHandler=Array.isArray(e)?this._getDefaultDisabledDatesHandler(e):e??(()=>!1)}_getDefaultDisabledDatesHandler(e){return()=>!1}_isTodayCell(e){return!1}_isDateOutOfRange(e){return!1}isDateDisabled(e){const t={date:e,view:this._getViewName()};return this._disabledDatesHandler(t)}_isOtherView(e){return!1}_isStartDayOfMonth(e){return!1}_isEndDayOfMonth(e){return!1}_getCellText(e){return""}_getFirstCellData(){return new Date}_getNextCellData(e){return new Date(e)}_renderContouredDate(e){const{focusStateEnabled:t}=this.option();if(!t)return;const{contouredDate:i}=this.option(),n=e??i,s=this._getContouredCell(),o=this._getCellByDate(n);s.removeClass("dx-calendar-contoured-date"),n&&o.addClass("dx-calendar-contoured-date")}_getContouredCell(){return this._$table.find(".dx-calendar-contoured-date")}_renderValue(){if(!this.option("allowValueSelection"))return;let{value:e=[]}=this.option();Array.isArray(e)||(e=[e]),this._updateSelectedClass(e)}_updateSelectedClass(e){var t;this._isRangeMode()&&!this._isMonthView()||((t=this._$selectedCells)===null||t===void 0||t.forEach((i=>{i.removeClass("dx-calendar-selected-date")})),this._$selectedCells=e.map((i=>this._getCellByDate(i))),this._$selectedCells.forEach((i=>{i.addClass("dx-calendar-selected-date")})))}_renderRange(){var e,t,i,n,s,o,a,l;const{allowValueSelection:d,value:c=[],range:u}=this.option();!d||!this._isRangeMode()||!this._isMonthView()||((e=this._$rangeCells)===null||e===void 0||e.forEach((p=>{p.removeClass("dx-calendar-cell-in-range")})),(t=this._$hoveredRangeCells)===null||t===void 0||t.forEach((p=>{p.removeClass("dx-calendar-cell-range-hover")})),(i=this._$rangeStartHoverCell)===null||i===void 0||i.removeClass("dx-calendar-cell-range-hover-start"),(n=this._$rangeEndHoverCell)===null||n===void 0||n.removeClass("dx-calendar-cell-range-hover-end"),(s=this._$rangeStartDateCell)===null||s===void 0||s.removeClass("dx-calendar-range-start-date"),(o=this._$rangeEndDateCell)===null||o===void 0||o.removeClass("dx-calendar-range-end-date"),this._$rangeCells=u.map((p=>this._getCellByDate(p))),this._$rangeStartDateCell=this._getCellByDate(c[0]),this._$rangeEndDateCell=this._getCellByDate(c[1]),this._$rangeCells.forEach((p=>{p.addClass("dx-calendar-cell-in-range")})),(a=this._$rangeStartDateCell)===null||a===void 0||a.addClass("dx-calendar-range-start-date"),(l=this._$rangeEndDateCell)===null||l===void 0||l.addClass("dx-calendar-range-end-date"))}_renderHoveredRange(){var e,t,i,n,s;const{allowValueSelection:o,hoveredRange:a}=this.option();!o||!this._isRangeMode()||!this._isMonthView()||((e=this._$hoveredRangeCells)===null||e===void 0||e.forEach((l=>{l.removeClass("dx-calendar-cell-range-hover")})),(t=this._$rangeStartHoverCell)===null||t===void 0||t.removeClass("dx-calendar-cell-range-hover-start"),(i=this._$rangeEndHoverCell)===null||i===void 0||i.removeClass("dx-calendar-cell-range-hover-end"),this._$hoveredRangeCells=a.map((l=>this._getCellByDate(l))),this._$rangeStartHoverCell=this._getCellByDate(a[0]),this._$rangeEndHoverCell=this._getCellByDate(a[a.length-1]),this._$hoveredRangeCells.forEach((l=>{l.addClass("dx-calendar-cell-range-hover")})),(n=this._$rangeStartHoverCell)===null||n===void 0||n.addClass("dx-calendar-cell-range-hover-start"),(s=this._$rangeEndHoverCell)===null||s===void 0||s.addClass("dx-calendar-cell-range-hover-end"))}_isMonthView(){const{zoomLevel:e}=this.option();return e==="month"}_isRangeMode(){const{selectionMode:e}=this.option();return e===Kt.range}_getCurrentDateFormat(){return null}getCellAriaLabel(e){const t=this._getViewName(),i=this._isTodayCell(e),n=this._getCurrentDateFormat(),s=n?`${P.format(e,n)}`:this._getCellText(e);return i?`${s}. ${Pf[t]}`:s}_getFirstAvailableDate(){const{date:e,min:t}=this.option(),i=R.getViewFirstCellDate(this._getViewName(),e)??e;return new Date(t&&i<t?t:i)}_getCellByDate(e){return h()}isBoundary(e){return!1}_optionChanged(e){const{name:t,value:i}=e;switch(t){case"value":this._renderValue(),this._updateTableAriaLabel();break;case"range":this._renderRange();break;case"hoveredRange":this._renderHoveredRange();break;case"contouredDate":this._renderContouredDate(i);break;case"onCellClick":this._createCellClickAction();break;case"onCellHover":this._createCellHoverAction();break;case"min":case"max":case"disabledDates":case"cellTemplate":case"selectionMode":this._invalidate();break;case"_todayDate":this._renderBody();break;default:super._optionChanged(e)}}}class kf extends ys{_getViewName(){return"month"}_getCurrentDateFormat(){return"longdate"}_getDefaultOptions(){return T({},super._getDefaultOptions(),{firstDayOfWeek:0,rowCount:6,colCount:7})}_renderImpl(){super._renderImpl(),this._renderHeader()}_renderBody(){super._renderBody(),this._$table.find(".dx-calendar-other-view").addClass("dx-calendar-other-month")}_renderFocusTarget(){}_renderHeader(){const e=h("<tr>"),t=h("<thead>").append(e);this._$table.prepend(t);const{colCount:i,showWeekNumbers:n}=this.option();for(let s=0,o=i;s<o;s+=1)this._renderHeaderCell(s,e);n&&this._renderWeekHeaderCell(e)}_renderHeaderCell(e,t){const{firstDayOfWeek:i=0}=this.option(),{full:n,abbreviated:s}=this._getDayCaption(i+e),o=h("<th>").attr({scope:"col",abbr:n}).text(s);t.append(o)}_renderWeekHeaderCell(e){const t=h("<th>").attr({scope:"col",abbr:"WeekNumber",class:"dx-week-number-header"});e.prepend(t)}_renderWeekNumberCell(e){const{showWeekNumbers:t,cellTemplate:i,selectionMode:n,selectWeekOnClick:s}=this.option();if(!t)return;const o=this._getWeekNumber(e.prevCellDate),a=M.createElement("td"),l=h(a);a.className="dx-calendar-week-number-cell",n!=="single"&&s&&l.addClass("dx-calendar-week-selection"),i?i.render(this._prepareCellTemplateData(o,-1,l)):a.innerHTML=`${o}`,e.row.prepend(a),this.setAria({role:"gridcell",label:`Week ${o}`},l)}_getWeekNumber(e){const{weekNumberRule:t="auto",firstDayOfWeek:i}=this.option();return t==="auto"?R.getWeekNumber(e,i,i===1?"firstFourDays":"firstDay"):R.getWeekNumber(e,i,t)}getNavigatorCaption(){const{date:e}=this.option();return`${P.format(e,"monthandyear")}`}_isTodayCell(e){const{_todayDate:t}=this.option();return R.sameDate(e,t())}_isDateOutOfRange(e){const t=this.option("min"),i=this.option("max");return!R.dateInRange(e,t,i,"date")}_isOtherView(e){const{date:t}=this.option();return e.getMonth()!==t.getMonth()}_isStartDayOfMonth(e){return R.sameDate(e,R.getFirstMonthDate(this.option("date")))}_isEndDayOfMonth(e){return R.sameDate(e,R.getLastMonthDate(this.option("date")))}_getCellText(e){return`${P.format(e,"d")}`}_getDayCaption(e){const{colCount:t}=this.option(),i=e%t;return{full:P.getDayNames()[i],abbreviated:P.getDayNames("abbreviated")[i]}}_getFirstCellData(){const{firstDayOfWeek:e=0,date:t}=this.option(),i=R.getFirstMonthDate(t);let n=e-i.getDay();const{colCount:s}=this.option();return n>=0&&(n-=s),i.setDate(i.getDate()+n),i}_getNextCellData(e){const t=new Date(e);return t.setDate(t.getDate()+1),t}_getCellByDate(e){return this._$table.find(`td[data-value='${fe.serializeDate(e,R.getShortDateFormat())}']`)}isBoundary(e){return R.sameMonthAndYear(e,this.option("min"))||R.sameMonthAndYear(e,this.option("max"))}_getDefaultDisabledDatesHandler(e){return t=>e.some((i=>R.sameDate(i,t.date)))}}class Mf extends ys{_getViewName(){return"year"}_getCurrentDateFormat(){return"monthandyear"}_isTodayCell(e){const{_todayDate:t}=this.option();return R.sameMonthAndYear(e,t())}_isDateOutOfRange(e){return!R.dateInRange(e,R.getFirstMonthDate(this.option("min")),R.getLastMonthDate(this.option("max")))}_isOtherView(){return!1}_isStartDayOfMonth(){return!1}_isEndDayOfMonth(){return!1}_getCellText(e){return P.getMonthNames("abbreviated")[e.getMonth()]}_getFirstCellData(){const{date:e}=this.option(),t=new Date(e);return t.setDate(1),t.setMonth(0),t}_getNextCellData(e){const t=new Date(e);return t.setMonth(t.getMonth()+1),t}_getCellByDate(e){const t=new Date(e);return t.setDate(1),this._$table.find(`td[data-value='${fe.serializeDate(t,R.getShortDateFormat())}']`)}getNavigatorCaption(){const{date:e}=this.option();return`${P.format(e,"yyyy")}`}isBoundary(e){return R.sameYear(e,this.option("min"))||R.sameYear(e,this.option("max"))}_renderWeekNumberCell(){}}class Bf extends ys{_getViewName(){return"decade"}_isTodayCell(e){const{_todayDate:t}=this.option();return R.sameYear(e,t())}_isDateOutOfRange(e){const{min:t,max:i}=this.option();return!R.dateInRange(e.getFullYear(),t==null?void 0:t.getFullYear(),i==null?void 0:i.getFullYear())}_isOtherView(e){const t=new Date(e);return t.setMonth(1),!R.sameDecade(t,this.option("date"))}_isStartDayOfMonth(){return!1}_isEndDayOfMonth(){return!1}_getCellText(e){return`${P.format(e,"yyyy")}`}_getFirstCellData(){const e=R.getFirstYearInDecade(this.option("date"))-1;return R.createDateWithFullYear(e,0,1)}_getNextCellData(e){const t=new Date(e);return t.setFullYear(t.getFullYear()+1),t}getNavigatorCaption(){const{date:e}=this.option(),t=R.getFirstYearInDecade(e),i=new Date(e),n=new Date(e);return i.setFullYear(t),n.setFullYear(t+9),`${P.format(i,"yyyy")}-${P.format(n,"yyyy")}`}_isValueOnCurrentView(e,t){return R.sameDecade(e,t)}_getCellByDate(e){const t=new Date(e);return t.setDate(1),t.setMonth(0),this._$table.find(`td[data-value='${fe.serializeDate(t,R.getShortDateFormat())}']`)}isBoundary(e){return R.sameDecade(e,this.option("min"))||R.sameDecade(e,this.option("max"))}_renderWeekNumberCell(){}}class Nf extends ys{_getViewName(){return"century"}_isTodayCell(e){const{_todayDate:t}=this.option();return R.sameDecade(e,t())}_isDateOutOfRange(e){const t=R.getFirstYearInDecade(e),i=R.getFirstYearInDecade(this.option("min")),n=R.getFirstYearInDecade(this.option("max"));return!R.dateInRange(t,i,n)}_isOtherView(e){const t=new Date(e);return t.setMonth(1),!R.sameCentury(t,this.option("date"))}_isStartDayOfMonth(){return!1}_isEndDayOfMonth(){return!1}_getCellText(e){const t=P.format(e,"yyyy"),i=new Date(e);return i.setFullYear(i.getFullYear()+9),`${t} - ${P.format(i,"yyyy")}`}_getFirstCellData(){const e=R.getFirstDecadeInCentury(this.option("date"))-10;return R.createDateWithFullYear(e,0,1)}_getNextCellData(e){const t=new Date(e);return t.setFullYear(t.getFullYear()+10),t}_getCellByDate(e){const t=new Date(e);return t.setDate(1),t.setMonth(0),t.setFullYear(R.getFirstYearInDecade(t)),this._$table.find(`td[data-value='${fe.serializeDate(t,R.getShortDateFormat())}']`)}getNavigatorCaption(){const{date:e}=this.option(),t=R.getFirstDecadeInCentury(e),i=new Date(e),n=new Date(e);return i.setFullYear(t),n.setFullYear(t+99),`${P.format(i,"yyyy")}-${P.format(n,"yyyy")}`}isBoundary(e){return R.sameCentury(e,this.option("min"))||R.sameCentury(e,this.option("max"))}_renderWeekNumberCell(){}}const Lf={month:kf,year:Mf,decade:Bf,century:Nf},ja=V(wd,"dxCalendar"),ci={month:3,year:2,decade:1,century:0},ie={MONTH:"month",YEAR:"year",DECADE:"decade",CENTURY:"century"},$f={SingleSelection:Af,MultipleSelection:Vf,RangeSelection:Ff};class Lc extends gn{_getDefaultOptions(){return T({},super._getDefaultOptions(),{hoverStateEnabled:!0,activeStateEnabled:!0,currentDate:new Date,value:null,min:new Date(1e3,0),max:new Date(3e3,0),viewsCount:1,zoomLevel:ie.MONTH,maxZoomLevel:ie.MONTH,minZoomLevel:ie.CENTURY,selectionMode:"single",selectWeekOnClick:!0,showTodayButton:!1,todayButtonText:w.format("dxCalendar-todayButtonText"),showWeekNumbers:!1,weekNumberRule:"auto",cellTemplate:"cell",disabledDates:null,onCellClick:null,onContouredChanged:null,skipFocusCheck:!1,_todayDate:()=>new Date})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:()=>G.real().deviceType==="desktop"&&!G.isSimulator(),options:{focusStateEnabled:!0}}])}_supportedKeys(){return T({},super._supportedKeys(),{rightArrow(e){e.preventDefault(),Ae(e)?this._waitRenderView(1):this._moveCurrentDateByOffset(1*this._getRtlCorrection())},leftArrow(e){e.preventDefault(),Ae(e)?this._waitRenderView(-1):this._moveCurrentDateByOffset(-1*this._getRtlCorrection())},upArrow(e){if(e.preventDefault(),Ae(e))this._navigateUp();else{if(ve.isAnimating(this._view.$element().get(0)))return;this._moveCurrentDateByOffset(-1*this._view.option("colCount"))}},downArrow(e){if(e.preventDefault(),Ae(e))this._navigateDown();else{if(ve.isAnimating(this._view.$element().get(0)))return;this._moveCurrentDateByOffset(1*this._view.option("colCount"))}},home(e){e.preventDefault();const t=this.option("zoomLevel"),i=this.option("currentDate"),n=this._getDateOption("min");if(this._view.isDateDisabled(i))return;const s=R.sameView(t,i,n)?n:R.getViewFirstCellDate(t,i);this._moveToClosestAvailableDate(s)},end(e){e.preventDefault();const t=this.option("zoomLevel"),i=this.option("currentDate"),n=this._getDateOption("max");if(this._view.isDateDisabled(i))return;const s=R.sameView(t,i,n)?n:R.getViewLastCellDate(t,i);this._moveToClosestAvailableDate(s)},pageUp(e){e.preventDefault(),this._waitRenderView(-1*this._getRtlCorrection())},pageDown(e){e.preventDefault(),this._waitRenderView(1*this._getRtlCorrection())},tab(){},enter:this._enterKeyHandler})}_enterKeyHandler(e){const{currentDate:t=new Date}=this.option();if(!this._isMaxZoomLevel())this._navigateDown();else if(!this._view.isDateDisabled(t)){const i=this._updateTimeComponent(t);this._selectionStrategy.selectValue(i,e)}}_getSerializationFormat(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"value";const{[e]:t}=this.option(),{dateSerializationFormat:i}=this.option();if(i)return i;if(Ee(t))return"number";if(!(!W(t)||t===""))return fe.getDateSerializationFormat(t)}_convertToDate(e){return fe.deserializeDate(e)}_dateValue(e,t){if(t){if(t.type==="keydown"){const i=this._view._getContouredCell().get(0);t.target=i}this._saveValueChangeEvent(t)}this._setDateOption("value",e)}_isArrayValue(e,t){return e==="value"&&!this._isSingleMode()}_setDateOption(e,t){const i=this._getSerializationFormat(e),n=this._isArrayValue(e,t)?t.map((s=>fe.serializeDate(s,i))):fe.serializeDate(t,i);this.option(e,n)}_getDateOption(e){let{[e]:t}=this.option();return this._isArrayValue(e,t)?(t??[]).map((n=>this._convertToDate(n))):(t===""&&(t=null),this._convertToDate(t))}_isSingleMode(){const{selectionMode:e}=this.option();return e==="single"}_shiftDate(e,t,i,n){switch(e){case ie.MONTH:t.setDate(t.getDate()+i*n);break;case ie.YEAR:t.setMonth(t.getMonth()+i*n);break;case ie.DECADE:t.setFullYear(t.getFullYear()+i*n);break;case ie.CENTURY:t.setFullYear(t.getFullYear()+10*i*n)}}_moveCurrentDateByOffset(e){const{currentDate:t=new Date,zoomLevel:i=ie.MONTH}=this.option();let n=new Date(t);this._shiftDate(i,n,e,1);const s=this._getMaxDate(),o=this._getMinDate();let a=this._areDatesInNeighborView(i,n,t),l=Jt(n,o,s)&&a;const d=new Date(n);for(;l;){if(!this._view.isDateDisabled(d)){n=d;break}this._shiftDate(i,d,e,1),a=this._areDatesInNeighborView(i,d,t),l=Jt(d,o,s)&&a}if(this._view.isDateDisabled(t)||this._view.isDateDisabled(n)){const c=e>0?1:-1;(c===1?this._isNextViewDisabled():this._isPrevViewDisabled())?this._moveToClosestAvailableDate(n):this._waitRenderView(c)}else this._skipNavigate=!0,this.option("currentDate",n)}_isNextViewDisabled(){const{disabled:e}=this._navigator._nextButton.option();return e===!0}_isPrevViewDisabled(){const{disabled:e}=this._navigator._prevButton.option();return e===!0}_areDatesInSameView(e,t,i){switch(e){case ie.YEAR:return t.getFullYear()===i.getFullYear();case ie.DECADE:return Math.floor(t.getFullYear()/10)===Math.floor(i.getFullYear()/10);case ie.CENTURY:return Math.floor(t.getFullYear()/100)===Math.floor(i.getFullYear()/100);case ie.MONTH:default:return t.getMonth()===i.getMonth()}}_areDatesInNeighborView(e,t,i){switch(e){case ie.YEAR:return Math.abs(t.getFullYear()-i.getFullYear())<=1;case ie.DECADE:return Math.abs(t.getFullYear()-i.getFullYear())<=10;case ie.CENTURY:return Math.abs(t.getFullYear()-i.getFullYear())<=100;case ie.MONTH:default:return((n,s)=>{const o=Math.abs(n-s);return Math.min(o,12-o)})(t.getMonth(),i.getMonth())<=1}}_moveToClosestAvailableDate(e){const{zoomLevel:t=ie.MONTH,currentDate:i=new Date}=this.option();let n=new Date(e??i);const s=!this._isDateNotAvailable(n);let o=s,a=s,l=!0,d=!0;const c=new Date(n),u=new Date(n);do{if(o){n=c;break}if(a){n=u;break}this._shiftDate(t,c,1,1),this._shiftDate(t,u,1,-1),l=this._areDatesInSameView(t,c,e??i),d=this._areDatesInSameView(t,u,e??i),o=l&&!this._isDateNotAvailable(c),a=d&&!this._isDateNotAvailable(u)}while(l||d);this.option("currentDate",n)}_isDateNotAvailable(e){const t=this._getMaxDate(),i=this._getMinDate();return!Jt(e,i,t)||this._view.isDateDisabled(e)}_init(){super._init(),this._activeStateUnit=".dx-calendar-cell",this._initSelectionStrategy(),this._correctZoomLevel(),this._initCurrentDate(),this._initActions()}_initSelectionStrategy(){const e=this._getSelectionStrategyName(),t=$f[e];(!this._selectionStrategy||this._selectionStrategy.NAME!==e)&&(this._selectionStrategy=new t(this))}_refreshSelectionStrategy(){this._initSelectionStrategy(),this._selectionStrategy.restoreValue(),this._refresh()}_getSelectionStrategyName(){const{selectionMode:e}=this.option();switch(e){case"multiple":return"MultipleSelection";case"range":return"RangeSelection";default:return"SingleSelection"}}_correctZoomLevel(){const{minZoomLevel:e=ie.CENTURY,maxZoomLevel:t=ie.MONTH,zoomLevel:i=ie.MONTH}=this.option();if(!(ci[t]<ci[e])){if(ci[i]>ci[t]){this.option("zoomLevel",t);return}ci[i]<ci[e]&&this.option("zoomLevel",e)}}_initCurrentDate(){const{currentDate:e=new Date}=this.option(),t=this._selectionStrategy.getDefaultCurrentDate(),i=(t?this._getNormalizedDate(t):null)??this._getNormalizedDate(e);this.option("currentDate",i)}_getNormalizedDate(e){const t=R.normalizeDate(e,this._getMinDate(),this._getMaxDate());return m(t)?this._getDate(t):e}_initActions(){this._cellClickAction=this._createActionByOption("onCellClick"),this._onContouredChanged=this._createActionByOption("onContouredChanged")}_initTemplates(){this._templateManager.addDefaultTemplates({cell:new Bh((e=>{const t=e.model;h(e.container).append(h("<span>").text((t==null?void 0:t.text)||String(t)))}))}),super._initTemplates()}_updateCurrentDate(e){ve.isAnimating(this._$viewsWrapper.get(0))&&ve.stop(this._$viewsWrapper.get(0),!0);const t=this._getMinDate(),i=this._getMaxDate();if(t>i){this.option("currentDate",new Date);return}const n=this._getNormalizedDate(e);if(e.getTime()!==n.getTime()){this.option("currentDate",new Date(n));return}const{date:s}=this._view.option();let o=this._getViewsOffset(s,n);o!==0&&!this._isMaxZoomLevel()&&this._isOtherViewCellClicked&&(o=0),this._view&&o!==0&&!this._suppressNavigation?this._additionalView?o>2||o<-1?(this._refreshViews(),this._setViewContoured(n),this._updateAriaId(n),this._renderNavigator()):o===1&&this._skipNavigate?(this._setViewContoured(n),this._updateAriaId(n)):this._navigate(o,n):this._navigate(o,n):(this._renderNavigator(),this._setViewContoured(n),this._updateAriaId(n)),this._skipNavigate=!1}_isAdditionalViewDate(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Date;return this._additionalView?e>=this._additionalView._getFirstAvailableDate():!1}_getActiveView(e){return this._isAdditionalViewDate(e)?this._additionalView:this._view}_setViewContoured(e){if(this.option("skipFocusCheck")||h(this._$viewsWrapper).is(":focus")){var t;this._view.option("contouredDate",null),(t=this._additionalView)===null||t===void 0||t.option("contouredDate",null),(this._isAdditionalViewDate(e)?this._additionalView:this._view).option("contouredDate",e)}}_getMinDate(){const{rangeMin:e}=this.option();return e||(this.min?this.min:(this.min=this._getDateOption("min")??new Date(1e3,0),this.min))}_getMaxDate(){const{rangeMax:e}=this.option();return e||(this.max?this.max:(this.max=this._getDateOption("max")??new Date(3e3,0),this.max))}_getViewsOffset(e,t){const{zoomLevel:i}=this.option();if(i===ie.MONTH)return this._getMonthsOffset(e,t);let n=1;switch(i){case ie.CENTURY:n=100;break;case ie.DECADE:n=10;break;default:n=1}return Math.floor(t.getFullYear()/n)-Math.floor(e.getFullYear()/n)}_getMonthsOffset(e,t){const i=t.getFullYear()-e.getFullYear(),n=t.getMonth()-e.getMonth();return 12*i+n}_waitRenderView(e){if(this._alreadyViewRender)return;this._alreadyViewRender=!0;const t=this._getDateByOffset(e*this._getRtlCorrection());this._moveToClosestAvailableDate(t),this._waitRenderViewTimeout=setTimeout((()=>{this._alreadyViewRender=!1}))}_getRtlCorrection(){const{rtlEnabled:e}=this.option();return e?-1:1}_getDateByOffset(e,t){const{currentDate:i=new Date}=this.option(),n=this._getDate(t??i),s=n.getDate(),o=R.getDifferenceInMonth(this.option("zoomLevel"))*e;n.setDate(1),n.setMonth(n.getMonth()+o);const a=R.getLastMonthDate(n).getDate();return n.setDate(s>a?a:s),n}_focusTarget(){return this._$viewsWrapper}_focusEventTarget(){return this.$element()}_initMarkup(){this._renderSubmitElement();const e=this.$element();e.addClass("dx-calendar");const{selectionMode:t}=this.option();e.toggleClass("dx-calendar-range",t==="range"),this._renderBody(),e.append(this.$body),this._renderViews(),this._renderNavigator(),super._initMarkup(),this._renderEvents(),e.prepend(this._navigator.$element()),this._renderSwipeable(),this._renderFooter(),this._selectionStrategy.updateAriaSelected(),this._updateAriaId(),this._updateNavigatorLabels(),this.setAria("role","application"),this._updateAriaLabelAndRole(),this._moveToClosestAvailableDate()}_render(){super._render();const{currentDate:e=new Date}=this.option();this._setViewContoured(e)}_renderBody(){this._$viewsWrapper||(this.$body=h("<div>").addClass("dx-calendar-body"),this._$viewsWrapper=h("<div>").addClass("dx-calendar-views-wrapper"),this.$body.append(this._$viewsWrapper))}_updateAriaLabelAndRole(){const e=this.option("readOnly"),t=this.$element(),i={role:e?"group":void 0,label:e?w.format("dxCalendar-readOnlyLabel"):void 0};this.setAria(i,t)}_setAriaReadonly(){}_getKeyboardListeners(){return super._getKeyboardListeners().concat([this._view])}_renderViews(){const{zoomLevel:e}=this.option();this.$element().addClass(`dx-calendar-view-${e}`);const{currentDate:t=new Date,viewsCount:i}=this.option();if(this.$element().toggleClass("dx-calendar-multiview",i>1),this._view=this._renderSpecificView(t),pe()){const n=this._getDateByOffset(-1,t);this._beforeView=this._isViewAvailable(n)?this._renderSpecificView(n):null;const s=this._getDateByOffset(i,t);s.setDate(1),this._afterView=this._isViewAvailable(s)?this._renderSpecificView(s):null}i>1&&(this._additionalView=this._renderSpecificView(this._getDateByOffset(1,t))),this._translateViews()}_renderSpecificView(e){const{zoomLevel:t=ie.MONTH}=this.option(),i=Lf[t],n=h("<div>").appendTo(this._$viewsWrapper),s=this._viewConfig(e);return this._createComponent(n,i,s)}_viewConfig(e){const{firstDayOfWeek:t=P.firstDayOfWeekIndex(),showWeekNumbers:i=!1,selectWeekOnClick:n,weekNumberRule:s,zoomLevel:o=ie.MONTH,focusStateEnabled:a,hoverStateEnabled:l,disabledDates:d,_todayDate:c}=this.option(),u=B(d)?this._injectComponent(d.bind(this)):d;return T({},this._selectionStrategy.getViewOptions(),{date:e,min:this._getMinDate(),max:this._getMaxDate(),firstDayOfWeek:t,showWeekNumbers:i,selectWeekOnClick:n,weekNumberRule:s,zoomLevel:o,tabIndex:void 0,focusStateEnabled:a,hoverStateEnabled:l,disabledDates:u,onCellClick:this._cellClickHandler.bind(this),cellTemplate:this._getTemplateByOption("cellTemplate"),allowValueSelection:this._isMaxZoomLevel(),_todayDate:c})}_renderEvents(){v.off(this._$viewsWrapper,ja);const{selectionMode:e}=this.option();e==="range"&&v.on(this._$viewsWrapper,ja,null,(()=>{this._updateViewsOption("hoveredRange",[])}))}_injectComponent(e){return t=>e(T({},t,{component:this}))}_isViewAvailable(e){const{zoomLevel:t}=this.option(),i=R.getViewMinBoundaryDate(t,this._getMinDate()),n=R.getViewMaxBoundaryDate(t,this._getMaxDate());return R.dateInRange(e,i,n)}_translateViews(){const{viewsCount:e}=this.option();jt(this._view.$element(),{left:0,top:0}),this._moveViewElement(this._beforeView,-1),this._moveViewElement(this._afterView,e),this._moveViewElement(this._additionalView,1)}_moveViewElement(e,t){e&&jt(e.$element(),{left:this._getViewPosition(t),top:0})}_getViewPosition(e){const t=this.option("rtlEnabled")?-1:1;return 100*e*t+"%"}_cellClickHandler(e){const t=this.option("zoomLevel"),i=R.getViewDown(t),n=this._isMaxZoomLevel();if(i&&!n)this._navigateDown(e.event.currentTarget);else{var s;const o=this._updateTimeComponent(e.value);this._selectionStrategy.selectValue(o,e.event),(s=this._cellClickAction)===null||s===void 0||s.call(this,e)}}_updateTimeComponent(e){const t=new Date(e),i=this._getDateOption("value");return i&&!this._isArrayValue("value",i)&&(t.setHours(i.getHours()),t.setMinutes(i.getMinutes()),t.setSeconds(i.getSeconds()),t.setMilliseconds(i.getMilliseconds())),t}_isMaxZoomLevel(){const{zoomLevel:e=ie.MONTH,maxZoomLevel:t}=this.option();return e===t}_navigateDown(e){const{zoomLevel:t,currentDate:i=new Date}=this.option();if(this._isMaxZoomLevel())return;const n=R.getViewDown(t);if(!n)return;const{contouredDate:s,date:o}=this._view.option();let a=s??o;e&&(a=h(e).data("dxDateValueKey")),this._isOtherViewCellClicked=!0,this.option("currentDate",a),this.option("zoomLevel",n),this._isOtherViewCellClicked=!1,this._renderNavigator(),this._animateShowView(),this._moveToClosestAvailableDate(),this._setViewContoured(this._getNormalizedDate(i))}_renderNavigator(){this._navigator||(this._navigator=this._createComponent(h("<div>"),Of,this._navigatorConfig())),this._navigator.option("text",this._getViewsCaption(this._view,this._additionalView)),this._updateButtonsVisibility()}_navigatorConfig(){const{focusStateEnabled:e,rtlEnabled:t}=this.option();return{text:this._getViewsCaption(this._view,this._additionalView),onClick:this._navigatorClickHandler.bind(this),onCaptionClick:this._navigateUp.bind(this),focusStateEnabled:e,rtlEnabled:t,tabIndex:void 0}}_navigatorClickHandler(e){const{currentDate:t,viewsCount:i}=this.option();let n=e.direction;if(i>1){const o=this._isAdditionalViewDate(t);(o&&n<0||!o&&n>0)&&(n*=2)}const s=this._getDateByOffset(n,t);this._moveToClosestAvailableDate(s)}_navigateUp(){const{zoomLevel:e=ie.MONTH,currentDate:t=new Date}=this.option(),i=R.getViewUp(e);!i||this._isMinZoomLevel(e)||(this.option("zoomLevel",i),this._renderNavigator(),this._animateShowView(),this._moveToClosestAvailableDate(),this._setViewContoured(this._getNormalizedDate(t)))}_isMinZoomLevel(e){const t=this._getMinDate(),i=this._getMaxDate(),{minZoomLevel:n}=this.option();return!!R.sameView(e,t,i)||n===e}_updateButtonsVisibility(){this._navigator.toggleButton("next",!m(this._afterView)),this._navigator.toggleButton("prev",!m(this._beforeView))}_renderSwipeable(){this._swipeable||(this._swipeable=this._createComponent(this.$element(),rs,{onStart:e=>{this._swipeStartHandler(e.event)},onUpdated:e=>{this._swipeUpdateHandler(e.event)},onEnd:e=>{this._swipeEndHandler(e.event)},itemSizeFunc:this._viewWidth.bind(this)}))}_swipeStartHandler(e){ve.stop(this._$viewsWrapper.get(0),!0);const{viewsCount:t}=this.option();this._toggleGestureCoverCursor("grabbing"),e.maxLeftOffset=this._getRequiredView("next")?1/t:0,e.maxRightOffset=this._getRequiredView("prev")?1/t:0}_toggleGestureCoverCursor(e){h(".dx-gesture-cover").css("cursor",e)}_getRequiredView(e){const{rtlEnabled:t}=this.option();return e==="prev"?t?this._afterView:this._beforeView:t?this._beforeView:this._afterView}_swipeUpdateHandler(e){const{offset:t}=e;jt(this._$viewsWrapper,{left:t*this._viewWidth(),top:0}),this._updateNavigatorCaption(t)}_swipeEndHandler(e){this._toggleGestureCoverCursor("auto");const{currentDate:t,rtlEnabled:i}=this.option(),{targetOffset:n}=e,s=n?n/Math.abs(n):0,a=this._isAdditionalViewDate(t)&&(i?s===-1:s===1);if(s===0){this._animateWrapper(0,250);return}const l=-s*this._getRtlCorrection()*(a?2:1);let d=this._getDateByOffset(l);this._isDateInInvalidRange(d)&&(s>=0?d=new Date(this._getMinDate()):d=new Date(this._getMaxDate())),this.option("currentDate",d)}_viewWidth(){if(!this._viewWidthValue){const{viewsCount:e}=this.option();this._viewWidthValue=H(this.$element())/e}return this._viewWidthValue}_updateNavigatorCaption(e){const t=e*this._getRtlCorrection(),{viewsCount:i}=this.option(),n=i>1;let s=null,o=null;t>.5&&this._beforeView?(s=this._beforeView,n&&(o=this._view)):t<-.5&&this._afterView?(s=n?this._additionalView:this._afterView,o=n?this._afterView:null):(s=this._view,o=n?this._additionalView:null),this._navigator.option("text",this._getViewsCaption(s,o))}_getViewsCaption(e,t){let i=e.getNavigatorCaption();const{viewsCount:n}=this.option();if(n>1&&t){const s=t.getNavigatorCaption();i=`${i} - ${s}`}return i}_isDateInInvalidRange(e){if(this._view.isBoundary(e))return!1;const t=this._getMinDate(),i=this._getMaxDate(),n=R.normalizeDate(e,t,i);return n===t||n===i}_renderFooter(){const{showTodayButton:e,todayButtonText:t}=this.option();if(e){const i=this._createComponent(h("<div>"),Ze,{focusStateEnabled:this.option("focusStateEnabled"),text:t,onClick:n=>{this._toTodayView(n)},type:st(Se())?"normal":"default",stylingMode:st(Se())?"outlined":"text",integrationOptions:{}}).$element().addClass("dx-calendar-today-button");this._$footer=h("<div>").addClass("dx-calendar-footer").append(i),this.$element().append(this._$footer)}this.$element().toggleClass("dx-calendar-with-footer",e)}_renderSubmitElement(){this._$submitElement=h("<input>").attr("type","hidden").appendTo(this.$element());const{value:e}=this.option();this._setSubmitValue(e)}_setSubmitValue(e){if(this._isArrayValue("value",e))return;const t=this._convertToDate(e);this._getSubmitElement().val(fe.serializeDate(t,"yyyy-MM-dd"))}_getSubmitElement(){return this._$submitElement}_animateShowView(){ve.stop(this._view.$element().get(0),!0),this._popAnimationView(this._view,.6,1,250);const{viewsCount:e}=this.option();e>1&&(ve.stop(this._additionalView.$element().get(0),!0),this._popAnimationView(this._additionalView,.6,1,250))}_popAnimationView(e,t,i,n){return ve.animate(e.$element().get(0),{type:"pop",from:{scale:t,opacity:t},to:{scale:i,opacity:i},duration:n})}_navigate(e,t){if(e!==0&&Math.abs(e)!==1&&this._isViewAvailable(t)){const d=this._renderSpecificView(t);if(e>0){var i;(i=this._afterView)===null||i===void 0||i.$element().remove(),this._afterView=d}else{var n;(n=this._beforeView)===null||n===void 0||n.$element().remove(),this._beforeView=d}this._translateViews()}const s=this._getRtlCorrection(),o=Qn(e),a=-s*o*this._viewWidth();this._$viewsWrapper.position().left!==a&&(this._preventViewChangeAnimation?this._wrapperAnimationEndHandler(e,t):this._animateWrapper(a,250).done(this._wrapperAnimationEndHandler.bind(this,e,t)))}_animateWrapper(e,t){return ve.animate(this._$viewsWrapper.get(0),{type:"slide",from:{left:this._$viewsWrapper.position().left},to:{left:e},duration:t})}_getDate(e){return new Date(e)}_toTodayView(e){const t=new Date;if(this._isMaxZoomLevel()){this._selectionStrategy.selectValue(t,e.event);return}this._preventViewChangeAnimation=!0,this.option("zoomLevel",this.option("maxZoomLevel")),this._selectionStrategy.selectValue(t,e.event),this._animateShowView(),this._preventViewChangeAnimation=!1}_wrapperAnimationEndHandler(e,t){this._rearrangeViews(e),this._translateViews(),this._resetLocation(),this._renderNavigator(),this._setViewContoured(t),this._updateAriaId(t),this._selectionStrategy.updateAriaSelected()}_rearrangeViews(e){var t;if(e===0)return;const{viewsCount:i}=this.option();let n=-1,s="_afterView",o="_beforeView",a=i===1?"_view":"_additionalView",l="_view";if(e<0&&(n=1,s="_beforeView",o="_afterView",a="_view",l=i===1?"_view":"_additionalView"),!this[s])return;const d=this[s].option("date");(t=this[o])===null||t===void 0||t.$element().remove(),this[o]=this._renderSpecificView(this._getDateByOffset(n*i,d)),this[l].$element().remove(),i===1?this[l]=this[s]:(this[l]=this[a],this[a]=this[s]);const c=this._getDateByOffset(-n,d);this[s]=this._isViewAvailable(c)?this._renderSpecificView(c):null}_resetLocation(){jt(this._$viewsWrapper,{left:0,top:0})}_clean(){super._clean(),this._clearViewWidthCache(),delete this._$viewsWrapper,delete this._navigator,delete this._$footer}_clearViewWidthCache(){delete this._viewWidthValue}_disposeViews(){var e,t,i;this._view.$element().remove(),(e=this._beforeView)===null||e===void 0||e.$element().remove(),(t=this._additionalView)===null||t===void 0||t.$element().remove(),(i=this._afterView)===null||i===void 0||i.$element().remove(),delete this._view,delete this._additionalView,delete this._beforeView,delete this._afterView,delete this._skipNavigate}_dispose(){clearTimeout(this._waitRenderViewTimeout),super._dispose()}_refreshViews(){this._resetActiveState(),this._disposeViews(),this._renderViews()}_visibilityChanged(){this._translateViews()}_shouldSkipFocusEvent(e){const{target:t,relatedTarget:i}=e;return!!h(t).parents(".dx-calendar").length&&!!h(i).parents(".dx-calendar").length}_focusInHandler(e){if(h(e.target).is(this._$viewsWrapper)){const{currentDate:t=new Date}=this.option();this._setViewContoured(t)}this._shouldSkipFocusEvent(e)||(super._focusInHandler.apply(this,[e]),this._toggleFocusClass(!0,this.$element()))}_focusOutHandler(e){if(h(e.target).is(this._$viewsWrapper)){var t;this._view.option("contouredDate",null),(t=this._additionalView)===null||t===void 0||t.option("contouredDate",null)}this._shouldSkipFocusEvent(e)||(super._focusOutHandler.apply(this,[e]),this._toggleFocusClass(!1,this.$element()))}_updateViewsOption(e,t){var i,n,s;this._view.option(e,t),(i=this._additionalView)===null||i===void 0||i.option(e,t),(n=this._beforeView)===null||n===void 0||n.option(e,t),(s=this._afterView)===null||s===void 0||s.option(e,t)}_setViewsMinOption(e){this._restoreViewsMinMaxOptions(),this.option("rangeMin",this._convertToDate(e)),this._updateViewsOption("min",this._getMinDate())}_setViewsMaxOption(e){this._restoreViewsMinMaxOptions(),this.option("rangeMax",this._convertToDate(e)),this._updateViewsOption("max",this._getMaxDate())}_restoreViewsMinMaxOptions(){this._resetActiveState(),this.option({rangeMin:null,rangeMax:null}),this._updateViewsOption("min",this._getMinDate()),this._updateViewsOption("max",this._getMaxDate())}_updateNavigatorLabels(){const{zoomLevel:e=ie.MONTH}=this.option(),t=e.charAt(0).toUpperCase()+e.slice(1),i=this._navigator._caption.option("text"),n=w.format(`dxCalendar-previous${t}ButtonLabel`),s=w.format(`dxCalendar-caption${t}Label`),o=w.format(`dxCalendar-next${t}ButtonLabel`);this.setAria("label",n,this._navigator._prevButton.$element()),this.setAria("label",`${i}. ${s}`,this._navigator._caption.$element()),this.setAria("label",o,this._navigator._nextButton.$element())}_updateAriaSelected(e,t){t==null||t.forEach((n=>{n&&this.setAria("selected",!1,this._view._getCellByDate(n))})),e==null||e.forEach((n=>{n&&this.setAria("selected",!0,this._view._getCellByDate(n))}));const{viewsCount:i}=this.option();i>1&&(t==null||t.forEach((n=>{n&&this.setAria("selected",!1,this._additionalView._getCellByDate(n))})),e==null||e.forEach((n=>{n&&this.setAria("selected",!0,this._additionalView._getCellByDate(n))})))}_updateAriaId(e){var t;const{currentDate:i=new Date}=this.option(),n=e??i,s=`dx-${new Te}`,a=this._getActiveView(n)._getCellByDate(n);this.setAria("id",s,a),this.setAria("activedescendant",s),(t=this._onContouredChanged)===null||t===void 0||t.call(this,s)}_suppressingNavigation(e,t){this._suppressNavigation=!0,e.apply(this,t),delete this._suppressNavigation}_optionChanged(e){const{name:t,value:i,previousValue:n}=e;switch(t){case"width":super._optionChanged(e),this._clearViewWidthCache();break;case"min":case"max":{this.min=void 0,this.max=void 0;const{currentDate:s=new Date}=this.option();this._suppressingNavigation(this._updateCurrentDate,[s]),this._refreshViews(),this._renderNavigator();break}case"selectionMode":this._refreshSelectionStrategy(),this._initCurrentDate();break;case"selectWeekOnClick":case"_todayDate":case"showWeekNumbers":case"weekNumberRule":this._refreshViews();break;case"firstDayOfWeek":this._refreshViews(),this._updateButtonsVisibility();break;case"focusStateEnabled":case"disabledDates":case"dateSerializationFormat":case"cellTemplate":case"showTodayButton":case"todayButtonText":this._invalidate();break;case"currentDate":this.setAria("id",void 0,this._view._getCellByDate(n)),this._updateCurrentDate(i);break;case"zoomLevel":this.$element().removeClass(`dx-calendar-view-${n}`),this._correctZoomLevel(),this._refreshViews(),this._renderNavigator(),this._updateAriaId(),this._updateNavigatorLabels();break;case"minZoomLevel":case"maxZoomLevel":this._correctZoomLevel(),this._updateButtonsVisibility();break;case"value":{R.sameDatesArrays(i,n)||this._selectionStrategy.processValueChanged(i,n),this._setSubmitValue(i),super._optionChanged(e);break}case"viewsCount":this._refreshViews(),this._renderNavigator();break;case"onCellClick":this._view.option("onCellClick",i);break;case"onContouredChanged":this._onContouredChanged=this._createActionByOption("onContouredChanged");break;case"readOnly":super._optionChanged(e),this._updateAriaLabelAndRole();break;case"skipFocusCheck":break;default:super._optionChanged(e)}}getContouredDate(){const{contouredDate:e}=this._view.option();return e}}_e("dxCalendar",Lc);class Is extends Dt.inherit({}){ctor(e){this.dateBox=e}widgetOption(e){var t;return(t=this._widget)===null||t===void 0?void 0:t.option.apply(this._widget,arguments)}_renderWidget(e){e=e||h("<div>"),this._widget=this._createWidget(e),this._widget.$element().appendTo(this._getWidgetContainer())}_createWidget(e){const t=this._getWidgetName(),i=this._getWidgetOptions();return this.dateBox._createComponent(e,t,i)}_getWidgetOptions(){Dt.abstract()}_getWidgetName(){Dt.abstract()}getDefaultOptions(){return{mode:"text"}}getDisplayFormat(e){Dt.abstract()}supportedKeys(){}getKeyboardListener(){}customizeButtons(){}getParsedText(e,t){return P.parse(e,t)||P.parse(e)}renderInputMinMax(){}renderOpenedState(){this._updateValue()}popupConfig(e){Dt.abstract()}_dimensionChanged(){var e;(e=this._getPopup())===null||e===void 0||e.repaint()}renderPopupContent(){const e=this._getPopup();this._renderWidget();const t=e.$content().parent();v.off(t,"mousedown"),v.on(t,"mousedown",this._preventFocusOnPopup.bind(this))}_preventFocusOnPopup(e){e.preventDefault()}_getWidgetContainer(){return this._getPopup().$content()}_getPopup(){return this.dateBox._popup}popupShowingHandler(){}popupHiddenHandler(){}_updateValue(e){var t;(t=this._widget)===null||t===void 0||t.option("value",this.dateBoxValue())}useCurrentDateByDefault(){}getDefaultDate(){return new Date}textChangedHandler(){}renderValue(){this.dateBox.option("opened")&&this._updateValue()}getValue(){return this._widget.option("value")}isAdaptivityChanged(){return!1}dispose(){const e=this._getPopup();e&&e.$content().empty()}dateBoxValue(e,t){return arguments.length?this.dateBox.dateValue.apply(this.dateBox,arguments):this.dateBox.dateOption.apply(this.dateBox,["value"])}}class $c extends Is{ctor(e){super.ctor(e),this.NAME="Calendar"}getDefaultOptions(){return T({},super.getDefaultOptions(),{todayButtonText:this.dateBox.option("todayButtonText")??w.format("dxCalendar-todayButtonText")})}supportedKeys(){const e=function(t){return this.option("opened")?(t.preventDefault(),!0):!1};return{rightArrow(){if(this.option("opened"))return!0},leftArrow(){if(this.option("opened"))return!0},enter:(function(t){if(this.dateBox.option("opened")){if(t.preventDefault(),this._widget.option("zoomLevel")===this._widget.option("maxZoomLevel")){const i=this._getContouredValue(),n=this._lastActionElement,s=this._closeDropDownByEnter();return s&&i&&n==="calendar"&&this.dateBoxValue(i,t),s&&this.dateBox.close(),this.dateBox._valueChangeEventHandler(t),!s}return!0}this.dateBox._valueChangeEventHandler(t)}).bind(this),home:e,end:e}}getDisplayFormat(e){return e||"shortdate"}_closeDropDownByEnter(){return!0}_getWidgetName(){return Lc}_getContouredValue(){return this._widget._view.option("contouredDate")}getKeyboardListener(){return this._widget}_getWidgetOptions(){const{disabledDates:e,min:t,max:i,todayButtonText:n}=this.dateBox.option();return b(this.dateBox.option("calendarOptions"),{value:this.dateBoxValue()||null,selectionMode:"single",dateSerializationFormat:null,min:t,max:i,onValueChanged:this._valueChangedHandler.bind(this),onCellClick:this._cellClickHandler.bind(this),disabledDates:B(e)?this._injectComponent(e.bind(this.dateBox)):e,onContouredChanged:this._refreshActiveDescendant.bind(this),skipFocusCheck:!0,todayButtonText:n})}_injectComponent(e){const t=this;return function(i){return b(i,{component:t.dateBox}),e(i)}}_refreshActiveDescendant(e){this._lastActionElement="calendar",this.dateBox.setAria("activedescendant",e.actionValue)}_getTodayButtonConfig(){const e=this.dateBox.option("buttonsLocation"),i=e==="default"?["bottom","center"]:Fd(e),n=Fi()?"text":"outlined";return{widget:"dxButton",toolbar:i[0],location:i[1]==="after"?"before":i[1],options:{onClick:s=>{this._widget._toTodayView(s)},text:this.dateBox.option("todayButtonText"),elementAttr:{class:"dx-button-today"},stylingMode:n}}}_isCalendarVisible(){const{calendarOptions:e}=this.dateBox.option();return nt(e)||e.visible!==!1}_getPopupToolbarItems(e){return this.dateBox.option("applyValueMode")==="useButtons"&&this._isCalendarVisible()?[this._getTodayButtonConfig(),...e]:e}popupConfig(e){return b(!0,e,{position:{collision:"flipfit flip"},width:"auto"})}_valueChangedHandler(e){const{value:t}=e,i=e.previousValue;R.sameDate(t,i)&&R.sameHoursAndMinutes(t,i)||this.dateBox.option("applyValueMode")==="instantly"&&this.dateBoxValue(this.getValue(),e.event)}_updateValue(e){this._widget&&this._widget.option("value",this.dateBoxValue())}textChangedHandler(){this._lastActionElement="input",this.dateBox.option("opened")&&this._widget&&this._updateValue(!0)}_cellClickHandler(e){const{dateBox:t}=this;t.option("applyValueMode")==="instantly"&&(t.option("opened",!1),this.dateBoxValue(this.getValue(),e.event))}}const Hf={row:"minWidth",col:"minHeight"},Wf={row:"maxWidth",col:"maxHeight"},Xa={start:"flex-start",end:"flex-end",center:"center","space-between":"space-between","space-around":"space-around"},Za={start:"flex-start",end:"flex-end",center:"center",stretch:"stretch"},zf={row:"row",col:"column"},ui=(r,e,t)=>{const i=Nh(e,t);if(r.style[Lh(e)]=i,!pe()){if(i===""||!m(i))return;const s=`${Ad(e)}: ${i};`;$h(r,s,!1)}};class Kf extends _s{_renderVisible(e,t){super._renderVisible(e),m(t)&&this._options.fireItemStateChangedAction({name:"visible",state:e,oldState:t})}}class Gf{constructor(e,t){this._$element=e,this._option=t}renderBox(){this._$element.css({display:`${Vs("flexDirection")}flex`});const e=this._option("direction")??"row";ui(this._$element.get(0),"flexDirection",zf[e])}renderAlign(){this._$element.css({justifyContent:this._normalizedAlign()})}_normalizedAlign(){const e=this._option("align")??"start";return e in Xa?Xa[e]:e}renderCrossAlign(){this._$element.css({alignItems:this._normalizedCrossAlign()})}_normalizedCrossAlign(){const e=this._option("crossAlign")??"start";return e in Za?Za[e]:e}renderItems(e){const t=Vs("flexDirection"),i=this._option("direction")??"row";x(e,(function(){const n=h(this),s=n.data("dxBoxItemData");n.css({display:`${t}flex`}).css(Wf[i],s.maxSize??"none").css(Hf[i],s.minSize??"0"),ui(n.get(0),"flexBasis",s.baseSize??0),ui(n.get(0),"flexGrow",s.ratio??0),ui(n.get(0),"flexShrink",m(s.shrink)?s.shrink:1),n.children().each(((o,a)=>(h(a).css({width:"auto",height:"auto",display:`${Vs("flexDirection")}flex`,flexBasis:0}),ui(a,"flexGrow",1),ui(a,"flexDirection",h(a)[0].style.flexDirection??"column"),!0)))}))}}class Bt extends nr{_getDefaultOptions(){return T({},super._getDefaultOptions(),{direction:"row",align:"start",crossAlign:"stretch",activeStateEnabled:!1,focusStateEnabled:!1})}_itemClass(){return"dx-box-item"}_itemDataKey(){return"dxBoxItemData"}_itemElements(){return this._itemContainer().children(this._itemSelector())}_init(){super._init(),this.$element().addClass("dx-box-flex"),this._initLayout(),this._initializeRenderQueue()}_initLayout(){this._layout=new Gf(this.$element(),(e=>this.option(e)))}_initializeRenderQueue(){const{_queue:e}=this.option();this._queue=e??[]}_queueIsNotEmpty(){return this.option("_queue")?!1:!!this._queue.length}_pushItemToQueue(e,t){this._queue.push({$item:e,config:t})}_shiftItemFromQueue(){return this._queue.shift()}_initMarkup(){this.$element().addClass("dx-box"),this._layout.renderBox(),super._initMarkup(),this._renderAlign(),this._renderActions()}_renderActions(){this._onItemStateChanged=this._createActionByOption("onItemStateChanged")}_renderAlign(){this._layout.renderAlign(),this._layout.renderCrossAlign()}_renderItems(e){super._renderItems(e),this._processRenderQueue(),this._layout.renderItems(this._itemElements())}_processRenderQueue(){if(this._queueIsNotEmpty()){const e=this._shiftItemFromQueue(),{itemTemplate:t,itemHoldTimeout:i,onItemHold:n,onItemClick:s,onItemContextMenu:o,onItemRendered:a}=this.option();e&&this._createComponent(e.$item,Bt,T({itemTemplate:t,itemHoldTimeout:i,onItemHold:n,onItemClick:s,onItemContextMenu:o,onItemRendered:a,_queue:this._queue},e.config)),this._processRenderQueue()}}_renderItemContent(e){var t;const i=(t=e.itemData)===null||t===void 0?void 0:t.node;return i?this._renderItemContentByNode(e,i):super._renderItemContent(e)}_postprocessRenderItem(e){var t;const i=(t=e.itemData)===null||t===void 0?void 0:t.box;i&&this._pushItemToQueue(e.itemContent,i)}_createItemByTemplate(e,t){const{itemData:i}=t;return i.box?e.source?e.source():h():super._createItemByTemplate(e,t)}_itemOptionChanged(e,t,i,n){t==="visible"&&this._onItemStateChanged({name:t,state:i,oldState:n!==!1}),super._itemOptionChanged(e,t,i,n)}_optionChanged(e){const{name:t}=e;switch(t){case"_queue":case"direction":this._invalidate();break;case"align":this._layout.renderAlign();break;case"crossAlign":this._layout.renderCrossAlign();break;default:super._optionChanged(e)}}_itemOptions(){const e=super._itemOptions();return e.fireItemStateChangedAction=t=>{this._onItemStateChanged(t)},e}}Bt.ItemClass=Kf;_e("dxBox",Bt);const Js=["year","day","month","day"],Qa=["hours","minutes","seconds","milliseconds"],Uf=864e5,qf=31536e6,Yf=function(r){const e=typeof r;return e==="string"?"format":e==="object"&&r.type!==void 0?r.type:null},K={SUPPORTED_FORMATS:["date","time","datetime"],ONE_MINUTE:6e4,ONE_DAY:Uf,ONE_YEAR:qf,MIN_DATEVIEW_DEFAULT_DATE:new Date(1900,0,1),MAX_DATEVIEW_DEFAULT_DATE:(function(){const r=new Date;return new Date(r.getFullYear()+50,r.getMonth(),r.getDate(),23,59,59)})(),FORMATS_INFO:{date:{getStandardPattern:()=>"yyyy-MM-dd",components:Js},time:{getStandardPattern:()=>"HH:mm",components:Qa},datetime:{getStandardPattern(){let r;return(function(){const e=h("<input>").attr("type","datetime");e.val("2000-01-01T01:01Z"),e.val()&&(r="yyyy-MM-ddTHH:mmZ")})(),r||(r="yyyy-MM-ddTHH:mm:ssZ"),K.FORMATS_INFO.datetime.getStandardPattern=function(){return r},r},components:[...Js,...Qa]},"datetime-local":{getStandardPattern:()=>"yyyy-MM-ddTHH:mm:ss",components:[...Js,"hours","minutes","seconds"]}},FORMATS_MAP:{date:"shortdate",time:"shorttime",datetime:"shortdateshorttime"},SUBMIT_FORMATS_MAP:{date:"date",time:"time",datetime:"datetime-local"},toStandardDateFormat(r,e){const t=K.FORMATS_INFO[e].getStandardPattern();return fe.serializeDate(r,t)},fromStandardDateFormat(r){const e=fe.dateParser(r);return xt(e)?e:void 0},getMaxMonthDay:(r,e)=>new Date(r,e+1,0).getDate(),mergeDates(r,e,t){if(!e)return e||null;if(!r||isNaN(r.getTime())){const s=new Date(null);r=new Date(s.getFullYear(),s.getMonth(),s.getDate())}const i=new Date(r.valueOf()),n=K.FORMATS_INFO[t];return x(n.components,(function(){const s=K.DATE_COMPONENTS_INFO[this];i[s.setter](e[s.getter]())})),i},getLongestCaptionIndex(r){let e=0,t=0,i;for(i=0;i<r.length;++i)r[i].length>t&&(e=i,t=r[i].length);return e},formatUsesMonthName:r=>P.formatUsesMonthName(r),formatUsesDayName:r=>P.formatUsesDayName(r),getLongestDate(r,e,t){const i=Yf(r);let n=9;(!i||K.formatUsesMonthName(i))&&(n=K.getLongestCaptionIndex(e));const s=new Date(1888,n,21,23,59,59,999);if(!i||K.formatUsesDayName(i)){const o=s.getDate()-s.getDay()+K.getLongestCaptionIndex(t);s.setDate(o)}return s},normalizeTime(r){r.setSeconds(0),r.setMilliseconds(0)}};K.DATE_COMPONENTS_INFO={year:{getter:"getFullYear",setter:"setFullYear",formatter(r,e){const t=new Date(e.getTime());return t.setFullYear(r),P.format(t,"yyyy")},startValue:void 0,endValue:void 0},day:{getter:"getDate",setter:"setDate",formatter(r,e){const t=new Date(e.getTime());return t.setDate(r),P.format(t,"d")},startValue:1,endValue:void 0},month:{getter:"getMonth",setter:"setMonth",formatter:r=>P.getMonthNames()[r],startValue:0,endValue:11},hours:{getter:"getHours",setter:"setHours",formatter:r=>P.format(new Date(0,0,0,r),"hour"),startValue:0,endValue:23},minutes:{getter:"getMinutes",setter:"setMinutes",formatter:r=>P.format(new Date(0,0,0,0,r),"minute"),startValue:0,endValue:59},seconds:{getter:"getSeconds",setter:"setSeconds",formatter:r=>P.format(new Date(0,0,0,0,0,r),"second"),startValue:0,endValue:59},milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",formatter:r=>P.format(new Date(0,0,0,0,0,0,r),"millisecond"),startValue:0,endValue:999}};const Ja=function(r,e,t){jf(r,e,t)},jf=function(r,e,t){r.css("transform",`rotate(${e}deg) translate(0,${t}px)`)};class Hc extends gn{_getDefaultOptions(){return T({},super._getDefaultOptions(),{value:new Date(Date.now()),use24HourFormat:!0,_showClock:!0,_arrowOffset:5})}_getValue(){const{value:e}=this.option();return e||new Date}_init(){super._init(),this.$element().addClass("dx-timeview")}_render(){super._render(),this._renderBox(),this._updateTime()}_renderBox(){const e=h("<div>").appendTo(this.$element()),t=[];this.option("_showClock")&&t.push({ratio:1,shrink:0,baseSize:"auto",template:this._renderClock.bind(this)}),t.push({ratio:0,shrink:0,baseSize:"auto",template:this._renderField.bind(this)}),this._createComponent(e,Bt,{height:"100%",width:"100%",direction:"col",items:t})}_renderClock(e,t,i){this._$hourArrow=h("<div>").addClass("dx-timeview-hourarrow"),this._$minuteArrow=h("<div>").addClass("dx-timeview-minutearrow");const n=h(i);n.addClass("dx-timeview-clock").append(this._$hourArrow).append(this._$minuteArrow),this.setAria("role","presentation",n)}_updateClock(){const e=this._getValue(),t=e.getHours()/12*360+e.getMinutes()/60*30,i=e.getMinutes()/60*360;Ja(this._$hourArrow,t,this.option("_arrowOffset")),Ja(this._$minuteArrow,i,this.option("_arrowOffset"))}_getBoxItems(e){const t=[{ratio:0,shrink:0,baseSize:"auto",template:()=>this._hourBox.$element()},{ratio:0,shrink:0,baseSize:"auto",template:h("<div>").addClass("dx-timeview-time-separator").text(P.getTimeSeparator())},{ratio:0,shrink:0,baseSize:"auto",template:()=>this._minuteBox.$element()}];return e&&t.push({ratio:0,shrink:0,baseSize:"auto",template:()=>this._format12.$element()}),t}_renderField(){const e=!this.option("use24HourFormat");return this._createHourBox(e),this._createMinuteBox(),e&&this._createFormat12Box(),this._createComponent(h("<div>").addClass("dx-timeview-field"),Bt,{direction:"row",align:"center",crossAlign:"center",items:this._getBoxItems(e)}).$element()}_createHourBox(e){this._hourBox=this._createComponent(h("<div>"),os,T({min:-1,max:e?13:24,value:this._getValue().getHours(),onValueChanged:this._onHourBoxValueChanged.bind(this),onKeyboardHandled:t=>this._keyboardHandler(t)},this._getNumberBoxConfig())),this._hourBox.setAria("label","hours")}_isPM(){return!this.option("use24HourFormat")&&this._format12.option("value")===1}_onHourBoxValueChanged(e){let{value:t,component:i}=e;const n=this._getValue(),s=new Date(n);let o=this._convertMaxHourToMin(t);i.option("value",o),this._isPM()&&(o+=12),s.setHours(o),K.normalizeTime(s),this.option("value",s)}_convertMaxHourToMin(e){const t=this.option("use24HourFormat")?24:12;return(t+e)%t}_createMinuteBox(){this._minuteBox=this._createComponent(h("<div>"),os,T({min:-1,max:60,value:this._getValue().getMinutes(),onKeyboardHandled:e=>this._keyboardHandler(e),onValueChanged:e=>{let{value:t,component:i}=e;const n=(60+t)%60;i.option("value",n);const s=new Date(this._getValue());s.setMinutes(n),K.normalizeTime(s),this.option("value",s)}},this._getNumberBoxConfig())),this._minuteBox.setAria("label","minutes")}_createFormat12Box(){const e=P.getPeriodNames();this._format12=this._createComponent(h("<div>").addClass("dx-timeview-format12"),Ld,{items:[{value:-1,text:e[0]},{value:1,text:e[1]}],valueExpr:"value",displayExpr:"text",onKeyboardHandled:t=>this._keyboardHandler(t),onValueChanged:t=>{let{value:i}=t;const n=this._getValue().getHours(),s=new Date(this._getValue()),o=(n+12*i)%24;s.setHours(o),this.option("value",s)},dropDownOptions:{container:this.$element()},value:this._getValue().getHours()>=12?1:-1,stylingMode:this.option("stylingMode")}),this._format12.setAria("label","type")}_refreshFormat12(){if(this.option("use24HourFormat"))return;const n=this._getValue().getHours()>=12?1:-1;this._silentEditorValueUpdate(this._format12,n)}_silentEditorValueUpdate(e,t){e&&(e._suppressValueChangeAction(),e.option("value",t),e._resumeValueChangeAction())}_getNumberBoxConfig(){const{stylingMode:e}=this.option();return{showSpinButtons:!0,displayValueFormatter:t=>(t<10?"0":"")+t,stylingMode:e}}_normalizeHours(e){return this.option("use24HourFormat")?e:e%12||12}_updateField(){const e=this._normalizeHours(this._getValue().getHours());this._silentEditorValueUpdate(this._hourBox,e),this._silentEditorValueUpdate(this._minuteBox,this._getValue().getMinutes()),this._refreshFormat12()}_updateTime(){this.option("_showClock")&&this._updateClock(),this._updateField()}_visibilityChanged(e){e&&this._updateTime()}_optionChanged(e){switch(e.name){case"value":this._updateTime(),super._optionChanged(e);break;case"_arrowOffset":break;case"use24HourFormat":case"_showClock":case"stylingMode":this._invalidate();break;default:super._optionChanged(e)}}}_e("dxTimeView",Hc);const Xf=oe(),el="dx-datebox-datetime-time-side";class Zf extends $c{ctor(e){super.ctor(e),this.NAME="CalendarWithTime"}getDefaultOptions(){return T({},super.getDefaultOptions(),{applyValueMode:"useButtons",buttonsLocation:"bottom after","dropDownOptions.showTitle":!1})}_closeDropDownByEnter(){return R.sameDate(this._getContouredValue(),this.widgetOption("value"))}getDisplayFormat(e){return e||"shortdateshorttime"}_is24HourFormat(){return P.is24HourFormat(this.getDisplayFormat(this.dateBox.option("displayFormat")))}_getContouredValue(){const e=super._getContouredValue();return this._updateDateTime(e)}_renderWidget(){super._renderWidget(),this._timeView=this.dateBox._createComponent(h("<div>"),Hc,{value:this.dateBoxValue(),_showClock:!this._isShrinkView(),use24HourFormat:this._is24HourFormat(),onValueChanged:this._valueChangedHandler.bind(this),stylingMode:this.dateBox.option("stylingMode")})}renderOpenedState(){super.renderOpenedState();const e=this._getPopup();e&&e.$wrapper().toggleClass("dx-datebox-adaptivity-mode",this._isSmallScreen()),clearTimeout(this._repaintTimer),this._repaintTimer=setTimeout((()=>{var t;(t=this._getPopup())===null||t===void 0||t.repaint()}),0)}isAdaptivityChanged(){const e=this._isShrinkView(),t=this._currentAdaptiveMode;return e!==t?(this._currentAdaptiveMode=e,t!==void 0):super.isAdaptivityChanged()}_updateValue(e){let t=this.dateBoxValue();!t&&!e&&(t=new Date,K.normalizeTime(t)),super._updateValue(),this._timeView&&(t&&this._timeView.option("value",t),this._timeView.option("use24HourFormat",this._is24HourFormat()))}_isSmallScreen(){return H(Xf)<=573}_isShrinkView(){return!this.dateBox.option("showAnalogClock")||this.dateBox.option("adaptivityEnabled")&&this._isSmallScreen()}_getBoxItems(){const e=[{ratio:0,shrink:0,baseSize:"auto",name:"calendar"}];return this._isShrinkView()||e.push({ratio:0,shrink:0,baseSize:"auto",name:"time"}),e}renderPopupContent(){super.renderPopupContent(),this._currentAdaptiveMode=this._isShrinkView();const e=this._getPopup().$content();this._box=this.dateBox._createComponent(h("<div>").appendTo(e),Bt,{direction:"row",crossAlign:"stretch",items:this._getBoxItems(),itemTemplate:(function(t,i,n){const s=h("<div>");switch(t.name){case"calendar":s.append(this._widget.$element()),this._isShrinkView()&&(this._timeView.$element().addClass(el),s.append(this._timeView.$element()));break;case"time":s.append(this._timeView.$element()),h(n).addClass(el)}return s}).bind(this)})}popupConfig(e){const t=super.popupConfig(e);return b(t,{width:"auto"})}_preventFocusOnPopup(e){h(e.target).hasClass("dx-texteditor-input")||(super._preventFocusOnPopup.apply(this,arguments),this.dateBox._hasFocusClass()||this.dateBox.focus())}_updateDateTime(e){const{value:t}=this._timeView.option();return e.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),e}getValue(){let e=this._widget.option("value")??this._widget.getContouredDate();return e=e?new Date(e):new Date,this._updateDateTime(e)}dispose(){clearTimeout(this._removeMinWidthTimer),clearTimeout(this._repaintTimer),super.dispose()}}class Qf{constructor(e){this.DIRECTION_HORIZONTAL="horizontal",this.DIRECTION_VERTICAL="vertical",this.DIRECTION_BOTH="both",this.direction=e??Eo}get isHorizontal(){return this.direction===Bd||this.direction===Fs}get isVertical(){return this.direction===Eo||this.direction===Fs}get isBoth(){return this.direction===Fs}}function Jf(r,e){if(ze(r)){const n=We(r.left,r.x),s=We(r.top,r.y);return{left:m(n)?n:void 0,top:m(s)?s:void 0}}const{isVertical:t,isHorizontal:i}=new Qf(e);return{left:i&&m(r)?r:void 0,top:t&&m(r)?r:void 0}}class Wc extends it{_getDefaultOptions(){return T({},super._getDefaultOptions(),{showScrollbar:"never",useNative:!1,selectedIndex:0,bounceEnabled:!1,items:[],showOnClick:!1,onClick:null,onSelectedIndexChanged:null,scrollByContent:!0})}_init(){super._init(),this.option("onVisibilityChange",this._visibilityChangedHandler.bind(this)),this.option("onEnd",this._endActionHandler.bind(this))}_render(){super._render(),this._renderSelectedItemFrame(),this.$element().addClass("dx-dateviewroller"),this._renderContainerClick(),this._renderItems(),this._renderSelectedValue(),this._renderItemsClick(),this._renderWheelEvent(),this._renderSelectedIndexChanged()}_renderSelectedIndexChanged(){this._selectedIndexChanged=this._createActionByOption("onSelectedIndexChanged")}_renderWheelEvent(){v.on(h(this.container()),"dxmousewheel",(e=>{this._isWheelScrolled=!0}))}_renderContainerClick(){if(!this.option("showOnClick"))return;const e=V(Q,this.NAME),t=this._createActionByOption("onClick");v.off(h(this.container()),e),v.on(h(this.container()),e,(i=>{t({event:i})}))}_renderItems(){const e=this.option("items")||[];let t=h();h(this.content()).empty(),e.forEach((i=>{t=t.add(h("<div>").addClass("dx-dateview-item").append(i))})),h(this.content()).append(t),this._$items=t,this.update()}_renderSelectedItemFrame(){h("<div>").addClass("dx-dateview-item-selected-frame").append(h("<div>").addClass("dx-dateview-item-selected-border")).appendTo(h(this.container()))}_renderSelectedValue(e){const t=this._fitIndex(e??this.option("selectedIndex"));this._moveTo({top:this._getItemPosition(t)}),this._renderActiveStateItem()}_fitIndex(e){const i=(this.option("items")||[]).length;return e>=i?i-1:e<0?0:e}_getItemPosition(e){return Math.round(this._itemHeight()*e)}_renderItemsClick(){const e=this._getItemSelector(),t=V(Q,this.NAME);v.off(this.$element(),t,e),v.on(this.$element(),t,e,this._itemClickHandler.bind(this))}_getItemSelector(){return".dx-dateview-item"}_itemClickHandler(e){this.option("selectedIndex",this._itemElementIndex(e.currentTarget))}_itemElementIndex(e){return this._itemElements().index(e)}_itemElements(){return this.$element().find(this._getItemSelector())}_renderActiveStateItem(){const e=this.option("selectedIndex");x(this._$items,(function(t){h(this).toggleClass("dx-dateview-item-selected",e===t)}))}_shouldScrollToNeighborItem(){return G.real().deviceType==="desktop"&&this._isWheelScrolled}_moveTo(e){const{top:t,left:i}=Jf(e),n=this.scrollOffset(),s={x:n.left-i,y:n.top-t};if(this._isVisible()&&(s.x||s.y))if(this._prepareDirections(!0),this._animation&&!this._shouldScrollToNeighborItem()){const o=this;ve.stop(h(this.content())),ve.animate(h(this.content()),{duration:200,type:"slide",to:{top:Math.floor(s.y)},complete(){bd(h(o.content())),o.handleMove({delta:s})}}),delete this._animation}else this.handleMove({delta:s})}_validate(e){return this._moveIsAllowed(e)}_fitSelectedIndexInRange(e){const t=this.option("items").length;return Math.max(Math.min(e,t-1),0)}_isInNullNeighborhood(e){return-.1<=e&&e<=.1}_getSelectedIndexAfterScroll(e){const t=this.scrollOffset().top,i=e*this._itemHeight(),n=t-i;if(this._isInNullNeighborhood(n))return e;const s=n>0?1:-1;return this._fitSelectedIndexInRange(e+s)}_getNewSelectedIndex(e){if(this._shouldScrollToNeighborItem())return this._getSelectedIndexAfterScroll(e);this._animation=!0;const t=this.scrollOffset().top/this._itemHeight();return Math.round(t)}_endActionHandler(){const e=this.option("selectedIndex"),t=this._getNewSelectedIndex(e);t===e?this._renderSelectedValue(t):this.option("selectedIndex",t),this._isWheelScrolled=!1}_itemHeight(){const e=this._$items.first();return X(e)}_toggleActive(e){this.$element().toggleClass("dx-state-active",e)}_isVisible(){return h(this.container()).is(":visible")}_fireSelectedIndexChanged(e,t){var i;(i=this._selectedIndexChanged)===null||i===void 0||i.call(this,{value:e,previousValue:t,event:void 0})}_visibilityChanged(e){super._visibilityChanged(e),this._visibilityChangedHandler(e)}_visibilityChangedHandler(e){e&&(this._visibilityTimer=setTimeout((()=>{this._renderSelectedValue(this.option("selectedIndex"))}))),this.toggleActiveState(!1)}toggleActiveState(e){this.$element().toggleClass("dx-dateviewroller-current",e)}_refreshSelectedIndex(){const e=this.option("selectedIndex"),t=this._fitIndex(e);t===e?this._renderActiveStateItem():this.option("selectedIndex",t)}_optionChanged(e){switch(e.name){case"selectedIndex":this._fireSelectedIndexChanged(e.value,e.previousValue),this._renderSelectedValue(e.value);break;case"items":this._renderItems(),this._refreshSelectedIndex();break;case"onClick":case"showOnClick":this._renderContainerClick();break;case"onSelectedIndexChanged":this._renderSelectedIndexChanged();break;default:super._optionChanged(e)}}_dispose(){clearTimeout(this._visibilityTimer),super._dispose()}}_e("dxDateViewRoller",Wc);const tl={date:"date"},ke={year:"year",month:"month",day:"day",hours:"hours"};class zc extends gn{_valueOption(){const{value:e}=this.option(),t=new Date(e);return!e||isNaN(t)?this._getDefaultDate():t}_getDefaultDate(){const e=new Date,{type:t}=this.option();return t===tl.date?new Date(e.getFullYear(),e.getMonth(),e.getDate()):e}_getDefaultOptions(){return T({},super._getDefaultOptions(),{minDate:K.MIN_DATEVIEW_DEFAULT_DATE,maxDate:K.MAX_DATEVIEW_DEFAULT_DATE,type:tl.date,value:new Date,applyCompactClass:!1})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:e=>e.deviceType!=="desktop",options:{applyCompactClass:!0}}])}_render(){super._render(),this.$element().addClass("dx-dateview");const{type:e}=this.option();this._toggleFormatClasses(e),this._toggleCompactClass()}_toggleFormatClasses(e,t){this.$element().addClass(`dx-dateview-${e}`),t&&this.$element().removeClass(`dx-dateview-${t}`)}_toggleCompactClass(){const{applyCompactClass:e}=this.option();this.$element().toggleClass("dx-dateview-compact",e)}_wrapper(){return this._$wrapper}_renderContentImpl(){this._$wrapper=h("<div>").addClass("dx-dateview-wrapper"),this._renderRollers(),this._$wrapper.appendTo(this.$element())}_renderRollers(){this._$rollersContainer||(this._$rollersContainer=h("<div>").addClass("dx-dateview-rollers")),this._$rollersContainer.empty(),this._createRollerConfigs(),this._rollers={};const e=this;x(e._rollerConfigs,(t=>{const i=h("<div>").appendTo(e._$rollersContainer).addClass(`dx-dateviewroller-${e._rollerConfigs[t].type}`);e._rollers[e._rollerConfigs[t].type]=e._createComponent(i,Wc,{items:e._rollerConfigs[t].displayItems,selectedIndex:e._rollerConfigs[t].selectedIndex,showScrollbar:"never",scrollByContent:!0,onStart(n){n.component._toggleActive(!0),e._setActiveRoller(e._rollerConfigs[t])},onEnd(n){n.component._toggleActive(!1)},onClick(n){const s=n.component;s._toggleActive(!0),e._setActiveRoller(e._rollerConfigs[t]),e._setRollerState(e._rollerConfigs[t],s.option("selectedIndex")),s._toggleActive(!1)},onSelectedIndexChanged(n){const s=n.component;e._setRollerState(e._rollerConfigs[t],s.option("selectedIndex"))}})})),e._$rollersContainer.appendTo(e._wrapper())}_createRollerConfigs(e){const t=this;e=e||t.option("type"),t._rollerConfigs={},P.getFormatParts(K.FORMATS_MAP[e]).forEach((i=>{t._createRollerConfig(i)}))}_createRollerConfig(e){const t=K.DATE_COMPONENTS_INFO[e],i=this._calculateRollerConfigValueRange(e),{startValue:n}=i,{endValue:s}=i,{formatter:o}=t,a=this._getCurrentDate(),l={type:e,setValue:t.setter,valueItems:[],displayItems:[],getIndex:d=>d[t.getter]()-n};for(let d=n;d<=s;d++)l.valueItems.push(d),l.displayItems.push(o(d,a));l.selectedIndex=l.getIndex(a),this._rollerConfigs[e]=l}_setActiveRoller(e){const t=e&&this._rollers[e.type];x(this._rollers,(function(){this.toggleActiveState(this===t)}))}_updateRollersPosition(){const e=this;x(this._rollers,(function(t){const i=e._rollerConfigs[t].getIndex(e._getCurrentDate());this.option("selectedIndex",i)}))}_setRollerState(e,t){if(t!==e.selectedIndex){const i=e.valueItems[t],{setValue:n}=e;let s=new Date(this._getCurrentDate()),o=s.getDate();const a=this.option("minDate"),l=this.option("maxDate");e.type===ke.month?o=Math.min(o,K.getMaxMonthDay(s.getFullYear(),i)):e.type===ke.year&&(o=Math.min(o,K.getMaxMonthDay(i,s.getMonth()))),s.setDate(o),s[n](i);const d=R.normalizeDate(s,a,l);s=K.mergeDates(d,s,"time"),s=R.normalizeDate(s,a,l),this.option("value",s),e.selectedIndex=t}e.type===ke.year&&this._refreshRollers(),e.type===ke.month&&(this._refreshRoller(ke.day),this._refreshRoller(ke.hours))}_refreshRoller(e){const t=this._rollers[e];if(t){this._createRollerConfig(e);const i=this._rollerConfigs[e];(e===ke.day||i.displayItems.toString()!==t.option("items").toString())&&t.option({items:i.displayItems,selectedIndex:i.selectedIndex})}}_getCurrentDate(){const e=this._valueOption(),t=this.option("minDate"),i=this.option("maxDate");return R.normalizeDate(e,t,i)}_calculateRollerConfigValueRange(e){const t=this._getCurrentDate(),{minDate:i,maxDate:n}=this.option(),s=R.sameYear(t,i),o=s&&t.getMonth()===i.getMonth(),a=R.sameYear(t,n),l=a&&t.getMonth()===n.getMonth(),d=o&&t.getDate()===i.getDate(),c=l&&t.getDate()===n.getDate(),u=K.DATE_COMPONENTS_INFO[e];let{startValue:p}=u,{endValue:g}=u;return e===ke.year&&(p=i.getFullYear(),g=n.getFullYear()),e===ke.month&&(s&&(p=i.getMonth()),a&&(g=n.getMonth())),e===ke.day&&(g=K.getMaxMonthDay(t.getFullYear(),t.getMonth()),s&&o&&(p=i.getDate()),a&&l&&(g=n.getDate())),e===ke.hours&&(p=d?i.getHours():p,g=c?n.getHours():g),{startValue:p,endValue:g}}_refreshRollers(){this._refreshRoller(ke.month),this._refreshRoller(ke.day),this._refreshRoller(ke.hours)}_optionChanged(e){switch(e.name){case"minDate":case"maxDate":case"type":this._renderRollers(),this._toggleFormatClasses(e.value,e.previousValue);break;case"visible":super._optionChanged(e),e.value&&this._renderRollers();break;case"value":this.option("value",this._valueOption()),this._refreshRollers(),this._updateRollersPosition();break;default:super._optionChanged(e)}}_clean(){super._clean(),delete this._$rollersContainer}}_e("dxDateView",zc);const eC=oe();class tC extends Is{ctor(e){super.ctor(e),this.NAME="DateView"}getDefaultOptions(){return T({},super.getDefaultOptions(),{openOnFieldClick:!0,applyButtonText:w.format("OK"),"dropDownOptions.showTitle":!0})}getDisplayFormat(e){return e||K.FORMATS_MAP[this.dateBox.option("type")]}popupConfig(e){return{toolbarItems:this.dateBox._popupToolbarItemsConfig(),onInitialized:e.onInitialized,defaultOptionsRules:[{device:{platform:"android"},options:{width:333,height:331}},{device(t){const{platform:i}=t;return i==="generic"||i==="ios"},options:{width:"auto",height:"auto"}},{device(t){const{platform:i}=t,{phone:n}=t;return i==="generic"&&n},options:{width:333,maxWidth:"100%",maxHeight:"100%",height:"auto",position:{collision:"flipfit flip"}}},{device:{platform:"ios",phone:!0},options:{width:"100%",position:{my:"bottom",at:"bottom",of:eC}}}]}}_renderWidget(){if(er(this.dateBox.option("mode"))&&this.dateBox._isNativeType()||this.dateBox.option("readOnly")){this._widget&&(this._widget.$element().remove(),this._widget=null);return}const e=this._getPopup();if(this._widget)this._widget.option(this._getWidgetOptions());else{const t=h("<div>").appendTo(e.$content());this._widget=this._createWidget(t)}this._widget.$element().appendTo(this._getWidgetContainer())}_getWidgetName(){return zc}renderOpenedState(){super.renderOpenedState(),this._widget&&this._widget.option("value",this._widget._getCurrentDate())}_getWidgetOptions(){return{value:this.dateBoxValue()||new Date,type:this.dateBox.option("type"),minDate:this.dateBox.dateOption("min")||new Date(1900,0,1),maxDate:this.dateBox.dateOption("max")||new Date(Date.now()+50*K.ONE_YEAR),onDisposing:(function(){this._widget=null}).bind(this)}}}const iC=oe(),nC={min:new Date(0,0,0,0,0),max:new Date(0,0,0,23,59)};class sC extends Is{ctor(e){super.ctor(e),this.NAME="List"}supportedKeys(){return{space:Ce,home:Ce,end:Ce}}getDefaultOptions(){return T({},super.getDefaultOptions(),{applyValueMode:"instantly"})}getDisplayFormat(e){return e||"shorttime"}popupConfig(e){return e}getValue(){const e=this._widget.option("selectedIndex");if(e===-1)return this.dateBox.option("value");const t=this._widgetItems[e];return this._getDateByItemData(t)}useCurrentDateByDefault(){return!0}getDefaultDate(){return new Date(null)}popupShowingHandler(){this.dateBox._dimensionChanged()}_renderWidget(){super._renderWidget(),this._refreshItems()}_getWidgetName(){return $d}_getWidgetOptions(){return{itemTemplate:this._timeListItemTemplate.bind(this),onItemClick:this._listItemClickHandler.bind(this),tabIndex:-1,onFocusedItemChanged:this._refreshActiveDescendant.bind(this),selectionMode:"single"}}_refreshActiveDescendant(e){this.dateBox.setAria("activedescendant",""),this.dateBox.setAria("activedescendant",e.actionValue)}_refreshItems(){this._widgetItems=this._getTimeListItems(),this._widget.option("items",this._widgetItems)}renderOpenedState(){this._widget&&(this._widget.option("focusedElement",null),this._setSelectedItemsByValue(),this._widget.option("templatesRenderAsynchronously")?this._asyncScrollTimeout=setTimeout(this._scrollToSelectedItem.bind(this)):this._scrollToSelectedItem())}dispose(){super.dispose(),clearTimeout(this._asyncScrollTimeout)}_updateValue(){this._widget&&(this._refreshItems(),this._setSelectedItemsByValue(),this._scrollToSelectedItem())}_setSelectedItemsByValue(){const e=this.dateBoxValue(),t=this._getDateIndex(e);t===-1?this._widget.option("selectedItems",[]):this._widget.option("selectedIndex",t)}_scrollToSelectedItem(){this._widget.scrollToItem(this._widget.option("selectedIndex"))}_getDateIndex(e){let t=-1;for(let i=0,n=this._widgetItems.length;i<n;i++)if(this._areDatesEqual(e,this._widgetItems[i])){t=i;break}return t}_areDatesEqual(e,t){return xt(e)&&xt(t)&&e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()}_getTimeListItems(){let e=this.dateBox.dateOption("min")||this._getBoundaryDate("min");const t=this.dateBox.dateOption("max")||this._getBoundaryDate("max"),i=this.dateBox.dateOption("value")||null;let n=t-e;const s=e.getMinutes()%this.dateBox.option("interval");return n<0?[]:(n>K.ONE_DAY&&(n=K.ONE_DAY),i-e<K.ONE_DAY?this._getRangeItems(e,new Date(e),n):(e=this._getBoundaryDate("min"),e.setMinutes(s),i&&Math.abs(i-t)<K.ONE_DAY&&(n=(60*t.getHours()+Math.abs(t.getMinutes()-s))*K.ONE_MINUTE),this._getRangeItems(e,new Date(e),n)))}_getRangeItems(e,t,i){const n=[],s=this.dateBox.option("interval");for(;t-e<=i;)n.push(new Date(t)),t.setMinutes(t.getMinutes()+s);return n}_getBoundaryDate(e){const t=nC[e],i=new Date(We(this.dateBox.dateOption("value"),0));return new Date(i.getFullYear(),i.getMonth(),i.getDate(),t.getHours(),t.getMinutes())}_timeListItemTemplate(e){const t=this.dateBox.option("displayFormat");return P.format(e,this.getDisplayFormat(t))}_listItemClickHandler(e){if(this.dateBox.option("applyValueMode")==="useButtons")return;const t=this._getDateByItemData(e.itemData);this.dateBox.option("opened",!1),this.dateBoxValue(t,e.event)}_getDateByItemData(e){let t=this.dateBox.option("value");const i=e.getHours(),n=e.getMinutes(),s=e.getSeconds(),o=e.getFullYear(),a=e.getMonth(),l=e.getDate();return t?(this.dateBox.option("dateSerializationFormat")?t=fe.deserializeDate(t):t=new Date(t),t.setHours(i),t.setMinutes(n),t.setSeconds(s),t.setFullYear(o),t.setMonth(a),t.setDate(l)):t=new Date(o,a,l,i,n,0,0),t}getKeyboardListener(){return this._widget}_updatePopupHeight(){var e;const t=Pp(this.dateBox.option("dropDownOptions.height"));if(t===void 0||t==="auto"){this.dateBox._setPopupOption("height","auto");const i=Y(this._widget.$element()),n=.45*X(iC);this.dateBox._setPopupOption("height",Math.min(i,n))}(e=this.dateBox._timeList)===null||e===void 0||e.updateDimensions()}getParsedText(e,t){let i=super.getParsedText(e,t);return i&&(i=K.mergeDates(i,new Date(null),"date")),i}}class oC extends Is{ctor(e){super.ctor(e),this.NAME="Native"}popupConfig(e){return T({},e,{width:"auto"})}getParsedText(e){return e?this.dateBox.option("type")==="datetime"?new Date(e.replace(/-/g,"/").replace("T"," ").split(".")[0]):K.fromStandardDateFormat(e):null}renderPopupContent(){}_getWidgetName(){}_getWidgetOptions(){}_getDateBoxType(){let{type:e}=this.dateBox.option();return K.SUPPORTED_FORMATS.includes(e)?e==="datetime"&&!er(e)&&(e="datetime-local"):e="date",e}customizeButtons(){const e=this.dateBox.getButton("dropDown");G.real().android&&e&&e.on("click",(()=>{this.dateBox._input().get(0).click()}))}getDefaultOptions(){return{mode:this._getDateBoxType()}}getDisplayFormat(e){const t=this._getDateBoxType();return e||K.FORMATS_MAP[t]}renderInputMinMax(e){const t=this.dateBox.option("type"),i={datetime:"yyyy-MM-ddTHH:mm:ss",date:"yyyy-MM-dd",time:"HH:mm:ss"}[t]??"yyyy-MM-dd";e.attr({min:fe.serializeDate(this.dateBox.dateOption("min"),i),max:fe.serializeDate(this.dateBox.dateOption("max"),i)})}}const Li=oe(),rC="dx-show-invalid-badge",aC="dx-clear-button-area",Ue={calendar:"calendar",rollers:"rollers",list:"list",native:"native"},qe={date:"date",datetime:"datetime",time:"time"},$i={calendar:"Calendar",dateView:"DateView",native:"Native",calendarWithTime:"CalendarWithTime",list:"List"},lC={Calendar:$c,DateView:tC,Native:oC,CalendarWithTime:Zf,List:sC};class dC extends kp{_supportedKeys(){return T({},super._supportedKeys(),this._strategy.supportedKeys())}_renderButtonContainers(){super._renderButtonContainers.apply(this,arguments),this._strategy.customizeButtons()}_getDefaultOptions(){return T({},super._getDefaultOptions(),{type:"date",showAnalogClock:!0,value:null,displayFormat:null,interval:30,disabledDates:null,pickerType:Ue.calendar,invalidDateMessage:w.format("dxDateBox-validation-datetime"),dateOutOfRangeMessage:w.format("validation-range"),applyButtonText:w.format("OK"),adaptivityEnabled:!1,calendarOptions:{},useHiddenSubmitElement:!0,_showValidationIcon:!0})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:{platform:"ios"},options:{"dropDownOptions.showTitle":!0}},{device:{platform:"android"},options:{buttonsLocation:"bottom after"}},{device(){const e=G.real(),{platform:t}=e;return t==="ios"||t==="android"},options:{pickerType:Ue.native}},{device:{platform:"generic",deviceType:"desktop"},options:{buttonsLocation:"bottom after"}}])}_initOptions(e){this._userOptions=b({},e),super._initOptions(e),this._updatePickerOptions()}_updatePickerOptions(){let{pickerType:e}=this.option();const{type:t}=this.option();e===Ue.list&&(t===qe.datetime||t===qe.date)&&(e=Ue.calendar),t===qe.time&&e===Ue.calendar&&(e=Ue.list),this._pickerType=e,this._setShowDropDownButtonOption()}_setShowDropDownButtonOption(){const{platform:e}=G.real(),t=e==="android"&&me.mozilla,i=this._isNativeType();let n=e!=="generic"||!i;i&&t&&(n=!1),this.option({showDropDownButton:n})}_init(){this._initStrategy(),this.option(b({},this._strategy.getDefaultOptions(),this._userOptions)),delete this._userOptions,super._init()}_toLowerCaseFirstLetter(e){return e.charAt(0).toLowerCase()+e.substr(1)}_initStrategy(){const e=this._getStrategyName(this._getFormatType()),t=lC[e];this._strategy&&this._strategy.NAME===e||(this._strategy=new t(this))}_getFormatType(){const e=this.option("type"),t=/h|m|s/g.test(e),i=/d|M|Y/g.test(e);let n="";return i&&(n+=qe.date),t&&(n+=qe.time),n}_getStrategyName(e){const t=this._pickerType;return t===Ue.rollers?$i.dateView:t===Ue.native?$i.native:e===qe.date?$i.calendar:e===qe.datetime?$i.calendarWithTime:$i.list}_initMarkup(){this.$element().addClass("dx-datebox"),super._initMarkup(),this._refreshFormatClass(),this._refreshPickerTypeClass(),this._strategy.renderInputMinMax(this._input())}_render(){super._render(),this._formatValidationIcon()}_renderDimensions(){super._renderDimensions(),this.$element().toggleClass("dx-auto-width",!this.option("width")),this._updatePopupWidth(),this._updatePopupHeight()}_dimensionChanged(){super._dimensionChanged(),this._updatePopupHeight()}_updatePopupHeight(){if(this._popup){var e,t;(e=(t=this._strategy)._updatePopupHeight)===null||e===void 0||e.call(t)}}_refreshFormatClass(){const e=this.$element();x(qe,((i,n)=>{e.removeClass(`dx-datebox-${n}`)}));const{type:t}=this.option();e.addClass(`dx-datebox-${t}`)}_refreshPickerTypeClass(){const e=this.$element();x(Ue,((t,i)=>{e.removeClass(`dx-datebox-${i}`)})),e.addClass(`dx-datebox-${this._pickerType}`)}_formatValidationIcon(){if(!pe())return;const e=this._input().get(0),t=this.option("rtlEnabled"),i=this._getClearButtonWidth(),n=this._getLongestElementDimensions(),s=parseFloat(Li.getComputedStyle(e).width)-i,o=n.width>s,{style:a}=e,{_showValidationIcon:l}=this.option();this.$element().toggleClass(rC,!o&&l),o?(this._storedPadding===void 0&&(this._storedPadding=t?n.leftPadding:n.rightPadding),t?a.paddingLeft=0:a.paddingRight=0):t?a.paddingLeft=`${this._storedPadding}px`:a.paddingRight=`${this._storedPadding}px`}_getClearButtonWidth(){let e=0;if(this._isClearButtonVisible()&&this._input().val()===""){const t=this.$element().find(`.${aC}`).get(0);e=parseFloat(Li.getComputedStyle(t).width)}return e}_getLongestElementDimensions(){const e=this._strategy.getDisplayFormat(this.option("displayFormat")),t=P.format(K.getLongestDate(e,P.getMonthNames(),P.getDayNames()),e),i=this._input(),n=i.get(0),s=Hh(i,t),a=this._storedPadding!==void 0?this._storedPadding:0;s.appendTo(this.$element());const l=parseFloat(Li.getComputedStyle(s.get(0)).width),d=parseFloat(Li.getComputedStyle(n).paddingRight),c=parseFloat(Li.getComputedStyle(n).paddingLeft),u=l+c+d+a;return s.remove(),{width:u,leftPadding:c,rightPadding:d}}_getKeyboardListeners(){var e;return super._getKeyboardListeners().concat([(e=this._strategy)===null||e===void 0?void 0:e.getKeyboardListener()])}_renderPopup(){var e;super._renderPopup(),(e=this._popup)===null||e===void 0||e.$wrapper().addClass("dx-datebox-wrapper"),this._renderPopupWrapper()}_getPopupToolbarItems(){var e,t;const i=super._getPopupToolbarItems();return((e=(t=this._strategy)._getPopupToolbarItems)===null||e===void 0?void 0:e.call(t,i))??i}_popupConfig(){const e=super._popupConfig();return T({},this._strategy.popupConfig(e),{title:this._getPopupTitle(),dragEnabled:!1})}_renderPopupWrapper(){if(!this._popup)return;const e=this.$element(),t=b({},qe,Ue);x(t,((n,s)=>{e.removeClass(`dx-datebox-wrapper-${s}`)}));const{type:i}=this.option();this._popup.$wrapper().addClass(`dx-datebox-wrapper-${i}`).addClass(`dx-datebox-wrapper-${this._pickerType}`).addClass("dx-dropdowneditor-overlay")}_renderPopupContent(){super._renderPopupContent(),this._strategy.renderPopupContent()}_popupShowingHandler(){super._popupShowingHandler(),this._strategy.popupShowingHandler()}_popupShownHandler(){super._popupShownHandler(),this._strategy.renderOpenedState()}_popupHiddenHandler(){super._popupHiddenHandler(),this._strategy.renderOpenedState(),this._strategy.popupHiddenHandler()}_visibilityChanged(e){e&&this._formatValidationIcon()}_clearValueHandler(e){this.option("text",""),super._clearValueHandler(e)}_readOnlyPropValue(){if(this._pickerType===Ue.rollers)return!0;const{platform:e}=G.real();if(this._isNativeType()&&(e==="ios"||e==="android")){const{readOnly:i}=this.option();return i}return super._readOnlyPropValue()}_isClearButtonVisible(){return super._isClearButtonVisible()&&!this._isNativeType()}_renderValue(){const e=this.dateOption("value");return this.option("text",this._getDisplayedText(e)),this._strategy.renderValue(),super._renderValue()}_setSubmitValue(){const e=this.dateOption("value"),{type:t,dateSerializationFormat:i}=this.option(),n=K.SUBMIT_FORMATS_MAP[t],s=i?fe.serializeDate(e,i):K.toStandardDateFormat(e,n);this._getSubmitElement().val(s)}_getDisplayedText(e){const{mode:t}=this.option();let i;if(t==="text"){const n=this._strategy.getDisplayFormat(this.option("displayFormat"));i=P.format(e,n)}else{const n=this._getFormatByMode(t);n?i=P.format(e,n):i=K.toStandardDateFormat(e,t)}return i}_getFormatByMode(e){return er(e)?null:K.FORMATS_MAP[e]}_valueChangeEventHandler(e){const{text:t,type:i,validationError:n}=this.option(),s=this.dateOption("value");if(t===this._getDisplayedText(s)){this._recallInternalValidation(s,n);return}const o=this._getParsedDate(t),a=s??this._getDateByDefault(),l=K.mergeDates(a,o,i),d=o&&i==="time"?l:o;if(this._applyInternalValidation(d).isValid){const c=this._getDisplayedText(l);a&&l&&a.getTime()===l.getTime()&&c!==t?this._renderValue():this.dateValue(l,e)}}_recallInternalValidation(e,t){(!t||t.editorSpecific)&&(this._applyInternalValidation(e),this._applyCustomValidation(e))}_getDateByDefault(){return this._strategy.useCurrentDateByDefault()&&this._strategy.getDefaultDate()}_getParsedDate(e){const t=this._strategy.getDisplayFormat(this.option("displayFormat"));return this._strategy.getParsedText(e,t)??void 0}_applyInternalValidation(e){const i=!!this.option("text")&&e!==null,n=!!e&&xt(e)&&!isNaN(e.getTime()),s=n&&R.dateInRange(e,this.dateOption("min"),this.dateOption("max"),this.option("type")),o=!i&&!e||s;let a="";const{invalidDateMessage:l,dateOutOfRangeMessage:d}=this.option();return n?s||(a=d):a=l,this._updateInternalValidationState(o,a),{isValid:o,isDate:n}}_updateInternalValidationState(e,t){this.option({isValid:e,validationError:e?null:{editorSpecific:!0,message:t}})}_applyCustomValidation(e){this.validationRequest.fire({editor:this,value:this._serializeDate(e)})}_isValueChanged(e){const t=this.dateOption("value"),i=t&&t.getTime(),n=e&&e.getTime();return i!==n}_isTextChanged(e){const t=this.option("text"),i=e&&this._getDisplayedText(e)||"";return t!==i}_renderProps(){super._renderProps(),this._input().attr("autocomplete","off")}_renderOpenedState(){this._isNativeType()||super._renderOpenedState(),this._strategy.isAdaptivityChanged()&&this._refreshStrategy()}_getPopupTitle(){const{placeholder:e}=this.option();if(e)return e;const{type:t}=this.option();return t===qe.time?w.format("dxDateBox-simulatedDataPickerTitleTime"):t===qe.date||t===qe.datetime?w.format("dxDateBox-simulatedDataPickerTitleDate"):""}_refreshStrategy(){this._strategy.dispose(),this._initStrategy(),this.option(this._strategy.getDefaultOptions()),this._refresh()}_applyButtonHandler(e){const t=this._strategy.getValue();this.dateValue(t,e.event),super._applyButtonHandler()}_dispose(){var e;super._dispose(),(e=this._strategy)===null||e===void 0||e.dispose()}_isNativeType(){return this._pickerType===Ue.native}_updatePopupTitle(){var e;(e=this._popup)===null||e===void 0||e.option("title",this._getPopupTitle())}_optionChanged(e){switch(e.name){case"showClearButton":case"buttons":case"isValid":case"readOnly":super._optionChanged.apply(this,arguments),this._formatValidationIcon();break;case"pickerType":this._updatePickerOptions(),this._refreshStrategy(),this._refreshPickerTypeClass(),this._invalidate();break;case"type":this._updatePickerOptions(),this._refreshStrategy(),this._refreshFormatClass(),this._renderPopupWrapper(),this._formatValidationIcon(),this._updateValue();break;case"placeholder":super._optionChanged.apply(this,arguments),this._updatePopupTitle();break;case"min":case"max":{const t=this.option("isValid");this._applyInternalValidation(this.dateOption("value")),t||this._applyCustomValidation(this.dateOption("value")),this._invalidate();break}case"dateSerializationFormat":case"interval":case"disabledDates":case"calendarOptions":case"todayButtonText":this._invalidate();break;case"displayFormat":this.option("text",this._getDisplayedText(this.dateOption("value"))),this._renderInputValue();break;case"text":this._strategy.textChangedHandler(e.value),super._optionChanged.apply(this,arguments);break;case"showDropDownButton":this._formatValidationIcon(),super._optionChanged.apply(this,arguments);break;case"invalidDateMessage":case"dateOutOfRangeMessage":case"adaptivityEnabled":case"showAnalogClock":case"_showValidationIcon":break;default:super._optionChanged.apply(this,arguments)}}_getSerializationFormat(){const{value:e}=this.option();if(this.option("dateSerializationFormat")&&gs().forceIsoDateParsing)return this.option("dateSerializationFormat");if(Ee(e))return"number";if(!(!W(e)||e===""))return fe.getDateSerializationFormat(e)}_updateValue(e){super._updateValue(),this._applyInternalValidation(e??this.dateOption("value"))}dateValue(e,t){const i=this._isValueChanged(e);if(i&&t&&this._saveValueChangeEvent(t),!i){const{text:n}=this.option();this._isTextChanged(e)?this._updateValue(e):n===""&&this._applyCustomValidation(e)}return this.dateOption("value",e)}dateOption(e,t){if(arguments.length===1)return fe.deserializeDate(this.option(e));this.option(e,this._serializeDate(t))}_serializeDate(e){const t=this._getSerializationFormat();return fe.serializeDate(e,t)}_clearValue(){const e=this.option("value");super._clearValue(),e===null&&this._applyCustomValidation(null)}clear(){const e=this.option("value");super.clear(),e===null&&this._applyInternalValidation(null)}}const il=r=>r.getMonth()+1,nl=(r,e)=>{const t=r.getDate(),i=an("M",r),n=At(parseInt(e),i.min,i.max);r.setMonth(n-1,1);const{min:s,max:o}=an("dM",r),a=At(t,s,o);r.setDate(a)},cC={a:r=>r.getHours()<12?0:1,E:"getDay",y:"getFullYear",M:il,L:il,d:"getDate",H:"getHours",h:"getHours",m:"getMinutes",s:"getSeconds",S:"getMilliseconds",x:"getTimezoneOffset"},uC=b({},lp(),{a:(r,e)=>{const t=r.getHours();t>=12!==!!parseInt(e)&&r.setHours((t+12)%24)},d:(r,e)=>{const t=an("dM",r).max;e>t&&r.setMonth(r.getMonth()+1),r.setDate(e)},h:(r,e)=>{const t=r.getHours()>=12;r.setHours(+e%12+(t?12:0))},M:nl,L:nl,E:(r,e)=>{e<0||r.setDate(r.getDate()-r.getDay()+parseInt(e))},y:(r,e)=>{const t=r.getFullYear(),i=String(e).length,n=String(an("y",r).max).length,s=parseInt(String(t).substr(0,n-i)+e);r.setFullYear(s)},x:r=>r}),hC=r=>cC[r]||(()=>r),pC=(r,e)=>{const t=e.regexp.exec(r);let i=0,n=0;const s=[];for(let o=1;o<t.length;o++){i=n,n=i+t[o].length;const a=e.patterns[o-1].replace(/^'|'$/g,""),l=hC(a[0]);s.push({index:o-1,isStub:a===t[o],caret:{start:i,end:n},pattern:a,text:t[o],limits:function(){for(var d=arguments.length,c=new Array(d),u=0;u<d;u++)c[u]=arguments[u];return an(a[0],...c)},setter:uC[a[0]]||Ce,getter:l})}return s},an=(r,e,t)=>{const i={y:{min:0,max:9999},M:{min:1,max:12},L:{min:1,max:12},d:{min:1,max:31},dM:{min:1,max:new Date(e.getFullYear(),e.getMonth()+1,0).getDate()},E:{min:0,max:6},H:{min:0,max:23},h:{min:1,max:12},m:{min:0,max:59},s:{min:0,max:59},S:{min:0,max:999},a:{min:0,max:1},x:{min:0,max:0}};return i[t||r]||i.getAmPm},gC=(r,e)=>{for(let t=0;t<r.length;t++){const i=r[t].caret.end>=e;if(!r[t].isStub&&i)return t}return null};class mC extends dC{_supportedKeys(){const e=super._supportedKeys(),t=n=>{const s=e[Ie(n)];return s==null?void 0:s.apply(this,[n])},i=(n,s)=>this._shouldUseOriginalHandler(n)?t.apply(this,[n]):s.apply(this,[n]);return T({},e,{del:n=>i(n,(s=>{this._revertPart(1),this._isAllSelected()||s.preventDefault()})),backspace:n=>i(n,(s=>{this._revertPart(-1),this._isAllSelected()||s.preventDefault()})),home:n=>i(n,(s=>{this._selectFirstPart(),s.preventDefault()})),end:n=>i(n,(s=>{this._selectLastPart(),s.preventDefault()})),escape:n=>i(n,(()=>{this._revertChanges()})),enter:n=>i(n,(()=>{this._enterHandler()})),leftArrow:n=>i(n,(s=>{this._selectNextPart(-1),s.preventDefault()})),rightArrow:n=>i(n,(s=>{this._selectNextPart(1),s.preventDefault()})),upArrow:n=>i(n,(s=>{this._upDownArrowHandler(1),s.preventDefault()})),downArrow:n=>i(n,(s=>{this._upDownArrowHandler(-1),s.preventDefault()}))})}_shouldUseOriginalHandler(e){const t=this.option("opened")&&e&&!["backspace","del"].includes(Ie(e));return!this._useMaskBehavior()||t||e&&e.altKey}_upDownArrowHandler(e){this._setNewDateIfEmpty();const t=this._getActivePartValue(this._initialMaskValue),n=this._getActivePartValue()-t;this._loadMaskValue(this._initialMaskValue),this._changePartValue(n+e,!0)}_changePartValue(e,t){const i=this._getActivePartProp("pattern");/^a{1,5}$/.test(i)?this._toggleAmPm():this._partIncrease(e,t)}_toggleAmPm(){const e=this._getActivePartProp("text"),i=1^up.getPeriodNames().indexOf(e);this._setActivePartValue(i)}_getDefaultOptions(){return T({},super._getDefaultOptions(),{useMaskBehavior:!1,emptyDateValue:new Date(2e3,0,1,0,0,0)})}_isSingleCharKey(e){let{originalEvent:t,alt:i}=e;const n=t.data||t.key;return typeof n=="string"&&n.length===1&&!i&&!Ae(t)}_isSingleDigitKey(e){var t;const i=(t=e.originalEvent)===null||t===void 0?void 0:t.data;return(i==null?void 0:i.length)===1&&parseInt(i,10)}_useBeforeInputEvent(){return G.real().android}_keyInputHandler(e,t){const i=this._input().val();this._processInputKey(t),e.preventDefault(),i!==this._input().val()&&v.trigger(this._input(),"input")}_keyboardHandler(e){let{key:t}=e.originalEvent;const i=super._keyboardHandler(e);return!this._useMaskBehavior()||this._useBeforeInputEvent()||(me.chrome&&e.key==="Process"&&e.code.indexOf("Digit")===0?(t=e.code.replace("Digit",""),this._processInputKey(t),this._maskInputHandler=()=>{this._renderSelectedPart()}):this._isSingleCharKey(e)&&this._keyInputHandler(e.originalEvent,t)),i}_maskBeforeInputHandler(e){this._maskInputHandler=null;const{inputType:t}=e.originalEvent;t==="insertCompositionText"&&(this._maskInputHandler=()=>{this._renderSelectedPart()});const i=t==="deleteContentBackward";if(i||t==="deleteContentForward"){const o=i?-1:1;this._maskInputHandler=()=>{this._revertPart(),this._selectNextPart(o)}}if(!this._useMaskBehavior()||!this._isSingleCharKey(e))return;const s=e.originalEvent.data;return this._keyInputHandler(e,s),!0}_keyPressHandler(e){const{originalEvent:t}=e;(t==null?void 0:t.inputType)==="insertCompositionText"&&this._isSingleDigitKey(e)&&(this._processInputKey(t.data),this._renderDisplayText(this._getDisplayedText(this._maskValue)),this._selectNextPart()),super._keyPressHandler(e),this._maskInputHandler&&(this._maskInputHandler(),this._maskInputHandler=null)}_processInputKey(e){this._isAllSelected()&&(this._activePartIndex=0),this._setNewDateIfEmpty(),isNaN(parseInt(e))?this._searchString(e):this._searchNumber(e)}_isAllSelected(){const e=this._caret(),{text:t}=this.option();return e.end-e.start===t.length}_getFormatPattern(){if(this._formatPattern)return this._formatPattern;const e=this._strategy.getDisplayFormat(this.option("displayFormat"));return W(e)&&!P._getPatternByFormat(e)?this._formatPattern=e:this._formatPattern=dp((i=>P.format(i,e))),this._formatPattern}_setNewDateIfEmpty(){if(!this._maskValue){const{type:e}=this.option(),t=e==="time"?new Date(null):new Date;this._maskValue=t,this._initialMaskValue=t,this._renderDateParts()}}_partLimitsReached(e){const t=String(e).length,i=this._getActivePartProp("pattern").length,s=i===1?t:Math.min(i,t),o=this._searchValue.length===s,a=parseInt(`${this._searchValue}0`)>e;return o||a}_searchNumber(e){const{max:t}=this._getActivePartLimits(),i=String(t).length;this._searchValue=(this._searchValue+e).substr(-i),isNaN(this._searchValue)&&(this._searchValue=e),this._setActivePartValue(this._searchValue),this._partLimitsReached(t)&&this._selectNextPart(1)}_searchString(e){if(!isNaN(parseInt(this._getActivePartProp("text"))))return;const t=this._getActivePartProp("limits")(this._maskValue),i=this._searchValue+e.toLowerCase(),n=t.max-t.min;for(let s=0;s<=n;s++)if(this._loadMaskValue(this._initialMaskValue),this._changePartValue(s+1),this._getActivePartProp("text").toLowerCase().indexOf(i)===0){this._searchValue=i;return}this._setNewDateIfEmpty(),this._searchValue&&(this._clearSearchValue(),this._searchString(e))}_clearSearchValue(){this._searchValue=""}_revertPart(e){if(!this._isAllSelected()){const t=this._getActivePartValue(this.option("emptyDateValue"));this._setActivePartValue(t),this._selectNextPart(e)}this._clearSearchValue()}_useMaskBehavior(){const{mode:e}=this.option();return this.option("useMaskBehavior")&&e==="text"}_prepareRegExpInfo(){this._regExpInfo=cp(this._getFormatPattern(),P);const{regexp:e}=this._regExpInfo,{source:t}=e,{flags:i}=e,n=new RegExp(/(\{[0-9]+,?[0-9]*\})/),s=t.split(n).map((o=>n.test(o)?o:le.convertDigits(o,!1))).join("");this._regExpInfo.regexp=new RegExp(s,i)}_initMaskState(){this._activePartIndex=0,this._formatPattern=null,this._prepareRegExpInfo(),this._loadMaskValue()}_renderMask(){super._renderMask(),this._detachMaskEvents(),this._clearMaskState(),this._useMaskBehavior()&&(this._attachMaskEvents(),this._initMaskState(),this._renderDateParts())}_renderDateParts(){if(!this._useMaskBehavior())return;const e=this.option("text")||this._getDisplayedText(this._maskValue);e&&(this._dateParts=pC(e,this._regExpInfo),this._input().is(":hidden")||this._selectNextPart())}_detachMaskEvents(){v.off(this._input(),".dateBoxMask")}_attachMaskEvents(){v.on(this._input(),V("dxclick","dateBoxMask"),this._maskClickHandler.bind(this)),v.on(this._input(),V("paste","dateBoxMask"),this._maskPasteHandler.bind(this)),v.on(this._input(),V("drop","dateBoxMask"),(()=>{this._renderSelectedPart()})),v.on(this._input(),V("compositionend","dateBoxMask"),this._maskCompositionEndHandler.bind(this)),this._useBeforeInputEvent()&&v.on(this._input(),V("beforeinput","dateBoxMask"),this._maskBeforeInputHandler.bind(this))}_renderSelectedPart(){this._renderDisplayText(this._getDisplayedText(this._maskValue)),this._selectNextPart()}_selectLastPart(){this.option("text")&&(this._activePartIndex=this._dateParts.length,this._selectNextPart(-1))}_selectFirstPart(){this.option("text")&&this._dateParts&&(this._activePartIndex=-1,this._selectNextPart(1))}_hasMouseWheelHandler(){return!0}_onMouseWheel(e){this._useMaskBehavior()&&this._partIncrease(e.delta>0?1:-1,e)}_selectNextPart(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(!this.option("text")||this._disposed)return;e&&(this._initialMaskValue=new Date(this._maskValue));let t=At(this._activePartIndex+e,0,this._dateParts.length-1);if(this._dateParts[t].isStub){if(!(t===0&&e<0||t===this._dateParts.length-1&&e>0)){this._selectNextPart(e>=0?e+1:e-1);return}t=this._activePartIndex}this._activePartIndex!==t&&this._clearSearchValue(),this._activePartIndex=t,this._caret(this._getActivePartProp("caret"))}_getRealLimitsPattern(){if(this._getActivePartProp("pattern")[0]==="d")return"dM"}_getActivePartLimits(e){return this._getActivePartProp("limits")(this._maskValue,e&&this._getRealLimitsPattern())}_getActivePartValue(e){e=e||this._maskValue;const t=this._getActivePartProp("getter");return B(t)?t(e):e[t]()}_addLeadingZeroes(e){const t=/^0+/.exec(this._searchValue),i=this._getActivePartLimits(),n=String(i.max).length;return((t&&t[0]||"")+String(e)).substr(-n)}_setActivePartValue(e,t){t=t||this._maskValue;const i=this._getActivePartProp("setter"),n=this._getActivePartLimits();e=Jt(e,n.min,n.max)?e:e%10,e=this._addLeadingZeroes(At(e,n.min,n.max)),B(i)?i(t,e):t[i](e),this._renderDisplayText(this._getDisplayedText(t)),this._renderDateParts()}_getActivePartProp(e){if(!(!this._dateParts||!this._dateParts[this._activePartIndex]))return this._dateParts[this._activePartIndex][e]}_loadMaskValue(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.dateOption("value");this._maskValue=e&&new Date(e),this._initialMaskValue=e&&new Date(e)}_saveMaskValue(){const e=this._maskValue&&new Date(this._maskValue),{type:t}=this.option();e&&t==="date"&&e.setHours(0,0,0,0),this._initialMaskValue=new Date(e),this._applyInternalValidation(e).isValid&&this.dateOption("value",e)}_revertChanges(){this._loadMaskValue(),this._renderDisplayText(this._getDisplayedText(this._maskValue)),this._renderDateParts()}_renderDisplayText(e){super._renderDisplayText(e),this._useMaskBehavior()&&this.option("text",e)}_partIncrease(e,t){this._setNewDateIfEmpty();const{max:i,min:n}=this._getActivePartLimits(t);let s=e+this._getActivePartValue();s>i?s=this._applyLimits(s,{limitBase:n,limitClosest:i,max:i}):s<n&&(s=this._applyLimits(s,{limitBase:i,limitClosest:n,max:i})),this._setActivePartValue(s)}_applyLimits(e,t){let{limitBase:i,limitClosest:n,max:s}=t;const o=(e-n)%s;return o?i+o-1*Qn(o):n}_maskClickHandler(){this._loadMaskValue(this._maskValue),this.option("text")&&(this._activePartIndex=gC(this._dateParts,this._caret().start),this._isAllSelected()||(this._clearSearchValue(),m(this._activePartIndex)?this._caret(this._getActivePartProp("caret")):this._selectLastPart()))}_maskCompositionEndHandler(e){this._input().val(this._getDisplayedText(this._maskValue)),this._selectNextPart(),this._maskInputHandler=()=>{this._renderSelectedPart()}}_maskPasteHandler(e){const t=this._replaceSelectedText(this.option("text"),this._caret(),Wh(e)),i=P.parse(t,this._getFormatPattern());i&&this._isDateValid(i)&&(this._maskValue=i,this._renderDisplayText(this._getDisplayedText(this._maskValue)),this._renderDateParts(),this._selectNextPart()),e.preventDefault()}_isDateValid(e){return xt(e)&&!isNaN(e)}_isValueDirty(){const e=this.dateOption("value");return(this._maskValue&&this._maskValue.getTime())!==(e&&e.getTime())}_fireChangeEvent(){this._clearSearchValue(),this._isValueDirty()&&v.trigger(this._input(),"change")}_enterHandler(){this._fireChangeEvent(),this._selectNextPart(1)}_focusOutHandler(e){this._useMaskBehavior()&&!e.isDefaultPrevented()?(this._fireChangeEvent(),super._focusOutHandler(e),this._selectFirstPart()):super._focusOutHandler(e)}_valueChangeEventHandler(e){const t=this.option("text");this._useMaskBehavior()?(this._saveValueChangeEvent(e),t?this._maskValue===null&&this._loadMaskValue(t):this._maskValue=null,this._saveMaskValue()):super._valueChangeEventHandler(e)}_optionChanged(e){switch(e.name){case"useMaskBehavior":this._renderMask();break;case"displayFormat":case"mode":super._optionChanged(e),this._renderMask();break;case"value":this._loadMaskValue(),super._optionChanged(e),this._renderDateParts();break;case"emptyDateValue":break;default:super._optionChanged(e)}}_clearMaskState(){this._clearSearchValue(),delete this._dateParts,delete this._activePartIndex,delete this._maskValue}clear(){this._clearMaskState(),this._activePartIndex=0,super.clear()}_clean(){super._clean(),this._detachMaskEvents(),this._clearMaskState()}}_e("dxDateBox",mC);const{isWrapped:_C}=gt,fC="dx-editor-inline-block",fn=function(r,e){return b(r,{readOnly:e.readOnly,placeholder:e.placeholder,inputAttr:{id:e.id,"aria-labelledby":e["aria-labelledby"]},tabIndex:e.tabIndex},e.editorOptions)},Kc=function(){return me.mozilla||G.real().ios},Gc=function(r){const e={},t=Kc(),i=r.sharedData||e;return fn({placeholder:r.placeholder,width:r.width,value:r.value,onValueChanged:function(n){const s=r.parentType==="filterRow"||r.parentType==="searchPanel",o=n.event&&(n.event.type==="input"||n.event.type==="keyup"),a=function(l,d){r&&r.setValue(l.value,d)};clearTimeout(e.valueChangeTimeout),o&&s?i.valueChangeTimeout=e.valueChangeTimeout=setTimeout((function(){a(n,e.valueChangeTimeout!==i.valueChangeTimeout)}),m(r.updateValueTimeout)?r.updateValueTimeout:0):a(n)},onKeyDown:function(n){t&&Ie(n.event)==="enter"&&v.trigger(h(n.component._input()),"change")},valueChangeEvent:"change"+(r.parentType==="filterRow"?" keyup input":"")},r)},sl=function(r){r.editorName="dxDateBox",r.editorOptions=fn({value:r.value,onValueChanged:function(e){r.setValue(e.value)},onKeyDown:function(e){let{component:t,event:i}=e;const n=t.option("useMaskBehavior");(Kc()||n)&&Ie(i)==="enter"&&(t.blur(),t.focus())},displayFormat:r.format,type:r.dataType,dateSerializationFormat:null,width:r.parentType==="filterBuilder"?void 0:"auto"},r)},ol=function(r){const e=Gc(r),t=r.parentType==="searchPanel";r.editorType&&r.editorType!=="dxTextBox"?e.value=r.value:e.value=(i=r.value,m(i)?i.toString():"");var i;e.valueChangeEvent+=t?" keyup input search":"",e.mode=e.mode||(t?"search":"text"),r.editorName="dxTextBox",r.editorOptions=e},rl=function(r){const e=Gc(r);e.value=m(r.value)?r.value:null,r.editorName="dxNumberBox",r.editorOptions=e},CC=function(r){r.parentType==="filterRow"||r.parentType==="filterBuilder"?Uc(b(r,{lookup:{displayExpr:function(e){if(e===!0)return r.trueText||"true";if(e===!1)return r.falseText||"false"},dataSource:[!0,!1]}})):qc(r)};function vC(r){if(r.row&&r.row.watch&&r.parentType==="dataRow"){const e=r.editorOptions||{};r.editorOptions=e;let t;const i=e.onInitialized;e.onInitialized=function(o){i&&i.apply(this,arguments),t=o.component,t.on("disposing",s)};let n;const s=r.row.watch((()=>(n=r.lookup.dataSource(r.row),n&&n.filter)),(()=>{t.option("dataSource",n)}),(o=>{r.row=o}))}}function Uc(r){const e=r.lookup;let t,i,n;const s=r.parentType==="filterRow";if(e){t=Pe(e.displayExpr),i=e.dataSource,B(i)&&!_C(i)&&(i=i(r.row||{}),vC(r)),(L(i)||Array.isArray(i))&&(i=pn(i),s&&(n=i.postProcess,i.postProcess=function(a){return this.pageIndex()===0&&(a=a.slice(0),a.unshift(null)),n?n.call(this,a):a}));const o=!!(e.allowClearing&&!s);r.editorName=r.editorType??"dxSelectBox",r.editorOptions=fn({searchEnabled:!0,value:r.value,valueExpr:r.lookup.valueExpr,searchExpr:r.lookup.searchExpr||r.lookup.displayExpr,allowClearing:o,showClearButton:o,displayExpr:function(a){return a===null?r.showAllText:t(a)},dataSource:i,onValueChanged:function(a){const l=[a.value];!s&&l.push(a.component.option("text")),r.setValue.apply(this,l)}},r)}}function qc(r){r.editorName="dxCheckBox",r.editorOptions=fn({elementAttr:{id:r.id},value:m(r.value)?r.value:void 0,hoverStateEnabled:!r.readOnly,focusStateEnabled:!r.readOnly,activeStateEnabled:!1,onValueChanged:function(e){r.setValue&&r.setValue(e.value,e)}},r)}const xC=function(r,e){const t=h(e.editorElement);if(e.editorName&&e.editorOptions&&t[e.editorName]){if((e.editorName==="dxCheckBox"||e.editorName==="dxSwitch")&&(e.isOnForm||(t.addClass(r.addWidgetPrefix("checkbox-size")),t.parent().addClass(fC))),r._createComponent(t,e.editorName,e.editorOptions),e.editorName==="dxDateBox"){const i=t.dxDateBox("instance"),n=i._supportedKeys().enter;i.registerKeyHandler("enter",(s=>(i.option("opened")&&n(s),!0)))}e.editorName==="dxTextArea"&&t.dxTextArea("instance").registerKeyHandler("enter",(function(i){Ie(i)==="enter"&&!i.ctrlKey&&!i.shiftKey&&i.stopPropagation()}))}},wC=r=>{r.editorName=r.editorType,r.editorOptions=fn({value:r.value,onValueChanged:function(e){r.setValue(e.value)}},r)},bC=r=>{const e={dxDateBox:sl,dxCheckBox:qc,dxNumberBox:rl,dxTextBox:ol};if(r.lookup)Uc(r);else if(r.editorType)(e[r.editorType]??wC)(r);else switch(r.dataType){case"date":case"datetime":sl(r);break;case"boolean":CC(r);break;case"number":rl(r);break;default:ol(r)}},Yc=r=>class extends r{createEditor(e,t){t.cancel=!1,t.editorElement=$(e),m(t.tabIndex)||(t.tabIndex=this.option("tabIndex")),bC(t),this.executeAction("onEditorPreparing",t),!t.cancel&&(t.parentType==="dataRow"&&!t.isOnForm&&!m(t.editorOptions.showValidationMark)&&(t.editorOptions.showValidationMark=!1),xC(this,t),this.executeAction("onEditorPrepared",t))}},yC="dx-editor-inline-block",jc="dxDataGridEditorFactory",al=V([Q,"focusin"].join(" "),jc),Tn="dx-hidden",IC=Yc(j.ViewController);let SC=class extends IC{init(){this.createAction("onEditorPreparing",{excludeValidators:["disabled","readOnly"],category:"rendering"}),this.createAction("onEditorPrepared",{excludeValidators:["disabled","readOnly"],category:"rendering"}),this._columnsResizerController=this.getController("columnsResizer"),this._editingController=this.getController("editing"),this._keyboardNavigationController=this.getController("keyboardNavigation"),this._columnsController=this.getController("columns"),this._validatingController=this.getController("validating"),this._columnHeadersView=this.getView("columnHeadersView"),this._rowsView=this.getView("rowsView"),this._updateFocusHandler=this._updateFocusHandler||this.createAction(this._updateFocus.bind(this)),this._subscribedContainerRoot=this._getContainerRoot(),v.on(this._subscribedContainerRoot,al,this._updateFocusHandler),this._attachContainerEventHandlers()}dispose(){clearTimeout(this._focusTimeoutID),clearTimeout(this._updateFocusTimeoutID),v.off(this._subscribedContainerRoot,al,this._updateFocusHandler)}_getFocusedElement(e){const i=["td[tabindex]:focus",`${this.option("focusedRowEnabled")?"tr[tabindex]:focus":"tr[tabindex]:not(.dx-data-row):focus"}`,"input:focus","button:focus","textarea:focus","div[tabindex]:focus",".dx-lookup-field:focus",".dx-checkbox:focus",".dx-switch:focus",".dx-dropdownbutton .dx-buttongroup:focus",".dx-adaptive-item-text:focus"].join(","),n=e.find(i);return this.elementIsInsideGrid(n)&&n}_getFocusCellSelector(){return".dx-row > td"}_updateFocusCore(){const e=this.component&&this.component.$element();if(e){let t=this._getFocusedElement(e);if(t&&t.length){let i;if(!t.hasClass("dx-cell-focus-disabled")&&!t.hasClass("dx-row")){const n=t.closest(`${this._getFocusCellSelector()}, .dx-cell-focus-disabled`);n.get(0)!==t.get(0)&&(i=this._needHideBorder(n),t=n)}if(t.length&&!t.hasClass("dx-cell-focus-disabled")){this.focus(t,i);return}}}this.loseFocus()}_needHideBorder(e){const t=this._rowsView.element(),i=e.closest(t).length>0,n=this._editingController.isEditing();return e.hasClass(yC)||i&&!n}_updateFocus(e){const t=this,i=e&&e.event&&h(e.event.target).hasClass(t.addWidgetPrefix("focus-overlay"));t._isFocusOverlay=t._isFocusOverlay||i,clearTimeout(t._updateFocusTimeoutID),t._updateFocusTimeoutID=setTimeout((()=>{delete t._updateFocusTimeoutID,t._isFocusOverlay||t._updateFocusCore(),t._isFocusOverlay=!1}))}updateFocusOverlaySize(e,t){e.hide();const i=ei.calculate(e,b({collision:"fit"},t));i.h.oversize>0&&Br(e,ge(e)-i.h.oversize),i.v.oversize>0&&Nr(e,Y(e)-i.v.oversize),e.show()}callbackNames(){return["focused"]}getFocusOverlayContainer(e){return e.closest(`.${this.addWidgetPrefix("content")}`)}getFocusOverlaySize(e){const t=re(e.get(0));return{width:t.right-t.left+1,height:t.bottom-t.top+1}}updateFocusOverlay(e){if(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)this._$focusOverlay.addClass(Tn);else if(e.length){const i=me.mozilla?"right bottom":"left top",n=e.hasClass(this.addWidgetPrefix("invalid")),s=e.hasClass("dx-cell-modified")&&!n,o=this.getFocusOverlayContainer(e),a=this.getFocusOverlaySize(e);this._$focusOverlay.removeClass(Tn).toggleClass("dx-focused-cell-invalid",n).toggleClass("dx-focused-cell-modified",s).appendTo(o),Nr(this._$focusOverlay,a.height),Br(this._$focusOverlay,a.width);const l={precise:!0,my:i,at:i,of:e,boundary:o.length&&o};this.updateFocusOverlaySize(this._$focusOverlay,l),ei.setup(this._$focusOverlay,l),this._$focusOverlay.css("visibility","visible")}}renderFocusOverlay(e,t){y.isElementInCurrentGrid(this,e)&&(this._$focusOverlay||(this._$focusOverlay=h("<div>").addClass(this.addWidgetPrefix("focus-overlay"))),this.updateFocusOverlay(e,t))}focus(e,t){const i=this;if(e===void 0)return i._$focusedElement;e&&(e.is(i._$focusedElement)||i._$focusedElement&&i._$focusedElement.removeClass("dx-focused"),i._$focusedElement=e,clearTimeout(i._focusTimeoutID),i._focusTimeoutID=setTimeout((()=>{delete i._focusTimeoutID,i.renderFocusOverlay(e,t),e.addClass("dx-focused"),i.focused.fire(e)})))}refocus(){const e=this.focus();this.focus(e)}resize(){const e=this._$focusedElement;e&&this.focus(e)}loseFocus(e){this._$focusedElement&&this._$focusedElement.removeClass("dx-focused"),this._$focusedElement=null,this._$focusOverlay&&this._$focusOverlay.addClass(Tn)}_getContainerRoot(){var e;const t=(e=this.component)===null||e===void 0?void 0:e.$element(),i=M.getRootNode(t==null?void 0:t.get(0));return i.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&!i.host?M.getDocument():i}_attachContainerEventHandlers(){const e=this,t=e.component&&e.component.$element();t&&v.on(t,V("keydown",jc),(i=>{Ie(i)==="tab"&&e._updateFocusHandler(i)}))}getFocusOverlay(){return this._$focusOverlay}hasOverlayElements(){var e;return!!((e=this._$focusOverlay)!==null&&e!==void 0&&e.length)&&!this._$focusOverlay.hasClass(Tn)}};const NS={defaultOptions:()=>({}),controllers:{editorFactory:SC}},Dn=oe(),EC={h:10,v:0},TC={text:w.format("OK"),onClick:()=>!0},DC=()=>st(Se())?{stylingMode:"contained",type:"default"}:{},RC=()=>st(Se())?{stylingMode:"outlined",type:"default"}:{},VC=r=>{const{buttons:e,dragEnabled:t,message:i,messageHtml:n,popupOptions:s,showCloseButton:o,showTitle:a,title:l="",width:d,position:c}=r??{};m(i)&&se.log("W1013");const p=m(n),g=String(p?n:i),_=l?null:new Te().toString(),f=S(),C=h("<div>").addClass("dx-dialog").appendTo(yd()),I=h("<div>").addClass("dx-dialog-message").html(g).attr("id",_);let E=null;const D=ce=>{var ue;f.resolve(ce),(ue=E)===null||ue===void 0||ue.hide()},A=(e??[TC]).map((ce=>{const{onClick:ue}=ce,te=new zh(ue,{context:E});return{toolbar:"bottom",location:G.current().android?"after":"center",widget:"dxButton",options:T({},ce,{onClick:Ge=>{const Oe=te.execute(Ge);D(Oe)}})}})),F=c??{boundaryOffset:T({},EC)},z={animation:{show:{type:"pop",duration:400},hide:{type:"pop",duration:400,to:{opacity:0,scale:0},from:{opacity:1,scale:1}}},container:C,dragAndResizeArea:Dn,dragEnabled:We(t,!0),height:"auto",ignoreChildEvents:!1,onContentReady:ce=>{const ue=ce.component;ue.$content().addClass("dx-dialog-content").append(I),_&&ue.$overlayContent().attr("aria-labelledby",_)},onHidden:ce=>{h(ce.element).remove()},onHiding:()=>{f.reject()},onShowing:ce=>{const te=ce.component.bottomToolbar();te==null||te.addClass("dx-dialog-buttons").find(".dx-button").addClass("dx-dialog-button"),Id.resetActiveElement()},onShown:ce=>{const te=ce.component.bottomToolbar(),be=te==null?void 0:te.find(".dx-button").first();v.trigger(be,"focus")},position:F,rtlEnabled:gs().rtlEnabled,showCloseButton:o??!1,showTitle:We(a,!0),title:l,toolbarItems:A,visualContainer:Dn,width:d},ee=T({},z,s);return E=new ni(C,ee),E.$wrapper().addClass("dx-dialog-wrapper").addClass("dx-dialog-root"),{show:()=>{var ce;if(G.real().deviceType==="phone"){var ue;const be=X(Dn)>H(Dn)?"90%":"60%";(ue=E)===null||ue===void 0||ue.option({width:be})}return(ce=E)===null||ce===void 0||ce.show(),f.promise()},hide:D}},OC=r=>ze(r),FC=(r,e,t)=>{const i=e??"",n=OC(r)?r:{title:i,messageHtml:r,showTitle:t,buttons:[T({text:w.format("Yes"),onClick:()=>!0},DC()),T({text:w.format("No"),onClick:()=>!1},RC())],dragEnabled:t};return VC(n).show()},Ss="dx-editor-cell",Tt="dx-row",AC="dx-cell-modified",ll="dx-selection",_r="edit-form",Je="insert",ht="remove",Kn="editing.popup",eo="editing.form",Le="editing.editRowKey",Qt="editing.editColumnName",Xc="targetComponent",fr="input:not([type='hidden'])",Cr=`[tabindex]:not([disabled]), ${fr}:not([disabled])`,Mo="batch",Qi="row",Bo="cell",vr="form",PC="popup",dl="first",Rn="last",cl="pageBottom",ul="pageTop",hl="viewportBottom",Zc="viewportTop",kC=["batch","row","cell","form","popup"],MC=["row","form","popup"],BC=["batch","cell"],NC=["batch","row","cell"],LC=["row","form"],$C="readonly",HC="dx-link",WC="dx-link-icon",zC="dx-selection",KC="dx-edit-button",GC="dx-command-edit",pl="dx-command-edit-with-icons",It="__DX_INSERT_INDEX__",UC="dx-row-inserted",qC="dx-row-modified",gl="dx-cell-modified",YC="dxDataGridEditing",jC="dx-cell-focus-disabled",Hi="update",XC="click",ZC={save:"dx-link-save",cancel:"dx-link-cancel",edit:"dx-link-edit",undelete:"dx-link-undelete",delete:"dx-link-delete",add:"dx-link-add"},QC={save:"save",cancel:"revert",edit:"edit",undelete:"revert",delete:"trash",add:"add"},JC={edit:"editRow",delete:"deleteRow",undelete:"undeleteRow",save:"saveEditData",cancel:"cancelEditData",add:"addRowByRowIndex"},ev={add:"allowAdding",edit:"allowUpdating",delete:"allowDeleting"},tv=["edit","save","cancel","delete","undelete"],pt="editing.changes",iv="focus-overlay",nv="addrow-button",sv="dx-dropdowneditor-overlay",ov="dx-data-row",rv="dx-row-removed",av="filter-row",Qc="edit-form-item",lv="edit-popup",dv="edit-popup-form",cv="dx-scrollable-container",uv="dx-button",hv="form-buttons-container",ml="dx-edit-row",Vn=function(r){return function(e){const t=e instanceof Error?e:new Error(e&&String(e)||"Unknown error");r.reject(t)}},Jc=function(r,e){return e.isEditing||r&&e.column.allowEditing},_l=function(r,e){const t=!!e.column.command,i=Jc(r,e),n=!t&&(i||e.column.showEditorAlways);return e.rowType==="data"&&n},pv=r=>{const e=r.component.option("editing.texts")||{};return{save:e.saveRowChanges,cancel:e.cancelRowChanges,edit:e.editRow,undelete:e.undeleteRow,delete:e.deleteRow,add:e.addRowToNode}},gv=()=>`_DX_KEY_${new Te}`,mv=r=>typeof r=="string"&&r.startsWith("_DX_KEY_")&&r.length===44,hi=(r,e)=>{let t=-1;return r.some(((i,n)=>{if(eu(i)===e)return t=n,!0})),t};function eu(r){return L(r)?r.name:r}function _v(r){return r&&(r.is("input")||r.is("textarea"))}const fv=r=>{var e;const{column:t}=r;return r.isCustomEditorType?r.editorType:(e=t.formItem)===null||e===void 0?void 0:e.editorType},tu=(r,e)=>{r.forEach((t=>{t.items||t.tabs?tu(t.items||t.tabs,e):e(t)}))};class Cv extends j.ViewController{init(){this._columnsController=this.getController("columns"),this._dataController=this.getController("data"),this._adaptiveColumnsController=this.getController("adaptiveColumns"),this._validatingController=this.getController("validating"),this._editorFactoryController=this.getController("editorFactory"),this._focusController=this.getController("focus"),this._keyboardNavigationController=this.getController("keyboardNavigation"),this._columnsResizerController=this.getController("columnsResizer"),this._errorHandlingController=this.getController("errorHandling"),this._rowsView=this.getView("rowsView"),this._headerPanelView=this.getView("headerPanel"),this._lastOperation=null,this._changes=[],this._deferreds&&this._deferreds.forEach((e=>{e.reject("cancel")})),this._deferreds=[],this._dataChangedHandler||(this._dataChangedHandler=this._handleDataChanged.bind(this),this._dataController.changed.add(this._dataChangedHandler)),this._saveEditorHandler||(this.createAction("onInitNewRow",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowInserting",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowInserted",{excludeValidators:["disabled","readOnly"]}),this.createAction("onEditingStart",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowUpdating",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowUpdated",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowRemoving",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowRemoved",{excludeValidators:["disabled","readOnly"]}),this.createAction("onSaved",{excludeValidators:["disabled","readOnly"]}),this.createAction("onSaving",{excludeValidators:["disabled","readOnly"]}),this.createAction("onEditCanceling",{excludeValidators:["disabled","readOnly"]}),this.createAction("onEditCanceled",{excludeValidators:["disabled","readOnly"]})),this._updateEditColumn(),this._updateEditButtons(),this._internalState||(this._internalState=new Map),this.component._optionsByReference[Le]=!0,this.component._optionsByReference[pt]=!0}getEditMode(){const e=this.option("editing.mode")??Qi;return kC.includes(e)?e:Qi}isCellBasedEditMode(){const e=this.getEditMode();return BC.includes(e)}_getDefaultEditorTemplate(){return(e,t)=>{const i=h("<div>").appendTo(e),n=b({},t.column,{value:t.value,setValue:t.setValue,row:t.row,parentType:"dataRow",width:null,readOnly:!t.setValue,isOnForm:t.isOnForm,id:t.id});NC.includes(this.getEditMode())&&(n["aria-labelledby"]=t.column.headerId),this._editorFactoryController.createEditor(i,n)}}_getNewRowPosition(){const e=this.option("editing.newRowPosition");if(this.option("scrolling.mode")==="virtual")switch(e){case ul:return Zc;case cl:return hl;default:return e}return e}getChanges(){return this.option(pt)}getInsertRowCount(){return this.option(pt).filter((t=>t.type==="insert")).length}resetChanges(){const e=this.getChanges();(e==null?void 0:e.length)&&(this._silentOption(pt,[]),this._internalState.clear())}_getInternalData(e){return this._internalState.get(Ot(e))}_addInternalData(e){const t=this._getInternalData(e.key);return t?b(t,e):(this._internalState.set(Ot(e.key),e),e)}_getOldData(e){var t;return(t=this._getInternalData(e))===null||t===void 0?void 0:t.oldData}getUpdatedData(e){const t=this._dataController.keyOf(e),i=this.getChanges(),n=y.getIndexByKey(t,i);return i[n]?Xt(e,i[n].data):e}getInsertedData(){return this.getChanges().filter((e=>e.data&&e.type===Je)).map((e=>e.data))}getRemovedData(){return this.getChanges().filter((e=>this._getOldData(e.key)&&e.type===ht)).map((e=>this._getOldData(e.key)))}_fireDataErrorOccurred(e){if(e==="cancel")return;const t=this.getPopupContent();this._dataController.dataErrorOccurred.fire(e,t)}_needToCloseEditableCell(e){}_closeEditItem(e){}_handleDataChanged(e){}_isDefaultButtonVisible(e,t){let i=!0;switch(e.name){case"delete":i=this.allowDeleting(t);break;case"undelete":i=!1}return i}isPopupEditMode(){return this.option("editing.mode")===PC}_isButtonVisible(e,t){const{visible:i}=e;return m(i)?B(i)?i.call(e,{component:t.component,row:t.row,column:t.column}):i:this._isDefaultButtonVisible(e,t)}_isButtonDisabled(e,t){const{disabled:i}=e;return B(i)?i.call(e,{component:t.component,row:t.row,column:t.column}):!!i}_getButtonConfig(e,t){const i=L(e)?e:{},n=eu(e),s=pv(t),o=JC[n],a=this.option("editing"),l=ev[n],d=l?a[l]:!0;return b({name:n,text:s[n],cssClass:ZC[n]},{onClick:o&&(c=>{const{event:u}=c;u.stopPropagation(),u.preventDefault(),setTimeout((()=>{t.row&&d&&this[o]&&this[o](t.row.rowIndex)}))})},i)}_getEditingButtons(e){let t;const i=!!e.column.buttons;let n=(e.column.buttons||[]).slice();return i?(t=hi(n,"edit"),t>=0&&(hi(n,"save")<0&&n.splice(t+1,0,"save"),hi(n,"cancel")<0&&n.splice(hi(n,"save")+1,0,"cancel")),t=hi(n,"delete"),t>=0&&hi(n,"undelete")<0&&n.splice(t+1,0,"undelete")):n=tv.slice(),n.map((s=>this._getButtonConfig(s,e)))}_renderEditingButtons(e,t,i,n){t.forEach((s=>{this._isButtonVisible(s,i)&&this._createButton(e,s,i,n)}))}_getEditCommandCellTemplate(){return(e,t,i)=>{const n=h(e);if(t.rowType==="data"){const s=this._getEditingButtons(t);if(this._renderEditingButtons(n,s,t,i),t.watch){const o=t.watch((()=>s.map((a=>({visible:this._isButtonVisible(a,t),disabled:this._isButtonDisabled(a,t)})))),(()=>{n.empty(),this._renderEditingButtons(n,s,t)}));v.on(n,ii,o)}}else y.setEmptyText(n)}}isRowBasedEditMode(){const e=this.getEditMode();return MC.includes(e)}getFirstEditableColumnIndex(){let e;const t=this._columnsController.getVisibleColumns();return x(t,((i,n)=>{if(n.allowEditing)return e=i,!1})),e}getFirstEditableCellInRow(e){var t;const i=this.getFirstEditableColumnIndex();return(t=this._rowsView)===null||t===void 0?void 0:t._getCellElement(e||0,i)}getFocusedCellInRow(e){return this.getFirstEditableCellInRow(e)}getIndexByKey(e,t){return y.getIndexByKey(e,t)}hasChanges(e){const t=this.getChanges();let i=!1;for(let n=0;n<(t==null?void 0:t.length);n++)if(t[n].type&&(!m(e)||this._dataController.getRowIndexByKey(t[n].key)===e)){i=!0;break}return i}dispose(){super.dispose(),clearTimeout(this._inputFocusTimeoutID),v.off(M.getDocument(),Z.up,this._pointerUpEditorHandler),v.off(M.getDocument(),Z.down,this._pointerDownEditorHandler),v.off(M.getDocument(),Q,this._saveEditorHandler)}_silentOption(e,t){e==="editing.changes"&&(this._changes=Et([],t)),super._silentOption(e,t)}optionChanged(e){if(e.name==="editing"){const{fullName:t}=e;t===Le?this._handleEditRowKeyChange(e):t===pt?ae(e.value,this._changes,{maxDepth:4})||(this._changes=Et([],e.value),this._handleChangesChange(e)):e.handled||(this._columnsController.reinit(),this.init(),this.resetChanges(),this._resetEditColumnName(),this._resetEditRowKey()),e.handled=!0}else super.optionChanged(e)}_handleEditRowKeyChange(e){const t=this._dataController.getRowIndexByKey(e.value),i=this._getEditRowIndexCorrection(),n=this._dataController.getRowIndexByKey(e.previousValue)+i;m(e.value)?e.value!==e.previousValue&&this._editRowFromOptionChanged(t,n):this.cancelEditData()}_handleChangesChange(e){const t=this._dataController,i=e.value;!e.value.length&&!e.previousValue.length||(i.forEach((n=>{if(n.type==="insert")this._addInsertInfo(n);else{var s;const o=t.getCachedStoreData()||((s=t.items())===null||s===void 0?void 0:s.map((l=>l.data))),a=y.getIndexByKey(n.key,o,t.key());this._addInternalData({key:n.key,oldData:o[a]})}})),t.updateItems({repaintChangesOnly:!0,isLiveUpdate:!1,isOptionChanged:!0}))}publicMethods(){return["addRow","deleteRow","undeleteRow","editRow","saveEditData","cancelEditData","hasEditData"]}refresh(){m(this._pageIndex)&&this._refreshCore.apply(this,arguments)}_refreshCore(e){}isEditing(){return m(this.option(Le))}isEditRow(e){return!1}_setEditRowKey(e,t){t?this._silentOption(Le,e):this.option(Le,e),this._refocusEditCell&&(this._refocusEditCell=!1,this._focusEditingCell())}getEditRowIndex(){return this._getVisibleEditRowIndex()}getEditFormRowIndex(){return-1}isEditRowByIndex(e){const t=this._dataController.getKeyByRowIndex(e),i=m(t)&&ae(this.option(Le),t);return i&&this._getVisibleEditRowIndex()===e}isEditCell(e,t){return this.isEditRowByIndex(e)&&this._getVisibleEditColumnIndex()===t}getPopupContent(){}_isProcessedItem(e){return!1}_getInsertRowIndex(e,t,i){let n=-1;const s=this._dataController,o=this._getInsertAfterOrBeforeKey(t);return!m(o)&&e.length===0?n=0:m(o)&&e.some(((a,l)=>{const d=i||this._isProcessedItem(a);if(L(a)&&(d||m(a[It])?ae(a.key,o)&&(n=l):ae(s.keyOf(a),o)&&(n=l)),n>=0){const c=e[n+1];return c&&(c.rowType==="detail"||c.rowType==="detailAdaptive")&&m(t.insertAfterKey)?void 0:(m(t.insertAfterKey)&&(n+=1),!0)}})),n}_generateNewItem(e){var t;const i={key:e},n=(t=this._getInternalData(e))===null||t===void 0?void 0:t.insertInfo;return n!=null&&n[It]&&(i[It]=n[It]),i}_getLoadedRowIndex(e,t,i){let n=this._getInsertRowIndex(e,t,i);const s=this._dataController;if(n<0){const o=this._getNewRowPosition(),a=s.pageIndex(),l=this._getInsertAfterOrBeforeKey(t);o!==Rn&&a===0&&!m(l)?n=0:o===Rn&&s.isLastPageLoaded()&&(n=e.length)}return n}processItems(e,t){const{changeType:i}=t;return this.update(i),this.getChanges().forEach((s=>{var o;if(!(s.type===Je))return;let{key:l}=s,d=(o=this._getInternalData(l))===null||o===void 0?void 0:o.insertInfo;(!m(l)||!m(d))&&(d=this._addInsertInfo(s),l=d.key);const c=this._getLoadedRowIndex(e,s),u=this._generateNewItem(l);c>=0&&e.splice(c,0,u)})),e}processDataItem(e,t,i){const n=t.visibleColumns,s=e.data[It]?e.data.key:e.key,o=this.getChanges(),a=y.getIndexByKey(s,o);e.isEditing=!1,a>=0&&this._processDataItemCore(e,o[a],s,n,i)}_processDataItemCore(e,t,i,n,s){const{data:o,type:a}=t;switch(a){case Je:e.isNewRow=!0,e.key=i,e.data=o;break;case Hi:e.modified=!0,e.oldData=e.data,e.data=Xt(e.data,o),e.modifiedValues=s(o,n,!0);break;case ht:e.removed=!0}}_initNewRow(e){if(this.executeAction("onInitNewRow",e),e.promise){const t=new S;return O(_t(e.promise)).done(t.resolve).fail(Vn(t)).fail((i=>this._fireDataErrorOccurred(i))),t}}_createInsertInfo(){const e={};return e[It]=this._getInsertIndex(),e}_addInsertInfo(e,t){var i;let n;e.key=this.getChangeKeyValue(e);const{key:s}=e;if(n=(i=this._getInternalData(s))===null||i===void 0?void 0:i.insertInfo,!m(n)){const o=this._getInsertAfterOrBeforeKey(e);n=this._createInsertInfo(),m(o)||this._setInsertAfterOrBeforeKey(e,t)}return this._addInternalData({insertInfo:n,key:s}),{insertInfo:n,key:s}}getChangeKeyValue(e){if(m(e.key))return e.key;const t=this._dataController.key();let i;return e.data&&t&&!Array.isArray(t)&&(i=e.data[t]),m(i)||(i=gv()),i}_setInsertAfterOrBeforeKey(e,t){const i=this.getView("rowsView"),n=this._dataController,s=n.items(!0),o=this._getNewRowPosition();switch(o){case dl:case Rn:break;case ul:s.length&&(e.insertBeforeKey=s[0].key);break;case cl:s.length&&(e.insertAfterKey=s[s.length-1].key);break;default:{let l=o===hl?i==null?void 0:i.getBottomVisibleItemIndex():i==null?void 0:i.getTopVisibleItemIndex();const d=n.getVisibleRows()[l];d&&(!d.isEditing&&d.rowType==="detail"||d.rowType==="detailAdaptive")&&l++;const c=n.getKeyByRowIndex(l);m(c)&&(e.insertBeforeKey=c)}}}_getInsertIndex(){let e=0;return this.getChanges().forEach((t=>{var i;const n=(i=this._getInternalData(t.key))===null||i===void 0?void 0:i.insertInfo;m(n)&&t.type===Je&&n[It]>e&&(e=n[It])})),e+1}_getInsertAfterOrBeforeKey(e){return e.insertAfterKey??e.insertBeforeKey}_getPageIndexToInsertRow(){const e=this._getNewRowPosition(),t=this._dataController,i=t.pageIndex(),n=t.pageCount()-1;return e===dl&&i!==0?0:e===Rn&&i!==n?n:-1}addRow(e){const t=this._dataController;return t.store()?this._addRow(e):(t.fireError("E1052",this.component.NAME),new S().reject())}_addRow(e){const i=this._dataController.store(),n=i&&i.key(),s={data:{}},o=this._getVisibleEditRowIndex(),a=new S;return this.refresh({allowCancelEditing:!0}),this._allowRowAdding()?(n||(s.data.__KEY__=String(new Te)),O(this._initNewRow(s,e)).done((()=>{this._allowRowAdding()?O(this._addRowCore(s.data,e,o)).done(a.resolve).fail(a.reject):a.reject("cancel")})).fail(a.reject),a.promise()):(O(this._navigateToNewRow(o)).done(a.resolve).fail(a.reject),a.promise())}_allowRowAdding(e){return!(this._getInsertIndex()>1)}_addRowCore(e,t,i){const n={data:e,type:Je},s=this._getVisibleEditRowIndex(),o=this._addInsertInfo(n,t),{key:a}=o;return this._setEditRowKey(a,!0),this._addChange(n),this._navigateToNewRow(i,n,s)}_navigateToNewRow(e,t,i){const n=new S,s=this._dataController;if(i=i??-1,t=t??this.getChanges().filter((c=>c.type===Je))[0],!t)return n.reject("cancel").promise();const o=this._getPageIndexToInsertRow();let a=this._getLoadedRowIndex(s.items(),t,!0);const l=c=>{var u;O((u=this._focusController)===null||u===void 0?void 0:u.navigateToRow(c)).done((()=>{a=s.getRowIndexByKey(t.key),n.resolve()}))},d=this._getInsertAfterOrBeforeKey(t);return o>=0?s.pageIndex(o).done((()=>{l(t.key)})).fail(n.reject):a<0&&m(d)?l(d):(s.updateItems({changeType:"update",rowIndices:[e,i,a]}),a=s.getRowIndexByKey(t.key),a<0?l(t.key):n.resolve()),n.done((()=>{var c;(c=this._rowsView)===null||c===void 0||c.waitAsyncTemplates(!0).done((()=>{this._showAddedRow(a),this._afterInsertRow(t.key)}))})),n.promise()}_showAddedRow(e){this._focusFirstEditableCellInRow(e)}_beforeFocusElementInRow(e){}_focusFirstEditableCellInRow(e){var t;const i=this._dataController,n=i.getKeyByRowIndex(e),s=this.getFirstEditableCellInRow(e);(t=this._keyboardNavigationController)===null||t===void 0||t.focus(s),this.option("focusedRowKey",n),this._editCellInProgress=!0,this._delayedInputFocus(s,(()=>{e=i.getRowIndexByKey(n),this._editCellInProgress=!1,this._beforeFocusElementInRow(e)}))}_isEditingStart(e){return this.executeAction("onEditingStart",e),e.cancel}_beforeUpdateItems(e,t){}_getVisibleEditColumnIndex(){const e=this.option(Qt);return m(e)?this._columnsController.getVisibleColumnIndex(e):-1}_setEditColumnNameByIndex(e,t){var i;const n=this._columnsController.getVisibleColumns();this._setEditColumnName((i=n[e])===null||i===void 0?void 0:i.name,t)}_setEditColumnName(e,t){t?this._silentOption(Qt,e):this.option(Qt,e)}_resetEditColumnName(){this._setEditColumnName(null,!0)}_getEditColumn(){const e=this.option(Qt);return this._getColumnByName(e)}_getColumnByName(e){const t=this._columnsController.getVisibleColumns();let i;return m(e)&&t.some((n=>{if(n.name===e)return i=n,!0})),i}_getVisibleEditRowIndex(e){const t=this._dataController,i=this.option(Le),n=t.getRowIndexByKey(i);return n===-1?n:n+this._getEditRowIndexCorrection(e)}_getEditRowIndexCorrection(e){const t=e?this._getColumnByName(e):this._getEditColumn();return(t==null?void 0:t.visibleWidth)==="adaptiveHidden"?1:0}_resetEditRowKey(){this._refocusEditCell=!1,this._setEditRowKey(null,!0)}_resetEditIndices(){this._resetEditColumnName(),this._resetEditRowKey()}editRow(e){const t=this._dataController,n=t.items()[e],s={data:n&&n.data,cancel:!1},o=this._getVisibleEditRowIndex();if(n){if(e===o)return!0;if(n.key===void 0){this._dataController.fireError("E1043");return}n.isNewRow||(s.key=n.key),!this._isEditingStart(s)&&(this.resetChanges(),this.init(),this._resetEditColumnName(),this._pageIndex=t.pageIndex(),this._addInternalData({key:n.key,oldData:n.oldData??n.data}),this._setEditRowKey(n.key))}}_editRowFromOptionChanged(e,t){const i=[t,e];this._beforeUpdateItems(i,e,t),this._editRowFromOptionChangedCore(i,e)}_editRowFromOptionChangedCore(e,t,i){this._needFocusEditor=!0,this._dataController.updateItems({changeType:"update",rowIndices:e,cancel:i})}_focusEditorIfNeed(){}_showEditPopup(e,t){}_repaintEditPopup(){}_getEditPopupHiddenHandler(){return e=>{this.isEditing()&&this.cancelEditData()}}_getPopupEditFormTemplate(e){}_getSaveButtonConfig(){const e={text:this.option("editing.texts.saveRowChanges"),onClick:this.saveEditData.bind(this)};return st(Se())&&(e.stylingMode="contained",e.type="default"),e}_getCancelButtonConfig(){const e={text:this.option("editing.texts.cancelRowChanges"),onClick:this.cancelEditData.bind(this)};return st(Se())&&(e.stylingMode="outlined"),e}_removeInternalData(e){this._internalState.delete(Ot(e))}_updateInsertAfterOrBeforeKeys(e,t){const i=e[t];e.forEach((n=>{if(n.type===Je){const s=this._getInsertAfterOrBeforeKey(n);ae(s,i.key)&&(n[m(n.insertAfterKey)?"insertAfterKey":"insertBeforeKey"]=this._getInsertAfterOrBeforeKey(i))}}))}_removeChange(e){if(e>=0){const t=[...this.getChanges()],{key:i}=t[e];this._removeInternalData(i),this._updateInsertAfterOrBeforeKeys(t,e),t.splice(e,1),this._silentOption(pt,t),ae(this.option(Le),i)&&this._resetEditIndices()}}executeOperation(e,t){this._lastOperation&&this._lastOperation.reject(),this._lastOperation=e,this.waitForDeferredOperations().done((()=>{e.state()!=="rejected"&&(t(),this._lastOperation=null)})).fail((()=>{e.reject(),this._lastOperation=null}))}waitForDeferredOperations(){return O(...this._deferreds)}_processCanceledEditingCell(){}_repaintEditCell(e,t,i){!e||!e.showEditorAlways||t&&!t.showEditorAlways?(this._editCellInProgress=!0,this._needFocusEditor=!0,this._editorFactoryController.loseFocus(),this._dataController.updateItems({changeType:"update",rowIndices:[i,this._getVisibleEditRowIndex()]})):e!==t&&(this._needFocusEditor=!0,this._dataController.updateItems({changeType:"update",rowIndices:[]}))}_delayedInputFocus(e,t,i){const n=()=>{if(t&&t(),e){const s=e.find(Cr).first();y.focusAndSelectElement(this,s)}this._beforeFocusCallback=null};G.real().ios||G.real().android?n():(this._beforeFocusCallback&&this._beforeFocusCallback(),clearTimeout(this._inputFocusTimeoutID),i&&(this._beforeFocusCallback=t),this._inputFocusTimeoutID=setTimeout(n))}_focusEditingCell(e,t,i){const n=this._getVisibleEditColumnIndex();t=t||this._rowsView&&this._rowsView._getCellElement(this._getVisibleEditRowIndex(),n),t&&this._delayedInputFocus(t,e,i)}deleteRow(e){this._checkAndDeleteRow(e)}_checkAndDeleteRow(e){const t=this.option("editing"),i=t==null?void 0:t.texts,n=t==null?void 0:t.confirmDelete,s=i==null?void 0:i.confirmDeleteMessage,o=this._dataController.items()[e],a=!this.isEditing()||o.isNewRow;if(o&&a)if(!n||!s)this._deleteRowCore(e);else{const l=i&&i.confirmDeleteTitle,d=m(l)&&l.length>0;FC(s,l,d).done((c=>{c&&this._deleteRowCore(e)}))}}_deleteRowCore(e){const i=this._dataController.items()[e],n=i&&i.key,s=this._getVisibleEditRowIndex();this.refresh();const o=this.getChanges(),a=y.getIndexByKey(n,o);return a>=0?o[a].type===Je?this._removeChange(a):this._addChange({key:n,type:ht}):this._addChange({key:n,oldData:i.data,type:ht}),this._afterDeleteRow(e,s)}_afterDeleteRow(e,t){return this.saveEditData()}undeleteRow(e){const t=this._dataController,i=t.items()[e],n=this._getVisibleEditRowIndex(),s=i&&i.key,o=this.getChanges();if(i){const a=y.getIndexByKey(s,o);if(a>=0){const{data:l}=o[a];nt(l)?this._removeChange(a):this._addChange({key:s,type:Hi}),t.updateItems({changeType:"update",rowIndices:[n,e]})}}}_fireOnSaving(){const e={cancel:!1,promise:null,changes:[...this.getChanges()]};this.executeAction("onSaving",e);const t=new S;return O(_t(e.promise)).done((()=>{t.resolve(e)})).fail((i=>{this._fireDataErrorOccurred(i),t.resolve({cancel:!0})})),t}_executeEditingAction(e,t,i){if(this.component._disposed)return null;const n=new S;return this.executeAction(e,t),O(_t(t.cancel)).done((s=>{s?setTimeout((()=>{n.resolve("cancel")})):i(t).done(n.resolve).fail(Vn(n))})).fail(Vn(n)),n}_processChanges(e,t,i,n){const s=this._dataController.store();x(n,((o,a)=>{const l=this._getOldData(a.key),{data:d,type:c}=a,u=T({},a);let p,g;if(!this._beforeSaveEditData(a,o)){switch(c){case ht:g={data:l,key:a.key,cancel:!1},p=this._executeEditingAction("onRowRemoving",g,(()=>s.remove(a.key).done((_=>{i.push({type:"remove",key:_})}))));break;case Je:g={data:d,cancel:!1},p=this._executeEditingAction("onRowInserting",g,(()=>s.insert(g.data).done(((_,f)=>{m(f)&&(u.key=f),_&&L(_)&&_!==g.data&&(u.data=_),i.push({type:"insert",data:_,index:0})}))));break;case Hi:g={newData:d,oldData:l,key:a.key,cancel:!1},p=this._executeEditingAction("onRowUpdating",g,(()=>s.update(a.key,g.newData).done(((_,f)=>{_&&L(_)&&_!==g.newData&&(u.data=_),i.push({type:"update",key:f,data:_})}))))}if(n[o]=u,p){const _=new S;p.always((f=>{t.push({key:a.key,result:f})})).always(_.resolve),e.push(_.promise())}}}))}_processRemoveIfError(e,t){const i=e[t];return(i==null?void 0:i.type)===ht&&t>=0&&e.splice(t,1),!0}_processRemove(e,t,i){const n=e[t];if(!i||!n||n.type===ht)return this._processRemoveCore(e,t,!i||!n)}_processRemoveCore(e,t,i){return t>=0&&e.splice(t,1),!0}_processSaveEditDataResult(e){let t=!1;const i=this.getChanges(),n=[...i],s=n.length;for(let o=0;o<e.length;o++){const a=e[o].result,l=a==="cancel",d=y.getIndexByKey(e[o].key,n),c=n[d];if(a&&a instanceof Error){if(c&&this._addInternalData({key:c.key,error:a}),this._fireDataErrorOccurred(a),this._processRemoveIfError(n,d))break}else if(this._processRemove(n,d,l)){t=!l;const p=y.getIndexByKey(e[o].key,i);this._updateInsertAfterOrBeforeKeys(i,p)}}return n.length<s&&this._silentOption(pt,n),t}_fireSaveEditDataEvents(e){x(e,((t,i)=>{let{data:n,key:s,type:o}=i;const a=this._addInternalData({key:s}),l={key:s,data:n};switch(a.error&&(l.error=a.error),o){case ht:this.executeAction("onRowRemoved",b({},l,{data:a.oldData}));break;case Je:this.executeAction("onRowInserted",l);break;case Hi:this.executeAction("onRowUpdated",l)}})),this.executeAction("onSaved",{changes:e})}saveEditData(){const e=new S;return this.waitForDeferredOperations().done((()=>{if(this.isSaving()){this._resolveAfterSave(e);return}O(this._beforeSaveEditData()).done((t=>{if(t){this._resolveAfterSave(e,{cancel:t});return}this._saving=!0,this._saveEditDataInner().always((()=>{this._saving=!1,this._refocusEditCell&&this._focusEditingCell()})).done(e.resolve).fail(e.reject)})).fail(e.reject)})).fail(e.reject),e.promise()}_resolveAfterSave(e){let{cancel:t,error:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};O(this._afterSaveEditData(t)).done((()=>{e.resolve(i)})).fail(e.reject)}_saveEditDataInner(){const e=new S,t=[],i=[],n=[],s=this._dataController.dataSource();return O(this._fireOnSaving()).done((o=>{let{cancel:a,changes:l}=o;if(a)return e.resolve().promise();if(this._processChanges(i,t,n,l),i.length)return this._refocusEditCell=!0,s==null||s.beginLoading(),O(...i).done((()=>{this._processSaveEditDataResult(t)?this._endSaving(n,l,e):(s==null||s.endLoading(),e.resolve())})).fail((d=>{s==null||s.endLoading(),e.resolve(d)})),e.always((()=>{this._refocusEditCell=!0})).promise();this._cancelSaving(e)})).fail(e.reject),e.promise()}_beforeEndSaving(e){this._resetEditIndices()}_endSaving(e,t,i){const n=this._dataController.dataSource();this._beforeEndSaving(t),n==null||n.endLoading(),this._refreshDataAfterSave(e,t,i)}_cancelSaving(e){this.executeAction("onSaved",{changes:[]}),this._resolveAfterSave(e)}_refreshDataAfterSave(e,t,i){const n=this._dataController,s=this.option("editing.refreshMode"),o=s!=="reshape"&&s!=="repaint";o||n.push(e),O(n.refresh({selection:o,reload:o,load:s==="reshape",changesOnly:this.option("repaintChangesOnly")})).always((()=>{this._fireSaveEditDataEvents(t)})).done((()=>{this._resolveAfterSave(i)})).fail((a=>{this._resolveAfterSave(i,{error:a})}))}isSaving(){return this._saving}_updateEditColumn(){const e=this._isEditColumnVisible(),t=this.option("editing.useIcons"),i=GC+(t?` ${pl}`:"");this._columnsController.addCommandColumn({type:"buttons",command:"edit",visible:e,cssClass:i,width:"auto",alignment:"center",cellTemplate:this._getEditCommandCellTemplate(),fixedPosition:"right"}),this._columnsController.columnOption("command:edit",{visible:e,cssClass:i})}_isEditColumnVisible(){return this.option("editing").allowDeleting}_isEditButtonDisabled(){const e=this.hasChanges();return!(m(this.option("editing.editRowKey"))||e)}_updateEditButtons(){const e=this._isEditButtonDisabled();this._headerPanelView&&(this._headerPanelView.setToolbarItemDisabled("saveButton",e),this._headerPanelView.setToolbarItemDisabled("revertButton",e))}_applyModified(e,t){e&&e.addClass(gl)}_beforeCloseEditCellInBatchMode(e){}cancelEditData(){const e=this.getChanges(),t={cancel:!1,changes:e};this.executeAction("onEditCanceling",t),t.cancel||(this._cancelEditDataCore(),this.executeAction("onEditCanceled",{changes:e}))}_cancelEditDataCore(){const e=this._getVisibleEditRowIndex();this._beforeCancelEditData(),this.init(),this.resetChanges(),this._resetEditColumnName(),this._resetEditRowKey(),this._afterCancelEditData(e)}_afterCancelEditData(e){this._dataController.updateItems({repaintChangesOnly:this.option("repaintChangesOnly")})}_hideEditPopup(){}hasEditData(){return this.hasChanges()}update(e){const t=this._dataController;t&&this._pageIndex!==t.pageIndex()&&(e==="refresh"&&this.refresh({isPageChanged:!0}),this._pageIndex=t.pageIndex()),this._updateEditButtons()}_getRowIndicesForCascadeUpdating(e,t){return t?[]:[e.rowIndex]}addDeferred(e){this._deferreds.includes(e)||(this._deferreds.push(e),e.always((()=>{const t=this._deferreds.indexOf(e);t>=0&&this._deferreds.splice(t,1)})))}_prepareChange(e,t,i){var n;const s={},o=(n=e.row)===null||n===void 0?void 0:n.data,a=e.key,l=new S;return a!==void 0&&(e.value=t,_t(e.column.setCellValue(s,t,b(!0,{},o),i)).done((()=>{l.resolve({data:s,key:a,oldData:o,type:Hi})})).fail(Vn(l)).fail((c=>this._fireDataErrorOccurred(c))),m(i)&&e.column.displayValueMap&&(e.column.displayValueMap[t]=i),this._updateRowValues(e),this.addDeferred(l)),l}_updateRowValues(e){if(e.values){const t=this._dataController,i=t.getRowIndexByKey(e.key),n=t.getVisibleRows()[i];n&&(e.row.values=n.values,e.values=n.values),e.values[e.columnIndex]=e.value}}updateFieldValue(e,t,i,n){const s=e.key,o=new S;return s===void 0&&this._dataController.fireError("E1043"),e.column.setCellValue?this._prepareChange(e,t,i).done((a=>{O(this._applyChange(e,a,n)).always((()=>{o.resolve()}))})):o.resolve(),o.promise()}_focusPreviousEditingCellIfNeed(e){if(this.hasEditData()&&!this.isEditCell(e.rowIndex,e.columnIndex))return this._focusEditingCell(),this._updateEditRow(e.row,!0),!0}_needUpdateRow(e){const t=this._columnsController.getVisibleColumns();e||(e=this._getEditColumn());const i=e&&e.setCellValue!==e.defaultSetCellValue,n=t.some((s=>s.calculateCellValue!==s.defaultCalculateCellValue));return i||n}_applyChange(e,t,i){const n=T({},e,{forceUpdateRow:i});return this._addChange(t,n),this._updateEditButtons(),this._applyChangeCore(e,n.forceUpdateRow)}_applyChangeCore(e,t){const i=e.column.setCellValue!==e.column.defaultSetCellValue,{row:n}=e;n&&(t||i?this._updateEditRow(n,t,i):n.update&&n.update())}_updateEditRowCore(e,t,i){this._dataController.updateItems({changeType:"update",rowIndices:this._getRowIndicesForCascadeUpdating(e,t)})}_updateEditRow(e,t,i){t?this._updateRowImmediately(e,t,i):this._updateRowWithDelay(e,i)}_updateRowImmediately(e,t,i){this._updateEditRowCore(e,!t,i),this._validateEditFormAfterUpdate(e,i),t||this._focusEditingCell()}_updateRowWithDelay(e,t){const i=new S;this.addDeferred(i),setTimeout((()=>{var n;const s=((n=this._editForm)===null||n===void 0?void 0:n.element())||this.component.$element().get(0),o=h(M.getActiveElement(s)),a=this._rowsView.getCellIndex(o,e.rowIndex);let l=o.get(0);const d=y.getSelectionRange(l);if(this._updateEditRowCore(e,!1,t),this._validateEditFormAfterUpdate(e,t),a>=0){const c=this._rowsView._getCellElement(e.rowIndex,a);this._delayedInputFocus(c,(()=>{setTimeout((()=>{var u;l=M.getActiveElement((u=this.component.$element())===null||u===void 0?void 0:u.get(0)),d.selectionStart>=0&&y.setSelectionRange(l,d)}))}))}i.resolve()}))}_validateEditFormAfterUpdate(){}_addChange(e,t){var i;const n=t==null?void 0:t.row,s=[...this.getChanges()];let o=y.getIndexByKey(e.key,s);o<0&&(o=s.length,this._addInternalData({key:e.key,oldData:e.oldData}),delete e.oldData,s.push(e));const a=T({},s[o]);return a&&(e.data&&(a.data=Xt(a.data,e.data)),(!a.type||!e.data)&&e.type&&(a.type=e.type),n&&(n.oldData=this._getOldData(n.key),n.data=Xt(n.data,e.data))),s[o]=a,this._silentOption(pt,s),t&&a!==((i=this.getChanges())===null||i===void 0?void 0:i[o])&&(t.forceUpdateRow=!0),a}_getFormEditItemTemplate(e,t){return t.editCellTemplate||this._getDefaultEditorTemplate()}getColumnTemplate(e){const{column:t}=e,i=e.row&&e.row.rowIndex;let n;const s=this.isRowBasedEditMode(),o=this.isEditRow(i),a=this.isEditCell(i,e.columnIndex);let l;return(t.showEditorAlways||t.setCellValue&&(o&&t.allowEditing||a))&&(e.rowType==="data"||e.rowType==="detailAdaptive")&&!t.command?(((this.allowUpdating(e)||o)&&t.allowEditing||a)&&(o||!s)&&(t.showEditorAlways&&!s&&(l={cancel:!1,key:e.row.isNewRow?void 0:e.row.key,data:e.row.data,column:t},this._isEditingStart(l)),(!l||!l.cancel)&&(e.setValue=(c,u)=>{this.updateFieldValue(e,c,u)})),n=t.editCellTemplate||this._getDefaultEditorTemplate()):t.command==="detail"&&e.rowType==="detail"&&o&&(n=this===null||this===void 0?void 0:this.getEditFormTemplate(e)),n}_createButton(e,t,i,n){let s=QC[t.name];const o=this.option("editing.useIcons"),a=this.option("useLegacyColumnButtonTemplate");let l=h("<a>").attr("href","#").addClass(HC).addClass(t.cssClass);if(t.template&&a)this._rowsView.renderTemplate(e,t.template,i,!0);else{if(t.template)l=h("<span>").addClass(t.cssClass);else if(o&&s||t.icon){s=t.icon||s;const d=Mp(s);d==="image"||d==="svg"?l=Ti(s).addClass(t.cssClass):l.addClass(`dx-icon${d==="dxIcon"?"-":" "}${s}`).attr("title",t.text),l.addClass(WC),e.addClass(pl);const c=this.getButtonLocalizationNames()[t.name];c&&l.attr("aria-label",w.format(c))}else l.text(t.text);m(t.hint)&&l.attr("title",t.hint),this._isButtonDisabled(t,i)?l.addClass("dx-state-disabled"):(!t.template||t.onClick)&&v.on(l,V("click",YC),this.createAction((d=>{var c;(c=t.onClick)===null||c===void 0||c.call(t,b({},d,{row:i.row,column:i.column})),d.event.preventDefault(),d.event.stopPropagation()}))),e.append(l),t.template&&(i.renderAsync=!1,this._rowsView.renderTemplate(l,t.template,i,!0,n))}}getButtonLocalizationNames(){return{edit:"dxDataGrid-editingEditRow",save:"dxDataGrid-editingSaveRowChanges",delete:"dxDataGrid-editingDeleteRow",undelete:"dxDataGrid-editingUndeleteRow",cancel:"dxDataGrid-editingCancelRowChanges"}}prepareButtonItem(e,t,i,n){const s=this.option("editing.texts")??{},o={revert:s.cancelAllChanges,save:s.saveAllChanges,addRow:s.addRow},a={revert:"cancel",save:"save",addRow:"addrow"}[t],l=o[t],d=(a==="save"||a==="cancel")&&this._isEditButtonDisabled();return{widget:"dxButton",options:{onInitialized:c=>{h(c.element).addClass(e._getToolbarButtonClass(`${KC} ${this.addWidgetPrefix(a)}-button`))},icon:`edit-button-${a}`,disabled:d,onClick:()=>{setTimeout((()=>{this[i]()}))},text:l,hint:l},showText:"inMenu",name:`${t}Button`,location:"after",locateInMenu:"auto",sortIndex:n}}prepareEditButtons(e){const t=this.option("editing")??{},i=[];return t.allowAdding&&i.push(this.prepareButtonItem(e,"addRow","addRow",20)),i}highlightDataCell(e,t){this.shouldHighlightCell(t)&&e.addClass(gl)}_afterInsertRow(e){}_beforeSaveEditData(e){if(e&&!m(e.key)&&m(e.type))return!0}_afterSaveEditData(){}_beforeCancelEditData(){}_allowEditAction(e,t){let i=this.option(`editing.${e}`);return B(i)&&(i=i({component:this.component,row:t.row})),i}allowUpdating(e,t){const i=this.option("editing.startEditAction")??XC;return(arguments.length>1?i===t||t==="down":!0)&&this._allowEditAction("allowUpdating",e)}allowDeleting(e){return this._allowEditAction("allowDeleting",e)}isCellModified(e){var t,i;const{columnIndex:n}=e;let s=e==null||(t=e.row)===null||t===void 0||(t=t.modifiedValues)===null||t===void 0?void 0:t[n];return e!=null&&(i=e.row)!==null&&i!==void 0&&i.isNewRow&&(s=e.value),s!==void 0}isNewRowInEditMode(){const e=this._getVisibleEditRowIndex(),t=this._dataController.items();return e>=0?t[e].isNewRow:!1}_isRowDeleteAllowed(){}_prepareEditCell(e){return!1}shouldHighlightCell(e){return this.isCellModified(e)&&e.column.setCellValue&&(this.getEditMode()!==Qi||!e.row.isEditing)}}const vv=r=>class extends r{reload(e,t){return!t&&this._editingController.refresh(),super.reload.apply(this,arguments)}repaintRows(){if(!this._editingController.isSaving())return super.repaintRows.apply(this,arguments)}_updateEditRow(e){const t=this.option(Le),i=y.getIndexByKey(t,e),n=e[i];if(n){var s;n.isEditing=!0,(s=this._updateEditItem)===null||s===void 0||s.call(this,n)}}_updateItemsCore(e){super._updateItemsCore(e),this._updateEditRow(this.items(!0))}_applyChangeUpdate(e){this._updateEditRow(e.items),super._applyChangeUpdate(e)}_applyChangesOnly(e){this._updateEditRow(e.items),super._applyChangesOnly(e)}_processItems(e,t){return e=this._editingController.processItems(e,t),super._processItems(e,t)}_processDataItem(e,t){return this._editingController.processDataItem(e,t,this.generateDataValues),super._processDataItem(e,t)}_processItem(e,t){return e=super._processItem(e,t),e.isNewRow&&(t.dataIndex--,delete e.dataIndex),e}_getChangedColumnIndices(e,t,i,n){if(!(e.isNewRow!==t.isNewRow||e.removed!==t.removed))return super._getChangedColumnIndices.apply(this,arguments)}_isCellChanged(e,t,i,n,s){const o=e.cells&&e.cells[n],a=this._editingController&&this._editingController.isEditCell(i,n);return s&&a?!1:o&&o.column&&!o.column.showEditorAlways&&o.isEditing!==a?!0:super._isCellChanged.apply(this,arguments)}needToRefreshOnDataSourceChange(e){return!(Array.isArray(e.value)&&e.value===e.previousValue&&this._editingController.isSaving())}_handleDataSourceChange(e){const t=super._handleDataSourceChange(e),i=this.option("editing.changes"),n=e.value;if(Array.isArray(n)&&i.length){const s=n.map((d=>this.keyOf(d))),o=i.filter((d=>d.type==="insert"||s.some((c=>ae(d.key,c)))));o.length!==i.length&&this.option("editing.changes",o);const a=this.option("editing.editRowKey");!o.some((d=>d.type==="insert"&&ae(a,d.key)))&&s.every((d=>!ae(a,d)))&&this.option("editing.editRowKey",null)}return t}},xv=r=>class extends r{getCellIndex(e,t){if(!e.is("td")&&t>=0){const i=this.getCellElements(t);let n=-1;return x(i,((s,o)=>{h(o).find(e).length&&(n=s)})),n}return super.getCellIndex.apply(this,arguments)}publicMethods(){return super.publicMethods().concat(["cellValue"])}_getCellTemplate(e){return this._editingController.getColumnTemplate(e)||super._getCellTemplate(e)}_createRow(e){const t=super._createRow.apply(this,arguments);if(e){const i=!!e.removed,n=!!e.isNewRow,s=!!e.modified;n&&t.addClass(UC),s&&t.addClass(qC),(n||i)&&t.removeClass(zC)}return t}_getColumnIndexByElement(e){let t=e.closest("table");const i=this.getTableElements();for(;t.length&&!i.filter(t).length;)e=t.closest("td"),t=e.closest("table");return this._getColumnIndexByElementCore(e)}_getColumnIndexByElementCore(e){const t=e.closest(`.${Tt}> td:not(.dx-master-detail-cell)`);return this.getCellIndex(t)}_editCellByClick(e,t){const i=this._editingController,n=h(e.event.target),s=this._getColumnIndexByElement(n),o=this._dataController.items()[e.rowIndex],a=i.allowUpdating({row:o},t)||o&&o.isNewRow,l=this._columnsController.getVisibleColumns()[s],d=i.isEditCell(e.rowIndex,s),c=a&&l&&(l.allowEditing||d),u=this.option("editing.startEditAction")||"click",p=l&&l.showEditorAlways;if(d)return!0;if(t==="down")return(G.real().ios||G.real().android)&&Id.resetActiveElement(),p&&c&&i.editCell(e.rowIndex,s);if(t==="click"&&u==="dblClick"&&this._pointerDownTarget===n.get(0)){const _=o==null?void 0:o.isNewRow;i.closeEditCell(!1,_)}if(c&&t===u)return i.editCell(e.rowIndex,s)||i.isEditRow(e.rowIndex)}_rowPointerDown(e){this._pointerDownTarget=e.event.target,this._pointerDownTimeout=setTimeout((()=>{this._editCellByClick(e,"down")}))}_rowClickTreeListHack(e){super._rowClick.apply(this,arguments)}_rowClick(e){const t=h(e.rowElement).hasClass(this.addWidgetPrefix(_r));e.event[Xc]=this.component,!this._editCellByClick(e,"click")&&!t&&super._rowClick.apply(this,arguments)}_rowDblClickTreeListHack(e){super._rowDblClick.apply(this,arguments)}_rowDblClick(e){this._editCellByClick(e,"dblClick")||super._rowDblClick.apply(this,arguments)}_cellPrepared(e,t){var i;const n=this._editingController,s=!!t.column.command,o=t.setValue,a=n.isEditRow(t.rowIndex),l=Jc(a,t);if(_l(a,t)){const{alignment:c}=t.column;e.toggleClass(this.addWidgetPrefix($C),!o).toggleClass(jC,!o),c&&e.find(fr).first().css("textAlign",c)}l&&this._editCellPrepared(e);const d=!!((i=t.column)!==null&&i!==void 0&&i.cellTemplate);t.column&&!s&&(!d||n.shouldHighlightCell(t))&&n.highlightDataCell(e,t),super._cellPrepared.apply(this,arguments)}_getCellOptions(e){const t=super._getCellOptions(e),{columnIndex:i,row:n}=e;return t.isEditing=this._editingController.isEditCell(t.rowIndex,t.columnIndex),t.removed=n.removed,n.modified&&(t.modified=n.modifiedValues[i]!==void 0),t}_setCellAriaAttributes(e,t,i){super._setCellAriaAttributes(e,t,i),t.removed&&this.setAria("roledescription",w.format("dxDataGrid-ariaDeletedCell"),e),t.modified&&this.setAria("roledescription",w.format("dxDataGrid-ariaModifiedCell"),e),t.column.allowEditing&&!t.removed&&!t.modified&&t.rowType==="data"&&t.column.calculateCellValue===t.column.defaultCalculateCellValue&&this._editingController.isCellBasedEditMode()&&this.setAria("roledescription",w.format("dxDataGrid-ariaEditableCell"),e)}_createCell(e){const t=super._createCell(e),i=this._editingController.isEditRow(e.rowIndex);return _l(i,e)&&t.addClass(Ss),t}cellValue(e,t,i,n){const s=this.getCellOptions(e,t);if(s){if(i===void 0)return s.value;this._editingController.updateFieldValue(s,i,n,!0)}}dispose(){super.dispose.apply(this,arguments),clearTimeout(this._pointerDownTimeout)}_renderCore(){return super._renderCore.apply(this,arguments),this.waitAsyncTemplates(!0).done((()=>{this._editingController._focusEditorIfNeed()}))}_editCellPrepared(){}_formItemPrepared(){}},wv=r=>class extends r{optionChanged(e){const{fullName:t}=e;switch(e.name){case"editing":{t&&![Kn,pt,Qt,Le].some((s=>s===t))&&this._invalidate(),super.optionChanged(e);break}case"useLegacyColumnButtonTemplate":e.handled=!0;break;default:super.optionChanged(e)}}_getToolbarItems(){const e=super._getToolbarItems();return this._editingController.prepareEditButtons(this).concat(e)}},LS={defaultOptions:()=>({editing:{mode:"row",refreshMode:"full",newRowPosition:Zc,allowAdding:!1,allowUpdating:!1,allowDeleting:!1,useIcons:!1,selectTextOnEditStart:!1,confirmDelete:!0,texts:{editRow:w.format("dxDataGrid-editingEditRow"),saveAllChanges:w.format("dxDataGrid-editingSaveAllChanges"),saveRowChanges:w.format("dxDataGrid-editingSaveRowChanges"),cancelAllChanges:w.format("dxDataGrid-editingCancelAllChanges"),cancelRowChanges:w.format("dxDataGrid-editingCancelRowChanges"),addRow:w.format("dxDataGrid-editingAddRow"),deleteRow:w.format("dxDataGrid-editingDeleteRow"),undeleteRow:w.format("dxDataGrid-editingUndeleteRow"),confirmDeleteMessage:w.format("dxDataGrid-editingConfirmDeleteMessage"),confirmDeleteTitle:""},form:{colCount:2},popup:{},startEditAction:"click",editRowKey:null,editColumnName:null,changes:[]},useLegacyColumnButtonTemplate:!1}),controllers:{editing:Cv},extenders:{controllers:{data:vv},views:{rowsView:xv,headerPanel:wv}}},bv=r=>class extends r{isRowEditMode(){return this.getEditMode()===Qi}_afterCancelEditData(e){const t=this._dataController;this.isRowBasedEditMode()&&e>=0?t.updateItems({changeType:"update",rowIndices:[e,e+1]}):super._afterCancelEditData(e)}_isDefaultButtonVisible(e,t){const i=this.isRowBasedEditMode(),s=!this.isPopupEditMode()&&t.row&&ae(t.row.key,this.option(Le));if(i)switch(e.name){case"edit":return!s&&this.allowUpdating(t);case"delete":return super._isDefaultButtonVisible(e,t)&&!s;case"save":case"cancel":return s;default:return super._isDefaultButtonVisible(e,t)}return super._isDefaultButtonVisible(e,t)}isEditRow(e){return this.isRowBasedEditMode()&&this.isEditRowByIndex(e)}_cancelSaving(e){this.isRowBasedEditMode()&&(this.hasChanges()||this._cancelEditDataCore()),super._cancelSaving(e)}_refreshCore(e){const{allowCancelEditing:t}=e??{};if(this.isRowBasedEditMode()){const i=this.getChanges().filter((n=>n.type==="update")).length>0;this.init(),t&&i&&this._cancelEditDataCore()}super._refreshCore(e)}_isEditColumnVisible(){const e=super._isEditColumnVisible(),t=this.option("editing"),i=this.isRowEditMode(),n=t.allowUpdating||t.allowAdding;return e||i&&n}_focusEditorIfNeed(){const e=this.getEditMode();if(this._needFocusEditor){if(LC.includes(e)){const t=this.getFocusedCellInRow(this._getVisibleEditRowIndex());this._delayedInputFocus(t,(()=>{t&&this.component.focus(t)}))}this._needFocusEditor=!1}}},yv=r=>class extends r{_getChangedColumnIndices(e,t,i,n){if(!(this._editingController.isRowBasedEditMode()&&e.isEditing!==t.isEditing))return super._getChangedColumnIndices.apply(this,arguments)}},Iv=r=>class extends r{_createRow(e){const t=super._createRow.apply(this,arguments);return e&&this._editingController.isEditRow(e.rowIndex)&&(t.addClass(ml),t.removeClass(ll),e.rowType==="detail"&&t.addClass(this.addWidgetPrefix(_r))),t}_update(e){super._update(e),e.changeType==="updateSelection"&&this.getTableElements().children("tbody").children(`.${ml}`).removeClass(ll)}},$S={extenders:{controllers:{editing:bv,data:yv},views:{rowsView:Iv}}},Sv="dx-validationsummary-item",Ev="dx-validationsummary-item-data";class xr extends nr{_getDefaultOptions(){return T({},super._getDefaultOptions(),{focusStateEnabled:!1,noDataText:null})}_setOptionsByReference(){super._setOptionsByReference(),b(this._optionsByReference,{validationGroup:!0})}_init(){super._init(),this._initGroupRegistration()}_initGroupRegistration(){const e=this.$element(),{validationGroup:t}=this.option(),i=t||he.findGroup(e,this._modelByElement(e)),n=he.addGroup(i,!0);this._unsubscribeGroup(),this._groupWasInit=!0,this._validationGroup=i,this.groupSubscription=this._groupValidationHandler.bind(this),n.on("validated",this.groupSubscription)}_unsubscribeGroup(){const e=he.getGroupConfig(this._validationGroup);e==null||e.off("validated",this.groupSubscription)}_getOrderedItems(e,t){let i=[];return x(e,((n,s)=>{const o=bi(t,(a=>{if(a.validator===s)return!0}));o.length&&(i=i.concat(o))})),i}_groupValidationHandler(e){const t=this._getOrderedItems(e.validators,wt(e.brokenRules,(i=>({text:i.message,validator:i.validator,index:i.index}))));this.validators=e.validators,x(this.validators,((i,n)=>{if(n._validationSummary!==this){let s=this._itemValidationHandler.bind(this);const o=function(){n.off("validated",s),n._validationSummary=null,s=null};n.on("validated",s),n.on("disposing",o),n._validationSummary=this}})),this.option("items",t)}_itemValidationHandler(e){let{isValid:t,validator:i,brokenRules:n}=e,{items:s}=this.option(),o=!1,a=0;for(;a<s.length;){const l=s[a];if(l.validator===i){const d=bi(n||[],(c=>c.index===l.index))[0];if(t||!d){s.splice(a,1),o=!0;continue}d.message!==l.text&&(l.text=d.message,o=!0)}a++}x(n,((l,d)=>{bi(s,(u=>u.validator===i&&u.index===d.index))[0]||(s.push({text:d.message,validator:i,index:d.index}),o=!0)})),o&&(s=this._getOrderedItems(this.validators,s),this.option("items",s))}_initMarkup(){this.$element().addClass("dx-validationsummary"),super._initMarkup()}_optionChanged(e){e.name==="validationGroup"?this._initGroupRegistration():super._optionChanged(e)}_itemClass(){return Sv}_itemDataKey(){return Ev}_postprocessRenderItem(e){v.on(e.itemElement,"click",(()=>{var t,i;(t=e.itemData.validator)===null||t===void 0||(i=t.focus)===null||i===void 0||i.call(t)}))}_dispose(){super._dispose(),this._unsubscribeGroup()}refreshValidationGroup(){this._initGroupRegistration()}}_e("dxValidationSummary",xr);class Tv extends Dt.inherit({}){ctor(e,t){this.editor=e,this.validator=t,this.validationRequestsCallbacks=[];const i=n=>{this.validationRequestsCallbacks.forEach((s=>s(n)))};e.validationRequest.add(i),e.on("disposing",(()=>{e.validationRequest.remove(i)}))}getValue(){return this.editor.option("value")}getCurrentValidationError(){return this.editor.option("validationError")}bypass(){return this.editor.option("disabled")}applyValidationResults(e){this.editor.option({validationErrors:e.brokenRules,validationStatus:e.status})}reset(){this.editor.clear()}focus(){this.editor.focus()}}class Es extends ps{_initOptions(e){super._initOptions.apply(this,arguments),this.option(he.initValidationOptions(e))}_getDefaultOptions(){return T({},super._getDefaultOptions(),{validationRules:[]})}_init(){super._init(),this._initGroupRegistration(),this.focused=$e(),this._initAdapter(),this._validationInfo={result:null,deferred:null,skipValidation:!1}}_initGroupRegistration(){const e=this._findGroup();this._groupWasInit||this.on("disposing",(t=>{he.removeRegisteredValidator(t.component._validationGroup,t.component)})),(!this._groupWasInit||this._validationGroup!==e)&&(he.removeRegisteredValidator(this._validationGroup,this),this._groupWasInit=!0,this._validationGroup=e,he.registerValidatorInGroup(e,this))}_setOptionsByReference(){super._setOptionsByReference(),b(this._optionsByReference,{validationGroup:!0})}_getEditor(){const e=this.$element()[0];return us(e,"dx-validation-target")}_initAdapter(){const e=this._getEditor();let{adapter:t}=this.option();if(!t){if(e){var i;t=new Tv(e,this),(i=t)===null||i===void 0||(i=i.validationRequestsCallbacks)===null||i===void 0||i.push((s=>{var o;(o=this._validationInfo)!==null&&o!==void 0&&o.skipValidation||this.validate(s)})),this.option("adapter",t);return}throw se.Error("E0120")}const n=t.validationRequestsCallbacks;n&&n.push((s=>{this.validate(s)}))}_toggleRTLDirection(e){var t;const{adapter:i}=this.option(),n=(i==null||(t=i.editor)===null||t===void 0?void 0:t.option("rtlEnabled"))??e;super._toggleRTLDirection(n)}_initMarkup(){this.$element().addClass("dx-validator"),super._initMarkup()}_render(){super._render(),this._toggleAccessibilityAttributes()}_toggleAccessibilityAttributes(){const e=this._getEditor();if(e){const i=(this.option("validationRules")||[]).some((n=>{let{type:s}=n;return s==="required"}))||null;e.isInitialized()&&e.setAria("required",i),e.option("_onMarkupRendered",(()=>{e.setAria("required",i)}))}}_visibilityChanged(e){e&&this._initGroupRegistration()}_optionChanged(e){switch(e.name){case"validationGroup":this._initGroupRegistration();return;case"validationRules":this._resetValidationRules(),this._toggleAccessibilityAttributes(),this.option("isValid")!==void 0&&this.validate();return;case"adapter":this._initAdapter();break;case"isValid":case"validationStatus":this.option(he.synchronizeValidationOptions(e,this.option()));break;default:super._optionChanged(e)}}_getValidationRules(){return this._validationRules||(this._validationRules=wt(this.option("validationRules"),((e,t)=>b({},e,{validator:this,index:t})))),this._validationRules}_findGroup(){const e=this.$element(),{validationGroup:t}=this.option();return t||he.findGroup(e,this._modelByElement(e))}_resetValidationRules(){delete this._validationRules}validate(e){var t,i,n,s,o;const{adapter:a,name:l}=this.option(),d=a==null||(t=a.bypass)===null||t===void 0?void 0:t.call(a),c=e&&e.value!==void 0?e.value:a==null||(i=a.getValue)===null||i===void 0?void 0:i.call(a),u=a==null||(n=a.getCurrentValidationError)===null||n===void 0?void 0:n.call(a),p=this._getValidationRules(),g=(s=this._validationInfo)===null||s===void 0?void 0:s.result;if(g&&g.status==="pending"&&g.value===c)return b({},g);let _;return d?_={isValid:!0,status:"valid"}:u!=null&&u.editorSpecific?(u.validator=this,_={isValid:!1,status:"invalid",brokenRule:u,brokenRules:[u]}):_=he.validate(c,p,l),_.id=new Te().toString(),this._applyValidationResult(_,a),(o=_.complete)===null||o===void 0||o.then((f=>{f.id===this._validationInfo.result.id&&this._applyValidationResult(f,a)})),b({},this._validationInfo.result)}reset(){const{adapter:e}=this.option(),t={id:null,isValid:!0,brokenRule:null,brokenRules:null,pendingRules:null,status:"valid",complete:null};this._validationInfo.skipValidation=!0,e.reset(),this._validationInfo.skipValidation=!1,this._resetValidationRules(),this._applyValidationResult(t,e)}_updateValidationResult(e){if(!this._validationInfo.result||this._validationInfo.result.id!==e.id){const t=this._validationInfo.deferred&&this._validationInfo.result.complete;this._validationInfo.result=b({},e,{complete:t})}else for(const t in e)t!=="id"&&t!=="complete"&&(this._validationInfo.result[t]=e[t])}_applyValidationResult(e,t){const i=this._createActionByOption("onValidated",{excludeValidators:["readOnly"]});if(e.validator=this,this._updateValidationResult(e),t.applyValidationResults&&t.applyValidationResults(this._validationInfo.result),this.option({validationStatus:this._validationInfo.result.status}),this._validationInfo.result.status==="pending"){this._validationInfo.deferred||(this._validationInfo.deferred=S(),this._validationInfo.result.complete=this._validationInfo.deferred.promise()),this._eventsStrategy.fireEvent("validating",[this._validationInfo.result]);return}this._validationInfo.result.status!=="pending"&&(i(e),this._validationInfo.deferred&&(this._validationInfo.deferred.resolve(e),this._validationInfo.deferred=null))}focus(){const{adapter:e}=this.option();e&&e.focus&&e.focus()}_useTemplates(){return!1}}_e("dxValidator",Es);class Dv extends ps{_getDefaultOptions(){return super._getDefaultOptions()}_init(){super._init(),he.addGroup(this,!1)}_initMarkup(){const e=this.$element();e.addClass("dx-validationgroup"),e.find(".dx-validator").each(((t,i)=>{Es.getInstance(h(i))._initGroupRegistration()})),e.find(".dx-validationsummary").each(((t,i)=>{xr.getInstance(h(i)).refreshValidationGroup()})),super._initMarkup()}validate(){return he.validateGroup(this)}reset(){return he.resetGroup(this)}_dispose(){he.removeGroup(this),this.$element().removeClass("dx-validationgroup"),super._dispose()}_useTemplates(){return!1}}_e("dxValidationGroup",Dv);const Rv="dx-form",to="dx-form-group",Vv="dx-form-group-caption",Ov="dx-form-group-custom-caption",fl="dx-col-",iu="dx-field-item",Cl="dx-layout-manager-one-col",nu="dx-field-item-label-content",Fv="dx-layout-manager",su="dx-field-item-label",No="dx-field-item-content",Av="dx-single-column-item-content",ou="dx-root-simple-item",Pv="dx-form-group-content",kv="dx-field-item-has-group",Mv="dx-field-item-has-tabs",Bv="dx-form-group-with-caption",vl="dx-field-item-tab",xl="dx-group-colcount-",wl="group-col-count",Nv="dx-form-validation-summary",Lv="dx-form-styling-mode-underlined",Lo="simple",$v=["dxTagBox","dxRangeSlider","dxDateRangeBox"],Hv=["dxRangeSlider","dxDateRangeBox"],Wv=["dxRangeSlider","dxSlider"],zv=["dxCalendar","dxCheckBox","dxHtmlEditor","dxRadioGroup","dxRangeSlider","dxSlider","dxSwitch"],Kv=["dxSelectBox","dxDropDownBox","dxTagBox","dxLookup","dxAutocomplete","dxColorBox","dxDateBox","dxDateRangeBox"];function Gv(r){return r==null?void 0:r.some((e=>e.type==="required"))}function Uv(r,e){let{showRequiredMark:t,requiredMark:i,showOptionalMark:n,optionalMark:s}=r;return{showRequiredMark:t&&e,requiredMark:i,showOptionalMark:n&&!e,optionalMark:s}}function qv(r){let{item:e,id:t,isRequired:i,managerMarkOptions:n,showColonAfterLabel:s,labelLocation:o,labelTemplate:a,formLabelMode:l,onLabelTemplateRendered:d}=r;const c=zv.includes(e.editorType),u=b({showColon:s,location:o,id:t,visible:l==="outside"||c&&l!=="hidden",isRequired:i},e?e.label:{},{markOptions:Uv(n,i),labelTemplate:a,onLabelTemplateRendered:d});return["dxRadioGroup","dxCheckBox","dxLookup","dxSlider","dxRangeSlider","dxSwitch","dxHtmlEditor","dxDateRangeBox"].includes(e.editorType)&&(u.labelID=`dx-label-${new Te}`),!u.text&&e.dataField&&(u.text=rn(e.dataField)),u.text&&(u.textWithoutColon=u.text,u.text+=u.showColon?":":""),u}function Yv(r,e,t){return Kv.includes(e)?{onPopupInitialized:n=>{let{component:s,popup:o}=n;const{openOnFieldClick:a}=s.option(),{hideOnOutsideClick:l}=o.option();if(a&&B(l)){const d=c=>{const u=h(c.target),p=r.find(`label[for="${t}"]`);return!!!u.closest(p).length&&l(c)};s.option("dropDownOptions",{hideOnOutsideClick:d}),o.option({hideOnOutsideClick:d})}}}:{}}function jv(r){let{$parent:e,editorType:t,defaultEditorName:i,editorValue:n,canAssignUndefinedValueToEditor:s,externalEditorOptions:o,editorInputId:a,editorValidationBoundary:l,editorStylingMode:d,formLabelMode:c,labelText:u,labelMark:p}=r;const g={};(n!==void 0||s)&&(g.value=n),$v.includes(t)&&(g.value=g.value||[]);let _=o==null?void 0:o.labelMode;m(_)||(_=c==="outside"?"hidden":c);const f=(o==null?void 0:o.stylingMode)||d,C=Wv.includes(t),I=Yv(e,t,a),E=b(!0,g,o,I,{inputAttr:{id:a},validationBoundary:l,stylingMode:f,label:C?o==null?void 0:o.label:u,labelMode:_,labelMark:p});if(o&&(E.dataSource&&(E.dataSource=o.dataSource),E.items&&(E.items=o.items)),i){if(Hv.includes(t))return t==="dxRangeSlider"&&(E.startName||(E.startName=`${i}Start`),E.endName||(E.endName=`${i}End`)),t==="dxDateRangeBox"&&(E.startDateName||(E.startDateName=`${i}Start`),E.endDateName||(E.endDateName=`${i}End`)),E;E.name||(E.name=i)}return E}function Xv(r){let{$parent:e,rootElementCssClassList:t,formOrLayoutManager:i,createComponentCallback:n,item:s,template:o,labelTemplate:a,name:l,formLabelLocation:d,requiredMessageTemplate:c,validationGroup:u,editorValue:p,canAssignUndefinedValueToEditor:g,editorValidationBoundary:_,editorStylingMode:f,showColonAfterLabel:C,managerLabelLocation:I,itemId:E,managerMarkOptions:D,labelMode:k,onLabelTemplateRendered:A}=r;const F=m(s.isRequired)?s.isRequired:!!Gv(s.validationRules),z=s.itemType===Lo,ee=s.helpText?`dx-${new Te}`:null,q=qv({item:s,id:E,isRequired:F,managerMarkOptions:D,showColonAfterLabel:C,labelLocation:I,formLabelMode:k,labelTemplate:a,onLabelTemplateRendered:A}),ce=!!q.visible&&!!(q.text||q.labelTemplate&&z),{location:ue,labelID:te}=q,be=ue!=="top"&&["dxTextArea","dxRadioGroup","dxCalendar","dxHtmlEditor"].includes(s.editorType??""),Ge=jv({$parent:e,editorType:s.editorType,editorValue:p,defaultEditorName:s.dataField,canAssignUndefinedValueToEditor:g,externalEditorOptions:s.editorOptions,editorInputId:E,editorValidationBoundary:_,editorStylingMode:f,formLabelMode:k,labelText:q.textWithoutColon,labelMark:q.markOptions.showRequiredMark?"Â "+q.markOptions.requiredMark:""}),ai=q.markOptions.showOptionalMark&&!q.visible&&Ge.labelMode!=="hidden"&&!m(s.helpText)?q.markOptions.optionalMark:s.helpText;return{$parent:e,rootElementCssClassList:t,formOrLayoutManager:i,createComponentCallback:n,labelOptions:q,labelNeedBaselineAlign:be,labelLocation:ue,needRenderLabel:ce,item:s,isSimpleItem:z,isRequired:F,template:o,helpID:ee,labelID:te,name:l,helpText:ai,formLabelLocation:d,requiredMessageTemplate:c,validationGroup:u,editorOptions:Ge}}function Zv(r){let{showRequiredMark:e,requiredMark:t,showOptionalMark:i,optionalMark:n}=r;return!e&&!i?"":"Â "+(e?t:n)}function Qv(r){const e=Zv(r);if(e==="")return h();const t=r.showRequiredMark?"dx-field-item-required-mark":"dx-field-item-optional-mark";return h("<span>").addClass(t).text(e)}function Jv(r){let{text:e,id:t,location:i,alignment:n,labelID:s=null,markOptions:o={},labelTemplate:a,labelTemplateData:l,onLabelTemplateRendered:d}=r;if((!m(e)||e.length<=0)&&!m(a))return null;const c=h("<label>").addClass(`${su} dx-field-item-label-location-${i}`).attr("for",t).attr("id",s).css("textAlign",n),u=h("<span>").addClass(nu);let p=h("<span>").addClass("dx-field-item-label-text");return p.text(e),a&&(p=h("<div>").addClass("dx-field-item-custom-label-content"),l.text=e,a.render({container:$(p),model:l,onRendered(){d==null||d()}})),c.append(u.append(p).append(Qv(o)))}function ex(r){let e=0;const t=r.children.length;for(let i=0;i<t;i+=1){const n=r.children[i];e+=n.offsetWidth}return e}function tx(r,e){const t=`${e} > .${su}:not(.dx-field-item-label-location-top) > .${nu}`,i=r.find(t),n=i.length;let s=0,o=0;for(let a=0;a<n;a+=1)s=ex(i[a]),s>o&&(o=s);for(let a=0;a<n;a+=1)i[a].style.width=`${o}px`}class oi{constructor(e){this._options=e,this._itemsRunTimeInfo=this._options.itemsRunTimeInfo}findInstance(){return this._itemsRunTimeInfo.findWidgetInstanceByItem(this._options.item)}findItemContainer(){return this._itemsRunTimeInfo.findItemContainerByItem(this._options.item)}findPreparedItem(){return this._itemsRunTimeInfo.findPreparedItemByItem(this._options.item)}tryExecute(){Dt.abstract()}}const $o=(r,e)=>`${e?"tabs":"items"}[${r}]`,ru=(r,e)=>m(r)&&m(e)?`${r}.${e}`:r||e,Ho=r=>r?r.replace(/\s/g,""):void 0,ix=(r,e)=>r?r.dataField===e||r.name===e||Ho(r.title)===e||r.itemType==="group"&&Ho(r.caption)===e:!1,Yi=(r,e)=>`${r}.${e}`,bl=r=>{const e=r.split(".");return e[e.length-1].replace(/\[\d+]/,"")},au=r=>r.includes("tabs"),nx=r=>{const e=r.split("."),t=[...e];for(let i=e.length-1;i>=0;i-=1){if(au(e[i]))return t.join(".");t.splice(i,1)}return""},lu=(r,e,t)=>{if(!e)return"";const i=r.indexOf(e);if(i>-1)return $o(i,t);for(let n=0;n<r.length;n+=1){const s=r[n],o=s.tabs??s.items;if(o){const a=lu(o,e,!!s.tabs);if(a)return ru($o(n,t),a)??""}}return""};function sx(r){let{form:e,$formElement:t,formOptions:i,items:n,validationGroup:s,extendedLayoutManagerOptions:o,onFieldDataChanged:a,onContentReady:l,onDisposing:d,onFieldItemRendered:c}=r;const u={form:e,items:n,$formElement:t,validationGroup:s,onFieldDataChanged:a,onContentReady:l,onDisposing:d,onFieldItemRendered:c,validationBoundary:i.scrollingEnabled?t:void 0,scrollingEnabled:i.scrollingEnabled,showRequiredMark:i.showRequiredMark,showOptionalMark:i.showOptionalMark,requiredMark:i.requiredMark,optionalMark:i.optionalMark,requiredMessage:i.requiredMessage,screenByWidth:i.screenByWidth,layoutData:i.formData,labelLocation:i.labelLocation,customizeItem:i.customizeItem,minColWidth:i.minColWidth,showColonAfterLabel:i.showColonAfterLabel,onEditorEnterKey:i.onEditorEnterKey,labelMode:i.labelMode};return b(u,{isRoot:o.isRoot,colCount:o.colCount,alignItemLabels:o.alignItemLabels,cssItemClass:o.cssItemClass,colCountByScreen:o.colCountByScreen,onLayoutChanged:o.onLayoutChanged,width:o.width})}class ox extends oi{tryExecute(){const{value:e}=this._options,t=this.findInstance();return t?(t.option(e),!0):!1}}class yl extends oi{tryExecute(){const e=this.findInstance();if(e){const{optionName:t,item:i,value:n}=this._options,s=this._itemsRunTimeInfo.findItemIndexByItem(i)??-1;if(s>=0)return e.option(Yi(`items[${s}]`,t),n),!0}return!1}}class rx extends oi{tryExecute(){return!1}}class ax extends oi{tryExecute(){const e=this.findPreparedItem();return e!=null&&e._prepareGroupItemTemplate&&e._renderGroupContentTemplate?(e._prepareGroupItemTemplate(this._options.item.template),e._renderGroupContentTemplate(),!0):!1}}class lx extends oi{tryExecute(){const e=this.findInstance();if(e){const{value:t}=this._options;return e.option("dataSource",t),!0}return!1}}class dx extends oi{tryExecute(){const{item:e}=this._options,t=this.findInstance(),i=t&&us(t.$element()[0],"dxValidator");if(i&&e){const n=a=>a.type==="required",s=(i.option("validationRules")||[]).some(n),o=(e.validationRules??[]).some(n);if(s===o)return i.option("validationRules",e.validationRules),!0}return!1}}class cx extends oi{tryExecute(){const e=this.findItemContainer();if(e.length){const{previousValue:t="",value:i=""}=this._options;return e.removeClass(t).addClass(i),!0}return!1}}const ux=(r,e)=>{switch(r){case"editorOptions":case"buttonOptions":return new ox(e);case"validationRules":return new dx(e);case"cssClass":return new cx(e);case"badge":case"disabled":case"icon":case"tabTemplate":case"title":return e.optionName=r,new yl(e);case"tabs":return new lx(e);case"template":{var t,i;const n=(e==null||(t=e.item)===null||t===void 0?void 0:t.itemType)??((i=e.itemsRunTimeInfo.findPreparedItemByItem(e==null?void 0:e.item))===null||i===void 0?void 0:i.itemType);return n==="simple"?new rx(e):n==="group"?new ax(e):(e.optionName=r,new yl(e))}default:return null}};class du{constructor(){this._map={}}_findWidgetInstance(e){let t;return x(this._map,((i,n)=>{let{widgetInstance:s,item:o}=n;return e(o)?(t=s,!1):!0})),t}_findFieldByCondition(e,t){let i;return x(this._map,((n,s)=>e(s)?(i=t==="guid"?n:s[t],!1):!0)),i}clear(){this._map={}}removeItemsByItems(e){x(e.getItems(),(t=>this.removeItemByKey(t)))}removeItemByKey(e){delete this._map[e]}add(e){const t=e.guid??new Te().toString();return this._map[t]=e,t}addItemsOrExtendFrom(e){e.each(((t,i)=>{this._map[t]?(i.widgetInstance&&(this._map[t].widgetInstance=i.widgetInstance),this._map[t].$itemContainer=i.$itemContainer):this.add({item:i.item,widgetInstance:i.widgetInstance,guid:t,$itemContainer:i.$itemContainer})}))}extendRunTimeItemInfoByKey(e,t){this._map[e]&&(this._map[e]=b(this._map[e],t))}findWidgetInstanceByItem(e){return this._findWidgetInstance((t=>t===e))}findGroupOrTabLayoutManagerByPath(e){return this._findFieldByCondition((t=>{let{path:i}=t;return i===e}),"layoutManager")}findKeyByPath(e){return this._findFieldByCondition((t=>{let{path:i}=t;return i===e}),"guid")}findWidgetInstanceByName(e){return this._findWidgetInstance((t=>e===t.name))}findWidgetInstanceByDataField(e){return this._findWidgetInstance((t=>e===(W(t)?t:t.dataField)))}findItemContainerByItem(e){for(const t in this._map)if(this._map[t].item===e)return this._map[t].$itemContainer??h();return h()}findItemIndexByItem(e){return this._findFieldByCondition((t=>{let{item:i}=t;return i===e}),"itemIndex")}findPreparedItemByItem(e){return this._findFieldByCondition((t=>{let{item:i}=t;return i===e}),"preparedItem")}getItems(){return this._map}each(e){x(this._map,((t,i)=>{e(t,i)}))}removeItemsByPathStartWith(e){Object.keys(this._map).filter((n=>{if(this._map[n].path){var s;return(s=this._map[n].path)===null||s===void 0?void 0:s.includes(e,0)}return!1})).forEach((n=>this.removeItemByKey(n)))}}function hx(r){return m(r)?r:"right"}function px(r){switch(r){case"center":return"center";case"bottom":return"flex-end";default:return"flex-start"}}function gx(r){let{item:e,$parent:t,rootElementCssClassList:i,validationGroup:n,createComponentCallback:s}=r;const o=h("<div>").appendTo(t).addClass(i.join(" ")).addClass("dx-field-button-item").css("textAlign",hx(e.horizontalAlignment));t.css("justifyContent",px(e.verticalAlignment));const a=h("<div>").appendTo(o);return{$rootElement:o,buttonInstance:s(a,b({validationGroup:n},e.buttonOptions))}}function mx(r){const{$parent:e,rootElementCssClassList:t}=r;return h("<div>").addClass("dx-field-empty-item").html("&nbsp;").addClass(t.join(" ")).appendTo(e)}function Il(r){const e=r.children().first();return e.hasClass("dx-template-wrapper")?e.children().first():e}function Sl(r){if(r&&Cs(Se())){const e=".dx-field-item-content-wrapper",t=i=>{let{element:n,component:s}=i;const{isValid:o,validationMessageMode:a}=s.option();h(n).parents(e).toggleClass("dx-invalid",o===!1&&(s._isFocused()||a==="always"))};r.on("optionChanged",(i=>{i.name==="isValid"&&t(i)})),r.on("focusIn",t).on("focusOut",t).on("enterKey",t)}}function _x(r){var e;return(r==null?void 0:r.data("dx-validation-target"))||(r==null||(e=r.parent)===null||e===void 0||(e=e.call(r))===null||e===void 0?void 0:e.data("dx-validation-target"))}function El(r,e,t){return{dataField:r.dataField,editorType:r.editorType,editorOptions:e,component:t,name:r.name}}function fx(r){let{$parent:e,rootElementCssClassList:t,formOrLayoutManager:i,createComponentCallback:n,labelOptions:s,labelNeedBaselineAlign:o,labelLocation:a,needRenderLabel:l,formLabelLocation:d,item:c,editorOptions:u,isSimpleItem:p,isRequired:g,template:_,helpID:f,labelID:C,name:I,helpText:E,requiredMessageTemplate:D,validationGroup:k}=r;const A=h("<div>").addClass(t.join(" ")).appendTo(e);A.addClass(g?"dx-field-item-required":"dx-field-item-optional"),p&&A.addClass("dx-flex-layout"),p&&o&&A.addClass("dx-field-item-label-align");const F=h("<div>");F.data("dx-form-item",c),F.addClass(No).addClass("dx-field-item-content-location-"+{right:"left",left:"right",top:"bottom"}[d]);let z=null;if(l&&(s.labelTemplate&&(s.labelTemplateData=El(c,u,i)),z=Jv(s)),z){const{editorType:te}=c;A.append(z),(a==="top"||a==="left")&&A.append(F),a==="right"&&A.prepend(F),a==="top"?A.addClass("dx-label-v-align"):A.addClass("dx-label-h-align"),(te==="dxCheckBox"||te==="dxSwitch")&&v.on(z,Q,(()=>{v.trigger(F.children(),Q)}));const Ge=["dxCheckBox","dxSwitch","dxRadioGroup"].includes(te),Oe=s.alignment;!_&&Ge&&a==="top"&&(Oe==="left"||!Oe)&&F.addClass("dx-toggle-controls-paddings")}else A.append(F);let ee;if(_)_.render({container:$(F),model:El(c,u,i),onRendered(){const te=Il(F),be=_x(te);Sl(be)}});else{const te=h("<div>").appendTo(F);try{ee=n(te,c.editorType,u),ee.setAria("describedby",f),C&&ee.setAria("labelledby",C),ee.setAria("required",g)}catch(be){se.log("E1035",be.message)}}const q=Il(F),ce=q==null?void 0:q.data("dx-validation-target");if(ce){var ue;const te=(ue=c.label)===null||ue===void 0?void 0:ue.text,be=te?null:I,Ge=te?c.label.text:be&&rn(be);let Oe=null;if(p)if(c.validationRules)Oe=c.validationRules;else{const ai=hn(D,Ge);Oe=c.isRequired?[{type:"required",message:ai}]:null}Array.isArray(Oe)&&Oe.length&&n(q,Es,{validationRules:Oe,validationGroup:k,dataGetter:()=>({formItem:c})}),Sl(ce)}return E&&p&&F.parent().append(h("<div>").addClass("dx-field-item-content-wrapper").append(F).append(h("<div>").addClass("dx-field-item-help-text").attr("id",f).text(E))),{$fieldEditorContainer:F,$rootElement:A,widgetInstance:ee}}const Tl="dx-responsivebox-screen-";class cu extends nr{_getDefaultOptions(){return T({},super._getDefaultOptions(),{rows:[],cols:[],singleColumnScreen:"",screenByWidth:null,height:"100%",width:"100%",activeStateEnabled:!1,focusStateEnabled:!1,onLayoutChanged:null})}_init(){const{screenByWidth:e}=this.option();e||this._options.silent("screenByWidth",Sd),super._init(),this._initLayoutChangedAction()}_initLayoutChangedAction(){this._layoutChangedAction=this._createActionByOption("onLayoutChanged",{excludeValidators:["disabled","readOnly"]})}_itemClass(){return"dx-box-item"}_itemDataKey(){return"dxBoxItemData"}_initMarkup(){super._initMarkup(),this.$element().addClass("dx-responsivebox")}_renderItems(){this._setScreenSize(),this._screenItems=this._itemsByScreen(),this._prepareGrid(),this._spreadItems(),this._layoutItems(),this._linkNodeToItem()}_itemOptionChanged(e){const t=this._findItemElementByItem(e);t.length&&(this._refreshItem(t,e),this._clearItemNodeTemplates(),this._update(!0))}_setScreenSize(){const e=this._getCurrentScreen();this._removeScreenSizeClass(),this.$element().addClass(Tl+e),this.option("currentScreenFactor",e)}_removeScreenSizeClass(){const{currentScreenFactor:e}=this.option();e&&this.$element().removeClass(Tl+e)}_prepareGrid(){this._grid=[],this._prepareRowsAndCols(),x(this._rows,(()=>{const e=[];this._grid.push(e),x(this._cols,(()=>{e.push(this._createEmptyCell())}))}))}getSingleColumnRows(){const{rows:e}=this.option(),t=this._screenItems.length;if(e!=null&&e.length){const i=this._filterByScreen(e),n=[];for(let s=0;s<t;s+=1){const o=this._defaultSizeConfig();s<i.length&&m(i[s].shrink)&&(o.shrink=i[s].shrink),n.push(o)}return n}return this._defaultSizeConfig(t)}_prepareRowsAndCols(){if(this._isSingleColumnScreen())this._prepareSingleColumnScreenItems(),this._rows=this.getSingleColumnRows(),this._cols=this._defaultSizeConfig(1);else{const{rows:e,cols:t}=this.option();this._rows=this._sizesByScreen(e),this._cols=this._sizesByScreen(t)}}_isSingleColumnScreen(){const{singleColumnScreen:e,rows:t,cols:i}=this.option();return this._screenRegExp().test(e)||!(t!=null&&t.length)||!(i!=null&&i.length)}_prepareSingleColumnScreenItems(){this._screenItems.sort(((e,t)=>e.location.row-t.location.row||e.location.col-t.location.col)),x(this._screenItems,((e,t)=>{Object.assign(t.location,{row:e,col:0,rowspan:1,colspan:1})}))}_sizesByScreen(e){return wt(this._filterByScreen(e),(t=>b(this._defaultSizeConfig(),t)))}_createDefaultSizeConfig(){return{ratio:1,baseSize:0,minSize:0,maxSize:0}}_defaultSizeConfig(e){const t=this._createDefaultSizeConfig();if(!arguments.length)return t;const i=[];for(let n=0;n<e;n+=1)i.push(t);return i}_filterByScreen(e){const t=this._screenRegExp();return bi(e,(i=>!i.screen||t.test(i.screen)))}_screenRegExp(){const e=this._getCurrentScreen();return new RegExp(`(^|\\s)${e}($|\\s)`,"i")}_getCurrentScreen(){const e=this._screenWidth(),{screenByWidth:t}=this.option();return t==null?void 0:t(e)}_screenWidth(){return pe()?H(oe()):1920}_createEmptyCell(){return{item:{},location:{colspan:1,rowspan:1}}}_spreadItems(){x(this._screenItems,((e,t)=>{const i=t.location||{},n=i.col,s=i.row,o=this._grid[s],a=o==null?void 0:o[n];this._occupyCells(a,t)}))}_itemsByScreen(){const{items:e=[]}=this.option();return e.reduce(((t,i)=>{let n=i.location??{};return n=ze(n)?[n]:n,this._filterByScreen(n).forEach((s=>{t.push({item:i,location:T({rowspan:1,colspan:1},s)})})),t}),[])}_occupyCells(e,t){!e||this._isItemCellOccupied(e,t)||(b(e,t),this._markSpanningCell(e))}_isItemCellOccupied(e,t){if(!nt(e.item))return!0;let i=!1;return this._loopOverSpanning(t.location,(n=>{i=i||!nt(n.item)})),i}_loopOverSpanning(e,t){const i=e.row+e.rowspan-1,n=e.col+e.colspan-1,s=Math.min(i,this._rows.length-1),o=Math.min(n,this._cols.length-1);e.rowspan-=i-s,e.colspan-=n-o;for(let a=e.row;a<=s;a+=1)for(let l=e.col;l<=o;l+=1)(a!==e.row||l!==e.col)&&t(this._grid[a][l])}_markSpanningCell(e){this._loopOverSpanning(e.location,(t=>{t.item=e.item,t.spanningCell=e}))}_linkNodeToItem(){x(this._itemElements(),((e,t)=>{const i=h(t),n=i.data("dxBoxItemData");n.box||(n.node=i.children())}))}_layoutItems(){const e=this._grid.length,t=e&&this._grid[0].length;if(!e&&!t)return;const i=this._layoutBlock({direction:"col",row:{start:0,end:e-1},col:{start:0,end:t-1}}),n=this._prepareBoxConfig((i==null?void 0:i.box)??{direction:"row",items:[b(i,{ratio:1})]});b(n,this._rootBoxConfig(n.items)),this._$root=h("<div>").appendTo(this._itemContainer()),this._createComponent(this._$root,Bt,n)}_rootBoxConfig(e){const t=x(e,((n,s)=>{this._needApplyAutoBaseSize(s)&&(s.baseSize="auto")})),{itemHoldTimeout:i}=this.option();return{width:"100%",height:"100%",items:t,itemTemplate:this._getTemplateByOption("itemTemplate"),itemHoldTimeout:i,onItemHold:this._createActionByOption("onItemHold"),onItemClick:this._createActionByOption("onItemClick"),onItemContextMenu:this._createActionByOption("onItemContextMenu"),onItemRendered:this._createActionByOption("onItemRendered")}}_needApplyAutoBaseSize(e){return!e.baseSize&&(!e.minSize||e.minSize==="auto")&&(!e.maxSize||e.maxSize==="auto")}_prepareBoxConfig(e){const{onItemStateChanged:t}=this.option();return b(e||{},{crossAlign:"stretch",onItemStateChanged:t})}_layoutBlock(e){return this._isSingleItem(e)?this._itemByCell(e.row.start,e.col.start):this._layoutDirection(e)}_isSingleItem(e){const{row:t,col:i}=e,n=this._grid[t.start][i.start].location,s=t.end-t.start===n.rowspan-1,o=i.end-i.start===n.colspan-1;return s&&o}_itemByCell(e,t){const i=this._grid[e][t];return i.spanningCell?null:i.item}_layoutDirection(e){const t=[],{direction:i}=e,n=this._crossDirection(i);let s=null;for(;s=this._nextBlock(e);){if(this._isBlockIndivisible(e.prevBlockOptions,s))throw se.Error("E1025");const o=this._layoutBlock({direction:n,row:s.row,col:s.col,prevBlockOptions:e});o&&(b(o,this._blockSize(s,n)),t.push(o)),e[n].start=s[n].end+1}return{box:this._prepareBoxConfig({direction:i,items:t})}}_isBlockIndivisible(e,t){return!!e&&e.col.start===t.col.start&&e.col.end===t.col.end&&e.row.start===t.row.start&&e.row.end===t.row.end}_crossDirection(e){return e==="col"?"row":"col"}_nextBlock(e){const{direction:t}=e,i=this._crossDirection(t),n=e[t].start,s=e[t].end,o=e[i].start;if(o>e[i].end)return null;let a=1;for(let d=o;d<o+a;d+=1){let c=1;for(let g=n;g<=s;g+=1){const _=this._cellByDirection(t,g,d);c=Math.max(c,_.location[`${i}span`])}const u=d+c,p=o+a;u>p&&(a+=u-p)}const l={};return l[t]={start:n,end:s},l[i]={start:o,end:o+a-1},l}_cellByDirection(e,t,i){return e==="col"?this._grid[i][t]:this._grid[t][i]}_blockSize(e,t){const i=t==="row"?"auto":0,n=t==="row"?this._rows:this._cols,s=T({},this._createDefaultSizeConfig(),{ratio:0});for(let o=e[t].start;o<=e[t].end;o+=1){const a=n[o];s.ratio+=a.ratio,s.baseSize+=a.baseSize,s.minSize+=a.minSize,s.maxSize+=a.maxSize,m(a.shrink)&&(s.shrink=a.shrink)}return s.minSize||(s.minSize=i),s.maxSize||(s.maxSize="auto"),this._isSingleColumnScreen()&&(s.baseSize="auto"),s}_update(e){var t;const i=this._$root;this._renderItems(),i&&(e?i.remove():(i.detach(),this._saveAssistantRoot(i))),(t=this._layoutChangedAction)===null||t===void 0||t.call(this)}_saveAssistantRoot(e){this._assistantRoots=this._assistantRoots??[],this._assistantRoots.push(e)}_dispose(){this._clearItemNodeTemplates(),this._cleanUnusedRoots(),super._dispose()}_cleanUnusedRoots(){this._assistantRoots&&x(this._assistantRoots,((e,t)=>{h(t).remove()}))}_clearItemNodeTemplates(){const{items:e}=this.option();x(e,(function(){delete this.node}))}_attachClickEvent(){}_optionChanged(e){const{name:t}=e;switch(t){case"rows":case"cols":case"screenByWidth":case"singleColumnScreen":this._clearItemNodeTemplates(),this._invalidate();break;case"width":case"height":super._optionChanged(e),this._update();break;case"onLayoutChanged":this._initLayoutChangedAction();break;case"itemTemplate":this._clearItemNodeTemplates(),super._optionChanged(e);break;case"currentScreenFactor":break;default:super._optionChanged(e)}}_dimensionChanged(){const{currentScreenFactor:e}=this.option();this._getCurrentScreen()!==e&&this._update()}repaint(){this._update()}}_e("dxResponsiveBox",cu);const Dl=200;class uu extends Lt{_getDefaultOptions(){return T({},super._getDefaultOptions(),{layoutData:{},readOnly:!1,colCount:1,labelLocation:"left",onFieldDataChanged:null,onEditorEnterKey:null,customizeItem:null,alignItemLabels:!0,minColWidth:Dl,showRequiredMark:!0,screenByWidth:null,showOptionalMark:!1,requiredMark:"*",labelMode:"outside",optionalMark:w.format("dxForm-optionalMark"),requiredMessage:w.getFormatter("dxForm-requiredMessage")})}_setOptionsByReference(){super._setOptionsByReference(),b(this._optionsByReference,{layoutData:!0,validationGroup:!0})}_init(){const{layoutData:e}=this.option();super._init(),this._itemWatchers=[],this._itemsRunTimeInfo=new du,this._updateReferencedOptions(e),this._initDataAndItems(e)}_dispose(){super._dispose(),this._cleanItemWatchers()}_initDataAndItems(e){this._syncDataWithItems(),this._updateItems(e)}_syncDataWithItems(){const{layoutData:e,items:t}=this.option();m(t)&&t.forEach((i=>{if(i.dataField&&this._getDataByField(i.dataField)===void 0){var n;const s=(n=i.editorOptions)===null||n===void 0?void 0:n.value;(m(s)||i.dataField in e)&&this._updateFieldValue(i.dataField,s)}}))}_getDataByField(e){return e?this.option(`layoutData.${e}`):null}_isCheckboxUndefinedStateEnabled(e,t,i){if(e&&t==="dxCheckBox"){const n=["layoutData",...i.split(".")],s=n.pop(),o=this.option(n.join("."));return s?o&&s in o:!1}return!1}_updateFieldValue(e,t){const{layoutData:i}=this.option();let n=t;!gt.isWrapped(i[e])&&m(e)?this.option(`layoutData.${e}`,n):gt.isWritableWrapped(i[e])&&(n=B(n)?n():n,i[e](n)),this._triggerOnFieldDataChanged({dataField:e,value:n})}_triggerOnFieldDataChanged(e){this._createActionByOption("onFieldDataChanged")(e)}_updateItems(e){const{items:t}=this.option(),i=m(t),{customizeItem:n}=this.option(),s=i?t:this._generateItemsByData(e);if(m(s)){const o=[];x(s,((a,l)=>{this._isAcceptableItem(l)&&(l=this._processItem(l),n==null||n(l),L(l)&&gt.unwrap(l.visible)!==!1&&o.push(l))})),(!this._itemWatchers.length||!i)&&this._updateItemWatchers(s),this._setItems(o),this._sortItems()}}_cleanItemWatchers(){this._itemWatchers.forEach((e=>{e()})),this._itemWatchers=[]}_updateItemWatchers(e){const t=this._getWatch();e.forEach((i=>{L(i)&&m(i.visible)&&B(t)&&this._itemWatchers.push(t((()=>gt.unwrap(i.visible)),(()=>{const{layoutData:n}=this.option();this._updateItems(n),this.repaint()}),{skipImmediate:!0}))}))}_generateItemsByData(e){const t=[];return m(e)&&x(e,(i=>{t.push({dataField:i})})),t}_isAcceptableItem(e){const t=W(e)?e:e.dataField,i=this._getDataByField(t);return!(B(i)&&!gt.isWrapped(i))}_processItem(e){if(typeof e=="string"&&(e={dataField:e}),typeof e=="object"&&!e.itemType&&(e.itemType=Lo),!m(e.editorType)&&m(e.dataField)){const t=this._getDataByField(e.dataField);e.editorType=m(t)?this._getEditorTypeByDataType(Rd(t)):"dxTextBox"}return e.editorType==="dxCheckBox"&&(e.allowIndeterminateState=e.allowIndeterminateState??!0),e}_getEditorTypeByDataType(e){switch(e){case"number":return"dxNumberBox";case"date":return"dxDateBox";case"boolean":return"dxCheckBox";default:return"dxTextBox"}}_sortItems(){sn(this._items,"visibleIndex"),this._sortIndexes()}_sortIndexes(){var e;(e=this._items)===null||e===void 0||e.sort(((t,i)=>{const n=t.visibleIndex,s=i.visibleIndex;return n>s?1:n<s?-1:0}))}_initMarkup(){this._itemsRunTimeInfo.clear(),this.$element().addClass(Fv),super._initMarkup(),this._renderResponsiveBox()}_renderResponsiveBox(){var e;const t=[];if((e=this._items)!==null&&e!==void 0&&e.length){const i=this._getColCount(),n=h("<div>").appendTo(this.$element());this._prepareItemsWithMerging(i);const s=this._generateLayoutItems();this._responsiveBox=super._createComponent(n,cu,this._getResponsiveBoxConfig(s,i,t)),pe()||this._renderTemplates(t)}}_itemStateChangedHandler(e){this._refresh()}_renderTemplates(e){let t=0;e.forEach((i=>{var n;let{item:s}=i;s!=null&&(n=s.label)!==null&&n!==void 0&&n.template&&(t+=1)})),x(e,((i,n)=>{switch(n.itemType){case"empty":mx(n);break;case"button":this._renderButtonItem(n);break;default:this._renderFieldItem(n,t)}}))}_getResponsiveBoxConfig(e,t,i){const n=this,{colCountByScreen:s,screenByWidth:o}=this.option(),a=s==null?void 0:s.xs;return{onItemStateChanged:this._itemStateChangedHandler.bind(this),onLayoutChanged:()=>{const{onLayoutChanged:l}=this.option(),d=this.isSingleColumnMode();l&&(this.$element().toggleClass(Cl,d),l(d))},onContentReady:l=>{pe()&&this._renderTemplates(i);const{onLayoutChanged:d}=this.option();d&&this.$element().toggleClass(Cl,this.isSingleColumnMode(l.component))},itemTemplate(l,d,c){var u;const{location:p}=l;if(!p)return;const g=h(c),_=p.row*t,f=(u=n._items)===null||u===void 0?void 0:u[p.col+_];if(!f)return;const C=[f.cssClass??""];g.toggleClass(Av,n.isSingleColumnMode(this)),p.row===0&&C.push("dx-first-row"),p.col===0&&C.push("dx-first-col");const{isRoot:I}=n.option();f.itemType===Lo&&I&&g.addClass(ou);const E=p.col===t-1||p.col+p.colspan===t,D=n._getRowsCount(),k=p.row===D-1;if(E&&C.push("dx-last-col"),k&&C.push("dx-last-row"),f.itemType!=="empty"){C.push(iu);const{cssItemClass:A=""}=n.option();C.push(A),m(f.col)&&C.push(`dx-col-${f.col}`)}i.push({itemType:f.itemType,item:f,$parent:g,rootElementCssClassList:C})},cols:this._generateRatio(t),rows:this._generateRatio(this._getRowsCount(),!0),dataSource:e,screenByWidth:o,singleColumnScreen:a?!1:"xs"}}_getColCount(){let{colCount:e}=this.option();const t=this.option("colCountByScreen");if(t){const{form:i}=this.option();let n=i==null?void 0:i.getTargetScreenFactor();n||(n=pe()?Ed(this.option("screenByWidth")):"lg"),e=t[n]||e}if(e==="auto"){if(this._cashedColCount)return this._cashedColCount;e=this._getMaxColCount(),this._cashedColCount=e}return e<1?1:e}_getMaxColCount(){if(!pe())return 1;const{minColWidth:e=Dl}=this.option(),t=H(this.$element()),i=this._items.length,n=Math.floor(t/e)||1;return i<n?i:n}isCachedColCountObsolete(){return!!this._cashedColCount&&this._getMaxColCount()!==this._cashedColCount}_prepareItemsWithMerging(e){const t=(this._items??[]).slice(0);let i=[];for(let n=0;n<t.length;n+=1){const s=t[n];i.push(s);const{alignItemLabels:o}=this.option();if((o||s.alignItemLabels||s.colSpan)&&(s.col=this._getColByIndex(i.length-1,e)),s.colSpan>1&&s.col+s.colSpan<=e){const a=[];for(let l=0;l<s.colSpan-1;l+=1)a.push({merged:!0});i=i.concat(a)}else delete s.colSpan}this._setItems(i)}_getColByIndex(e,t){return e%t}_setItems(e){this._items=e,this._cashedColCount=null}_generateLayoutItems(){const e=this._items??[],t=this._getColCount(),i=[];for(let n=0;n<e.length;n+=1){const s=e[n];if(!s.merged){const o={row:parseInt(String(n/t),10),col:this._getColByIndex(n,t)};m(s.colSpan)&&(o.colspan=s.colSpan),m(s.rowSpan)&&(o.rowspan=s.rowSpan);const a={location:o};m(s.disabled)&&(a.disabled=s.disabled),m(s.visible)&&(a.visible=s.visible),i.push(a)}}return i}_renderButtonItem(e){const{item:t,$parent:i,rootElementCssClassList:n}=e,{validationGroup:s}=this.option(),{$rootElement:o,buttonInstance:a}=gx({item:t,$parent:i,rootElementCssClassList:n,validationGroup:s,createComponentCallback:(l,d)=>super._createComponent(l,Ze,d)});this._itemsRunTimeInfo.add({item:t,widgetInstance:a,guid:t.guid,$itemContainer:o})}_renderFieldItem(e,t){var i;const{item:n,$parent:s,rootElementCssClassList:o}=e,a=this._getDataByField(n.dataField);let l=!1;if(a===void 0){const{allowIndeterminateState:z,editorType:ee,dataField:q}=n;l=this._isCheckboxUndefinedStateEnabled(z,ee,q)}const d=n.dataField||n.name,c=this._getFormOrThis(),{form:u,labelLocation:p,requiredMessage:g,validationGroup:_,validationBoundary:f,showColonAfterLabel:C,labelMode:I}=this.option(),E=Xv({$parent:s,rootElementCssClassList:o,item:n,name:d,editorValue:a,canAssignUndefinedValueToEditor:l,formOrLayoutManager:this._getFormOrThis(),createComponentCallback:this._createComponent.bind(this),formLabelLocation:p,requiredMessageTemplate:g,validationGroup:_,editorValidationBoundary:f,editorStylingMode:u==null?void 0:u.option("stylingMode"),showColonAfterLabel:!!C,managerLabelLocation:p,template:n.template?this._getTemplate(n.template):null,labelTemplate:(i=n.label)!==null&&i!==void 0&&i.template?this._getTemplate(n.label.template):null,itemId:u==null?void 0:u.getItemID(d),managerMarkOptions:this._getMarkOptions(),labelMode:I,onLabelTemplateRendered:()=>{this._incTemplateRenderedCallCount(),this._shouldAlignLabelsOnTemplateRendered(c,t)&&c._alignLabels(this,this.isSingleColumnMode(c))}}),{$fieldEditorContainer:D,widgetInstance:k,$rootElement:A}=fx(E),{onFieldItemRendered:F}=this.option();F==null||F(),k&&n.dataField&&this._bindDataField(k,n.dataField,D),this._itemsRunTimeInfo.add({item:n,widgetInstance:k,guid:n.guid,$itemContainer:A})}_incTemplateRenderedCallCount(){this._labelTemplateRenderedCallCount=(this._labelTemplateRenderedCallCount??0)+1}_shouldAlignLabelsOnTemplateRendered(e,t){const{templatesRenderAsynchronously:i}=e.option();return!!i&&this._labelTemplateRenderedCallCount===t}_getMarkOptions(){const{showRequiredMark:e,requiredMark:t,showOptionalMark:i,optionalMark:n}=this.option();return{showRequiredMark:e,requiredMark:t,showOptionalMark:i,optionalMark:n}}_getFormOrThis(){const{form:e}=this.option();return e||this}_bindDataField(e,t,i){const n=this._getFormOrThis();e.on("enterKey",(s=>{n._createActionByOption("onEditorEnterKey")(b(s,{dataField:t}))})),this._createWatcher(e,i,t),this.linkEditorToDataField(e,t)}_createWatcher(e,t,i){const n=this._getWatch();if(!B(n))return;const s=n((()=>this._getDataByField(i)),(()=>{const o=this._getDataByField(i);if(e.NAME==="dxTagBox"){const a=e.option("value");if(o!==a&&(function(l,d){if(!Array.isArray(l)||!Array.isArray(d)||l.length!==d.length)return!1;for(let c=0;c<l.length;c+=1)if(l[c]!==d[c])return!1;return!0})(o,a))return}e.option("value",o)}),{deep:!0,skipImmediate:!0},{createWatcherDataField:i});v.on(t,ii,s)}_getWatch(){if(!m(this._watch)){const{form:e}=this.option();this._watch=e==null?void 0:e.option("integrationOptions.watchMethod")}return this._watch}_createComponent(e,t,i){const{readOnly:n}=this.option();let s=Object.hasOwn(i,"readOnly");const o=super._createComponent(e,t,T({},i,{readOnly:s?i.readOnly:n}));let a=!1;return o.on("optionChanged",(l=>{l.name==="readOnly"&&!a&&(s=!0)})),this.on("optionChanged",(l=>{l.name==="readOnly"&&!s&&(a=!0,o.option(l.name,l.value),a=!1)})),o}_generateRatio(e,t){const i=[];for(let n=0;n<e;n+=1){const s={ratio:1};t&&(s.baseSize="auto"),i.push(s)}return i}_getRowsCount(){const e=this._items??[];return Math.ceil(e.length/this._getColCount())}_updateReferencedOptions(e){const t=this.option("layoutData");L(t)&&Object.getOwnPropertyNames(t).forEach((i=>delete this._optionsByReference[`layoutData.${i}`])),L(e)&&Object.getOwnPropertyNames(e).forEach((i=>this._optionsByReference[`layoutData.${i}`]=!0))}_clearWidget(e){this._disableEditorValueChangedHandler=!0,e.clear(),this._disableEditorValueChangedHandler=!1,e.option("isValid",!0)}_optionChanged(e){if(e.fullName.search("layoutData.")!==0)switch(e.name){case"showRequiredMark":case"showOptionalMark":case"requiredMark":case"optionalMark":case"alignItemLabels":case"labelLocation":case"labelMode":case"requiredMessage":this._invalidate();break;case"layoutData":{this._updateReferencedOptions(e.value);const{items:t}=this.option();t?nt(e.value)||this._itemsRunTimeInfo.each(((i,n)=>{if(m(n.item)){const{dataField:s}=n.item;if(s&&m(n.widgetInstance)){const a=Pe(s)(e.value),{allowIndeterminateState:l,editorType:d}=n.item;a!==void 0||this._isCheckboxUndefinedStateEnabled(l,d,s)?n.widgetInstance.option("value",a):this._clearWidget(n.widgetInstance)}}})):(this._initDataAndItems(e.value),this._invalidate());break}case"items":this._cleanItemWatchers(),this._initDataAndItems(e.value),this._invalidate();break;case"customizeItem":this._updateItems(this.option("layoutData")),this._invalidate();break;case"colCount":case"colCountByScreen":this._resetColCount();break;case"minColWidth":{const{colCount:t}=this.option();t==="auto"&&this._resetColCount();break}case"readOnly":case"onFieldDataChanged":break;case"width":{super._optionChanged(e);const{colCount:t}=this.option();t==="auto"&&this._resetColCount();break}default:super._optionChanged(e)}}_resetColCount(){this._cashedColCount=null,this._invalidate()}linkEditorToDataField(e,t){this.on("optionChanged",(i=>{i.fullName===`layoutData.${t}`&&e._setOptionWithoutOptionChange("value",i.value)})),e.on("valueChanged",(i=>{const n=L(i.value)||Array.isArray(i.value);!this._disableEditorValueChangedHandler&&!(n&&i.value===i.previousValue)&&this._updateFieldValue(t,i.value)}))}_dimensionChanged(){const{colCount:e}=this.option();e==="auto"&&this.isCachedColCountObsolete()&&this._eventsStrategy.fireEvent("autoColCountChanged")}updateData(e,t){L(e)?x(e,((i,n)=>{this._updateFieldValue(i,n)})):typeof e=="string"&&this._updateFieldValue(e,t)}getEditor(e){return this._itemsRunTimeInfo.findWidgetInstanceByDataField(e)??this._itemsRunTimeInfo.findWidgetInstanceByName(e)}isSingleColumnMode(e){const t=this._responsiveBox||e;if(t){const{currentScreenFactor:i,singleColumnScreen:n}=t.option();return i===n}return!1}getItemsRunTimeInfo(){return this._itemsRunTimeInfo}}_e("dxLayoutManager",uu);const On={move(r,e){jt(r,{left:e})}},io={moveTo(r,e,t,i){ve.animate(r.get(0),{type:"slide",to:{left:e},duration:t,complete:i})},complete(r){ve.stop(r.get(0),!0)}},Rl=r=>+r,Cx=r=>Gi(r).left;class hu extends Hd{_supportedKeys(){return T({},super._supportedKeys(),{pageUp:Ce,pageDown:Ce})}_getDefaultOptions(){return T({},super._getDefaultOptions(),{selectedIndex:0,swipeEnabled:!0,animationEnabled:!0,loop:!1,deferRendering:!0,loopItemFocus:!1,selectOnFocus:!0,selectionMode:"single",selectionRequired:!0,selectByClick:!1})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:()=>G.real().deviceType==="desktop"&&!G.isSimulator(),options:{focusStateEnabled:!0}}])}_itemClass(){return"dx-multiview-item"}_itemDataKey(){return"dxMultiViewItemData"}_itemContainer(){return this._$itemContainer}_itemElements(){return this._itemContainer().children(this._itemSelector())}_itemWidth(){return this._itemWidthValue?this._itemWidthValue:H(this._$wrapper)}_clearItemWidthCache(){delete this._itemWidthValue}_itemsCount(){const{items:e=[]}=this.option();return e.length}_isAllItemsHidden(){const{items:e=[]}=this.option();return e.every(((t,i)=>!this._isItemVisible(i)))}_normalizeIndex(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=this._itemsCount();let s=e;if(this._isAllItemsHidden())return;e<0&&(s+=n),e>=n&&(s-=n);const o=t>0?-1:1,a=o===-1?0:n-1;for(;!this._isItemVisible(s)&&(i||s!==a);)s=(s+o+n)%n;return s}_getRTLSignCorrection(){const{rtlEnabled:e}=this.option();return e?-1:1}_init(){super._init(),this._activeStateUnit=".dx-multiview-item";const e=this.$element();e.addClass("dx-multiview"),this._$wrapper=h("<div>").addClass("dx-multiview-wrapper"),this._$wrapper.appendTo(e),this._$itemContainer=h("<div>").addClass("dx-multiview-item-container"),this._$itemContainer.appendTo(this._$wrapper);const{loop:t}=this.option();this.option("loopItemFocus",t),this._findBoundaryIndices(),this._initSwipeable()}_ensureSelectedItemIsVisible(){const{loop:e,selectedIndex:t}=this.option();if(!m(t)||this._isItemVisible(t))return;if(this._isAllItemsHidden()){this.option("selectedIndex",0);return}const i=-1*this._getRTLSignCorrection();let n=this._normalizeIndex(t,i,e);n===t&&(n=this._normalizeIndex(t,-i,e)),this.option("selectedIndex",n)}_initMarkup(){this._deferredItems=[],super._initMarkup(),this._ensureSelectedItemIsVisible();const e=this._getSelectedItemIndices();this._updateItemsVisibility(e[0]),this._setElementAria(),this._setItemsAria()}_afterItemElementDeleted(e,t){super._afterItemElementDeleted(e,t),this._deferredItems&&this._deferredItems.splice(t.itemIndex,1)}_beforeItemElementInserted(e){super._beforeItemElementInserted(e),this._deferredItems&&this._deferredItems.splice(e.index,0,null)}_executeItemRenderAction(e,t,i){const{items:n=[]}=this.option(),s=n.indexOf(t);super._executeItemRenderAction(s,t,i)}_renderItemContent(e){const t=S(),i=S();i.done((()=>{const s=super._renderItemContent(e);t.resolve(s)})),this._deferredItems[e.index]=i;const{deferRendering:n}=this.option();return n||i.resolve(),t.promise()}_render(){super._render(),Re((()=>{const e=this._getSelectedItemIndices();this._updateItems(e[0])}))}_getElementAria(){return{role:"group",roledescription:w.format("dxMultiView-elementAriaRoleDescription"),label:w.format("dxMultiView-elementAriaLabel")}}_setElementAria(){const e=this._getElementAria();this.setAria(e,this.$element())}_setItemsAria(){const e=this._itemElements(),t=this._itemsCount();e.each(((i,n)=>{const s=this._getItemAria({itemIndex:i,itemsCount:t});this.setAria(s,h(n))}))}_getItemAria(e){const{itemIndex:t,itemsCount:i}=e;return{role:"group",roledescription:w.format("dxMultiView-itemAriaRoleDescription"),label:w.format("dxMultiView-itemAriaLabel",t+1,i)}}_updateItems(e,t){this._updateItemsPosition(e,t),this._updateItemsVisibility(e,t)}_modifyByChanges(e,t){super._modifyByChanges(e,t);const i=this._getSelectedItemIndices();this._updateItemsVisibility(i[0])}_updateItemsPosition(e,t){const i=this._itemElements(),n=m(t)?-this._animationDirection(t,e):void 0,s=i.eq(e);On.move(s,0),m(t)&&m(n)&&On.move(i.eq(t),100*n+"%")}_isItemVisible(e){var t;const{items:i=[]}=this.option();return(m(e)&&((t=i[e])===null||t===void 0?void 0:t.visible))??!0}_updateItemsVisibility(e,t){this._itemElements().each(((n,s)=>{const o=h(s),a=n!==e&&n!==t;a||this._renderSpecificItem(n),o.toggleClass("dx-multiview-item-hidden",a),this.setAria("hidden",a||void 0,o)}))}_renderSpecificItem(e){const t=this._itemElements().eq(e),i=t.find(this._itemContentClass()).length>0;if(m(e)&&!i){var n;(n=this._deferredItems[e])===null||n===void 0||n.resolve(),Td(t)}}_refreshItem(e,t){super._refreshItem(e,t);const{selectedIndex:i=0}=this.option();this._updateItemsVisibility(i)}_setAriaSelectionAttribute(){}_updateSelection(e,t){const i=e[0],n=t[0];io.complete(this._$itemContainer),this._updateItems(n,i);const s=this._animationDirection(i,n);this._animateItemContainer(s*this._itemWidth(),(()=>{On.move(this._$itemContainer,0),this._updateItems(i),H(this._$itemContainer)}))}_animateItemContainer(e,t){const{animationEnabled:i}=this.option(),n=i?200:0;io.moveTo(this._$itemContainer,e,n,t)}_animationDirection(e,t){const i=Cx(this._$itemContainer),n=this._getRTLSignCorrection()*this._getItemFocusLoopSignCorrection(),s=(t-e)*n;return Qn(i!==0?i:s)}_getSwipeDisabledState(){const{swipeEnabled:e}=this.option();return!e||this._itemsCount()<=1}_initSwipeable(){this._createComponent(this.$element(),rs,{disabled:this._getSwipeDisabledState(),elastic:!1,itemSizeFunc:this._itemWidth.bind(this),onStart:e=>{this._swipeStartHandler(e.event)},onUpdated:e=>{this._swipeUpdateHandler(e.event)},onEnd:e=>{this._swipeEndHandler(e.event)}})}_findBoundaryIndices(){const{items:e=[]}=this.option();let t,i;e.forEach(((n,s)=>{const o=!!(n!=null&&n.disabled),a=this._isItemVisible(s);!o&&a&&(t??(t=s),i=s)})),this._boundaryIndices={firstAvailableIndex:t??0,lastAvailableIndex:i??e.length-1,firstTrueIndex:0,lastTrueIndex:e.length-1}}_swipeStartHandler(e){io.complete(this._$itemContainer);const{selectedIndex:t,loop:i,rtlEnabled:n}=this.option();if(!m(t)||!m(this._boundaryIndices))return;const{firstAvailableIndex:s,lastAvailableIndex:o}=this._boundaryIndices,a=n?t>s:t<o,l=n?t<o:t>s;e.maxLeftOffset=Rl(!!i||a),e.maxRightOffset=Rl(!!i||l)}_swipeUpdateHandler(e){const{offset:t}=e,i=Qn(t)*this._getRTLSignCorrection(),{selectedIndex:n}=this.option();if(!m(n))return;const s=this._normalizeIndex(n-i,i);n!==s&&(On.move(this._$itemContainer,t*this._itemWidth()),this._updateItems(n,s))}_findNextAvailableIndex(e,t){if(!m(this._boundaryIndices))return e;const{items:i=[],loop:n}=this.option(),{firstAvailableIndex:s,lastAvailableIndex:o,firstTrueIndex:a,lastTrueIndex:l}=this._boundaryIndices,d=[a,s].includes(e),c=[l,o].includes(e);if(n){if(d&&t<0)return o;if(c&&t>0)return s}for(let u=e+t;u>=s&&u<=o;u+=t){const p=!!i[u].disabled,g=this._isItemVisible(u);if(!p&&g)return u}return e}_postprocessSwipe(e){}_swipeEndHandler(e){const t=e.targetOffset*this._getRTLSignCorrection();if(t){const{selectedIndex:i}=this.option();if(!m(i))return;const n=this._findNextAvailableIndex(i,-t);this.selectItem(n).fail((()=>{this._animateItemContainer(0,Ce)})).done((()=>{this._postprocessSwipe({swipedTabsIndex:n})}));const s=this.itemElements().filter(".dx-item-selected"),{focusStateEnabled:o}=this.option();o&&this.option("focusedElement",$(s))}else this._animateItemContainer(0,Ce)}_getItemFocusLoopSignCorrection(){return this._itemFocusLooped?-1:1}_moveFocus(e,t){super._moveFocus(e,t),this._itemFocusLooped=!1}_prevItem(e){const t=super._prevItem(e);return this._itemFocusLooped=t.is(e.last()),t}_nextItem(e){const t=super._nextItem(e);return this._itemFocusLooped=t.is(e.first()),t}_dimensionChanged(){this._clearItemWidthCache()}_visibilityChanged(e){e&&this._dimensionChanged()}_updateSwipeDisabledState(){const e=this._getSwipeDisabledState();rs.getInstance(this.$element()).option("disabled",e)}_dispose(){delete this._boundaryIndices,super._dispose()}_itemOptionChanged(e,t,i,n){super._itemOptionChanged(e,t,i,n);const{selectedItem:s}=this.option();t==="visible"&&e===s&&this._ensureSelectedItemIsVisible()}_optionChanged(e){const{value:t}=e;switch(e.name){case"loop":this.option("loopItemFocus",t);break;case"animationEnabled":break;case"swipeEnabled":this._updateSwipeDisabledState();break;case"deferRendering":this._invalidate();break;case"items":this._updateSwipeDisabledState(),this._findBoundaryIndices(),super._optionChanged(e);break;case"selectedIndex":this._isItemVisible(t)?super._optionChanged(e):this._ensureSelectedItemIsVisible();break;default:super._optionChanged(e)}}}_e("dxMultiView",hu);function pu(r){return r.scrollWidth-r.clientWidth}function vx(r){return r.scrollHeight-r.clientHeight}function xx(r,e){return Math.round(r)<=e}function wx(r,e,t){return Math.round(pu(r)-e)<=t}function bx(r,e){return Math.round(r)<=e}function yx(r,e,t,i){return Math.round(vx(r)-e-t)<=i}const Vl="dx-tabs-expanded";class Ix extends _s{_renderWatchers(){super._renderWatchers(),this._startWatcher("badge",this._renderBadge.bind(this))}_renderBadge(e){if(this._$element.children(".dx-badge").remove(),!e)return;const t=h("<div>").addClass("dx-tabs-item-badge").addClass("dx-badge").text(e);this._$element.append(t)}}const Sx="dx-tab-text",Ex="dx-tab-text-span",Tx="dx-tab-text-span-pseudo",Ol={vertical:"dx-tabs-vertical",horizontal:"dx-tabs-horizontal"},Fl={top:"dx-tab-indicator-position-top",right:"dx-tab-indicator-position-right",bottom:"dx-tab-indicator-position-bottom",left:"dx-tab-indicator-position-left"},Wi={top:"dx-tabs-icon-position-top",end:"dx-tabs-icon-position-end",bottom:"dx-tabs-icon-position-bottom",start:"dx-tabs-icon-position-start"},Al={primary:"dx-tabs-styling-mode-primary",secondary:"dx-tabs-styling-mode-secondary"},no={horizontal:"horizontal",vertical:"vertical"},Fn={right:"right",bottom:"bottom",left:"left"},Pl={horizontal:"horizontal",vertical:"vertical"},pi={top:"top",end:"end",bottom:"bottom",start:"start"},kl={primary:"primary",secondary:"secondary"};class wr extends Hd{_getDefaultOptions(){return T({},super._getDefaultOptions(),{hoverStateEnabled:!0,showNavButtons:!0,scrollByContent:!0,scrollingEnabled:!0,selectionMode:"single",orientation:no.horizontal,iconPosition:pi.start,stylingMode:kl.primary,activeStateEnabled:!0,selectionRequired:!1,selectOnFocus:!0,loopItemFocus:!1,useInkRipple:!1,badgeExpr:e=>e==null?void 0:e.badge,_itemAttributes:{role:"tab"},_indicatorPosition:null})}_defaultOptionsRules(){const e=Se();return super._defaultOptionsRules().concat([{device:()=>G.real().deviceType!=="desktop",options:{showNavButtons:!1}},{device:{deviceType:"desktop"},options:{scrollByContent:!1}},{device:()=>G.real().deviceType==="desktop"&&!G.isSimulator(),options:{focusStateEnabled:!0}},{device:()=>st(e),options:{iconPosition:pi.top,stylingMode:kl.secondary}},{device:()=>Fi(e),options:{useInkRipple:!0,selectOnFocus:!1,iconPosition:pi.top}}])}_init(){const{orientation:e,stylingMode:t,scrollingEnabled:i}=this.option(),n=this._getIndicatorPosition();super._init(),this._activeStateUnit=".dx-tab",this.setAria("role","tablist"),this.$element().addClass("dx-tabs"),this._toggleScrollingEnabledClass(i),this._toggleOrientationClass(e),this._toggleIndicatorPositionClass(n),this._toggleIconPositionClass(),this._toggleStylingModeClass(t),this._renderWrapper(),this._renderMultiple(),this._feedbackHideTimeout=100}_prepareDefaultItemTemplate(e,t){const i=ze(e)?e==null?void 0:e.text:e;if(m(i)){const n=h("<span>").addClass("dx-tab-text-span");n.text(i);const s=h("<span>").addClass("dx-tab-text-span-pseudo");s.text(i),s.appendTo(n),n.appendTo(t)}m(e.html)&&t.html(e.html)}_initTemplates(){super._initTemplates(),this._templateManager.addDefaultTemplates({item:new ir(((e,t)=>{this._prepareDefaultItemTemplate(t,e);const i=Ti(t.icon);i&&i.prependTo(e);const n=h("<div>").addClass("dx-tab-text");e.wrapInner(n)}),["text","html","icon"],this.option("integrationOptions.watchMethod"))})}_itemClass(){return"dx-tab"}_selectedItemClass(){return"dx-tab-selected"}_itemDataKey(){return"dxTabData"}_initMarkup(){super._initMarkup(),this.option("useInkRipple")&&this._renderInkRipple(),this.$element().addClass("dx-overflow-hidden"),this._attachResizeObserverSubscription()}_postProcessRenderItems(){this._renderScrolling()}_renderScrolling(){const e=["dx-tabs-stretched",Vl,"dx-overflow-hidden"];if(this.$element().removeClass(e.join(" ")),this.option("scrollingEnabled")&&this._isItemsSizeExceeded()){this._scrollable||(this._renderScrollable(),this._renderNavButtons());const t=this.getScrollable();if(t==null||t.update(),this.option("rtlEnabled")){const n=pu(h(this.getScrollable().container()).get(0));t==null||t.scrollTo({left:n})}this._updateNavButtonsState();const{selectedItem:i}=this.option();this._scrollToItem(i)}this.option("scrollingEnabled")&&this._isItemsSizeExceeded()||(this._cleanScrolling(),this._needStretchItems()&&this.$element().addClass("dx-tabs-stretched"),this.$element().removeClass("dx-tabs-nav-buttons").addClass(Vl))}_isVertical(){const{orientation:e}=this.option();return e===no.vertical}_isItemsSizeExceeded(){return this._isVertical()?this._isItemsHeightExceeded():this._isItemsWidthExceeded()}_isItemsWidthExceeded(){const e=this._getVisibleItems(),t=this._getSummaryItemsSize("width",e,!0),i=H(this.$element());return[t,i].includes(0)?!1:t>i-1}_isItemsHeightExceeded(){const e=this._getVisibleItems(),t=this._getSummaryItemsSize("height",e,!0),i=X(this.$element());return t-1>i}_needStretchItems(){const e=this._getVisibleItems(),t=H(this.$element()),i=[];x(e,((o,a)=>{i.push(ge(a,!0))}));const n=Math.max.apply(null,i),s=t/e.length;return n>s+1}_cleanNavButtons(){!this._leftButton||!this._rightButton||(this._leftButton.$element().remove(),this._rightButton.$element().remove(),this._leftButton=null,this._rightButton=null)}_cleanScrolling(){this._scrollable&&(this._$wrapper.appendTo(this.$element()),this._scrollable.$element().remove(),this._scrollable=null,this._cleanNavButtons())}_renderInkRipple(){this._inkRipple=Md()}_getPointerEvent(){return Z.up}_toggleActiveState(e,t,i){if(super._toggleActiveState(e,t,i),!this._inkRipple)return;const n={element:e,event:i};t?this._inkRipple.showWave(n):this._inkRipple.hideWave(n)}_renderMultiple(){const{selectionMode:e}=this.option();e==="multiple"&&this.option("selectOnFocus",!1)}_renderWrapper(){this._$wrapper=h("<div>").addClass("dx-tabs-wrapper"),this.$element().append(this._$wrapper)}_itemContainer(){return this._$wrapper}_getScrollableDirection(){return this._isVertical()?Pl.vertical:Pl.horizontal}_updateScrollable(){this.getScrollable()&&this._cleanScrolling(),this._renderScrolling()}_renderScrollable(){const e=this.$element().wrapInner(h("<div>").addClass("dx-tabs-scrollable")).children(),{scrollByContent:t}=this.option();this._scrollable=this._createComponent(e,it,{direction:this._getScrollableDirection(),showScrollbar:"never",useKeyboard:!1,useNative:!1,scrollByContent:t,onScroll:()=>{this._updateNavButtonsState()}}),this.$element().append(this._scrollable.$element())}_scrollToItem(e){if(!this._scrollable)return;const t=this._editStrategy.getItemElement(e);this._scrollable.scrollToElement(t)}_itemPointerHandler(e){this._handleItemFocus(e)}_itemPointerUpHandler(e){super._itemPointerHandler(e)}_renderNavButtons(){const{showNavButtons:e,rtlEnabled:t}=this.option();if(this.$element().toggleClass("dx-tabs-nav-buttons",e),!e)return;this._leftButton=this._createNavButton(-30,t?"chevronnext":"chevronprev");const i=this._leftButton.$element();i.addClass("dx-tabs-nav-button-left"),this.$element().prepend(i),this._rightButton=this._createNavButton(30,t?"chevronprev":"chevronnext");const n=this._rightButton.$element();n.addClass("dx-tabs-nav-button-right"),this.$element().append(n)}_updateNavButtonsAriaDisabled(){[this._leftButton,this._rightButton].forEach((t=>{t==null||t.$element().attr({"aria-disabled":null})}))}_updateNavButtonsState(){const e=this._isVertical(),t=this.getScrollable();if(e){var i,n;(i=this._leftButton)===null||i===void 0||i.option("disabled",bx(t.scrollTop(),1)),(n=this._rightButton)===null||n===void 0||n.option("disabled",yx(h(t.container()).get(0),t.scrollTop(),0,1))}else{var s,o;(s=this._leftButton)===null||s===void 0||s.option("disabled",xx(t.scrollLeft(),1)),(o=this._rightButton)===null||o===void 0||o.option("disabled",wx(h(t.container()).get(0),t.scrollLeft(),1))}this._updateNavButtonsAriaDisabled()}_updateScrollPosition(e,t){var i,n;(i=this._scrollable)===null||i===void 0||i.update(),(n=this._scrollable)===null||n===void 0||n.scrollBy(e/t)}_createNavButton(e,t){const i=this._createAction((()=>{this._holdInterval=setInterval((()=>{this._updateScrollPosition(e,5)}),5)})),n=V(Di.name,"dxNavButton"),s=V(Z.up,"dxNavButton"),o=V(Z.out,"dxNavButton"),a=this._createComponent(h("<div>").addClass("dx-tabs-nav-button"),Ze,{focusStateEnabled:!1,icon:t,integrationOptions:{},elementAttr:{role:null,"aria-label":null,"aria-disabled":null},onClick:()=>{this._updateScrollPosition(e,1)}}),l=a.$element();return v.on(l,n,{timeout:300},(d=>{i({event:d})})),v.on(l,s,(()=>{this._clearInterval()})),v.on(l,o,(()=>{this._clearInterval()})),a}_clearInterval(){this._holdInterval&&clearInterval(this._holdInterval)}_updateSelection(e){if(this._scrollable)return this._scrollable.scrollToElement(this.itemElements().eq(e[0]))}_visibilityChanged(e){e&&this._dimensionChanged()}_attachResizeObserverSubscription(){Ii.unobserve(this.$element().get(0)),Ii.observe(this.$element().get(0),(()=>{this._dimensionChanged()}))}_dimensionChanged(){this._renderScrolling()}_enterKeyHandler(e){const{focusedElement:t}=this.option();super._enterKeyHandler(e),this.option("focusedElement",t)}_itemSelectHandler(e){const{selectionMode:t}=this.option();t==="single"&&this.isItemSelected(e.currentTarget)||super._itemSelectHandler(e)}_clean(){Ii.unobserve(this.$element().get(0)),this._cleanScrolling(),super._clean()}_toggleTabsVerticalClass(e){this.$element().toggleClass(Ol.vertical,e)}_toggleTabsHorizontalClass(e){this.$element().toggleClass(Ol.horizontal,e)}_getIndicatorPositionClass(e){return Fl[e]}_getIndicatorPosition(){const{_indicatorPosition:e,rtlEnabled:t}=this.option();if(e)return e;const i=this._isVertical();return t?i?Fn.left:Fn.bottom:i?Fn.right:Fn.bottom}_toggleIndicatorPositionClass(e){const t=this._getIndicatorPositionClass(e);this._toggleElementClasses(Fl,t)}_toggleScrollingEnabledClass(e){this.$element().toggleClass("dx-tabs-scrolling-enabled",!!e)}_toggleOrientationClass(e){const t=e===no.vertical;this._toggleTabsVerticalClass(t),this._toggleTabsHorizontalClass(!t)}_getTabsIconPositionClass(){const{iconPosition:e}=this.option();switch(e){case pi.top:return Wi.top;case pi.end:return Wi.end;case pi.bottom:return Wi.bottom;default:return Wi.start}}_toggleIconPositionClass(){const e=this._getTabsIconPositionClass();this._toggleElementClasses(Wi,e)}_toggleStylingModeClass(e){const t=Al[e??"primary"];this._toggleElementClasses(Al,t)}_toggleElementClasses(e,t){for(const i in e)this.$element().removeClass(e[i]);this.$element().addClass(t)}_toggleFocusedDisabledNextClass(e,t){this._itemElements().eq(e).toggleClass("dx-focused-disabled-next-tab",t)}_toggleFocusedDisabledPrevClass(e,t){this._itemElements().eq(e).toggleClass("dx-focused-disabled-prev-tab",t)}_toggleFocusedDisabledClasses(e){const{selectedIndex:t}=this.option();this._itemElements().removeClass("dx-focused-disabled-next-tab").removeClass("dx-focused-disabled-prev-tab");const i=t-1,n=t+1,s=h(e).index(),o=this._itemElements().eq(n).hasClass("dx-state-disabled"),a=this._itemElements().eq(i).hasClass("dx-state-disabled"),l=o&&s===n,d=a&&s===i;this._toggleFocusedDisabledNextClass(t,l),this._toggleFocusedDisabledPrevClass(t,d)}_updateFocusedElement(){const{focusStateEnabled:e,selectedIndex:t}=this.option(),i=this._itemElements();if(e&&i.length){const n=i.get(t);this.option({focusedElement:n})}}_optionChanged(e){var t;const{name:i,value:n}=e;switch(i){case"useInkRipple":case"scrollingEnabled":this._toggleScrollingEnabledClass(n),this._invalidate();break;case"showNavButtons":case"badgeExpr":this._invalidate();break;case"scrollByContent":(t=this._scrollable)===null||t===void 0||t.option(i,n);break;case"width":case"height":super._optionChanged(e),this._dimensionChanged();break;case"selectionMode":this._renderMultiple(),super._optionChanged(e);break;case"focusedElement":this._toggleFocusedDisabledClasses(h(n)),super._optionChanged(e),this._scrollToItem(n);break;case"rtlEnabled":{super._optionChanged(e);const s=this._getIndicatorPosition();this._toggleIndicatorPositionClass(s);break}case"orientation":{this._toggleOrientationClass(n);const s=this._getIndicatorPosition();this._toggleIndicatorPositionClass(s),pe()&&this._updateScrollable();break}case"iconPosition":this._toggleIconPositionClass(),pe()&&this._dimensionChanged();break;case"stylingMode":this._toggleStylingModeClass(n),pe()&&this._dimensionChanged();break;case"_indicatorPosition":{const s=this._getIndicatorPosition();this._toggleIndicatorPositionClass(s);break}case"selectedIndex":case"selectedItem":case"selectedItems":super._optionChanged(e),this._updateFocusedElement();break;default:super._optionChanged(e)}}_afterItemElementInserted(){super._afterItemElementInserted(),this._planPostRenderActions()}_afterItemElementDeleted(e,t){super._afterItemElementDeleted(e,t),this._renderScrolling()}getScrollable(){return this._scrollable}}wr.ItemClass=Ix;_e("dxTabs",wr);class Dx extends _s{_renderWatchers(){this._startWatcher("badge",Ce),super._renderWatchers()}}const gi={top:"dx-tabpanel-tabs-position-top",right:"dx-tabpanel-tabs-position-right",bottom:"dx-tabpanel-tabs-position-bottom",left:"dx-tabpanel-tabs-position-left"},St={top:"top",right:"right",bottom:"bottom",left:"left"},Rx={top:"bottom",right:"left",bottom:"top",left:"right"},Ml={horizontal:"horizontal",vertical:"vertical"},Bl={top:"top",start:"start"},Nl={primary:"primary",secondary:"secondary"};class br extends hu{_getDefaultOptions(){return T({},super._getDefaultOptions(),{itemTitleTemplate:"title",hoverStateEnabled:!0,selectOnFocus:!1,showNavButtons:!1,scrollByContent:!0,scrollingEnabled:!0,tabsPosition:St.top,iconPosition:Bl.start,stylingMode:Nl.primary,onTitleClick:null,onTitleHold:null,onTitleRendered:null,badgeExpr:e=>e==null?void 0:e.badge,_tabsIndicatorPosition:null})}_defaultOptionsRules(){const e=Se();return super._defaultOptionsRules().concat([{device:()=>G.real().deviceType==="desktop"&&!G.isSimulator(),options:{focusStateEnabled:!0}},{device:()=>!hs.touch,options:{swipeEnabled:!1}},{device:{platform:"generic"},options:{animationEnabled:!1}},{device:()=>st(e),options:{stylingMode:Nl.secondary}},{device:()=>Cs(e),options:{iconPosition:Bl.top}}])}_init(){super._init(),this.$element().addClass("dx-tabpanel"),this._toggleTabPanelTabsPositionClass()}_getElementAria(){return{role:"tabpanel"}}_getItemAria(){return{role:"tabpanel"}}_initMarkup(){super._initMarkup(),this._createTitleActions(),this._renderLayout()}_prepareTabsItemTemplate(e,t){const i=Ti(e==null?void 0:e.icon);i&&t.append(i);const n=ze(e)?e==null?void 0:e.title:e;if(m(n)&&!ze(n)){const s=h("<span>").addClass(Ex);s.append(M.createTextNode(n));const o=h("<span>").addClass(Tx);o.append(M.createTextNode(n)),o.appendTo(s),s.appendTo(t)}}_initTemplates(){super._initTemplates(),this._templateManager.addDefaultTemplates({title:new ir(((e,t)=>{this._prepareTabsItemTemplate(t,e);const i=h("<div>").addClass(Sx);e.wrapInner(i)}),["title","icon"],this.option("integrationOptions.watchMethod"))})}_createTitleActions(){this._createTitleClickAction(),this._createTitleHoldAction(),this._createTitleRenderedAction()}_createTitleClickAction(){this._titleClickAction=this._createActionByOption("onTitleClick")}_createTitleHoldAction(){this._titleHoldAction=this._createActionByOption("onTitleHold")}_createTitleRenderedAction(){this._titleRenderedAction=this._createActionByOption("onTitleRendered")}_renderLayout(){if(this._tabs)return;const e=this.$element();this._$tabContainer=h("<div>").addClass("dx-tabpanel-tabs").appendTo(e);const t=h("<div>").appendTo(this._$tabContainer);this._tabs=this._createComponent(t,wr,this._tabConfig()),this._$container=h("<div>").addClass("dx-tabpanel-container").appendTo(e),this._$container.append(this._$wrapper);const{focusStateEnabled:i,selectedIndex:n}=this.option();if(i&&m(n)){const s=this._tabs.itemElements().get(n);s&&this._tabs.option({focusedElement:s})}}_refreshActiveDescendant(){if(!this._tabs)return;const e=this._tabs,t=e.itemElements(),i=h(t[e.option("selectedIndex")]),n=this.getFocusedItemId();this.setAria("controls",void 0,h(t)),this.setAria("controls",n,i)}_getTabsIndicatorPosition(){const{_tabsIndicatorPosition:e,tabsPosition:t}=this.option();return e??Rx[t??St.top]}_tabConfig(){const e=this._getTabsIndicatorPosition(),{focusStateEnabled:t,hoverStateEnabled:i,repaintChangesOnly:n,tabIndex:s,selectedIndex:o,badgeExpr:a,itemHoldTimeout:l,items:d,scrollingEnabled:c,scrollByContent:u,showNavButtons:p,loop:g,iconPosition:_,stylingMode:f}=this.option();return{selectOnFocus:!0,focusStateEnabled:t,hoverStateEnabled:i,repaintChangesOnly:n,tabIndex:s,selectedIndex:o,badgeExpr:a,onItemClick:this._titleClickAction.bind(this),onItemHold:this._titleHoldAction.bind(this),itemHoldTimeout:l,onSelectionChanging:C=>{const I=C.addedItems[0],E=this._getIndexByItemData(I),D=this.selectItem(E),k=D.state();if(k!=="pending"){C.cancel=k==="rejected";return}C.cancel=new Promise((A=>{D.done((()=>{A(!1)})).fail((()=>{A(!0)}))}))},onSelectionChanged:()=>{this._refreshActiveDescendant()},onItemRendered:this._titleRenderedAction.bind(this),itemTemplate:this._getTemplateByOption("itemTitleTemplate"),items:d,noDataText:null,scrollingEnabled:c,scrollByContent:u,showNavButtons:p,itemTemplateProperty:"tabTemplate",loopItemFocus:g,selectionRequired:!0,onOptionChanged:C=>{if(C.name==="focusedElement")if(C.value){const I=h(C.value),E=this._itemElements().eq(I.index());this.option("focusedElement",$(E))}else this.option("focusedElement",C.value)},onFocusIn:C=>{this._focusInHandler(C.event)},onFocusOut:C=>{this._isFocusOutHandlerExecuting||this._focusOutHandler(C.event)},orientation:this._getTabsOrientation(),iconPosition:_,stylingMode:f,_itemAttributes:{class:"dx-tabpanel-tab"},_indicatorPosition:e}}_renderFocusTarget(){this._focusTarget().attr("tabIndex",-1)}_getTabsOrientation(){const{tabsPosition:e}=this.option();return[St.right,St.left].includes(e)?Ml.vertical:Ml.horizontal}_getTabPanelTabsPositionClass(){const{tabsPosition:e}=this.option();switch(e){case St.right:return gi.right;case St.bottom:return gi.bottom;case St.left:return gi.left;case St.top:default:return gi.top}}_toggleTabPanelTabsPositionClass(){for(const t in gi)this.$element().removeClass(gi[t]);const e=this._getTabPanelTabsPositionClass();this.$element().addClass(e)}_updateTabsOrientation(){const e=this._getTabsOrientation();this._setTabsOption("orientation",e)}_toggleWrapperFocusedClass(e){this._toggleFocusClass(e,this._$wrapper)}_toggleDisabledFocusedClass(e){this._focusTarget().toggleClass("dx-disabled-focused-tab",e)}_updateFocusState(e,t){super._updateFocusState(e,t);const i=e.target===this._tabs._focusTarget().get(0),n=e.target===this._focusTarget().get(0);if(i&&this._toggleFocusClass(t,this._focusTarget()),i||n){const s=this._isDisabled(this.option("focusedElement"));this._toggleWrapperFocusedClass(t&&!s),this._toggleDisabledFocusedClass(t&&s)}n&&(this._toggleFocusClass(t,this._tabs.$element()),this._toggleFocusClass(t,this._tabs.option("focusedElement")))}_focusOutHandler(e){this._isFocusOutHandlerExecuting=!0,super._focusOutHandler(e),this._tabs._focusOutHandler(e),this._isFocusOutHandlerExecuting=!1}_setTabsOption(e,t){this._tabs&&this._tabs.option(e,t)}_postprocessSwipe(e){this._setTabsOption("selectedIndex",e.swipedTabsIndex)}_visibilityChanged(e){e&&this._tabs._dimensionChanged()}registerKeyHandler(e,t){super.registerKeyHandler(e,t),this._tabs&&this._tabs.registerKeyHandler(e,t)}repaint(){super.repaint(),this._tabs.repaint()}_updateTabsIndicatorPosition(){const e=this._getTabsIndicatorPosition();this._setTabsOption("_indicatorPosition",e)}_optionChanged(e){const{name:t,value:i,fullName:n}=e;switch(t){case"dataSource":default:super._optionChanged(e);break;case"items":this._setTabsOption(t,this.option(t)),this.option("repaintChangesOnly")||this._tabs.repaint(),super._optionChanged(e);break;case"width":super._optionChanged(e),this._tabs.repaint();break;case"selectedIndex":case"selectedItem":{this._setTabsOption(n,i),super._optionChanged(e);const{focusStateEnabled:s}=this.option();if(s===!0){const o=this.option("selectedIndex"),a=this._itemElements().eq(o);this.option("focusedElement",$(a))}break}case"itemHoldTimeout":case"focusStateEnabled":case"hoverStateEnabled":this._setTabsOption(n,i),super._optionChanged(e);break;case"scrollingEnabled":case"scrollByContent":case"showNavButtons":this._setTabsOption(n,i);break;case"focusedElement":{const s=i&&h(i).index(),o=i&&this._tabs?this._tabs._itemElements().eq(s):i;if(this._setTabsOption("focusedElement",$(o)),i){const a=this._isDisabled(i);this._toggleWrapperFocusedClass(!a),this._toggleDisabledFocusedClass(a)}super._optionChanged(e);break}case"itemTitleTemplate":this._setTabsOption("itemTemplate",this._getTemplateByOption("itemTitleTemplate"));break;case"onTitleClick":this._createTitleClickAction(),this._setTabsOption("onItemClick",this._titleClickAction.bind(this));break;case"onTitleHold":this._createTitleHoldAction(),this._setTabsOption("onItemHold",this._titleHoldAction.bind(this));break;case"onTitleRendered":this._createTitleRenderedAction(),this._setTabsOption("onItemRendered",this._titleRenderedAction.bind(this));break;case"loop":this._setTabsOption("loopItemFocus",i),super._optionChanged(e);break;case"badgeExpr":this._invalidate();break;case"tabsPosition":this._toggleTabPanelTabsPositionClass(),this._updateTabsIndicatorPosition(),this._updateTabsOrientation();break;case"iconPosition":this._setTabsOption("iconPosition",i);break;case"stylingMode":this._setTabsOption("stylingMode",i);break;case"_tabsIndicatorPosition":this._setTabsOption("_indicatorPosition",i)}}}br.ItemClass=Dx;_e("dxTabPanel",br);const Vx=["items","isRequired","validationRules","visible"];class yr extends Lt{_init(){super._init(),this._dirtyFields=new Set,this._cachedColCountOptions=[],this._itemsRunTimeInfo=new du,this._groupsColCount=[],this._attachSyncSubscriptions()}_getDefaultOptions(){return T({},super._getDefaultOptions(),{formID:`dx-${new Te}`,formData:{},colCount:1,screenByWidth:Sd,labelLocation:"left",readOnly:!1,onFieldDataChanged:null,customizeItem:null,onEditorEnterKey:null,minColWidth:200,alignItemLabels:!0,alignItemLabelsInAllGroups:!0,alignRootItemLabels:!0,showColonAfterLabel:!0,showRequiredMark:!0,showOptionalMark:!1,requiredMark:"*",optionalMark:w.format("dxForm-optionalMark"),requiredMessage:w.getFormatter("dxForm-requiredMessage"),showValidationSummary:!1,scrollingEnabled:!1,stylingMode:gs().editorStylingMode,labelMode:"outside",isDirty:!1})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:()=>Cs(Se()),options:{labelLocation:"top"}},{device:()=>Fi(Se()),options:{showColonAfterLabel:!1}}])}_setOptionsByReference(){super._setOptionsByReference(),b(this._optionsByReference,{formData:!0,validationGroup:!0})}_getGroupColCount(e){return parseInt(e.attr(wl)??"1",10)}_applyLabelsWidthByCol(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=i!=null&&i.inOneColumn?iu:fl+t,s=i!=null&&i.excludeTabbed?`:not(.${vl})`:"";tx(e,`.${n}${s}`)}_applyLabelsWidth(e,t,i,n){const s={excludeTabbed:t,inOneColumn:i},o=i?1:n??this._getGroupColCount(e);for(let a=0;a<o;a+=1)this._applyLabelsWidthByCol(e,a,s)}_getGroupElementsInColumn(e,t,i){const n=m(i)?`.${xl}${i}`:"",s=`.${fl}${t} > .${No} > .${to}${n}`;return e.find(s)}_applyLabelsWidthWithGroups(e,t,i){const{alignRootItemLabels:n}=this.option();if(n===!0){const o=e.find(`.${ou}`);for(let a=0;a<t;a+=1)this._applyLabelsWidthByCol(o,a)}if(this.option("alignItemLabelsInAllGroups"))this._applyLabelsWidthWithNestedGroups(e,t,i);else{const o=this.$element().find(`.${to}`);for(let a=0;a<o.length;a+=1)this._applyLabelsWidth(o.eq(a),i,!1,void 0)}}_applyLabelsWidthWithNestedGroups(e,t,i){const n={excludeTabbed:i};for(let s=0;s<t;s+=1){const o=this._getGroupElementsInColumn(e,s);this._applyLabelsWidthByCol(o,0,n);for(let a=0;a<this._groupsColCount.length;a+=1){const l=this._getGroupElementsInColumn(e,s,this._groupsColCount[a]),d=this._getGroupColCount(l);for(let c=1;c<d;c+=1)this._applyLabelsWidthByCol(l,c,n)}}}_labelLocation(){const{labelLocation:e}=this.option();return e}_alignLabelsInColumn(e){const{layoutManager:t,inOneColumn:i,$container:n,excludeTabbed:s,items:o}=e;!pe()||this._labelLocation()==="top"||(i?this._applyLabelsWidth(n,s,!0,void 0):this._checkGrouping(o)?this._applyLabelsWidthWithGroups(n,t._getColCount(),s):this._applyLabelsWidth(n,s,!1,t._getColCount()))}_prepareFormData(){m(this.option("formData"))||this.option("formData",{})}_setStylingModeClass(){const{stylingMode:e}=this.option();e==="underlined"&&this.$element().addClass(Lv)}_initMarkup(){he.addGroup(this._getValidationGroup(),!1),this._clearCachedInstances(),this._prepareFormData(),this.$element().addClass(Rv),this._setStylingModeClass(),super._initMarkup(),this.setAria("role","form",this.$element());const{scrollingEnabled:e}=this.option();e&&this._renderScrollable(),this._renderLayout(),this._renderValidationSummary(),this._lastMarkupScreenFactor=this._targetScreenFactor||this._getCurrentScreenFactor(),this._attachResizeObserverSubscription()}_attachResizeObserverSubscription(){if(pe()){const e=this.$element().get(0);Ii.unobserve(e),Ii.observe(e,(()=>{this._resizeHandler()}))}}_resizeHandler(){this._cachedLayoutManagers.length&&x(this._cachedLayoutManagers,((e,t)=>{const{onLayoutChanged:i}=t.option();i==null||i(t.isSingleColumnMode())}))}_getCurrentScreenFactor(){const{screenByWidth:e}=this.option();return pe()?Ed(e):"lg"}_clearCachedInstances(){this._itemsRunTimeInfo.clear(),this._cachedLayoutManagers=[]}_alignLabels(e,t){const{items:i}=this.option();this._alignLabelsInColumn({$container:this.$element(),layoutManager:e,excludeTabbed:!0,items:i,inOneColumn:t}),Td(this.$element().find(`.${Bp}`))}_clean(){this._clearValidationSummary(),super._clean(),this._groupsColCount=[],this._cachedColCountOptions=[],this._lastMarkupScreenFactor=void 0,Ii.unobserve(this.$element().get(0))}_renderScrollable(){const e=this.option("useNativeScrolling");this._scrollable=new it(this.$element(),{useNative:!!e,useSimulatedScrollbar:!e,useKeyboard:!1,direction:"both",bounceEnabled:!1})}_getContent(){var e;const{scrollingEnabled:t}=this.option();return t?h((e=this._scrollable)===null||e===void 0?void 0:e.content()):this.$element()}_clearValidationSummary(){var e;(e=this._$validationSummary)===null||e===void 0||e.remove(),this._$validationSummary=void 0,this._validationSummary=void 0}_renderValidationSummary(){this._clearValidationSummary();const{showValidationSummary:e}=this.option();e&&(this._$validationSummary=h("<div>").addClass(Nv).appendTo(this._getContent()),this._validationSummary=super._createComponent(this._$validationSummary,xr,{validationGroup:this._getValidationGroup()}))}_prepareItems(e,t,i,n){if(e){const s=[];for(let o=0;o<e.length;o+=1){let a=e[o];const l=ru(i,$o(o,n)),d={item:a,itemIndex:o,path:l},c=this._itemsRunTimeInfo.add(d);if(W(a)&&(a={dataField:a}),L(a)){const u=T({},a);d.preparedItem=u,u.guid=c,this._tryPrepareGroupItemCaption(u),this._tryPrepareGroupItem(u),this._tryPrepareTabbedItem(u,l),this._tryPrepareItemTemplate(u),t&&(u.cssItemClass=vl),u.items&&(u.items=this._prepareItems(u.items,t,l)),s.push(u)}else s.push(a)}return s}return e}_isGroupItem(e){return e.itemType==="group"}_tryPrepareGroupItemCaption(e){this._isGroupItem(e)&&(e._prepareGroupCaptionTemplate=t=>{e.captionTemplate&&(e.groupCaptionTemplate=this._getTemplate(t)),e.captionTemplate=this._itemGroupTemplate.bind(this,e)},e._prepareGroupCaptionTemplate(e.captionTemplate))}_tryPrepareGroupItem(e){this._isGroupItem(e)&&(e.alignItemLabels=We(e.alignItemLabels,!0),e._prepareGroupItemTemplate=t=>{e.template&&(e.groupContentTemplate=this._getTemplate(t)),e.template=this._itemGroupTemplate.bind(this,e)},e._prepareGroupItemTemplate(e.template))}_isTabbedItem(e){return e.itemType==="tabbed"}_tryPrepareTabbedItem(e,t){this._isTabbedItem(e)&&(e.template=this._itemTabbedTemplate.bind(this,e),e.tabs=this._prepareItems(e.tabs,!0,t,!0))}_tryPrepareItemTemplate(e){e.template&&(e.template=this._getTemplate(e.template))}_checkGrouping(e){if(e){for(let t=0;t<e.length;t+=1)if(e[t].itemType==="group")return!0}return!1}_renderLayout(){const{items:e}=this.option(),t=this._getContent(),i=this._prepareItems(e),{colCount:n,alignItemLabels:s,screenByWidth:o,colCountByScreen:a}=this.option();this._rootLayoutManager=this._renderLayoutManager(t,this._createLayoutManagerOptions(i,{isRoot:!0,colCount:n,alignItemLabels:s,screenByWidth:o,colCountByScreen:a,onLayoutChanged:l=>{this._alignLabels.bind(this)(this._rootLayoutManager,l)},onContentReady:l=>{this._alignLabels(l.component,l.component.isSingleColumnMode())}}))}_tryGetItemsForTemplate(e){return e.items??[]}_itemTabbedTemplate(e,t,i){const n=h("<div>").appendTo(i),s=T({},e.tabPanelOptions,{dataSource:e.tabs,onItemRendered:l=>{var d,c;(d=e.tabPanelOptions)===null||d===void 0||(c=d.onItemRendered)===null||c===void 0||c.call(d,l),Kh(l.itemElement)},itemTemplate:(l,d,c)=>{const{screenByWidth:u}=this.option(),p=h(c),g=We(l.alignItemLabels,!0),_=this._renderLayoutManager(p,this._createLayoutManagerOptions(this._tryGetItemsForTemplate(l),{colCount:l.colCount,alignItemLabels:g,screenByWidth:u,colCountByScreen:l.colCountByScreen,cssItemClass:l.cssItemClass,onLayoutChanged:f=>{this._alignLabelsInColumn({$container:h(c),layoutManager:_,items:l.items,inOneColumn:f,excludeTabbed:!1})}}));this._itemsRunTimeInfo&&this._itemsRunTimeInfo.extendRunTimeItemInfoByKey(l.guid??"",{layoutManager:_}),g&&this._alignLabelsInColumn({$container:p,layoutManager:_,items:l.items,inOneColumn:_.isSingleColumnMode(),excludeTabbed:!1})}}),o=(l,d)=>{Array.isArray(l)&&l.forEach((c=>this._itemsRunTimeInfo.extendRunTimeItemInfoByKey(c.guid??"",{widgetInstance:d})))},a=this._createComponent(n,br,s);h(i).parent().addClass(Mv),a.on("optionChanged",(l=>{const{fullName:d,value:c,component:u}=l;d==="dataSource"&&o(c,u)})),o([{guid:e.guid},...e.tabs??[]],a)}_itemGroupCaptionTemplate(e,t,i){if(e.groupCaptionTemplate){const n=h("<div>").addClass(Ov).attr("id",i).appendTo(t);e._renderGroupCaptionTemplate=()=>{var s;const o={component:this,caption:e.caption,name:e.name};(s=e.groupCaptionTemplate)===null||s===void 0||s.render({model:o,container:$(n)})},e._renderGroupCaptionTemplate();return}e.caption&&h("<span>").addClass(Vv).text(e.caption).attr("id",i).appendTo(t)}_itemGroupContentTemplate(e,t){const i=h("<div>").addClass(Pv).appendTo(t);if(e.groupContentTemplate)e._renderGroupContentTemplate=()=>{var s;i.empty();const o={formData:this.option("formData"),component:this};(s=e.groupContentTemplate)===null||s===void 0||s.render({model:o,container:$(i)})},e._renderGroupContentTemplate();else{var n;const s=this._renderLayoutManager(i,this._createLayoutManagerOptions(this._tryGetItemsForTemplate(e),{colCount:e.colCount,colCountByScreen:e.colCountByScreen,alignItemLabels:e.alignItemLabels,cssItemClass:e.cssItemClass}));(n=this._itemsRunTimeInfo)===null||n===void 0||n.extendRunTimeItemInfoByKey(e.guid??"",{layoutManager:s});const o=s._getColCount();this._groupsColCount.includes(o)||this._groupsColCount.push(o),t.addClass(xl+o),t.attr(wl,o)}}_itemGroupTemplate(e,t,i){var n;const{id:s}=t.editorOptions.inputAttr,o=h("<div>").toggleClass(Bv,!!((n=e.caption)!==null&&n!==void 0&&n.length)).addClass(to).appendTo(i),a={role:"group",labelledby:s};this.setAria(a,o),h(i).parent().addClass(kv),this._itemGroupCaptionTemplate(e,o,s),this._itemGroupContentTemplate(e,o)}_createLayoutManagerOptions(e,t){return sx({form:this,formOptions:this.option(),$formElement:this.$element(),items:e,validationGroup:this._getValidationGroup(),extendedLayoutManagerOptions:t,onFieldDataChanged:i=>{this._isDataUpdating||this._triggerOnFieldDataChanged(i)},onContentReady:i=>{var n;this._itemsRunTimeInfo.addItemsOrExtendFrom(i.component._itemsRunTimeInfo),(n=t.onContentReady)===null||n===void 0||n.call(t,i)},onDisposing:i=>{const{component:n}=i,s=n.getItemsRunTimeInfo();this._itemsRunTimeInfo.removeItemsByItems(s)},onFieldItemRendered:()=>{var i;(i=this._validationSummary)===null||i===void 0||i.refreshValidationGroup()}})}_renderLayoutManager(e,t){const i={lg:t.colCount,md:t.colCount,sm:t.colCount,xs:1};this._cachedColCountOptions.push({colCountByScreen:b(i,t.colCountByScreen)});const n=h("<div>");n.appendTo(e);const s=this._createComponent(n,uu,t);return s.on("autoColCountChanged",(()=>{this._clearAutoColCountChangedTimeout(),this.autoColCountChangedTimeoutId=setTimeout((()=>!this._disposed&&this._refresh()),0)})),this._cachedLayoutManagers.push(s),s}_getValidationGroup(){const{validationGroup:e}=this.option();return e??this}_createComponent(e,t,i){const{readOnly:n}=this.option();return this._extendConfig(i??{},{readOnly:n}),super._createComponent(e,t,i)}_attachSyncSubscriptions(){this.on("optionChanged",(e=>{const{fullName:t,name:i}=e;t==="formData"&&(m(e.value)||this._options.silent("formData",e.value={}),this._triggerOnFieldDataChangedByDataSet(e.value)),this._cachedLayoutManagers.length&&x(this._cachedLayoutManagers,((n,s)=>{t==="formData"&&(this._isDataUpdating=!0,s.option("layoutData",e.value),this._isDataUpdating=!1),(i==="readOnly"||i==="disabled")&&s.option(t,e.value)}))}))}_optionChanged(e){const{fullName:t}=e,i=t.split(".");i.length>1&&i[0].search("items")!==-1&&this._itemsOptionChangedHandler(e)||i.length>1&&i[0].search("formData")!==-1&&this._formDataOptionChangedHandler(e)||this._defaultOptionChangedHandler(e)}_defaultOptionChangedHandler(e){switch(e.name){case"formData":this.option("items")?nt(e.value)&&this._clear():this._invalidate();break;case"onFieldDataChanged":case"alignRootItemLabels":case"readOnly":case"isDirty":break;case"items":case"colCount":case"onEditorEnterKey":case"labelLocation":case"labelMode":case"alignItemLabels":case"showColonAfterLabel":case"customizeItem":case"alignItemLabelsInAllGroups":case"showRequiredMark":case"showOptionalMark":case"requiredMark":case"optionalMark":case"requiredMessage":case"scrollingEnabled":case"formID":case"colCountByScreen":case"screenByWidth":case"stylingMode":this._invalidate();break;case"showValidationSummary":this._renderValidationSummary();break;case"minColWidth":{const{colCount:t}=this.option();t==="auto"&&this._invalidate();break}case"width":super._optionChanged(e),this._rootLayoutManager.option(e.name,e.value),this._alignLabels(this._rootLayoutManager,this._rootLayoutManager.isSingleColumnMode());break;case"validationGroup":he.removeGroup(e.previousValue||this),this._invalidate();break;default:super._optionChanged(e)}}_itemsOptionChangedHandler(e){const{value:t,fullName:i}=e,n=i.split("."),s=this._getItemPath(n),o=this.option(s),a=i.replace(`${s}.`,""),l=a.split(".")[0].replace(/\[\d+]/,""),d=this._tryCreateItemOptionAction(l,o,o[l],e.previousValue,s);let c=this._tryExecuteItemOptionAction(d)??this._tryChangeLayoutManagerItemOption(i,t);if(!c&&o){this._changeItemOption(o,a,t);const{items:u}=this.option(),p=this._generateItemsFromData(u);this.option("items",p),c=!0}return c}_formDataOptionChangedHandler(e){const t=e.fullName.split("."),{value:i}=e,n=t.slice(1).join("."),s=this.getEditor(n);return s?s.option("value",i):this._triggerOnFieldDataChanged({dataField:n,value:i}),!0}_tryCreateItemOptionAction(e,t,i,n,s){let o=i;return e==="tabs"&&(this._itemsRunTimeInfo.removeItemsByPathStartWith(`${s}.tabs`),o=this._prepareItems(o,!0,s,!0)),ux(e,{item:t,value:o,previousValue:n,itemsRunTimeInfo:this._itemsRunTimeInfo})}_tryExecuteItemOptionAction(e){return e==null?void 0:e.tryExecute()}_updateValidationGroupAndSummaryIfNeeded(e){const t=bl(e);if(Vx.includes(t)&&(he.addGroup(this._getValidationGroup(),!1),this.option("showValidationSummary"))){var i;(i=this._validationSummary)===null||i===void 0||i.refreshValidationGroup()}}_setLayoutManagerItemOption(e,t,i,n){if(this._updateLockCount>0){e._updateLockCount||e.beginUpdate();const o=this._itemsRunTimeInfo.findKeyByPath(n);this.postponedOperations.add(o,(()=>(e._disposed||e.endUpdate(),S().resolve())))}const s=o=>{if(o.component.off("contentReady",s),au(n)){const a=nx(n),l=this._itemsRunTimeInfo.findGroupOrTabLayoutManagerByPath(a);if(l){const{items:d}=l.option();this._alignLabelsInColumn({items:d,layoutManager:l,$container:l.$element(),inOneColumn:l.isSingleColumnMode(),excludeTabbed:!1})}}else this._alignLabels(this._rootLayoutManager,this._rootLayoutManager.isSingleColumnMode())};e.on("contentReady",s),e.option(t,i),this._updateValidationGroupAndSummaryIfNeeded(t)}_tryChangeLayoutManagerItemOption(e,t){const i=e.split("."),n=bl(e);if(n==="items"&&i.length>1){const s=this._getItemPath(i),o=this._itemsRunTimeInfo.findGroupOrTabLayoutManagerByPath(s);if(o){this._itemsRunTimeInfo.removeItemsByItems(o.getItemsRunTimeInfo());const a=this._prepareItems(t,!1,s);return this._setLayoutManagerItemOption(o,n,a,s),!0}}else if(i.length>2){const s=i.length-2,o=this._getItemPath(i.slice(0,s)),a=this._itemsRunTimeInfo.findGroupOrTabLayoutManagerByPath(o);if(a){const l=Yi(i[s],n);if(n==="editorType"&&a.option(l)!==t)return!1;if(n==="visible"){const d=this.option(Yi(o,"items"));if(d!=null&&d.length){const{items:c}=a.option();d.forEach(((u,p)=>{const g=c[p];g.visibleIndex=u.visibleIndex}))}}return this._setLayoutManagerItemOption(a,l,t,o),!0}}return!1}_tryChangeLayoutManagerItemOptions(e,t){let i=!1;return this.beginUpdate(),x(t,((n,s)=>(i=this._tryChangeLayoutManagerItemOption(Yi(e,n),s),!!i))),this.endUpdate(),i}_getItemPath(e){let t=e[0];for(let i=1;i<e.length&&e[i].search(/items\[\d+]|tabs\[\d+]/)!==-1;i+=1)t+=`.${e[i]}`;return t}_triggerOnFieldDataChanged(e){this._updateIsDirty(e.dataField??""),this._createActionByOption("onFieldDataChanged")(e)}_triggerOnFieldDataChangedByDataSet(e){e&&L(e)&&Object.keys(e).forEach((t=>{this._triggerOnFieldDataChanged({dataField:t,value:e[t]})}))}_updateFieldValue(e,t){const{formData:i}=this.option();if(m(i)){const n=this.getEditor(e);this.option(`formData.${e}`,t),n&&n.option("value")!==t&&n.option("value",t)}}_generateItemsFromData(e){const{formData:t}=this.option(),i=[];return!e&&m(t)&&x(t,(n=>{i.push({dataField:n})})),e&&x(e,((n,s)=>{L(s)?i.push(s):i.push({dataField:s})})),i}_getItemByField(e,t){const i=L(e)?e:this._getFieldParts(e),{fieldName:n}=i,{fieldPath:s}=i;let o=!1;return t.length&&x(t,((a,l)=>{const{itemType:d}=l;if(s.length){const c=s.slice();l=this._getItemByFieldPath(c,n,l)}else if(this._isGroupItem(l)&&!(l.caption||l.name)||d==="tabbed"&&!l.name){const c=this._getSubItemField(d);l.items=this._generateItemsFromData(l.items),l=this._getItemByField({fieldName:n,fieldPath:s},l[c])}return ix(l,n)?(o=l,!1):!0})),o}_getFieldParts(e){let t=e,i=t.indexOf(".");const n=[];for(;i!==-1;)n.push(t.substr(0,i)),t=t.substr(i+1),i=t.indexOf(".");return{fieldName:t,fieldPath:n.reverse()}}_getItemByFieldPath(e,t,i){const{itemType:n}=i,s=this._getSubItemField(n),o=n==="group"||n==="tabbed"||i.title;let a=!1;do if(o){const l=i.name||i.caption||i.title,d=m(l),c=Ho(l);let u="";if(i[s]=this._generateItemsFromData(i[s]),d&&(u=e.pop()),!e.length&&(a=this._getItemByField(t,i[s]),a))break;(!d||d&&c===u)&&e.length&&(a=this._searchItemInEverySubItem(e,t,i[s]))}else break;while(e.length&&!m(a));return a}_getSubItemField(e){return e==="tabbed"?"tabs":"items"}_searchItemInEverySubItem(e,t,i){let n=!1;return x(i,((s,o)=>(n=this._getItemByFieldPath(e.slice(),t,o),!n))),n||!1}_changeItemOption(e,t,i){L(e)&&(e[t]=i)}_dimensionChanged(){const e=this._getCurrentScreenFactor();this._lastMarkupScreenFactor!==e&&(this._isColCountChanged(this._lastMarkupScreenFactor,e)&&(this._targetScreenFactor=e,this._refresh(),this._targetScreenFactor=void 0),this._lastMarkupScreenFactor=e)}_isColCountChanged(e,t){let i=!1;return x(this._cachedColCountOptions,((n,s)=>s.colCountByScreen[e]!==s.colCountByScreen[t]?(i=!0,!1):!0)),i}_refresh(){const e=`.${Np}.${Gh}:not(.${Lp}) .${$p}`;v.trigger(this.$element().find(e),"change"),super._refresh()}_updateIsDirty(e){const t=this.getEditor(e);t&&(t.option("isDirty")?this._dirtyFields.add(e):this._dirtyFields.delete(e),this.option("isDirty",!!this._dirtyFields.size))}updateRunTimeInfoForEachEditor(e){this._itemsRunTimeInfo.each(((t,i)=>{const{widgetInstance:n}=i;m(n)&&gn.isEditor(n)&&e(n)}))}_clear(){this.updateRunTimeInfoForEachEditor((e=>{e.clear(),e.option("isValid",!0)})),he.resetGroup(this._getValidationGroup())}_updateData(e,t,i){const n=i?t:e;L(n)?x(n,((s,o)=>{this._updateData(i?`${e}.${s}`:s,o,L(o))})):W(e)&&this._updateFieldValue(e,t)}registerKeyHandler(e,t){super.registerKeyHandler(e,t),this._itemsRunTimeInfo.each(((i,n)=>{m(n.widgetInstance)&&n.widgetInstance.registerKeyHandler(e,t)}))}_focusTarget(){return this.$element().find(`.${No} [tabindex]`).first()}_visibilityChanged(){this._alignLabels(this._rootLayoutManager,this._rootLayoutManager.isSingleColumnMode())}_clearAutoColCountChangedTimeout(){this.autoColCountChangedTimeoutId&&(clearTimeout(this.autoColCountChangedTimeoutId),this.autoColCountChangedTimeoutId=void 0)}_dispose(){this._clearAutoColCountChangedTimeout(),he.removeGroup(this._getValidationGroup()),super._dispose()}clear(){this._clear()}resetValues(){this._clear()}reset(e){this.updateRunTimeInfoForEachEditor((t=>{const{name:i=""}=t.option();e&&i in e?(t.reset(e[i]),this._updateIsDirty(i)):t.reset()})),this._renderValidationSummary()}updateData(e,t){this._updateData(e,t)}getEditor(e){return this._itemsRunTimeInfo.findWidgetInstanceByDataField(e)??this._itemsRunTimeInfo.findWidgetInstanceByName(e)}getButton(e){return this._itemsRunTimeInfo.findWidgetInstanceByName(e)}updateDimensions(){const e=S();return this._scrollable?this._scrollable.update().done((()=>{e.resolveWith(this)})):e.resolveWith(this),e.promise()}itemOption(e,t,i){const{items:n}=this.option(),s=this._generateItemsFromData(n),o=this._getItemByField(e,s),a=lu(s,o);if(o){if(arguments.length===1)return o;switch(arguments.length){case 3:{const l=this._tryCreateItemOptionAction(t,o,i,o[t??""],a);this._changeItemOption(o,t??"",i);const d=Yi(a,t);!this._tryExecuteItemOptionAction(l)&&!this._tryChangeLayoutManagerItemOption(d,i)&&this.option("items",s);break}default:if(L(t)&&!this._tryChangeLayoutManagerItemOptions(a,t)){let l=!1;x(t,((d,c)=>{const u=this._tryCreateItemOptionAction(d,o,c,o[d],a);this._changeItemOption(o,d,c),!l&&!this._tryExecuteItemOptionAction(u)&&(l=!0)})),l&&this.option("items",s)}}}}validate(){return he.validateGroup(this._getValidationGroup())}getItemID(e){const{formID:t}=this.option();return`dx_${t}_${e||new Te}`}getTargetScreenFactor(){return this._targetScreenFactor}}_e("dxForm",yr);const Ox=r=>class extends r{init(){this._editForm=null,this._updateEditFormDeferred=null,super.init()}isEditRow(e){return!this.isPopupEditMode()&&super.isEditRow(e)}isFormOrPopupEditMode(){return this.isPopupEditMode()||this.isFormEditMode()}isFormEditMode(){return this.option("editing.mode")===vr}getFirstEditableColumnIndex(){const e=this._firstFormItem;if(this.isFormEditMode()&&e){const t=this.option(Le),i=this._dataController.getRowIndexByKey(t),n=this._rowsView.getCellElements(i);return this._rowsView._getEditFormEditorVisibleIndex(n,e.column)}return super.getFirstEditableColumnIndex()}getEditFormRowIndex(){return this.isFormOrPopupEditMode()?this._getVisibleEditRowIndex():super.getEditFormRowIndex()}_isEditColumnVisible(){const e=super._isEditColumnVisible(),t=this.option("editing");return this.isFormOrPopupEditMode()&&t.allowUpdating||e}_handleDataChanged(e){if(this.isPopupEditMode()){var t,i;const n=this.option("editing.editRowKey"),s=e==null||(t=e.items)===null||t===void 0?void 0:t.some((a=>ae(a.key,n))),o=((i=e.changeTypes)===null||i===void 0?void 0:i.length)&&e.changeTypes.every((a=>a==="insert"));(e.changeType==="refresh"||s&&e.isOptionChanged)&&!o&&this._repaintEditPopup()}super._handleDataChanged(e)}getPopupContent(){var e;const t=(e=this._editPopup)===null||e===void 0?void 0:e.option("visible");if(this.isPopupEditMode()&&t)return this._$popupContent}_showAddedRow(e){this.isPopupEditMode()?this._showEditPopup(e):super._showAddedRow(e)}_cancelEditDataCore(){super._cancelEditDataCore(),this.isPopupEditMode()&&this._hideEditPopup()}_updateEditRowCore(e,t,i){const n=this._editForm;if(this.isPopupEditMode())if(this.option("repaintChangesOnly")){var s;(s=e.update)===null||s===void 0||s.call(e,e),this._rowsView.renderDelayedTemplates()}else n&&(this._updateEditFormDeferred=new S().done((()=>n.repaint())),this._updateLockCount||this._updateEditFormDeferred.resolve());else super._updateEditRowCore(e,t,i)}_showEditPopup(e,t){const i=G.current().deviceType!=="desktop",n=this.addWidgetPrefix(lv),s=b({showTitle:!1,fullScreen:i,wrapperAttr:{class:n},toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:this._getSaveButtonConfig()},{toolbar:"bottom",location:"after",widget:"dxButton",options:this._getCancelButtonConfig()}],contentTemplate:this._getPopupEditFormTemplate(e)},this.option(Kn));if(!this._editPopup){const o=h("<div>").appendTo(this.component.$element()).addClass(n);this._editPopup=this._createComponent(o,ni),this._editPopup.on("hiding",this._getEditPopupHiddenHandler()),this._editPopup.on("shown",(a=>{if(v.trigger(a.component.$content().find(Cr).not(`.${cv}`).first(),"focus"),t){var l;(l=this._editForm)===null||l===void 0||l.repaint()}}))}this._editPopup.option(s),this._editPopup.show(),super._showEditPopup(e,t)}_getPopupEditFormTemplate(e){const t=this.component.getVisibleRows()[e],i={row:t,values:t.values,rowType:t.rowType,key:t.key,rowIndex:e};return this._rowsView._addWatchMethod(i,t),n=>{const s=this.getEditFormTemplate(),o=this._createComponent(h("<div>").appendTo(n),it);this._$popupContent=h(o.content()),s(this._$popupContent,i,{isPopupForm:!0}),this._rowsView.renderDelayedTemplates(),h(n).parent().attr("aria-label",this.localize("dxDataGrid-ariaEditForm"))}}_repaintEditPopup(){const e=this._getVisibleEditRowIndex();if(e>=0){var t,i;const n=(t=this._editPopup)===null||t===void 0?void 0:t.option("animation");(i=this._editPopup)===null||i===void 0||i.option("animation",null),this._showEditPopup(e,!0),n!==void 0&&this._editPopup.option("animation",n)}}_hideEditPopup(){var e;(e=this._editPopup)===null||e===void 0||e.option("visible",!1)}optionChanged(e){if(e.name==="editing"&&this.isFormOrPopupEditMode()){const{fullName:t}=e;t.indexOf(eo)===0?(this._handleFormOptionChange(e),e.handled=!0):t.indexOf(Kn)===0&&(this._handlePopupOptionChange(e),e.handled=!0)}super.optionChanged(e)}_handleFormOptionChange(e){var t;if(this.isFormEditMode()){const i=this._getVisibleEditRowIndex();i>=0&&this._dataController.updateItems({changeType:"update",rowIndices:[i]})}else(t=this._editPopup)!==null&&t!==void 0&&t.option("visible")&&e.fullName.indexOf(eo)===0&&this._repaintEditPopup()}_handlePopupOptionChange(e){const t=this._editPopup;if(t){const i=e.fullName.slice(Kn.length+1);i?t.option(i,e.value):t.option(e.value)}}renderFormEditorTemplate(e,t,i,n,s){const o=this,a=h(n),{column:l}=t,d=fv(t),c=e==null?void 0:e.row,u=c==null?void 0:c.data,p=i.component,g=l.calculateCellValue(u),_=y.getDisplayValue(l,g,u,c==null?void 0:c.rowType),{label:f,labelMark:C,labelMode:I}=i.editorOptions||{},E=b({},e,{data:u,cellElement:null,isOnForm:!0,item:t,id:p.getItemID(t.name||t.dataField),column:b({},l,{editorType:d,editorOptions:b({label:f,labelMark:C,labelMode:I},l.editorOptions,t.editorOptions)}),columnIndex:l.index,setValue:!s&&l.allowEditing&&function(k,A){o.updateFieldValue(E,k,A)}});E.value=g,E.displayValue=_,E.text=l.command?"":y.formatValue(_,l);const D=this._getFormEditItemTemplate.bind(this)(E,l);return this._rowsView.renderTemplate(a,D,E,!!un(a)).done((()=>{this._rowsView._updateCell(a,E)})),E}getFormEditorTemplate(e,t){const i=this.component.columnOption(t.name||t.dataField);return(n,s)=>{const o=h(s),{row:a}=e;if(a!=null&&a.watch){const l=a.watch((()=>i.selector(a.data)),(()=>{var d;let c=o.find(".dx-widget").first(),u=c.data("dxValidator");const p=(d=u)===null||d===void 0?void 0:d.option();o.contents().remove(),e=this.renderFormEditorTemplate.bind(this)(e,t,n,o),c=o.find(".dx-widget").first(),u=c.data("dxValidator"),p&&!u&&c.dxValidator({validationRules:p.validationRules,validationGroup:p.validationGroup,dataGetter:p.dataGetter})}));v.on(o,ii,l)}e=this.renderFormEditorTemplate.bind(this)(e,t,n,o)}}getEditFormOptions(e){var t;const i=(t=this._getValidationGroupsInForm)===null||t===void 0?void 0:t.call(this,e),n=this.option("editing.form.customizeItem"),s=this.addWidgetPrefix(Qc);let o=this.option("editing.form.items");const a={};if(o)tu(o,(l=>{const d=(l==null?void 0:l.name)||(l==null?void 0:l.dataField);d&&(a[d]=!!l.editorType)}));else{const l=this._columnsController.getColumns();o=[],x(l,((d,c)=>{!c.isBand&&!c.type&&o.push({column:c,name:c.name,dataField:c.dataField})}))}return b({},i,{items:o,formID:`dx-${new Te}`,customizeItem:l=>{let d;const c=l.name||l.dataField;if((l.column||c)&&(d=l.column||this._columnsController.columnOption(l.name?`name:${l.name}`:`dataField:${l.dataField}`)),d){if(l.label=l.label||{},l.label.text=l.label.text||d.caption,d.dataType==="boolean"&&l.label.visible===void 0){const p=this.option("editing.form.labelMode");(p==="floating"||p==="static")&&(l.label.visible=!0)}l.template=l.template||this.getFormEditorTemplate(e,l),l.column=d,l.isCustomEditorType=a[c],d.formItem&&b(l,d.formItem),l.isRequired===void 0&&d.validationRules&&(l.isRequired=d.validationRules.some((p=>p.type==="required")),l.validationRules=[]);const u=m(l.visible)?l.visible:!0;!this._firstFormItem&&u&&(this._firstFormItem=l)}n==null||n.call(this,l),l.cssClass=W(l.cssClass)?`${l.cssClass} ${s}`:s}})}getEditFormTemplate(){return(e,t,i)=>{const n=this.option(eo),s=this.getEditFormOptions(t),o=h("<div>").appendTo(e),a=i==null?void 0:i.isPopupForm;if(this._firstFormItem=void 0,a&&o.addClass(this.addWidgetPrefix(dv)),this._editForm=this._createComponent(o,yr,b({},n,s)),!a){const l=h("<div>").addClass(this.addWidgetPrefix(hv)).appendTo(e);this._createComponent(h("<div>").appendTo(l),Ze,this._getSaveButtonConfig()),this._createComponent(h("<div>").appendTo(l),Ze,this._getCancelButtonConfig())}this._editForm.on("contentReady",(()=>{var l;this._rowsView.renderDelayedTemplates(),(l=this._editPopup)===null||l===void 0||l.repaint()}))}}getEditForm(){return this._editForm}_endUpdateCore(){var e;(e=this._updateEditFormDeferred)===null||e===void 0||e.resolve()}_beforeEndSaving(e){if(super._beforeEndSaving(e),this.isPopupEditMode()){var t;(t=this._editPopup)===null||t===void 0||t.hide()}}_processDataItemCore(e,t,i,n,s){const{type:o}=t;this.isPopupEditMode()&&o===Je&&(e.visible=!1),super._processDataItemCore(e,t,i,n,s)}_editRowFromOptionChangedCore(e,t){const i=this.isPopupEditMode();super._editRowFromOptionChangedCore(e,t,i),i&&this._showEditPopup(t)}},Fx=r=>class extends r{_updateEditItem(e){this._editingController.isFormEditMode()&&(e.rowType="detail")}_getChangedColumnIndices(e,t,i,n){if(!(n===!1&&t.isEditing&&this._editingController.isFormEditMode()))return super._getChangedColumnIndices.apply(this,arguments)}},Ax=r=>class extends r{_renderCellContent(e,t){t.rowType==="data"&&this._editingController.isPopupEditMode()&&t.row.visible===!1||super._renderCellContent.apply(this,arguments)}getCellElements(e){const t=super.getCellElements(e),i=this._editingController,n=i.getEditForm();return i.getEditFormRowIndex()===e&&t&&n?n.$element().find(`.${this.addWidgetPrefix(Qc)}, .${uv}`):t}_getVisibleColumnIndex(e,t,i){if(this._editingController.getEditFormRowIndex()===t&&W(i)){const s=this._columnsController.columnOption(i);return this._getEditFormEditorVisibleIndex(e,s)}return super._getVisibleColumnIndex.apply(this,arguments)}_getEditFormEditorVisibleIndex(e,t){let i=-1;return x(e,((n,s)=>{const o=h(s).find(".dx-field-item-content").data("dx-form-item");if(o!=null&&o.column&&t&&o.column.index===t.index)return i=n,!1})),i}_isFormItem(e){const t=e.rowType==="detail"||e.rowType==="detailAdaptive",i=e.rowType==="data"&&this._editingController.isPopupEditMode();return(t||i)&&e.item}_updateCell(e,t){this._isFormItem(t)?this._formItemPrepared(t,e):super._updateCell(e,t)}_updateContent(){const e=this._editingController,t=e.getEditForm(),i=t==null?void 0:t.option("validationGroup");return super._updateContent.apply(this,arguments).done((()=>{const s=e.getEditForm();i&&s&&s!==t&&s.option("validationGroup",i)}))}},HS={extenders:{controllers:{editing:Ox,data:Fx},views:{rowsView:Ax}}},Px=r=>class extends r{init(){const e=!this._saveEditorHandler;if(super.init(),e){let t,i;this._pointerUpEditorHandler=()=>{var n;i=(n=this._columnsResizerController)===null||n===void 0?void 0:n.isResizing()},this._pointerDownEditorHandler=n=>t=h(n.target),this._saveEditorHandler=this.createAction((function(n){const{event:s}=n,o=h(s.target),a=s[Xc],{component:l}=this;if(_v(t)&&!t.is(o))return;function d(c){if(!c)return!1;const u=c.closest(`.${sv}`),p=l.$element();return u.length>0&&p.closest(u).length===0}if(this.isCellOrBatchEditMode()&&!this._editCellInProgress){const c=d(o)||d(a==null?void 0:a.$element()),u=a&&!a._disposed&&a!==this.component,p=!!o.closest(`.${this.addWidgetPrefix(nv)}`).length,g=o.hasClass(this.addWidgetPrefix(iv)),_=this.isCellEditMode();!i&&!c&&!g&&!(p&&_&&this.isEditing())&&(un(o)||u)&&this._closeEditItem.bind(this)(o)}})),v.on(M.getDocument(),Z.up,this._pointerUpEditorHandler),v.on(M.getDocument(),Z.down,this._pointerDownEditorHandler),v.on(M.getDocument(),Q,this._saveEditorHandler)}}isCellEditMode(){return this.option("editing.mode")===Bo}isBatchEditMode(){return this.option("editing.mode")===Mo}isCellOrBatchEditMode(){return this.isCellEditMode()||this.isBatchEditMode()}_needToCloseEditableCell(e){const t=this.component.$element();let i=this.isEditing();if((!t||!!e.closest(t).length)&&e.closest(`.${ov}`).length){const a=e.closest(`.${Tt}> td`),l=this._rowsView.getRowIndex(a.parent()),d=this._rowsView.getCellElements(l);if(d!=null&&d.length){var s;const c=d.index(a),p=(s=this._columnsController.getVisibleColumns()[c])===null||s===void 0?void 0:s.allowEditing,g=this.isEditCell(l,c);i=i&&!p&&!g}}return i||super._needToCloseEditableCell(e)}_closeEditItem(e){this._needToCloseEditableCell(e)&&this.closeEditCell()}_focusEditorIfNeed(){if(this._needFocusEditor&&this.isCellOrBatchEditMode()){var e;const t=this._getVisibleEditColumnIndex(),i=(e=this._rowsView)===null||e===void 0?void 0:e._getCellElement(this._getVisibleEditRowIndex(),t);this._refocusEditCell=!1,clearTimeout(this._inputFocusTimeoutID),i&&!i.find(":focus").length?this._focusEditingCell((()=>{this._editCellInProgress=!1}),i,!0):this._editCellInProgress=!1,this._needFocusEditor=!1}else super._focusEditorIfNeed()}isEditing(){if(this.isCellOrBatchEditMode()){const e=m(this.option(Le)),t=m(this.option(Qt));return e&&t}return super.isEditing()}_handleEditColumnNameChange(e){const t=this._getVisibleEditRowIndex(e.previousValue);if(this.isCellOrBatchEditMode()&&t!==-1&&m(e.value)&&e.value!==e.previousValue){const i=this._columnsController.getVisibleColumnIndex(e.value),n=this._columnsController.getVisibleColumnIndex(e.previousValue);this._editCellFromOptionChanged(i,n,t)}}_addRow(e){if(this.isCellEditMode()&&this.hasChanges()){const t=new S;return this.saveEditData().done((()=>{this.hasChanges()?t.reject("cancel"):this.addRow(e).done(t.resolve).fail(t.reject)})),t.promise()}return super._addRow(e)}editCell(e,t){return this._editCell({rowIndex:e,columnIndex:t})}_editCell(e){const t=new S;let i;return this.executeOperation(t,(()=>{i=this._editCellCore(e),O(i).done(t.resolve).fail(t.reject)})),i!==void 0?i:t.promise()}_editCellCore(e){const t=this._getNormalizedEditCellOptions(e),{columnIndex:i,rowIndex:n,column:s,item:o}=t;if(o.key===void 0){this._dataController.fireError("E1043");return}return s&&(o.rowType==="data"||o.rowType==="detailAdaptive")&&!o.removed&&this.isCellOrBatchEditMode()?this.isEditCell(n,i)?!0:O(this._beforeEditCell(n,i,o)).done((a=>{a||this._prepareEditCell(t)||this._processCanceledEditingCell()})):!1}_beforeEditCell(e,t,i){if(this.isCellEditMode()&&!i.isNewRow&&this.hasChanges()){const n=new S;return this.saveEditData().always((()=>{n.resolve(this.hasChanges())})),this.addDeferred(n),n}return!1}publicMethods(){return super.publicMethods().concat(["editCell","closeEditCell"])}_getNormalizedEditCellOptions(e){let{oldColumnIndex:t,oldRowIndex:i,columnIndex:n,rowIndex:s}=e;const o=this._columnsController,a=o.getVisibleColumns(),d=this._dataController.items()[s];let c;m(t)?c=a[t]:c=this._getEditColumn(),m(i)||(i=this._getVisibleEditRowIndex()),W(n)&&(n=o.columnOption(n,"index"),n=o.getVisibleIndex(n));const u=a[n];return{oldColumn:c,columnIndex:n,oldRowIndex:i,rowIndex:s,column:u,item:d}}_prepareEditCell(e){let{item:t,column:i,oldColumn:n,columnIndex:s,oldRowIndex:o}=e;const a={data:t==null?void 0:t.data,cancel:!1,column:i,key:t.isNewRow?void 0:t.key};return this._isEditingStart(a)?!1:(this._pageIndex=this._dataController.pageIndex(),this._setEditRowKey(t.key,!0),this._setEditColumnNameByIndex(s,!0),this._repaintEditCell(i,n,o),i.showEditorAlways||this._addInternalData({key:t.key,oldData:t.oldData??t.data}),!0)}closeEditCell(e,t){let i=O();const n=this._getVisibleEditRowIndex();if(this.isCellOrBatchEditMode()){const s=new S;i=new S,this.executeOperation(s,(()=>{this._closeEditCellCore(e,n,t).always(i.resolve)}))}return i.promise()}_closeEditCellCore(e,t,i){const n=this._dataController,s=new S,o=s.promise();if(this.isCellEditMode()&&this.hasChanges()){if(!i)return this.saveEditData().done((a=>{if(!this.hasChanges()){this.closeEditCell(!!a).always(s.resolve);return}s.resolve()})),o}else if(this._resetEditRowKey(),this._resetEditColumnName(),t>=0){const a=[t];this._beforeCloseEditCellInBatchMode(a),e||n.updateItems({changeType:"update",rowIndices:a})}return s.resolve(),o}_resetModifiedClassCells(e){if(this.isBatchEditMode()){const t=this._columnsController.getVisibleColumns().length;e.forEach((i=>{let{key:n}=i;const s=this._dataController.getRowIndexByKey(n);for(let o=0;o<t;o++){const a=this._rowsView._getCellElement(s,o);a==null||a.removeClass(AC)}}))}}_prepareChange(e,t,i){const n=h(e.cellElement);return this.isBatchEditMode()&&e.key!==void 0&&this._applyModified(n,e),super._prepareChange(e,t,i)}_cancelSaving(e){const t=this._dataController;this.isCellOrBatchEditMode()&&(this.isBatchEditMode()&&this._resetEditIndices(),t.updateItems()),super._cancelSaving(e)}optionChanged(e){const{fullName:t}=e;e.name==="editing"&&t===Qt?(this._handleEditColumnNameChange(e),e.handled=!0):super.optionChanged(e)}_editCellFromOptionChanged(e,t,i){const n=this._columnsController.getVisibleColumns();e>-1&&Re((()=>{this._repaintEditCell(n[e],n[t],i)}))}_handleEditRowKeyChange(e){if(this.isCellOrBatchEditMode()){const i=this._getVisibleEditColumnIndex(),n=this._getEditRowIndexCorrection(),s=this._dataController.getRowIndexByKey(e.previousValue)+n;if(m(e.value)&&e.value!==e.previousValue){var t;(t=this._editCellFromOptionChanged)===null||t===void 0||t.call(this,i,i,s)}}else super._handleEditRowKeyChange(e)}deleteRow(e){if(this.isCellEditMode()&&this.isEditing()){const{isNewRow:t}=this._dataController.items()[e],i=this._dataController.getKeyByRowIndex(e);this.closeEditCell(null,t).always((()=>{e=this._dataController.getRowIndexByKey(i),this._checkAndDeleteRow(e)}))}else super.deleteRow(e)}_checkAndDeleteRow(e){this.isBatchEditMode()?this._deleteRowCore(e):super._checkAndDeleteRow(e)}_refreshCore(e){const{isPageChanged:t}=e??{},i=this.isBatchEditMode()||t&&this.option("scrolling.mode")!=="virtual";this.isCellOrBatchEditMode()?i&&(this._resetEditColumnName(),this._resetEditRowKey()):super._refreshCore(e)}_allowRowAdding(e){return this.isBatchEditMode()?!0:super._allowRowAdding(e)}_afterDeleteRow(e,t){const i=this._dataController;return this.isBatchEditMode()?(i.updateItems({changeType:"update",rowIndices:[t,e]}),new S().resolve()):super._afterDeleteRow(e,t)}_updateEditRow(e,t,i){this.isCellOrBatchEditMode()?this._updateRowImmediately(e,t,i):super._updateEditRow(e,t,i)}_isDefaultButtonVisible(e,t){if(this.isCellOrBatchEditMode()){const i=this.isBatchEditMode();switch(e.name){case"save":case"cancel":case"edit":return!1;case"delete":return super._isDefaultButtonVisible(e,t)&&(!i||!t.row.removed);case"undelete":return i&&this.allowDeleting(t)&&t.row.removed;default:return super._isDefaultButtonVisible(e,t)}}return super._isDefaultButtonVisible(e,t)}_isRowDeleteAllowed(){return super._isRowDeleteAllowed()||this.isBatchEditMode()}_beforeEndSaving(e){if(this.isCellEditMode()){var t;((t=e[0])===null||t===void 0?void 0:t.type)!=="update"&&super._beforeEndSaving(e)}else this.isBatchEditMode()&&this._resetModifiedClassCells(e),super._beforeEndSaving(e)}prepareEditButtons(e){const t=this.option("editing")??{},i=super.prepareEditButtons(e);return(t.allowUpdating||t.allowAdding||t.allowDeleting)&&this.isBatchEditMode()&&(i.push(this.prepareButtonItem(e,"save","saveEditData",21)),i.push(this.prepareButtonItem(e,"revert","cancelEditData",22))),i}_saveEditDataInner(){var e;const t=this._dataController.getVisibleRows()[this.getEditRowIndex()],i=this._getEditColumn(),n=i==null?void 0:i.showEditorAlways,s=this.isCellEditMode()&&!(t!=null&&t.isNewRow);let o;return s&&n&&(o=new S,this.addDeferred(o)),super._saveEditDataInner().always((e=o)===null||e===void 0?void 0:e.resolve)}_applyChange(e,t,i){const n=this.isCellEditMode()&&e.row&&!e.row.isNewRow,{showEditorAlways:s}=e.column,o=e.column.setCellValue!==e.column.defaultSetCellValue;if(s&&!i&&n&&this.hasEditData()&&!this.isEditCell(e.rowIndex,e.columnIndex)){this._focusEditingCell(),this._updateEditRow(e.row,!0,o);return}return super._applyChange(e,t,i)}_applyChangeCore(e,t){const{showEditorAlways:i}=e.column,n=this.isCellEditMode()&&e.row&&!e.row.isNewRow;if(i&&!t){if(n)return this._setEditRowKey(e.row.key,!0),this._setEditColumnNameByIndex(e.columnIndex,!0),this.saveEditData();if(this.isBatchEditMode())return t=this._needUpdateRow(e.column),super._applyChangeCore(e,t)}return super._applyChangeCore(e,t)}_processDataItemCore(e,t,i,n,s){const{data:o,type:a}=t;this.isBatchEditMode()&&a===ht&&(e.data=Xt(e.data,o)),super._processDataItemCore(e,t,i,n,s)}_processRemoveCore(e,t,i){if(!(this.isBatchEditMode()&&!i))return super._processRemoveCore(e,t,i)}_processRemoveIfError(e,t){if(!this.isBatchEditMode())return super._processRemoveIfError(e,t)}_beforeFocusElementInRow(e){super._beforeFocusElementInRow(e);const t=e>=0?e:0,i=this.getFirstEditableColumnIndex();i>=0&&this.editCell(t,i)}},kx=r=>class extends r{_createTable(){const e=super._createTable.apply(this,arguments),t=this._editingController;return t.isCellOrBatchEditMode()&&this.option("editing.allowUpdating")&&v.on(e,V(Di.name,"dxDataGridRowsView"),`td:not(.${Ss})`,this.createAction((()=>{t.isEditing()&&t.closeEditCell()}))),e}_createRow(e){const t=super._createRow.apply(this,arguments);if(e){const i=this._editingController,n=!!e.removed;i.isBatchEditMode()&&n&&t.addClass(rv)}return t}},WS={extenders:{controllers:{editing:Px},views:{rowsView:kx}}},Ll="__DX_INSERT_INDEX__",gu="row",Gn="batch",Si="cell",mu=["popup","form"],Me={valid:"valid",invalid:"invalid",pending:"pending"},ji=function(r){return m(r)&&r!=="cancel"},_u=function(r,e){return r!==void 0||r===void 0&&e&&!e.isNewRow};class Mx extends j.Controller{constructor(){super(...arguments),this._isValidationInProgress=!1,this._disableApplyValidationResults=!1}init(){this._editingController=this.getController("editing"),this._editorFactoryController=this.getController("editorFactory"),this._columnsController=this.getController("columns"),this.createAction("onRowValidating"),this._validationState||this.initValidationState()}initValidationState(){this._validationState=[],this._validationStateCache={}}_rowIsValidated(e){const t=this._getValidationData(e==null?void 0:e.key);return!!t&&!!t.validated}_getValidationData(e,t){const i=Ot(e),n=L(i);let s;return n?s=this._validationState.filter((o=>ae(o.key,e)))[0]:s=this._validationStateCache[i],!s&&t&&(s={key:e,isValid:!0},this._validationState.push(s),n||(this._validationStateCache[i]=s)),s}_getBrokenRules(e,t){let i;return t?i=t.brokenRules||t.brokenRule&&[t.brokenRule]:i=e.brokenRules||[],i}_rowValidating(e,t){const i=new S,n=this._editingController.getChangeByKey(e==null?void 0:e.key),s=this._getBrokenRules(e,t),o=t?t.isValid:e.isValid,a={brokenRules:s,isValid:o,key:n.key,newData:n.data,oldData:this._editingController._getOldData(n.key),promise:null,errorText:this.getHiddenValidatorsErrorText(s)};return this.executeAction("onRowValidating",a),O(_t(a.promise)).always((()=>{e.isValid=a.isValid,e.errorText=a.errorText,i.resolve(a)})),i.promise()}getHiddenValidatorsErrorText(e){const t=[];return x(e,((i,n)=>{const{column:s}=n,o=s&&s.groupIndex!==void 0&&!s.showWhenGrouped,a=s&&s.visible;!n.validator.$element().parent().length&&(!a||o)&&t.push(n.message)})),t.join(", ")}validate(e){let t=!0;const i=this._editingController,n=new S,s=[],o=i.getEditMode();if(e=e||o===gu,this._isValidationInProgress)return n.resolve(!1).promise();if(this._isValidationInProgress=!0,e){i.addDeferred(n);const a=i.getChanges();x(a,((l,d)=>{let{type:c,key:u}=d;if(c!=="remove"){const p=this._getValidationData(u,!0),g=this.validateGroup(p);s.push(g),g.done((_=>{p.validated=!0,t=t&&_.isValid}))}}))}else if(this._currentCellValidator){const a=this.validateGroup(this._currentCellValidator._findGroup());s.push(a),a.done((l=>{t=l.isValid}))}return O(...s).done((()=>{this._isValidationInProgress=!1,n.resolve(t)})),n.promise()}validateGroup(e){var t;const i=new S,n=e&&he.getGroupConfig(e);let s;return n!=null&&n.validators.length&&(this.resetRowValidationResults(e),s=he.validateGroup(e)),O(((t=s)===null||t===void 0?void 0:t.complete)||s).done((o=>{O(this._rowValidating(e,o)).done(i.resolve)})),i.promise()}isRowDataModified(e){return!nt(e.data)}updateValidationState(e){const t=this._editingController.getEditMode(),{key:i}=e,n=this._getValidationData(i,!0);if(mu.includes(t))n.isValid=!0;else{if(e.type==="insert"&&!this.isRowDataModified(e)){n.isValid=!0;return}if(this.setDisableApplyValidationResults(!0),he.getGroupConfig(n)){const o=he.validateGroup(n);O(o.complete||o).done((a=>{n.isValid=a.isValid,n.brokenRules=a.brokenRules}))}else(!n.brokenRules||!n.brokenRules.length)&&(n.isValid=!0);this.setDisableApplyValidationResults(!1)}}setValidator(e){this._currentCellValidator=e}renderCellPendingIndicator(e){let t=e.find(".dx-pending-indicator");if(!t.length){const i=e;t=h("<div>").appendTo(i).addClass("dx-pending-indicator"),this._createComponent(t,yi),e.addClass("dx-validation-pending")}}disposeCellPendingIndicator(e){const t=e.find(".dx-pending-indicator");if(t.length){const i=yi.getInstance(t);i&&(i.dispose(),i.$element().remove()),e.removeClass("dx-validation-pending")}}validationStatusChanged(e){const{validator:t}=e,i=t.option("validationGroup"),{column:n}=t.option("dataGetter")();this.updateCellValidationResult({rowKey:i.key,columnIndex:n.index,validationResult:e})}validatorInitialized(e){e.component.on("validating",this.validationStatusChanged.bind(this)),e.component.on("validated",this.validationStatusChanged.bind(this))}validatorDisposing(e){const t=e.component,i=t.option("validationGroup"),{column:n}=t.option("dataGetter")(),s=this.getCellValidationResult({rowKey:i==null?void 0:i.key,columnIndex:n.index});ji(s)&&s.status===Me.pending&&this.cancelCellValidationResult({change:i,columnIndex:n.index})}applyValidationResult(e,t){const{validator:i}=t,n=i.option("validationGroup"),{column:s}=i.option("dataGetter")();if(t.brokenRules&&t.brokenRules.forEach((o=>{o.columnIndex=s.index,o.column=s})),e){const o=this.getCellValidationResult({rowKey:n.key,columnIndex:s.index}),a=ji(o)&&o.disabledPendingId===t.id;if(this._disableApplyValidationResults||a)return;if(t.status===Me.invalid){const d=e.find(":focus");Dd(d)||(v.trigger(d,"focus"),v.trigger(d,Z.down))}const l=!s.editCellTemplate&&this._editorFactoryController.getEditorInstance(e);t.status===Me.pending?l?l.option("validationStatus",Me.pending):this.renderCellPendingIndicator(e):l?l.option("validationStatus",Me.valid):this.disposeCellPendingIndicator(e),e.toggleClass(this.addWidgetPrefix("invalid"),t.status===Me.invalid)}}_syncInternalEditingData(e){var t;const i=this._editingController,n=i.getChangeByKey(e.key),s=i._getOldData(e.key),o=(t=e.row)===null||t===void 0?void 0:t.oldData;n&&o&&!s&&i._addInternalData({key:e.key,oldData:o})}createValidator(e,t){const i=this._editingController,{column:n}=e;let{showEditorAlways:s}=n;if(m(n.command)||!n.validationRules||!Array.isArray(n.validationRules)||!n.validationRules.length)return;let a=i.getIndexByKey(e.key,i.getChanges())>-1;if(!a){if(!s){var l;s=(((l=this._columnsController)===null||l===void 0?void 0:l.getVisibleColumns())||[]).some((g=>g.showEditorAlways))}const c=ae(this.option("editing.editRowKey"),e.key),u=i.isCellOrBatchEditMode()&&i.allowUpdating({row:e.row});if(a=c||u&&s,u&&s){var d;i._addInternalData({key:e.key,oldData:((d=e.row)===null||d===void 0?void 0:d.oldData)??e.data})}}if(a){if(t&&!t.length){se.log("E1050");return}this._syncInternalEditingData(e);const c=this._getValidationData(e.key,!0),u=()=>{const _=i.getChangeByKey(c==null?void 0:c.key),f=n.calculateCellValue((_==null?void 0:_.data)||{});return f!==void 0?f:e.value},p=t&&t.hasClass("dx-widget");t&&t.addClass(this.addWidgetPrefix("validator"));const g=new Es(t||h("<div>"),{name:n.caption,validationRules:b(!0,[],n.validationRules),validationGroup:c,adapter:p?null:{getValue:u,applyValidationResults:_=>{this.applyValidationResult(t,_)}},dataGetter(){const _=c==null?void 0:c.key,f=i.getChangeByKey(_),C=i._getOldData(_);return{data:Xt(C,f==null?void 0:f.data),column:n}},onInitialized:this.validatorInitialized.bind(this),onDisposing:this.validatorDisposing.bind(this)});if(p){const _=g.option("adapter");if(_){const f=_.bypass,C=()=>e.row.isNewRow&&!this._isValidationInProgress&&!i.isCellModified(e);_.getValue=u,_.validationRequestsCallbacks=[],_.bypass=()=>f.call(_)||C()}}return g}}setDisableApplyValidationResults(e){this._disableApplyValidationResults=e}getDisableApplyValidationResults(){return this._disableApplyValidationResults}isCurrentValidatorProcessing(e){let{rowKey:t,columnIndex:i}=e;return this._currentCellValidator&&ae(this._currentCellValidator.option("validationGroup").key,t)&&this._currentCellValidator.option("dataGetter")().column.index===i}validateCell(e){const t={rowKey:e.option("validationGroup").key,columnIndex:e.option("dataGetter")().column.index,validationResult:null};let i=this.getCellValidationResult(t);const n=ji(i),s=e.option("adapter");if(!n)i=e.validate();else{const a=s.getValue();ae(a,i.value)||(i=e.validate())}const o=new S;return n&&i.status===Me.pending&&(this.updateCellValidationResult(t),s.applyValidationResults(i)),O(i.complete||i).done((a=>{n&&s.applyValidationResults(a),o.resolve(a)})),o.promise()}updateCellValidationResult(e){let{rowKey:t,columnIndex:i,validationResult:n}=e;const s=this._getValidationData(t);if(!s)return;s.validationResults||(s.validationResults={});let o;if(n){if(o=b({},n),s.validationResults[i]=o,n.status===Me.pending&&(this._editingController.getEditMode()===Si&&(o.deferred=new S,o.complete.always((()=>{o.deferred.resolve()})),this._editingController.addDeferred(o.deferred)),this._disableApplyValidationResults)){o.disabledPendingId=n.id;return}}else o=s.validationResults[i];o&&o.disabledPendingId&&delete o.disabledPendingId}getCellValidationResult(e){var t;let{rowKey:i,columnIndex:n}=e;const s=this._getValidationData(i,!0);return s==null||(t=s.validationResults)===null||t===void 0?void 0:t[n]}removeCellValidationResult(e){let{change:t,columnIndex:i}=e;const n=this._getValidationData(t==null?void 0:t.key);n&&n.validationResults&&(this.cancelCellValidationResult({change:t,columnIndex:i}),delete n.validationResults[i])}cancelCellValidationResult(e){let{change:t,columnIndex:i}=e;const n=this._getValidationData(t.key);if(t&&n.validationResults){const s=n.validationResults[i];s&&(s.deferred&&s.deferred.reject("cancel"),n.validationResults[i]="cancel")}}resetRowValidationResults(e){e&&(e.validationResults&&delete e.validationResults,delete e.validated)}isInvalidCell(e){let{rowKey:t,columnIndex:i}=e;const n=this.getCellValidationResult({rowKey:t,columnIndex:i});return ji(n)&&n.status===Me.invalid}getCellValidator(e){let{rowKey:t,columnIndex:i}=e;const n=this._getValidationData(t),s=n&&he.getGroupConfig(n),o=s&&s.validators;return o&&o.filter((a=>{const{column:l}=a.option("dataGetter")();return l?l.index===i:!1}))[0]}setCellValidationStatus(e){const t=this.getCellValidationResult({rowKey:e.key,columnIndex:e.column.index});m(t)?e.validationStatus=t!=="cancel"?t.status:"cancel":delete e.validationStatus}}const Bx=r=>class extends r{processDataItemTreeListHack(e){super.processDataItem.apply(this,arguments)}processItemsTreeListHack(e,t){return super.processItems.apply(this,arguments)}_addChange(e){const t=super._addChange.apply(this,arguments);return t&&e.type!=="remove"&&this._validatingController.updateValidationState(t),t}_handleChangesChange(e){super._handleChangesChange.apply(this,arguments),e.value.forEach((t=>{this._validatingController._getValidationData(t.key)===void 0&&this._validatingController.updateValidationState(t)}))}_updateRowAndPageIndices(){const e=this,t=e.getView("rowsView").getTopVisibleItemIndex();let i=t;x(e.getChanges(),((n,s)=>{let{key:o,type:a}=s;const l=this._validatingController._getValidationData(o);l&&!l.isValid&&l.pageIndex!==e._pageIndex&&(l.pageIndex=e._pageIndex,a==="insert"?l.rowIndex=t:l.rowIndex=i,i++)}))}_getValidationGroupsInForm(e){return{validationGroup:this._validatingController._getValidationData(e.key,!0)}}_validateEditFormAfterUpdate(e,t){t&&this._editForm&&this._editForm.validate(),super._validateEditFormAfterUpdate.apply(this,arguments)}_prepareEditCell(e){const{column:t,item:i}=e,n=super._prepareEditCell(e),s=i.isNewRow?void 0:i.key;return n&&t.showEditorAlways&&this._validatingController.updateValidationState({key:s}),n}processItems(e,t){const i=this.getChanges(),n=(o,a)=>{let l=-1;const d=o.type==="insert",{key:c}=o;return x(a,((u,p)=>{if(ae(c,d?p.key:this._dataController.keyOf(p)))return l=u,!1})),l};e=super.processItems(e,t);const s=e.length;return this.getEditMode()===Gn&&t!=="prepend"&&t!=="append"&&i.forEach((o=>{const{key:a}=o,l=this._validatingController._getValidationData(a);l&&o.type&&l.pageIndex===this._pageIndex&&(o==null?void 0:o.pageIndex)!==this._pageIndex&&(function(d,c){const u={key:d.key};if(n(d,e)>=0)return;c.rowIndex=c.rowIndex>s?c.rowIndex%s:c.rowIndex;const{rowIndex:g}=c;u[Ll]=1,e.splice(g,0,u)})(o,l)})),e}processDataItem(e){const t=e.data[Ll],i=t?e.data.key:e.key;if(this.getEditMode()===Gn&&t&&i){const s=this.getChanges(),o=y.getIndexByKey(i,s);if(o>=0){const a=s[o];if(a.type!=="insert"){const l=this._getOldData(a.key);e.data=b(!0,{},l,a.data),e.key=i}}}super.processDataItem.apply(this,arguments)}_createInvisibleColumnValidators(e){const t=this,i=this._columnsController.getColumns(),n=this._columnsController.getInvisibleColumns().filter((l=>!l.isBand)),s=this._columnsController.getGroupColumns().filter((l=>!l.showWhenGrouped&&n.indexOf(l)===-1)),o=[],a=(l,d)=>this._dataController.getRowIndexByKey(d)>=0&&n.indexOf(l)<0;return n.push(...s),mu.includes(this.getEditMode())||x(i,((l,d)=>{e.forEach((c=>{let u;if(!a(d,c.key)){if(c.type==="insert")u=c.data;else if(c.type==="update"){const p=t._getOldData(c.key);if(!m(p))return;u=Xt(p,c.data)}if(u){const p=this._validatingController.createValidator({column:d,key:c.key,value:d.calculateCellValue(u)});p&&o.push(p)}}}))})),function(){o.forEach((l=>{l.dispose()}))}}_beforeSaveEditData(e,t){let i=super._beforeSaveEditData.apply(this,arguments);const n=this._validatingController._getValidationData(e==null?void 0:e.key,!0);if(e){const s=e.type==="remove"||n.isValid;i=i||!s}else{const s=this._createInvisibleColumnValidators(this.getChanges());i=new S,this.executeOperation(i,(()=>{this._validatingController.validate(!0).done((o=>{switch(s(),this._updateRowAndPageIndices(),this.getEditMode()){case Si:o||this._focusEditingCell();break;case Gn:o||(this._resetEditRowKey(),this._resetEditColumnName(),this._dataController.updateItems())}i.resolve(!o)}))}))}return i.promise?i.promise():i}_beforeEditCell(e,t,i){const n=super._beforeEditCell(e,t,i);if(this.getEditMode()===Si){const s=this._rowsView._getCellElement(e,t),o=s&&s.data("dxValidator"),a=s&&s.closest(".dx-row").data("options"),l=o&&o.option("adapter").getValue();if(o&&_u(l,a)){const d=new S;return O(this._validatingController.validateCell(o),n).done(((c,u)=>{d.resolve(c.status===Me.valid&&u)})),d.promise()}if(!o)return n}return!1}_afterSaveEditData(e){let t;const i=this.getEditMode()===Si;if(x(this.getChanges(),((n,s)=>{const o=this._showErrorRow(s);t=t||o})),t){const n=this._rowsView.getScrollable();n&&(n.update(),n.scrollToElement(t))}if(e&&i&&this._needUpdateRow()){const n=this.getEditRowIndex();this._dataController.updateItems({changeType:"update",rowIndices:[n]}),this._focusEditingCell()}else if(!e){let n=!0;i&&(n=!(this._columnsController.getColumns().filter((a=>{var l;return a.showEditorAlways&&((l=a.validationRules)===null||l===void 0?void 0:l.length)>0})).length>0)),n&&this._validatingController.initValidationState()}}_handleDataChanged(e){const t=this._validatingController._validationState;this.option("scrolling.mode")==="standard"&&this.resetRowAndPageIndices(),e.changeType==="prepend"&&x(t,((i,n)=>{n.rowIndex+=e.items.length})),super._handleDataChanged(e)}resetRowAndPageIndices(){const e=this._validatingController._validationState;x(e,((t,i)=>{i.pageIndex!==this._pageIndex&&(delete i.pageIndex,delete i.rowIndex)}))}_beforeCancelEditData(){this._validatingController.initValidationState(),super._beforeCancelEditData()}_showErrorRow(e){let t;const i=this._dataController.items(),n=this.getIndexByKey(e.key,i),s=this._validatingController._getValidationData(e.key);if(!(s!=null&&s.isValid)&&s!==null&&s!==void 0&&s.errorText&&n>=0)return t=this.getPopupContent(),this._errorHandlingController&&this._errorHandlingController.renderErrorRow(s==null?void 0:s.errorText,n,t)}updateFieldValue(e){const t=new S;return this._validatingController.removeCellValidationResult({change:this.getChangeByKey(e.key),columnIndex:e.column.index}),super.updateFieldValue.apply(this,arguments).done((()=>{const i=this._validatingController.getCellValidator({rowKey:e.key,columnIndex:e.column.index});O(i&&this._validatingController.validateCell(i)).done((n=>{this._editorFactoryController.refocus(),t.resolve(n)}))})),t.promise()}highlightDataCell(e,t){super.highlightDataCell.apply(this,arguments),this._validatingController.setCellValidationStatus(t);const i=!!t.setValue,n=this.isCellModified(t),s=m(t.validationStatus);if(n&&t.column.setCellValue||i&&!n&&!(t.row.isNewRow||!s)){const a=e.data("dxValidator");a&&O(this._validatingController.validateCell(a)).done((()=>{this._validatingController.setCellValidationStatus(t)}))}}getChangeByKey(e){const t=this.getChanges();return t[y.getIndexByKey(e,t)]}isCellModified(e){const t=super.isCellModified(e),i=this.getChangeByKey(e.key),n=!!e.row&&this._validatingController.isInvalidCell({rowKey:e.key,columnIndex:e.column.index});return t||this._validatingController._rowIsValidated(i)&&n}},Nx=function(r,e){const t=h(e).closest("tr").index(),i=h(r._rowsView.getRowElement(t)).first().children().filter(":not(.dx-hidden-cell)");return r._rowsView._getWidths(i).reduce(((n,s)=>n+s),0)},Lx=function(r){let e,t;return r.some(((i,n)=>{if(i.command==="transparent")return e=n===0?-1:n,t=n===r.length-1?-1:n+i.colspan-1,!0})),{startColumnIndex:e,endColumnIndex:t}},$x=r=>class extends r{_showRevertButton(e){var t,i;let n=(t=this._revertTooltip)===null||t===void 0?void 0:t.$element();if(!e||!e.length){var s;(s=n)===null||s===void 0||s.remove(),this._revertTooltip=void 0;return}if(e.find(n).length){var o;(o=this._revertTooltip)===null||o===void 0||o.repaint();return}const a=this.getRevertButtonContainer(e),l=this.addWidgetPrefix("revert-tooltip");(i=n)===null||i===void 0||i.remove(),n=h("<div>").addClass(l).appendTo(e);const d={animation:null,visible:!0,width:"auto",height:"auto",shading:!1,container:a,propagateOutsideClick:!0,hideOnOutsideClick:!1,wrapperAttr:{class:l},contentTemplate:()=>{const c=h("<div>").addClass("dx-revert-button"),u={icon:"revert",hint:this.option("editing.texts.validationCancelChanges"),elementAttr:{id:"dxRevertButton","aria-label":w.format("dxDataGrid-ariaRevertButton")},onClick:()=>{this._editingController.cancelEditData()}};return new Ze(c,u).$element()},position:{my:"left top",at:"right top",offset:"1 0",collision:"flip",boundaryOffset:"0 0",boundary:this._rowsView.element(),of:e},onPositioned:this.overlayPositionedHandler.bind(this)};this._revertTooltip=new wi(n,d)}_hideFixedGroupCell(e,t){var i,n;let s,o;const a=(i=this._rowsView)===null||i===void 0||(n=i.isFixedColumns)===null||n===void 0?void 0:n.call(i),l=this._editingController.isFormOrPopupEditMode();if(a&&!l){const d=e.closest(".dx-row").next().data("options");d&&d.rowType==="group"&&(s=h(this._rowsView.getRowElement(d.rowIndex)).last(),o=s.find(".dx-group-cell"),o.length&&o.get(0).style.visibility!=="hidden"&&(o.css("visibility","hidden"),t.onDisposing=function(){o.css("visibility","")}))}}_showValidationMessage(e,t,i){const n=e.find(".dx-dropdowneditor-overlay").data("dxPopup"),s=n&&n.option("visible"),o=s?"top right":`top ${i}`,a=s?"top left":`bottom ${i}`,l=this.getValidationMessageContainer(e);let d="";t&&t.forEach((g=>{d+=(d.length?"<br/>":"")+hp(g)}));const c=this.addWidgetPrefix("invalid-message");this._rowsView.element().find(`.${c}`).remove();const u=h("<div>").addClass("dx-invalid-message").addClass("dx-invalid-message-always").addClass(c).html(d).appendTo(e),p={container:l,shading:!1,width:"auto",height:"auto",visible:!0,animation:!1,propagateOutsideClick:!0,hideOnOutsideClick:!1,wrapperAttr:{id:"dxInvalidMessage",class:`dx-invalid-message dx-invalid-message-always ${c}`},position:{collision:"flip",boundary:this._rowsView.element(),boundaryOffset:"0 0",offset:{x:0,y:!s&&me.mozilla?-1:0},my:o,at:a,of:e},onPositioned:g=>{this.overlayPositionedHandler(g,s),this._shiftValidationMessageIfNeed(g.component.$content(),e)}};this._hideFixedGroupCell(e,p),new wi(u,p)}getValidationMessages(){var e;return(e=this._rowsView.element())===null||e===void 0?void 0:e.find(this._getValidationMessagesSelector())}getRevertButton(){var e;return h((e=this._revertTooltip)===null||e===void 0?void 0:e.element())}_hideValidationMessage(){var e;const t=(e=this._rowsView.element())===null||e===void 0?void 0:e.find(this._getValidationMessagesSelector());t==null||t.remove()}_normalizeValidationMessagePositionAndMaxWidth(e,t,i){const n=this._columnsController.getFixedColumns();if(!n||!n.length)return;let s;const o=!t&&Nx(this,e.element),a=e.component.$content(),l=ge(a,!0),d=!t&&l>o,c=this._rowsView.getCellIndex(h(e.element).closest("td")),u=Lx(n);return!t&&(c===u.startColumnIndex||d)?s={collision:"none flip",my:"top left",at:i?"top right":"bottom left"}:c===u.endColumnIndex&&(s={collision:"none flip",my:"top right",at:t||i?"top left":"bottom right"},t&&(s.offset="-1 0")),s&&{position:s,maxWidth:d?o-2:void 0}}_shiftValidationMessageIfNeed(e,t){const i=this._revertTooltip&&this._revertTooltip.$content();if(!i)return;const n=e.offset(),s=i.offset();if(n.top===s.top&&n.left+H(e)>s.left){const o=H(i)+2;e.css("left",s.left<t.offset().left?-o:o)}}getOverlayBaseZIndex(){return wi.baseZIndex()}overlayPositionedHandler(e,t){if(!e.component.__skipPositionProcessing){const i=h(e.element).hasClass(this.addWidgetPrefix("revert-tooltip")),n=!i&&this._rowsView.updateFreeSpaceRowHeight(),s=this._normalizeValidationMessagePositionAndMaxWidth(e,i,t);e.component.__skipPositionProcessing=!!(n||s),s?e.component.option(s):n&&e.component.repaint()}}_getRevertTooltipsSelector(){return`.dx-editor-cell .${this.addWidgetPrefix("revert-tooltip")}`}_getValidationMessagesSelector(){const e=this.addWidgetPrefix("invalid-message");return`.dx-editor-cell .${e}, .dx-cell-modified .${e}`}loseFocus(e){e||this._validatingController.setValidator(null),super.loseFocus()}updateCellState(e,t,i){var n;const s=e==null?void 0:e.closest(this._getFocusCellSelector()),o=s!=null&&s.is("td")?s:null,a=s==null?void 0:s.closest(".dx-row").data("options"),l=a?this._editingController.getChangeByKey(a.key):null,d=o&&this._columnsController.getVisibleColumns()[o.index()],c=(l==null||(n=l.data)===null||n===void 0?void 0:n[d==null?void 0:d.name])!==void 0&&!this._editingController.isSaving(),u=[];if(this._editingController.getEditMode()===Si&&((t==null?void 0:t.status)===Me.invalid||c?(this._showRevertButton(s),u.push("dxRevertButton")):this._revertTooltip&&this._revertTooltip.$element().remove()),t&&t.status===Me.invalid&&o&&d&&t&&t.brokenRules){const g=[];t.brokenRules.forEach((_=>{_.message&&g.push(_.message)})),g.length&&(this._showValidationMessage(s,g,d.alignment||"left"),u.push("dxInvalidMessage"))}this._updateAriaValidationAttributes(s,u),!i&&this._rowsView.element()&&this._rowsView.updateFreeSpaceRowHeight()}_updateAriaValidationAttributes(e,t){if(t.length===0)return;const i=this._editingController.getEditMode();if([Si,Gn,gu].includes(i)){const s=this._getCurrentFocusElement(e);s.attr("aria-labelledby",t.join(" ")),s.attr("aria-invalid",!0)}}_getCurrentFocusElement(e){return this._editingController.isEditing()?e.find(fr).first():e}focus(e,t){if(!arguments.length)return super.focus();if(this._hideValidationMessage(),e!=null&&e.hasClass("dx-row")||e!=null&&e.hasClass("dx-master-detail-cell"))return super.focus(e,t);const i=e==null?void 0:e.closest(this._getFocusCellSelector()),n=i&&(i.data("dxValidator")||e.find(`.${this.addWidgetPrefix("validator")}`).eq(0).data("dxValidator")),s=i&&i.closest(".dx-row").data("options"),o=s?this._editingController.getChangeByKey(s.key):null;let a;if(n){this._validatingController.setValidator(n);const l=n.option("adapter").getValue();if(_u(l,s)||this._validatingController._rowIsValidated(o))return this._editingController.waitForDeferredOperations().done((()=>{this._rowsView.isElementInside(e)&&O(this._validatingController.validateCell(n)).done((c=>{a=c;const{column:u}=a.validator.option("dataGetter")();o&&u&&!this._validatingController.isCurrentValidatorProcessing({rowKey:o.key,columnIndex:u.index})||(!st(Se())&&a.status===Me.invalid&&(t=!0),this.updateCellState(e,a,t),super.focus.call(this,e,t))}))})),super.focus(e,t)}return this.updateCellState(e,a,t),super.focus(e,t)}getEditorInstance(e){const t=e.find(".dx-texteditor").eq(0);return y.getWidgetInstance(t)}getValidationMessageContainer(e){return e.closest(`.${this.addWidgetPrefix("content")}`)}getRevertButtonContainer(e){return e.closest(`.${this.addWidgetPrefix("content")}`).parent()}hasOverlayElements(){const e=this.getValidationMessages(),t=this.getRevertButton();return super.hasOverlayElements()||!!(e!=null&&e.length)||!!(t!=null&&t.length)}},Hx=r=>class extends r{_getValidationStatus(e){return(ji(e)?e.status:e)||Me.valid}_isCellChanged(e,t,i,n,s){var o,a;const l=(o=e.cells)===null||o===void 0?void 0:o[n],d=this._getValidationStatus({status:l==null?void 0:l.validationStatus}),c=this._validatingController.getCellValidationResult({rowKey:e.key,columnIndex:n}),u=this._validatingController._getValidationData(e.key),p=this._getValidationStatus(c),g=JSON.stringify(t.modifiedValues)!==JSON.stringify(e.modifiedValues),_=d!==p&&g,f=h(l==null?void 0:l.cellElement).hasClass(this.addWidgetPrefix("invalid")),C=l==null||(a=l.column.validationRules)===null||a===void 0?void 0:a.length,I=e.isEditing!==t.isEditing&&C,E=_||u.isValid&&f;return I||E?!0:super._isCellChanged.apply(this,arguments)}},Wx=r=>class extends r{updateFreeSpaceRowHeight(e){const t=this;let i,n,s;const o=t.element(),a=o&&o.find(`.${t.addWidgetPrefix("invalid-message")} .dx-overlay-content`);if(super.updateFreeSpaceRowHeight(e),a&&a.length){i=t._getRowElements().filter(":visible"),s=t._getFreeSpaceRowElements(e),n=s.first();const l=i.find(":focus").length>0;if(n&&i.length===1&&(!n.is(":visible")||Y(a)>Y(n))&&l)return s.show(),ti(s,Y(a)),!0}}_formItemPrepared(e,t){super._formItemPrepared.apply(this,arguments),je((()=>{const i=t.find(".dx-widget").first();i.length&&!i.children().length||this._validatingController.createValidator(e,i)}))}_cellPrepared(e,t){this._editingController.isFormOrPopupEditMode()||this._validatingController.createValidator(t,e),super._cellPrepared.apply(this,arguments)}_restoreErrorRow(e){this._editingController&&this._editingController.hasChanges()&&this._getRowElements(e).each(((t,i)=>{const n=h(i).data("options");if(n){const s=this._editingController.getChangeByKey(n.key);s&&this._editingController._showErrorRow(s)}}))}},zS={defaultOptions:()=>({editing:{texts:{validationCancelChanges:w.format("dxDataGrid-validationCancelChanges")}}}),controllers:{validating:Mx},extenders:{controllers:{editing:Bx,editorFactory:$x,data:Hx},views:{rowsView:Wx}}},so="scrolling.legacyMode",fu=r=>r.option("scrolling.loadTwoPagesOnStart")||r._controller.isVirtual()||r._controller.getViewportItemIndex()>0,Un=r=>r._cache.length?r._cache[0].pageIndex:-1,Wo=r=>r._cache.length?r._cache[r._cache.length-1].pageIndex:-1,as=(r,e,t)=>{r._isChangedFiring=!0,e(t),r._isChangedFiring=!1},$l=(r,e,t)=>{if(r._isDelayChanged)return r._isDelayChanged=!1,as(r,e,t),!0},zx=r=>{const e=r._dataOptions.pageSize();if(r.option("scrolling.preventPreload"))return 0;let i=r._controller.viewportSize();if(r._controller.isVirtualMode()&&r.option("scrolling.removeInvisiblePages")){i=0;const n=r._controller.viewportSize()*r._controller.viewportItemSize();let s=r._controller.getContentOffset();const o=r._controller.getViewportPosition(),a=r._controller.virtualItemsCount(),l=r._dataOptions.totalItemsCount();for(let d=a.begin;d<l&&!(s>=o+n);d++){const c=r._controller.getItemSizes()[d]||r._controller.viewportItemSize();s+=c,s>=o&&i++}}return e&&i>0?Math.ceil(i/e):1},qn=(r,e)=>{const t=r.option("scrolling.preloadEnabled");let i=zx(r);const n=r._controller.isAppendMode();return i&&(e?i=t?1:0:(t&&i++,(n||!fu(r))&&i--)),i},Kx=r=>{let e=-1;const t=Un(r),i=r._dataOptions;return t<0?e=r._pageIndex:r._cache[r._pageIndex-t]?t>=0&&r._controller.viewportSize()>=0&&(t>0&&(Wo(r)+1===i.pageCount()&&r._cache.length<qn(r)+1||r._pageIndex===t&&qn(r,!0))&&(e=t-1),e<0&&t+r._cache.length<=r._pageIndex+qn(r)&&(e=t+r._cache.length)):e=r._pageIndex,r._loadingPageIndexes[e]&&(e=-1),e},Gx=(r,e)=>{const t=r._dataOptions;if(e===r.pageIndex()||!t.isLoading()&&e<t.pageCount()||!t.hasKnownLastPage()&&e===t.pageCount())return t.pageIndex(e),r._loadingPageIndexes[e]=!0,O(t.load()).always((()=>{r._loadingPageIndexes[e]=!1}))},Hl=(r,e,t,i,n)=>{const s=r._dataOptions,o=s.items().slice();let a=L(t)?t:void 0;const l=t==="prepend",d=s.viewportItems();t&&W(t)&&!r._isDelayChanged&&(a={changeType:t,items:o},n&&(a.removeCount=n.itemsCount,a.removeCount&&s.correctCount&&(a.removeCount=s.correctCount(d,a.removeCount,l))));let c=n?n.itemsLength:0;c&&s.correctCount&&(c=s.correctCount(d,c,l)),t==="append"?(d.push.apply(d,o),n&&d.splice(0,c)):l?(d.unshift.apply(d,o),n&&d.splice(-c)):r._dataOptions.viewportItems(o),s.updateLoading(),r._lastPageIndex=r.pageIndex(),r._isDelayChanged=i,i||as(r,e,a)};class Ux{constructor(e,t){this._dataOptions=t,this._controller=e,this._pageIndex=this._lastPageIndex=t.pageIndex(),this._cache=[],this._loadingPageIndexes={}}option(){return this._controller.option.apply(this._controller,arguments)}viewportItemIndexChanged(e){const t=this._dataOptions.pageSize(),i=this._dataOptions.pageCount(),n=this._controller.isVirtualMode(),s=this._controller.isAppendMode(),o=this._dataOptions.totalItemsCount();let a;if(t&&(n||s)&&o>=0){const l=this._controller.viewportSize();if(l&&e+l>=o&&!this._controller.isVirtual())if(this._dataOptions.hasKnownLastPage()){a=i-1;const d=o%t;a>0&&d>0&&d<l&&a--}else a=i;else{a=Math.floor(e/t);const d=i-1;a=Math.max(a,0),a=Math.min(a,d)}return this.pageIndex(a),this.load()}}pageIndex(e){const t=this._controller.isVirtualMode(),i=this._controller.isAppendMode();return this.option(so)!==!1&&(t||i)?(e!==void 0&&(this._pageIndex=e),this._pageIndex):this._dataOptions.pageIndex(e)}beginPageIndex(e){let t=Un(this);return t<0&&(t=e!==void 0?e:this.pageIndex()),t}endPageIndex(){const e=Wo(this);return e>0?e:this._lastPageIndex}pageSize(){return this._dataOptions.pageSize()}load(){const e=this._dataOptions;let t;const i=this._controller.isVirtualMode(),n=this._controller.isAppendMode();if(this.option(so)!==!1&&(i||n)){const s=Kx(this);if(s>=0){const o=Gx(this,s);o&&(t=new S,o.done((()=>{const a=this._delayDeferred;a?a.done(t.resolve).fail(t.reject):t.resolve()})).fail(t.reject),e.updateLoading())}}else t=e.load();return!t&&this._lastPageIndex!==this.pageIndex()&&this._dataOptions.onChanged({changeType:"pageIndex"}),t||new S().resolve()}loadIfNeed(){const e=this._controller.isVirtualMode(),t=this._controller.isAppendMode();if((e||t)&&!this._dataOptions.isLoading()&&(!this._isChangedFiring||this._controller.isVirtual())){const i=this._controller.getViewportPosition();i>0?this._controller._setViewportPositionCore(i):this.load()}}handleDataChanged(e,t){const i=this._dataOptions;let n=this._cache.length,s,o;const a=this._controller.isVirtualMode(),l=this._controller.isAppendMode();if(t&&t.changes)as(this,e,t);else if(this.option(so)!==!1&&(a||l)){const d=Un(this);if(d>=0&&(a&&d+this._cache.length!==i.pageIndex()&&d-1!==i.pageIndex()&&(n=0,this._cache=[]),l)){if(i.pageIndex()===0)this._cache=[];else if(i.pageIndex()<Wo(this)){as(this,e,{changeType:"append",items:[]});return}}const c={pageIndex:i.pageIndex(),itemsLength:i.items(!0).length,itemsCount:this.itemsCount(!0)};this.option("scrolling.removeInvisiblePages")&&a?o=this._cache.length>Math.max(qn(this)+(this.option("scrolling.preloadEnabled")?1:0),2):$l(this,e,{isDelayed:!0});let u;d===i.pageIndex()+1?(o&&(u=this._cache.pop()),s="prepend",this._cache.unshift(c)):(o&&(u=this._cache.shift()),s="append",this._cache.push(c));const p=a&&n===0&&fu(this);Hl(this,e,this._cache.length>1?s:void 0,p,u),this._delayDeferred=this.load().done((()=>{$l(this,e)&&this.load()}))}else Hl(this,e,t)}getDelayDeferred(){return this._delayDeferred}itemsCount(e){let t=0;const i=this._controller.isVirtualMode();return!e&&i?this._cache.forEach((n=>{t+=n.itemsCount})):t=this._dataOptions.itemsCount(),t}virtualItemsCount(){let e=Un(this);e<0&&(e=this._dataOptions.pageIndex());const t=e*this._dataOptions.pageSize(),i=this._cache.length*this._dataOptions.pageSize(),n=Math.max(0,this._dataOptions.totalItemsCount()-i-t);return{begin:t,end:n}}reset(){this._loadingPageIndexes={},this._cache=[]}}const An="scrolling.legacyMode",Wl=r=>r.option("scrolling.mode")==="virtual"||r._isVirtual,qx=r=>r.option("scrolling.mode")==="infinite"&&!r._isVirtual;function Cu(r,e,t){let i;const n=[],s=[];t=t||r;function o(c){const u=c.element?c.$element():c,p=ei.offset(u);return p?c.scrollTop()-(p.top-r.offset().top):r.offset().top}const a={on(c,u,p){c.on("scroll",p)},off(c,u,p){c.off("scroll",p)}};function l(c){const u=c.get(0).nodeName==="#document",p=c.get(0).nodeType===oe().Node.ELEMENT_NODE;let g=c.data("dxScrollable"),_=a;if(!g&&(g=u&&h(oe())||p&&c.css("overflowY")==="auto"&&c,_=v,!g))return;const f=(function(C){return function(){let I=C.scrollTop()-o(C);I=I>0?I:0,e(I)}})(g);_.on(g,"scroll",f),n.push((C=>{const I=o(g),E=g.scrollTo?"scrollTo":"scrollTop";C-I>=0&&g[E](C+I)})),s.push((()=>{_.off(g,"scroll",f)}))}const d=c=>h(c.get(0).parentNode??c.get(0).host);for(i=t.parent();i.length;i=d(i))l(i);return{scrollTo(c){x(n,((u,p)=>{p(c)}))},dispose(){x(s,((c,u)=>{u()}))}}}class Ir{constructor(e,t,i){this._dataOptions=t,this.component=e,this._viewportSize=e.option(An)===!1?15:0,this._viewportItemSize=20,this._viewportItemIndex=0,this._position=0,this._isScrollingBack=!1,this._contentSize=0,this._itemSizes={},this._sizeRatio=1,this._isVirtual=i,this.positionChanged=$e(),this._dataLoader=new Ux(this,this._dataOptions)}getItemSizes(){return this._itemSizes}option(e,t){return this.component.option.apply(this.component,arguments)}isVirtual(){return this._isVirtual}virtualItemsCount(){if(Wl(this)){const e=this._dataOptions,t=e.totalItemsCount();if(this.option(An)===!1&&t!==-1){const i=this.getViewportParams(),n=e.loadedOffset(),s=e.loadedItemCount(),o=Math.max(i.skip,n),a=Math.min(i.take,s),l=Math.max(t-(o+a),0);return{begin:o,end:l}}return this._dataLoader.virtualItemsCount.apply(this._dataLoader,arguments)}}getScrollingTimeout(){const e=this.option("scrolling.renderAsync");let t=0;return m(e)?e&&(t=this.option("scrolling.timeout")??0):(t=Math.min(this.option("scrolling.timeout")||0,this._dataOptions.changingDuration()),t<this.option("scrolling.renderingThreshold")&&(t=this.option("scrolling.minTimeout")||0)),t}setViewportPosition(e){const t=new S,i=this.getScrollingTimeout();return clearTimeout(this._scrollTimeoutID),i>0?this._scrollTimeoutID=setTimeout((()=>{this._setViewportPositionCore(e),t.resolve()}),i):(this._setViewportPositionCore(e),t.resolve()),t.promise()}getViewportPosition(){return this._position}getItemIndexByPosition(e,t,i){e=e??this._position;const n=this.getItemSize();let s=0,o=0;const a=Object.keys(this._itemSizes).concat(-1);for(let l=0;l<a.length&&s<e;l++){const d=parseInt(a[l]);let c=(e-s)/n;if(d<0||o+c<d){o+=c,this._sizeRatio<1&&m(t)&&(o=t+i/this._viewportItemSize);break}else c=d-o,s+=c*n,o+=c;const u=this._itemSizes[d];s+=u,o+=s<e?1:(e-s+u)/u}return Math.round(50*o)/50}isScrollingBack(){return this._isScrollingBack}_setViewportPositionCore(e){const t=this._position||0;this._position=e,t!==this._position&&(this._isScrollingBack=this._position<t);const i=this.getItemIndexByPosition(),n=this.setViewportItemIndex(i);return this.positionChanged.fire(),n}setContentItemSizes(e){const t=this.virtualItemsCount();if(this._contentSize=e.reduce(((i,n)=>i+n),0),t){e.forEach(((s,o)=>{this._itemSizes[t.begin+o]=s}));const i=(t.begin+t.end+this.itemsCount())*this._viewportItemSize,n=y.getContentHeightLimit(me);i>n?this._sizeRatio=n/i:this._sizeRatio=1}}getItemSize(){return this._viewportItemSize*this._sizeRatio}getItemOffset(e,t){const i=this.virtualItemsCount();let n=e;if(!i)return 0;let s=0;const o=this._dataOptions.totalItemsCount();return Object.keys(this._itemSizes).forEach((a=>{n&&(t?a>=o-e:a<e)&&(s+=this._itemSizes[a],n--)})),Math.floor(s+n*this._viewportItemSize*this._sizeRatio)}getContentOffset(e){const t=e==="end",i=this.virtualItemsCount();return i?this.getItemOffset(t?i.end:i.begin,t):0}getVirtualContentSize(){return this.virtualItemsCount()?this.getContentOffset("begin")+this.getContentOffset("end")+this._contentSize:0}getViewportItemIndex(){return this._viewportItemIndex}setViewportItemIndex(e){if(this._viewportItemIndex=e,this.option(An)!==!1)return this._dataLoader.viewportItemIndexChanged.apply(this._dataLoader,arguments)}viewportItemSize(e){return e!==void 0&&(this._viewportItemSize=e),this._viewportItemSize}viewportSize(e){return e!==void 0&&(this._viewportSize=e),this._viewportSize}viewportHeight(e,t){const i=t??this._position,n=this.getItemIndexByPosition(i),s=this.getItemIndexByPosition(i+e,n,e);this.viewportSize(Math.ceil(s-n)),!m(t)&&this._viewportItemIndex!==n&&this._setViewportPositionCore(i)}reset(e){this._dataLoader.reset(),e||(this._itemSizes={})}subscribeToWindowScrollEvents(e){this._windowScroll=this._windowScroll||Cu(e,(t=>{this.viewportItemSize()&&this.setViewportPosition(t)}))}dispose(){clearTimeout(this._scrollTimeoutID),this._windowScroll&&this._windowScroll.dispose(),this._windowScroll=null}scrollTo(e){this._windowScroll&&this._windowScroll.scrollTo(e)}isVirtualMode(){return Wl(this)}isAppendMode(){return qx(this)}getViewportParams(){const e=this.option("scrolling.mode")==="virtual",t=this._dataOptions.totalItemsCount(),n=this._dataOptions.hasKnownLastPage()&&this._viewportItemIndex>t?t:this._viewportItemIndex,s=this._viewportSize+n,o=this.option("scrolling.prerenderedRowChunkSize")||1,a=this.isScrollingBack(),l=this.option("scrolling.prerenderedRowCount")??1,d=a?l:0,c=a?0:l,u=Math.floor(Math.max(0,n-d)/o)*o;let p=Math.ceil((s+c-u)/o)*o;if(e){const g=Math.max(0,t-u);p=Math.min(p,g)}return{skip:u,take:p}}itemsCount(){let e=0;return this.option(An)?e=this._dataLoader.itemsCount.apply(this._dataLoader,arguments):e=this._dataOptions.itemsCount(),e}pageIndex(){return this._dataLoader.pageIndex(...arguments)}beginPageIndex(){return this._dataLoader.beginPageIndex(...arguments)}endPageIndex(){return this._dataLoader.endPageIndex(...arguments)}pageSize(){return this._dataLoader.pageSize(...arguments)}load(){return this._dataLoader.load(...arguments)}loadIfNeed(){return this._dataLoader.loadIfNeed(...arguments)}handleDataChanged(){return this._dataLoader.handleDataChanged(...arguments)}getDelayDeferred(){return this._dataLoader.getDelayDeferred()}}const KS={VirtualScrollController:Ir},vu="dx-freespace-row",Yx="dx-row-inserted",N="scrolling.legacyMode",jx=["beginPageIndex","endPageIndex","pageIndex"],Ve=function(r){return r.option("scrolling.mode")==="virtual"},at=function(r){return r.option("scrolling.mode")==="infinite"},et=function(r){return Ve(r)||at(r)},zl=function(r,e,t,i){for(let n=0;n<e+1;n++){const s=r[t?r.length-1-n:n];s&&!i(s,n===e,t)&&e++}return e},Yn=function(r,e){return r.rowType==="data"&&!r.isNewRow||r.rowType==="group"&&e.isGroupItemCountable(r.data)},Xx=function(r){return r.forEach(((e,t)=>{e.rowIndex=t})),r},oo=function(r){const e=r._virtualScrollController.beginPageIndex(-1);Ve(r)&&(e<0||r.viewportSize()>=0&&r.getViewportItemIndex()>=0&&(e*r.pageSize()>r.getViewportItemIndex()||e*r.pageSize()+r.itemsCount()<r.getViewportItemIndex()+r.viewportSize())&&r._dataSource.isLoading()?r._isLoading||(r._isLoading=!0,r.loadingChanged.fire(!0)):r._isLoading&&(r._isLoading=!1,r.loadingChanged.fire(!1)))},De=function(r,e,t){if(r.option(N)===!1&&jx.includes(e)){const n=r._dataSource;return n.pageIndex.apply(n,t)}const i=r._virtualScrollController;return i[e].apply(i,t)},Kl=function(r,e){const t=r.toArray().map((n=>h(n).parent(`.${e}`).get(0))).filter((n=>n));t.length&&(r=h(t));const i=e===vu?r.length-1:r.length;for(let n=0;n<i;n++)r.eq(n).remove()},GS=r=>class extends r{init(){super.init.apply(this,arguments),this._items=[],this._totalCount=-1,this._isLoaded=!0,this._loadPageCount=1,this._virtualScrollController=new Ir(this.component,this._getVirtualScrollDataOptions())}dispose(){this._virtualScrollController.dispose(),super.dispose.apply(this,arguments)}_getVirtualScrollDataOptions(){const e=this;return{pageSize:()=>e.pageSize(),totalItemsCount:()=>e.totalItemsCount(),hasKnownLastPage:()=>e.hasKnownLastPage(),pageIndex:t=>e._dataSource.pageIndex(t),isLoading:()=>e._dataSource.isLoading()&&!e.isCustomLoading(),pageCount:()=>e.pageCount(),load:()=>e._dataSource.load(),updateLoading(){oo(e)},itemsCount:()=>e.itemsCount(!0),items:()=>e._dataSource.items(),viewportItems(t){return t&&(e._items=t),e._items},onChanged(t){e.changed.fire(t)},changingDuration(){return e.isLoading()?300:e._renderTime||0}}}_handleLoadingChanged(e){if(this.option(N)===!1){super._handleLoadingChanged.apply(this,arguments);return}(!Ve(this)||this._isLoadingAll)&&(this._isLoading=e,super._handleLoadingChanged.apply(this,arguments)),e?this._startLoadTime=new Date:this._startLoadTime=void 0}_handleLoadError(){this.option(N)!==!1&&(this._isLoading=!1,this.loadingChanged.fire(!1)),super._handleLoadError.apply(this,arguments)}_handleDataChanged(e){if(this.option(N)===!1){this._items=this._dataSource.items().slice(),this._totalCount=this._dataSourceTotalCount(!0),super._handleDataChanged.apply(this,arguments);return}const t=super._handleDataChanged.bind(this);this._virtualScrollController.handleDataChanged(t,e)}_customizeRemoteOperations(e,t){const i=this.option(N)===!1;let n=this.option("scrolling.renderAsync");m(n)||(n=this._renderTime>=this.option("scrolling.renderingThreshold")),(Ve(this)||at(this)&&i)&&!t.reload&&(t.skip||i)&&!n&&(e.delay=void 0),super._customizeRemoteOperations.apply(this,arguments)}items(){return this._items}_dataSourceTotalCount(e){return this.option(N)===!1&&Ve(this)&&!e?this._totalCount:super._dataSourceTotalCount()}itemsCount(e){return e||this.option(N)===!1?super.itemsCount():this._virtualScrollController.itemsCount()}load(e){return this.option(N)===!1||e?super.load(e):this._virtualScrollController.load()}isLoading(){return this.option(N)===!1?this._dataSource.isLoading():this._isLoading}isLoaded(){return this._dataSource.isLoaded()&&this._isLoaded}resetPagesCache(e){e||this._virtualScrollController.reset(!0),super.resetPagesCache.apply(this,arguments)}_changeRowExpandCore(){const e=super._changeRowExpandCore.apply(this,arguments);return this.option(N)===!1||(this.resetPagesCache(),oo(this)),e}reload(){this._dataSource.pageIndex(this.pageIndex());const e=this._virtualScrollController;if(this.option(N)!==!1&&e){const t=new S;return super.reload.apply(this,arguments).done((i=>{const n=e.getDelayDeferred();n?n.done(t.resolve).fail(t.reject):t.resolve(i)})).fail(t.reject),t}return super.reload.apply(this,arguments)}refresh(e,t){if(this.option(N)!==!1){const{storeLoadOptions:i}=e,n=this._dataSource;t.reload?(this._virtualScrollController.reset(),n.items().length=0,this._isLoaded=!1,oo(this),this._isLoaded=!0,at(this)?(this.pageIndex(0),n.pageIndex(0),i.pageIndex=0,e.pageIndex=0,i.skip=0):(n.pageIndex(this.pageIndex()),n.paginate()&&(e.pageIndex=this.pageIndex(),i.skip=this.pageIndex()*this.pageSize()))):at(this)&&i.skip&&this._totalCountCorrection<0&&(i.skip+=this._totalCountCorrection)}return super.refresh.apply(this,arguments)}loadPageCount(e){if(!m(e))return this._loadPageCount;this._loadPageCount=e}_handleDataLoading(e){const t=this.loadPageCount(),i=this.pageSize(),n=this.option(N)===!1,{storeLoadOptions:s}=e,o=m(s.take);e.loadPageCount=t,!e.isCustomLoading&&n&&o&&t>1&&i>0&&(s.take=t*i),super._handleDataLoading.apply(this,arguments)}_loadPageSize(){return super._loadPageSize.apply(this,arguments)*this.loadPageCount()}beginPageIndex(){return De(this,"beginPageIndex",[...arguments])}endPageIndex(){return De(this,"endPageIndex",[...arguments])}pageIndex(e){return De(this,"pageIndex",[...arguments])}virtualItemsCount(){return De(this,"virtualItemsCount",[...arguments])}getContentOffset(){return De(this,"getContentOffset",[...arguments])}getVirtualContentSize(){return De(this,"getVirtualContentSize",[...arguments])}setContentItemSizes(){return De(this,"setContentItemSizes",[...arguments])}setViewportPosition(){return De(this,"setViewportPosition",[...arguments])}getViewportItemIndex(){return De(this,"getViewportItemIndex",[...arguments])}setViewportItemIndex(e){return De(this,"setViewportItemIndex",[...arguments])}getItemIndexByPosition(){return De(this,"getItemIndexByPosition",[...arguments])}viewportSize(){return De(this,"viewportSize",[...arguments])}viewportItemSize(){return De(this,"viewportItemSize",[...arguments])}getItemSize(){return De(this,"getItemSize",[...arguments])}getItemSizes(){return De(this,"getItemSizes",[...arguments])}loadIfNeed(){return De(this,"loadIfNeed",[...arguments])}},Zx=r=>class extends r{dispose(){const e=this._rowsScrollController;e&&e.dispose(),super.dispose.apply(this,arguments)}_refreshDataSource(){const e=super._refreshDataSource.apply(this,arguments)||new S().resolve().promise();return e.done(this.initVirtualRows.bind(this)),e}_loadDataSource(){if(this._rowsScrollController&&et(this)){var e;const{loadPageCount:t}=m(this._loadViewportParams)?this.getLoadPageParams():{loadPageCount:0};t>=1&&((e=this._dataSource)===null||e===void 0||e.loadPageCount(t))}return super._loadDataSource.apply(this,arguments)}getRowPageSize(){const e=this.option("scrolling.rowPageSize"),t=this.pageSize();return t&&t<e?t:e}reload(){const e=this._rowsScrollController||this._dataSource,t=e==null?void 0:e.getItemIndexByPosition(),i=super.reload.apply(this,arguments);return i==null?void 0:i.done((()=>{if(Ve(this)||y.isVirtualRowRendering(this)){const s=this.getRowIndexOffset(),o=Math.floor(t)-s,{component:a}=this,l=a.getScrollable&&a.getScrollable(),d=this.dataSource().operationTypes().sorting;if(l&&!d&&o>=0){var n;const c=a.getRowElement(o),u=(c==null?void 0:c[0])&&h(c[0]);let p=u==null||(n=u.position())===null||n===void 0?void 0:n.top;const g=me.chrome&&Number(me.version??0)>=91,_=me.mozilla||g?1:0;p&&p>_&&(p=Math.round(p+Y(u)*(t%1)),l.scrollTo({y:p}))}}}))}initVirtualRows(){const e=y.isVirtualRowRendering(this);if(this._allItems=null,this._loadViewportParams=null,this.option("scrolling.mode")!=="virtual"&&!e||!e||this.option(N)!==!1&&!this.option("scrolling.rowPageSize")){this._visibleItems=null,this._rowsScrollController=null;return}const t=!Ve(this)&&this.pageIndex()>=this.pageCount()?this.pageCount()-1:this.pageIndex();this._rowPageIndex=Math.ceil(t*this.pageSize()/this.getRowPageSize()),this._visibleItems=this.option(N)===!1?null:[],this._viewportChanging=!1,this._needUpdateViewportAfterLoading=!1,this._rowsScrollController||(this._rowsScrollController=new Ir(this.component,this._getRowsScrollDataOptions(),!0),this._rowsScrollController.positionChanged.add((()=>{var i;if(this.option(N)===!1){this._viewportChanging=!0,this.loadViewport(),this._viewportChanging=!1;return}(i=this._dataSource)===null||i===void 0||i.setViewportItemIndex(this._rowsScrollController.getViewportItemIndex())}))),this.option(N)===!1&&this._updateLoadViewportParams(),this.isLoaded()&&this.option(N)!==!1&&this._rowsScrollController.load()}isViewportChanging(){return this._viewportChanging}_getRowsScrollDataOptions(){const e=this,t=function(i){return Yn(i,e._dataSource)};return{pageSize:()=>e.getRowPageSize(),loadedOffset(){var i;return Ve(e)&&((i=e._dataSource)===null||i===void 0?void 0:i.lastLoadOptions().skip)||0},loadedItemCount:()=>e._itemCount,totalItemsCount(){return et(e)?e.totalItemsCount():e.option(N)===!1?e._itemCount:e._items.filter(t).length},hasKnownLastPage:()=>e.option(N)===!1?e.hasKnownLastPage():!0,pageIndex(i){return i!==void 0&&(e._rowPageIndex=i),e._rowPageIndex},isLoading:()=>e.isLoading(),pageCount(){return Math.ceil(this.totalItemsCount()/this.pageSize())||1},load(){e._rowsScrollController.pageIndex()>=this.pageCount()&&(e._rowPageIndex=this.pageCount()-1,e._rowsScrollController.pageIndex(e._rowPageIndex)),!(!this.items().length&&this.totalItemsCount())&&e._rowsScrollController.handleDataChanged((i=>{i=i||{},i.changeType=i.changeType||"refresh",i.items=i.items||e._visibleItems,e._visibleItems.forEach(((n,s)=>{n.rowIndex=s})),e._fireChanged(i)}))},updateLoading(){},itemsCount(){return this.items(!0).length},correctCount:(i,n,s)=>zl(i,n,s,((o,a,l)=>o.isNewRow?a&&!l:a&&l?!o.isNewRow:t(o))),items(i){let n=e._items;if(e.option(N)){const s=e.dataSource(),o=s==null?void 0:s.virtualItemsCount(),a=o?o.begin:0,l=e.getRowPageSize();let d=e._rowPageIndex*l-a,c=l;if(d<0)return[];d&&(d=this.correctCount(n,d),n=n.slice(d)),c&&(c=this.correctCount(n,c),n=n.slice(0,c))}return i?n.filter(t):n},viewportItems(i){return i&&e.option(N)!==!1&&(e._visibleItems=i),e._visibleItems},onChanged(){},changingDuration(){const i=e.dataSource();return i!=null&&i.isLoading()&&e.option(N)!==!1?300:(i==null?void 0:i._renderTime)||0}}}_updateItemsCore(e){const t=this.getRowIndexDelta();if(super._updateItemsCore.apply(this,arguments),this.option(N)===!1&&y.isVirtualRowRendering(this)){e.changeType==="update"&&e.rowIndices.length===0&&e.cancelEmptyChanges&&(e.cancel=!0);return}const i=this._rowsScrollController;if(i){const n=this._visibleItems,s=e.changeType==="refresh"||e.isLiveUpdate;if(e.changeType==="append"&&e.items&&!e.items.length)return;s||e.changeType==="append"||e.changeType==="prepend"?(e.cancel=!0,s&&i.reset(!0),i.load()):(e.changeType==="update"?e.rowIndices.forEach(((o,a)=>{const l=e.changeTypes[a],d=e.items[a];l==="update"?n[o]=d:l==="insert"?n.splice(o,0,d):l==="remove"&&n.splice(o,1)})):(n.forEach(((o,a)=>{n[a]=this._items[a+t]||n[a]})),e.items=n),Xx(n))}}_updateLoadViewportParams(){const e=this._rowsScrollController.getViewportParams(),t=this.pageSize();if(e&&!et(this)&&t>0){const i=this.pageIndex()*t;e.skip+=i}this._loadViewportParams=e}_processItems(){const e=super._processItems.apply(this,arguments);if(this.option(N)===!1){const t=this._dataSource;let i=(t==null?void 0:t.lastLoadOptions().skip)??0,n,s,o,a=!1,l=[];e.forEach((d=>{const{rowType:c}=d,u=Yn(d,t),p=c==="group"&&(n||u||s!=="group"&&i>0),g=c==="data"&&u&&(n||s!=="group");!d.isNewRow&&m(n)&&(p||g)&&!(o&&!a)&&i++,(p||g)&&(a=!0),d.isNewRow?l.push(d):(l.forEach((_=>{_.loadIndex=i})),l=[]),d.loadIndex=i,n=u,s=c,o=d.isNewRow})),l.forEach((d=>{d.loadIndex=i}))}return e}_afterProcessItems(e){if(this._itemCount=e.filter((t=>Yn(t,this._dataSource))).length,m(this._loadViewportParams)){this._updateLoadViewportParams();let t=e;if(this._allItems=e,e.length){const{skipForCurrentPage:i}=this.getLoadPageParams(!0),n=e[0].loadIndex+i,{take:s}=this._loadViewportParams;t=e.filter((o=>{const a=o.isNewRow&&o.loadIndex===n&&s===0,l=o.loadIndex>=n,d=o.loadIndex<n+s||a;return l&&d}))}return t}return super._afterProcessItems.apply(this,arguments)}_applyChange(e){const t=this,{items:i}=e,{changeType:n}=e;let{removeCount:s}=e;if(s){const o=n==="prepend";s=zl(t._items,s,o,((a,l)=>a.rowType==="data"&&!a.isNewRow||a.rowType==="group"&&(t._dataSource.isGroupItemCountable(a.data)||l))),e.removeCount=s}switch(n){case"prepend":t._items.unshift.apply(t._items,i),s&&t._items.splice(-s);break;case"append":t._items.push.apply(t._items,i),s&&t._items.splice(0,s);break;default:super._applyChange(e)}}items(e){return e?this._allItems||this._items:this._visibleItems||this._items}getRowIndexDelta(){let e=0;if(this.option(N)){const t=this._visibleItems;t!=null&&t[0]&&(e=this._items.indexOf(t[0]))}return e<0?0:e}getRowIndexOffset(e,t){let i=0;const n=this.dataSource(),s=this._rowsScrollController,o=this.option(N)===!1,a=et(this);if(s&&!e)if(o&&m(this._loadViewportParams)){const{skipForCurrentPage:d,pageIndex:c}=this.getLoadPageParams(!0),u=this.items(!0);if(i=a?c*this.pageSize():0,u.length){const p=u[0].loadIndex;i+=u.filter((g=>g.loadIndex<p+d)).length}}else i=s.beginPageIndex()*s.pageSize();else if(a&&o&&n){var l;const d=n.lastLoadOptions();t&&(l=d.skips)!==null&&l!==void 0&&l.length?i=d.skips.reduce(((c,u)=>c+u),0):i=d.skip??0}else Ve(this)&&n&&(i=n.beginPageIndex()*n.pageSize());return i}getDataIndex(){return this.option(N)===!1?this.getRowIndexOffset(!0,!0):super.getDataIndex.apply(this,arguments)}viewportSize(){const e=this._rowsScrollController,t=this._dataSource,i=e==null?void 0:e.viewportSize.apply(e,arguments);return this.option(N)===!1?i:t==null?void 0:t.viewportSize.apply(t,arguments)}viewportHeight(e,t){var i;(i=this._rowsScrollController)===null||i===void 0||i.viewportHeight(e,t)}viewportItemSize(){const e=this._rowsScrollController,t=this._dataSource,i=e==null?void 0:e.viewportItemSize.apply(e,arguments);return this.option(N)===!1?i:t==null?void 0:t.viewportItemSize.apply(t,arguments)}setViewportPosition(){const e=this._rowsScrollController,t=this._dataSource;this._isPaging=!1,e?e.setViewportPosition.apply(e,arguments):t==null||t.setViewportPosition.apply(t,arguments)}setContentItemSizes(e){const t=this._rowsScrollController,i=this._dataSource,n=t==null?void 0:t.setContentItemSizes(e);return this.option(N)===!1?n:i==null?void 0:i.setContentItemSizes(e)}getPreloadedRowCount(){const e=this.option("scrolling.preloadedRowCount"),t=this.option("scrolling.preloadEnabled");if(m(e))return e;const i=this.viewportSize();return t?2*i:i}getLoadPageParams(e){var t,i;const n=this.pageSize(),s=this._loadViewportParams,o=(t=this._dataSource)===null||t===void 0?void 0:t.lastLoadOptions(),a=(o==null?void 0:o.pageIndex)||0,l=(o==null?void 0:o.take)||0,d=this._rowsScrollController.isScrollingBack(),c=d?this.getPreloadedRowCount():0,u=d?0:this.getPreloadedRowCount(),p=((i=this._dataSource)===null||i===void 0?void 0:i.totalCountCorrection())||0,g=Math.max(0,s.skip-c),_=e?a:Math.floor(n?g/n:0),f=_*n,C=s.skip-f,I=s.take+C+u-p,D=Math.ceil(n?(e?l:I)/n:0);return{pageIndex:_,loadPageCount:Math.max(1,D),skipForCurrentPage:Math.max(0,C)}}_updateVisiblePageIndex(e){if(!this._rowsScrollController)return;if(m(e)){this._silentOption("paging.pageIndex",e),this.pageChanged.fire();return}const t=this._rowsScrollController.getViewportItemIndex(),i=Math.floor(t/this.pageSize());this.pageIndex()!==i&&(this._silentOption("paging.pageIndex",i),this.updateItems({changeType:"pageIndex"}))}_getChangedLoadParams(){const e=this.getLoadPageParams(!0),{pageIndex:t,loadPageCount:i}=this.getLoadPageParams(),n=this._pageIndexIsValid(t);let s=null;return!this._isLoading&&n&&(t!==e.pageIndex||i!==e.loadPageCount)&&(s={pageIndex:t,loadPageCount:i}),s}_pageIndexIsValid(e){let t=!0;return(at(this)&&this.hasKnownLastPage()||Ve(this))&&(t=e*this.pageSize()<this.totalItemsCount()),t}_loadItems(e,t){const i=et(this),n=this._dataSource,s=this._getChangedLoadParams(),o=(n==null?void 0:n.loadPageCount())??0,a=this.pageSize()*o,l=(n==null?void 0:n.pageIndex())??0,d=(s==null?void 0:s.pageIndex)===l,c=at(this)&&this.totalItemsCount()<a,u=this.option("editing.refreshMode")==="repaint",p=(s==null?void 0:s.pageIndex)>l;let g=!1;if(!n||i&&e&&(u&&t||p||d&&c))return g;if(i&&this._isLoading&&(this._needUpdateViewportAfterLoading=!0),i&&s){g=!0,n.pageIndex(s.pageIndex),n.loadPageCount(s.loadPageCount),this._repaintChangesOnly=!0,this._needUpdateDimensions=!0;const _=this._viewportChanging;this.load().always((()=>{this._repaintChangesOnly=void 0,this._needUpdateDimensions=void 0})).done((()=>{const f=this.pageCount()>0&&this.pageIndex()===this.pageCount()-1;(_||f)&&this._updateVisiblePageIndex(),this._needUpdateViewportAfterLoading&&(this._needUpdateViewportAfterLoading=!1,this.loadViewport({checkLoadedParamsOnly:!0}))}))}return g}loadViewport(e){const{checkLoadedParamsOnly:t,checkLoading:i,viewportIsNotFilled:n}=e??{};if(et(this)||y.isVirtualRowRendering(this)){var o;this._updateLoadViewportParams();const l=this._loadItems(i,!n),d=(o=this._dataSource)===null||o===void 0?void 0:o.isCustomLoading(),c=i&&!d&&this._isLoading;if(!(l||c||t)){var a;const p=!((a=this._editingController)!==null&&a!==void 0&&(a=a.getChanges())!==null&&a!==void 0&&a.length);this.updateItems({repaintChangesOnly:!0,needUpdateDimensions:!0,useProcessedItemsCache:p,cancelEmptyChanges:!0})}}}updateViewport(){var e;const t=this.viewportSize(),i=this.items().length,n=t>i,s=((e=this._loadViewportParams)===null||e===void 0?void 0:e.take)??0,o=this._rowsScrollController,a=o==null?void 0:o.getViewportParams().take;(n||s<a)&&!this._isPaging&&i&&this.loadViewport({checkLoading:!0,viewportIsNotFilled:n})}loadIfNeed(){if(this.option(N)===!1)return;const e=this._rowsScrollController;e&&e.loadIfNeed();const t=this._dataSource;return t==null?void 0:t.loadIfNeed()}getItemSize(){const e=this._rowsScrollController;if(e)return e.getItemSize.apply(e,arguments);const t=this._dataSource;return t==null?void 0:t.getItemSize.apply(t,arguments)}getItemSizes(){const e=this._rowsScrollController;if(e)return e.getItemSizes.apply(e,arguments);const t=this._dataSource;return t==null?void 0:t.getItemSizes.apply(t,arguments)}getContentOffset(){const e=this._rowsScrollController;if(e)return e.getContentOffset.apply(e,arguments);const t=this._dataSource;return t==null?void 0:t.getContentOffset.apply(t,arguments)}refresh(e){const t=this._dataSource;return t&&e!==null&&e!==void 0&&e.load&&at(this)&&t.resetCurrentTotalCount(),super.refresh.apply(this,arguments)}topItemIndex(){var e;return(e=this._loadViewportParams)===null||e===void 0?void 0:e.skip}bottomItemIndex(){const e=this._loadViewportParams;return e&&e.skip+e.take}virtualItemsCount(){const e=this._rowsScrollController;if(e)return e.virtualItemsCount.apply(e,arguments);const t=this._dataSource;return t==null?void 0:t.virtualItemsCount.apply(t,arguments)}pageIndex(e){const t=et(this),i=this._rowsScrollController;return this.option(N)===!1&&t&&i&&e===void 0?this.option("paging.pageIndex")??0:super.pageIndex.apply(this,arguments)}_fireChanged(e){super._fireChanged.apply(this,arguments);const{operationTypes:t}=e;if(this.option(N)===!1&&et(this)&&t){const{fullReload:i,pageIndex:n}=t;e.isDataChanged&&!i&&n&&this._updateVisiblePageIndex(this._dataSource.pageIndex())}}_getPagingOptionValue(e){let t=super._getPagingOptionValue.apply(this,arguments);return this.option(N)===!1&&et(this)&&(t=this[e]()),t}isEmpty(){return this.option(N)===!1?!this.items(!0).length:super.isEmpty.apply(this,arguments)}isLastPageLoaded(){let e=!1;if(this.option(N)===!1&&et(this)){const{pageIndex:t,loadPageCount:i}=this.getLoadPageParams(!0),n=this.pageCount();e=t+i>=n}else e=super.isLastPageLoaded.apply(this,arguments);return e}reset(){this._itemCount=0,this._allItems=null,super.reset.apply(this,arguments)}_applyFilter(){var e;return(e=this._dataSource)===null||e===void 0||e.loadPageCount(1),super._applyFilter.apply(this,arguments)}getVirtualContentSize(){var e;return(e=this._dataSource)===null||e===void 0?void 0:e.getVirtualContentSize.apply(this._dataSource,arguments)}setViewportItemIndex(){var e;return(e=this._dataSource)===null||e===void 0?void 0:e.setViewportItemIndex.apply(this._dataSource,arguments)}},Qx=r=>class extends r{dispose(){super.dispose.apply(this,arguments),clearTimeout(this._resizeTimeout)}_updateMasterDataGridCore(e){return O(super._updateMasterDataGridCore.apply(this,arguments)).done((t=>{const i=Ve(e)&&e.option(N)===!1;!t&&i&&e.getScrollable()&&e.updateDimensions()}))}hasResizeTimeout(){return m(this._resizeTimeout)}resetLastResizeTime(){this._lastTime=void 0}resize(){let e;if(Ve(this)||y.isVirtualRowRendering(this)){clearTimeout(this._resizeTimeout),this._resizeTimeout=null;const t=new Date-this._lastTime,i=this.option("scrolling.updateTimeout");this._lastTime&&t<i?(e=new S,this._resizeTimeout=setTimeout((()=>{this._resizeTimeout=null,super.resize.apply(this).done(e.resolve).fail(e.reject),this._lastTime=new Date}),i),this._lastTime=new Date):(e=super.resize.apply(this),this._dataController.isLoaded()&&(this._lastTime=new Date))}else e=super.resize.apply(this);return e}},Jx=r=>class extends r{init(){var e;super.init(),this._dataController.pageChanged.add((t=>{const i=this._scrollTop;this.scrollToPage(t??this._dataController.pageIndex()),this.option(N)===!1&&this._scrollTop===i&&this._dataController.updateViewport()})),this._dataController.dataSourceChanged.add((()=>{!this._scrollTop&&this._scrollToCurrentPageOnResize()})),(e=this._dataController.stateLoaded)===null||e===void 0||e.add((()=>{this._scrollToCurrentPageOnResize()})),this._scrollToCurrentPageOnResize()}dispose(){clearTimeout(this._scrollTimeoutID),super.dispose()}_scrollToCurrentPageOnResize(){if(this._dataController.pageIndex()>0){const e=()=>{this.resizeCompleted.remove(e),this.scrollToPage(this._dataController.pageIndex())};this.resizeCompleted.add(e)}}scrollToPage(e){const t=this._dataController?this._dataController.pageSize():0;let i;if(Ve(this)||at(this)){const n=this._dataController.getItemSize(),s=this._dataController.getItemSizes(),o=e*t;i=o*n;for(const a in s)parseInt(a)<o&&(i+=s[a]-n)}else i=0;this.scrollTo({y:i,x:this._scrollLeft})}renderDelayedTemplates(){this.waitAsyncTemplates().done((()=>{this._updateContentPosition(!0)})),super.renderDelayedTemplates.apply(this,arguments)}_renderCore(e){const t=new Date,i=super._renderCore.apply(this,arguments),n=this._dataController._dataSource;if(n&&e){const s=e.items?e.items.length:20,o=this._dataController.viewportSize()||20;y.isVirtualRowRendering(this)&&s>0&&this.option(N)!==!1?n._renderTime=(new Date-t)*o/s:n._renderTime=new Date-t}return i}_getRowElements(e){const t=super._getRowElements(e);return t==null?void 0:t.not(".dx-virtual-row")}_removeRowsElements(e,t,i){let n=this._getRowElements(e).toArray();i==="append"?n=n.slice(0,t):n=n.slice(-t),n.map((s=>{const o=h(s);this._errorHandlingController&&this._errorHandlingController.removeErrorRow(o.next()),o.remove()}))}_updateContent(e,t){let i;const n=this._findContentElement(),s=t==null?void 0:t.changeType,o=S(),a=n.children().first();return s==="append"||s==="prepend"?this.waitAsyncTemplates().done((()=>{const l=this._getBodies(e);l.length===1?this._getBodies(a)[s==="append"?"append":"prepend"](l.children()):l[s==="append"?"appendTo":"prependTo"](a),e.remove(),i=this._getFreeSpaceRowElements(a),Kl(i,vu),t.removeCount&&this._removeRowsElements(a,t.removeCount,s),this._restoreErrorRow(a),o.resolve()})).fail(o.reject):super._updateContent.apply(this,arguments).done((()=>{s==="update"&&this._restoreErrorRow(a),o.resolve()})).fail(o.reject),o.promise().done((()=>{this._updateBottomLoading()}))}_addVirtualRow(e,t,i,n){if(!n)return;let s=this._createEmptyRow("dx-virtual-row",t,n);s=this._wrapRowIfNeed(e,s),this._appendEmptyRow(e,s,i)}_updateContentItemSizes(){const e=this._getRowHeights(),t=this._correctRowHeights(e);this._dataController.setContentItemSizes(t)}_updateViewportSize(e,t){m(e)||(e=this._hasHeight?Y(this.element()):Y(oe())),this._dataController.viewportHeight(e,t)}_getRowHeights(){var e,t;const i=(e=this._editingController)===null||e===void 0||(t=e.isPopupEditMode)===null||t===void 0?void 0:t.call(e);let n=this._getRowElements(this._tableElement).toArray();return i&&(n=n.filter((s=>!h(s).hasClass(Yx)))),n.map((s=>re(s).height))}_correctRowHeights(e){const t=this._dataController,i=t._dataSource,n=[],s=t.getVisibleRows();let o=0,a=!0,l=-1;for(let d=0;d<e.length;d++){const c=s[d];m(c)&&(this.option(N)===!1?(l>=0&&l!==c.loadIndex&&(n.push(o),o=0),l=c.loadIndex):Yn(c,i)&&(a?a=!1:(n.push(o),o=0)),o+=e[d])}return o>0&&n.push(o),n}_updateContentPosition(e){const t=this._rowHeight||20;if(this._dataController.viewportItemSize(t),Ve(this)||y.isVirtualRowRendering(this)){if(this._dataController.isEmpty())return;e||this._updateContentItemSizes();const n=this._dataController.getContentOffset("begin"),s=this._dataController.getContentOffset("end"),o=this.getTableElements(),a=o.children("tbody").children(".dx-virtual-row");Kl(a,"dx-virtual-row"),o.each(((l,d)=>{const c=l>0,u=this._isFixedTableRendering;this._isFixedTableRendering=c,this._addVirtualRow(h(d),c,"top",n),this._addVirtualRow(h(d),c,"bottom",s),this._isFixedTableRendering=u}))}}_isTableLinesDisplaysCorrect(e){return e.find(".dx-column-lines").length>0===this.option("showColumnLines")}_isColumnElementsEqual(e,t){let i=e.length===t.length;return i&&x(e,((n,s)=>{if(s.style.width!==t[n].style.width)return i=!1,i})),i}_getCellClasses(e){const t=[],{cssClass:i}=e,n=e.command==="expand";return i&&t.push(i),n&&t.push(this.addWidgetPrefix("group-space")),t}_findBottomLoadPanel(e){const t=e||this.element(),i=t==null?void 0:t.find(`.${this.addWidgetPrefix("bottom-load-panel")}`);if(i!=null&&i.length)return i}_updateBottomLoading(){const e=this,t=Ve(this),i=at(this),n=!e._dataController.hasKnownLastPage()&&e._dataController.isLoaded()&&(t||i),s=e._findContentElement(),o=e._findBottomLoadPanel(s);n?o||h("<div>").addClass(e.addWidgetPrefix("bottom-load-panel")).append(e._createComponent(h("<div>"),yi,{elementAttr:{role:null,"aria-label":null}}).$element()).appendTo(s):o&&o.remove()}_handleScroll(e){const t=this.option(N)===!0,i=e.scrollOffset.top===0,s=this._scrollTop!==e.scrollOffset.top||e.forceUpdateScrollPosition,o=this._hasHeight||!t&&i;s&&o&&this._rowHeight&&(this._scrollTop=e.scrollOffset.top,(Ve(this)||this.option("scrolling.rowRenderingMode")!=="standard")&&this.option(N)===!1&&(this._updateContentItemSizes(),this._updateViewportSize(null,this._scrollTop)),this._dataController.setViewportPosition(e.scrollOffset.top)),super._handleScroll.apply(this,arguments)}_needUpdateRowHeight(e){return super._needUpdateRowHeight.apply(this,arguments)||e>0&&at(this)&&!y.isVirtualRowRendering(this)}_updateRowHeight(){if(super._updateRowHeight.apply(this,arguments),this._rowHeight){this._updateContentPosition();const e=this._hasHeight?Y(this.element()):Y(oe());this.option(N)===!1?(this._updateViewportSize(e),this._dataController.updateViewport()):this._dataController.viewportSize(Math.ceil(e/this._rowHeight))}}updateFreeSpaceRowHeight(){const e=super.updateFreeSpaceRowHeight.apply(this,arguments);return e&&this._updateContentPosition(),e}setLoading(e,t){const i=this._dataController,n=i.pageIndex()>0&&i.isLoaded()&&!!this._findBottomLoadPanel();this.option(N)===!1&&e&&i.isViewportChanging()||(n&&(e=!1),super.setLoading.call(this,e,t))}isGridDragging(){return this.component.option("isDragging")}throwHeightWarningIfNeed(){const e=this.isGridDragging();if(this._hasHeight===void 0||e)return;!this._hasHeight&&et(this)&&!this._heightWarningIsThrown&&(this._heightWarningIsThrown=!0,se.log("W1025"))}_resizeCore(){const e=this,t=e.element();super._resizeCore(),this.throwHeightWarningIfNeed(),e.component.$element()&&!e._windowScroll&&un(t)&&(e._windowScroll=Cu(t,(i=>{!e._hasHeight&&e._rowHeight&&e._dataController.setViewportPosition(i)}),e.component.$element()),e.on("disposing",(()=>{e._windowScroll.dispose()}))),this.option(N)!==!1&&e.loadIfNeed()}loadIfNeed(){var e,t;(e=this._dataController)===null||e===void 0||(t=e.loadIfNeed)===null||t===void 0||t.call(e)}_restoreErrorRow(e){if(this.option(N)===!1){var t;(t=this._errorHandlingController)===null||t===void 0||t.removeErrorRow()}super._restoreErrorRow.apply(this,arguments)}},US={defaultOptions:()=>({scrolling:{timeout:300,updateTimeout:300,minTimeout:0,renderingThreshold:100,removeInvisiblePages:!0,rowPageSize:5,prerenderedRowChunkSize:1,mode:"standard",preloadEnabled:!1,rowRenderingMode:"standard",loadTwoPagesOnStart:!1,legacyMode:!1,prerenderedRowCount:1}}),extenders:{controllers:{data:Zx,resizing:Qx},views:{rowsView:Jx}}},xu=(r,e)=>{const t=r.offset();if(t===void 0)return;const i=h(oe()),{top:n}=t;let s=0;const o=i.scrollTop(),a=Uh(i);if(Ee(e)){if(e<n)return n-e;s=a-e+o}else{const l=n-o,d=a-l-Y(r);s=Math.max(l,d)}return .9*s};class ro extends pr{_getMaxUsableSpace(e,t,i){return Math.max(e,t-e-i)}_getDefaultOptions(){return T({},super._getDefaultOptions(),{orientation:"horizontal",tabIndex:null,onHoverStart:Ce})}_initDataAdapter(){const{_dataAdapter:e}=this.option();this._dataAdapter=e,this._dataAdapter||super._initDataAdapter()}_renderContentImpl(){this._renderContextMenuOverlay(),super._renderContentImpl();const{_parentKey:e}=this.option(),t=this._dataAdapter.getNodeByKey(e);t&&this._renderItems(this._getChildNodes(t)),this._renderDelimiter()}_renderDelimiter(){this.$contentDelimiter=h("<div>").appendTo(this._itemContainer()).addClass("dx-context-menu-content-delimiter")}_getOverlayOptions(){return b(!0,super._getOverlayOptions(),{onPositioned:this._overlayPositionedActionHandler.bind(this),position:{precise:!0}})}_overlayPositionedActionHandler(e){this._showDelimiter(e)}_hoverEndHandler(e){super._hoverEndHandler(e),this._toggleFocusClass(!1,e.currentTarget)}_isMenuHorizontal(){const{orientation:e}=this.option();return e==="horizontal"}_hoverStartHandler(e){const{onHoverStart:t}=this.option();t==null||t(e),super._hoverStartHandler(e)}_drawSubmenu(e){var t,i,n,s;(t=(i=this._actions).onShowing)===null||t===void 0||t.call(i,{rootItem:$(e),submenu:this}),super._drawSubmenu(e),(n=(s=this._actions).onShown)===null||n===void 0||n.call(s,{rootItem:$(e),submenu:this})}_hideSubmenu(e){var t,i,n,s;(t=(i=this._actions).onHiding)===null||t===void 0||t.call(i,{cancel:!0,rootItem:$(e),submenu:this}),super._hideSubmenu(e),(n=(s=this._actions).onHidden)===null||n===void 0||n.call(s,{rootItem:$(e),submenu:this})}_getDelimiterWidth(e,t){if(this._isMenuHorizontal()){const i=H(e),n=H(t);return i<n?i:n}return 3}_getDelimiterHeight(e,t){if(this._isMenuHorizontal())return 3;const i=X(e),n=X(t);return i<n?i:n}_showDelimiter(e){if(!this.$contentDelimiter)return;const{position:t}=this.option(),i=this._itemContainer().children(".dx-submenu").eq(0),n=h(t==null?void 0:t.of).find(".dx-context-menu-container-border"),s={of:i,precise:!0},o=e.position,a=o.v.location,l=o.h.location,d=n.offset(),c=Math.round((d==null?void 0:d.left)??0),u=Math.round((d==null?void 0:d.top)??0);this.$contentDelimiter.css("display","block"),on(this.$contentDelimiter,this._getDelimiterWidth(n,i)),ti(this.$contentDelimiter,this._getDelimiterHeight(n,i)),this._isMenuHorizontal()?a>u?Math.round(l)===c?(s.offset="0 -2.5",s.at="left top",s.my="left top"):(s.offset="0 -2.5",s.at="right top",s.my="right top"):(ti(this.$contentDelimiter,5),Math.round(l)===c?(s.offset="0 5",s.at="left bottom",s.my="left bottom"):(s.offset="0 5",s.at="right bottom",s.my="right bottom")):l>c?Math.round(a)===u?(s.offset="-2.5 0",s.at="left top",s.my="left top"):(s.offset="-2.5 0",s.at="left bottom",s.my="left bottom"):Math.round(a)===u?(s.offset="2.5 0",s.at="right top",s.my="right top"):(s.offset="2.5 0",s.at="right bottom",s.my="right bottom"),ei.setup(this.$contentDelimiter,s)}_getContextMenuPosition(){const{position:e}=this.option();return e}isOverlayVisible(){var e;const{visible:t}=((e=this._overlay)===null||e===void 0?void 0:e.option())??{};return t}getOverlayContent(){var e;return(e=this._overlay)===null||e===void 0?void 0:e.$content()}}const jn="dx-menu-adaptive-mode",ew=`${jn}-overlay-wrapper`,Gl={show:50,hide:300},Ul=["onSubmenuShowing","onSubmenuShown","onSubmenuHiding","onSubmenuHidden","onItemContextMenu","onItemClick","onSelectionChanged","onItemRendered"];class zo extends hr{_getDefaultOptions(){return T({},super._getDefaultOptions(),{orientation:"horizontal",submenuDirection:"auto",showFirstSubmenuMode:{name:"onClick",delay:{show:50,hide:300}},hideSubmenuOnMouseLeave:!1,onSubmenuShowing:null,onSubmenuShown:null,onSubmenuHiding:null,onSubmenuHidden:null,adaptivityEnabled:!1})}_setOptionsByReference(){super._setOptionsByReference(),b(this._optionsByReference,{animation:!0,selectedItem:!0})}_itemElements(){const e=super._itemElements(),t=this._submenuItemElements();return e.add(t)}_submenuItemElements(){const e=this._submenus.length&&this._submenus[0];if(e&&e.itemsContainer()){var t;return((t=e.itemsContainer())===null||t===void 0?void 0:t.find(".dx-menu-item"))??h()}return h()}_focusTarget(){return this.$element()}_isMenuHorizontal(){const{orientation:e}=this.option();return e==="horizontal"}_moveFocus(e){const t=this._getAvailableItems(),i=this._isMenuHorizontal(),n=this._getActiveItem(!0);let s,o;switch(e){case"up":o=i?"showSubmenu":this._getItemsNavigationOperation("prevItem"),s=i?n:t;break;case"down":o=i?"showSubmenu":this._getItemsNavigationOperation("nextItem"),s=i?n:t;break;case"right":o=i?this._getItemsNavigationOperation("nextItem"):"showSubmenu",s=i?t:n;break;case"left":o=i?this._getItemsNavigationOperation("prevItem"):"showSubmenu",s=i?t:n;break;default:return super._moveFocus(e)}const l=this._getKeyboardNavigationAction(o,s)();l&&l.length!==0&&this.option("focusedElement",$(l))}_getItemsNavigationOperation(e){const{rtlEnabled:t}=this.option();return t?e==="prevItem"?"nextItem":"prevItem":e}_getKeyboardNavigationAction(e,t){let i=Ce;switch(e){case"showSubmenu":t.hasClass("dx-state-disabled")||(i=this._showSubmenu.bind(this,t));break;case"nextItem":i=this._nextItem.bind(this,t);break;case"prevItem":i=this._prevItem.bind(this,t)}return i}_clean(){super._clean();const{templatesRenderAsynchronously:e}=this.option();e&&clearTimeout(this._resizeEventTimer)}_visibilityChanged(e){e&&(this._menuItemsWidth||this._updateItemsWidthCache(),this._dimensionChanged())}_isAdaptivityEnabled(){const{adaptivityEnabled:e,orientation:t}=this.option();return!!e&&t==="horizontal"}_updateItemsWidthCache(){const e=this.$element().find("ul").first().children("li").children(".dx-menu-item");this._menuItemsWidth=this._getSummaryItemsSize("width",e,!0)}_dimensionChanged(){if(!this._isAdaptivityEnabled())return;const e=ge(this.$element());this._toggleAdaptiveMode(this._menuItemsWidth>e)}_init(){super._init(),this._submenus=[]}_initActions(){this._actions={},x(Ul,((e,t)=>{this._actions[t]=this._createActionByOption(t)}))}_initMarkup(){this._visibleSubmenu=null,this.$element().addClass("dx-menu"),super._initMarkup(),this._addCustomCssClass(this.$element()),this.setAria("role","menubar")}_setAriaRole(e){const t=this._isAdaptivityEnabled()&&e?void 0:"menubar";this.setAria({role:t})}_render(){super._render(),this._initAdaptivity()}_isTargetOutOfComponent(e){const t=h(e).closest(".dx-menu").length!==0,i=h(e).closest(".dx-context-menu").length!==0;return!(t||i)}_focusOutHandler(e){const{relatedTarget:t}=e;t&&this._isTargetOutOfComponent(t)&&this._hideVisibleSubmenu(),super._focusOutHandler(e)}_renderHamburgerButton(){return this._hamburger=new Ze(h("<div>").addClass("dx-menu-hamburger-button"),{icon:"menu",activeStateEnabled:!1,onClick:()=>{this._toggleTreeView()}}),this._hamburger.$element()}_toggleTreeView(e){var t,i;const n=e??!((t=this._overlay)!==null&&t!==void 0&&(t=t.option())!==null&&t!==void 0&&t.visible);if((i=this._overlay)===null||i===void 0||i.option("visible",n),n){var s;(s=this._treeView)===null||s===void 0||s.focus()}this._toggleHamburgerActiveState(n)}_toggleHamburgerActiveState(e){var t;(t=this._hamburger)===null||t===void 0||t.$element().toggleClass("dx-state-active",e)}_toggleAdaptiveMode(e){const t=this.$element().find(".dx-menu-horizontal"),i=this.$element().find(`.${jn}`);if(e)this._hideVisibleSubmenu();else{var n;(n=this._treeView)===null||n===void 0||n.collapseAll(),this._overlay&&this._toggleTreeView(e)}this._setAriaRole(e),t.toggle(!e),i.toggle(e)}_removeAdaptivity(){this._$adaptiveContainer&&(this._toggleAdaptiveMode(!1),this._$adaptiveContainer.remove(),this._$adaptiveContainer=null,this._treeView=null,this._hamburger=null,this._overlay=null)}_treeviewItemClickHandler(e){var t;this._actions.onItemClick(e),(t=e.node)!==null&&t!==void 0&&(t=t.children)!==null&&t!==void 0&&t.length||this._toggleTreeView(!1)}_getAdaptiveOverlayOptions(){var e;const{rtlEnabled:t}=this.option(),i=t?"right":"left";return{_ignoreFunctionValueDeprecation:!0,maxHeight:()=>xu(this.$element()),deferRendering:!1,shading:!1,animation:!1,hideOnParentScroll:!0,onHidden:()=>{this._toggleHamburgerActiveState(!1)},height:"auto",hideOnOutsideClick:n=>!h(n.target).closest(".dx-menu-hamburger-button").length,position:{collision:"flipfit",at:`bottom ${i}`,my:`top ${i}`,of:(e=this._hamburger)===null||e===void 0?void 0:e.$element()}}}_getTreeViewOptions(){const e={};x(["rtlEnabled","width","accessKey","activeStateEnabled","animation","dataSource","disabled","displayExpr","displayExpr","focusStateEnabled","hint","hoverStateEnabled","itemsExpr","items","itemTemplate","selectedExpr","selectionMode","tabIndex","visible"],((n,s)=>{e[s]=this.option(s)})),x(["onItemContextMenu","onSelectionChanged","onItemRendered"],((n,s)=>{e[s]=o=>{this._actions[s](o)}}));const{animation:t,selectByClick:i}=this.option();return T({},e,{dataSource:this.getDataSource(),animationEnabled:!!t,onItemClick:this._treeviewItemClickHandler.bind(this),onItemExpanded:n=>{var s,o,a;(s=this._overlay)===null||s===void 0||s.repaint(),(o=(a=this._actions).onSubmenuShown)===null||o===void 0||o.call(a,n)},onItemCollapsed:n=>{var s,o,a;(s=this._overlay)===null||s===void 0||s.repaint(),(o=(a=this._actions).onSubmenuHidden)===null||o===void 0||o.call(a,n)},selectNodesRecursive:!1,selectByClick:i,expandEvent:"click",_supportItemUrl:!0})}_initAdaptivity(){if(!this._isAdaptivityEnabled())return;const{cssClass:e}=this.option(),t=this._renderHamburgerButton();this._treeView=this._createComponent(h("<div>"),_n,this._getTreeViewOptions()),this._overlay=this._createComponent(h("<div>"),wi,this._getAdaptiveOverlayOptions()),this._overlay.$content().append(this._treeView.$element()).addClass(jn).addClass(e),this._overlay.$wrapper().addClass(ew),this._$adaptiveContainer=h("<div>").addClass(jn),this._$adaptiveContainer.append(t),this._$adaptiveContainer.append(this._overlay.$element()),this.$element().append(this._$adaptiveContainer),this._updateItemsWidthCache(),this._dimensionChanged()}_getDelay(e){const{showFirstSubmenuMode:t}=this.option(),i=L(t)?t.delay:void 0;return m(i)?L(i)?i[e]??Gl[e]:i:Gl[e]}_keyboardHandler(e){return super._keyboardHandler(e,!!this._visibleSubmenu)}_renderContainer(){const e=h("<div>");return e.appendTo(this.$element()).addClass(this._isMenuHorizontal()?"dx-menu-horizontal":"dx-menu-vertical"),super._renderContainer(e)}_renderSubmenuItems(e,t){const i=this._createSubmenu(e,t);return this._submenus.push(i),this._renderBorderElement(t),i}_getKeyboardListeners(){return super._getKeyboardListeners().concat(this._visibleSubmenu)}_createSubmenu(e,t){const i=h("<div>").addClass("dx-context-menu").appendTo(t),n=this._getChildNodes(e),s=this._createComponent(i,ro,T({},this._getSubmenuOptions(),{_dataAdapter:this._dataAdapter,_parentKey:e.internalFields.key,items:n,onHoverStart:this._clearTimeouts.bind(this),position:this.getSubmenuPosition(t)}));return this._attachSubmenuHandlers(t,s),s}_getSubmenuOptions(){const e=h("<div>"),t=this._isMenuHorizontal(),{itemTemplate:i,orientation:n,selectionMode:s,cssClass:o,selectByClick:a,hoverStateEnabled:l,activeStateEnabled:d,focusStateEnabled:c,animation:u,showSubmenuMode:p,displayExpr:g,disabledExpr:_,selectedExpr:f,itemsExpr:C}=this.option();return{itemTemplate:i,target:e,orientation:n,selectionMode:s,cssClass:o,selectByClick:a,hoverStateEnabled:l,activeStateEnabled:d,focusStateEnabled:c,animation:u,showSubmenuMode:p,displayExpr:g,disabledExpr:_,selectedExpr:f,itemsExpr:C,onFocusedItemChanged:I=>{const{visible:E,focusedElement:D}=I.component.option();E&&this.option("focusedElement",D)},onSelectionChanged:this._nestedItemOnSelectionChangedHandler.bind(this),onItemClick:this._nestedItemOnItemClickHandler.bind(this),onItemRendered:this._nestedItemOnItemRenderedHandler.bind(this),onLeftFirstItem:t?null:this._moveMainMenuFocus.bind(this,"prevItem"),onLeftLastItem:t?null:this._moveMainMenuFocus.bind(this,"nextItem"),onCloseRootSubmenu:this._moveMainMenuFocus.bind(this,t?"prevItem":null),onExpandLastSubmenu:t?this._moveMainMenuFocus.bind(this,"nextItem"):null}}_getShowFirstSubmenuMode(){if(!this._isDesktopDevice())return"onClick";const{showFirstSubmenuMode:e}=this.option();return L(e)?e.name:e}_moveMainMenuFocus(e){const t=this._getAvailableItems(),i=t.length,n=t.filter(".dx-menu-item-expanded").eq(0);let s=t.index(n);this._hideSubmenu(this._visibleSubmenu),s+=e==="prevItem"?-1:1,s>=i?s=0:s<0&&(s=i-1);const o=t.eq(s);this.option("focusedElement",$(o))}_nestedItemOnSelectionChangedHandler(e){const t=e.addedItems.length&&e.addedItems[0],i=ro.getInstance(e.element),{onSelectionChanged:n}=this._actions;n==null||n(e),t&&this._clearSelectionInSubmenus(i),this._clearRootSelection(),this._setOptionWithoutOptionChange("selectedItem",t)}_clearSelectionInSubmenus(e){const t=!arguments.length;x(this._submenus,((i,n)=>{const s=n._itemContainer(),o=!s.is(e==null?void 0:e._itemContainer()),a=s.find(`.${this._selectedItemClass()}`);if(o&&a.length||t){a.removeClass(this._selectedItemClass());const l=this._getItemData(a);l&&(l.selected=!1),n._clearSelectedItems()}}))}_clearRootSelection(){const e=this.$element().find(".dx-menu-items-container").first().children().children().filter(`.${this._selectedItemClass()}`);if(e.length){const t=this._getItemData(e);t.selected=!1,e.removeClass(this._selectedItemClass())}}_nestedItemOnItemClickHandler(e){var t,i;(t=(i=this._actions).onItemClick)===null||t===void 0||t.call(i,e)}_nestedItemOnItemRenderedHandler(e){var t,i;(t=(i=this._actions).onItemRendered)===null||t===void 0||t.call(i,e)}_attachSubmenuHandlers(e,t){const i=t.getOverlayContent(),n=i==null?void 0:i.find(".dx-submenu"),s=V(wd,`${this.NAME}_submenu`);t.option({onShowing:this._submenuOnShowingHandler.bind(this,e,t),onShown:this._submenuOnShownHandler.bind(this,e,t),onHiding:this._submenuOnHidingHandler.bind(this,e,t),onHidden:this._submenuOnHiddenHandler.bind(this,e,t)}),x(n,((o,a)=>{v.off(a,s),v.on(a,s,null,this._submenuMouseLeaveHandler.bind(this,e))}))}_submenuOnShowingHandler(e,t,i){var n,s;let{rootItem:o}=i;const a=e.children(".dx-context-menu-container-border"),l=this._getVisibilityChangeEventParams(o,t,e);(n=(s=this._actions).onSubmenuShowing)===null||n===void 0||n.call(s,l),a.show(),e.addClass("dx-menu-item-expanded")}_submenuOnShownHandler(e,t,i){var n,s;let{rootItem:o}=i;const a=this._getVisibilityChangeEventParams(o,t,e);(n=(s=this._actions).onSubmenuShown)===null||n===void 0||n.call(s,a)}_submenuOnHidingHandler(e,t,i){var n,s;const o=e.children(".dx-context-menu-container-border"),a=this._getVisibilityChangeEventParams(i.rootItem,t,e,!0);i.itemData=a.itemData,i.rootItem=a.rootItem,i.submenuContainer=a.submenuContainer,i.submenu=a.submenu,(n=(s=this._actions).onSubmenuHiding)===null||n===void 0||n.call(s,i);const{focusedElement:l}=this.option(),{focusedElement:d}=t.option(),c=this._visibleSubmenu===t;c&&l===d&&this.option("focusedElement",$(e)),i.cancel||(c&&(this._visibleSubmenu=null),o.hide(),e.removeClass("dx-menu-item-expanded"))}_submenuOnHiddenHandler(e,t,i){var n,s;let{rootItem:o}=i;const a=this._getVisibilityChangeEventParams(o,t,e,!0);(n=(s=this._actions).onSubmenuHidden)===null||n===void 0||n.call(s,a)}_getVisibilityChangeEventParams(e,t,i,n){let s,o;if(e){const l=n?h(e).closest(".dx-menu-item")[0]:e;s=this._getItemData(l),o=h(l).find(".dx-submenu").first()}else{var a;const l=h((a=t._overlay)===null||a===void 0?void 0:a.content());s=this._getItemData(i),o=l.find(".dx-submenu").first()}return{itemData:s,rootItem:$(i),submenuContainer:$(o),submenu:t}}_submenuMouseLeaveHandler(e,t){var i;const n=h(t.relatedTarget).parents(".dx-context-menu")[0],s=this._getSubmenuByRootElement(e),o=s==null||(i=s.getOverlayContent())===null||i===void 0?void 0:i[0],{hideSubmenuOnMouseLeave:a}=this.option();a&&n!==o&&(this._clearTimeouts(),setTimeout(this._hideSubmenuAfterTimeout.bind(this),this._getDelay("hide")))}_hideSubmenuAfterTimeout(){var e,t;if(!this._visibleSubmenu)return;const i=h(this._visibleSubmenu.$element().context).hasClass("dx-state-hover"),n=(e=this._visibleSubmenu.getOverlayContent())===null||e===void 0?void 0:e.find(".dx-state-hover").length;!((t=this._visibleSubmenu.getOverlayContent())===null||t===void 0?void 0:t.get(0).querySelector(":hover"))&&!n&&!i&&this._visibleSubmenu.hide()}_getSubmenuByRootElement(e){if(!e)return;const t=e.children(".dx-context-menu");if(t.length)return ro.getInstance(t)}getSubmenuPosition(e){const{submenuDirection:t,rtlEnabled:i}=this.option(),n=this._isMenuHorizontal(),s=t==null?void 0:t.toLowerCase(),o={collision:"flip",of:e,precise:!0};switch(s){case"leftortop":o.at="left top",o.my=n?"left bottom":"right top";break;case"rightorbottom":o.at=n?"left bottom":"right top",o.my="left top";break;default:n?(o.at=i?"right bottom":"left bottom",o.my=i?"right top":"left top"):(o.at=i?"left top":"right top",o.my=i?"right top":"left top")}return o}_renderBorderElement(e){h("<div>").appendTo(e).addClass("dx-context-menu-container-border").hide()}_itemPointerHandler(e){if(h(e.target).closest(this._itemElements()).hasClass("dx-menu-item-has-submenu")){this.option("focusedElement",null);return}super._itemPointerHandler(e)}_hoverStartHandler(e){const t=V(Z.move,this.NAME),i=this._getItemElementByEventArgs(e);if(!i||this._isItemDisabled(i))return;const n=this._dataAdapter.getNodeByItem(this._getItemData(i)),s=m(e.buttons)&&e.buttons===1||!m(e.buttons)&&e.which===1;if(v.off(i,t),!this._hasChildren(n)){this._showSubmenuTimer=setTimeout(this._hideSubmenuAfterTimeout.bind(this),this._getDelay("hide"));return}if(this._getShowFirstSubmenuMode()==="onHover"&&!s){const o=this._getSubmenuByElement(i);this._clearTimeouts(),o!=null&&o.isOverlayVisible()||(v.on(i,t,this._itemMouseMoveHandler.bind(this)),this._showSubmenuTimer=this._getDelay("hide"))}}_hoverEndHandler(e){const t=this._getItemElementByEventArgs(e),i=h(e.relatedTarget);if(super._hoverEndHandler(e),this._clearTimeouts(),!t||this._isItemDisabled(t)||i.hasClass("dx-context-menu-content-delimiter"))return;const{hideSubmenuOnMouseLeave:n}=this.option();n&&!i.hasClass("dx-menu-items-container")&&(this._hideSubmenuTimer=setTimeout((()=>{this._hideSubmenuAfterTimeout()}),this._getDelay("hide")))}_hideVisibleSubmenu(){return this._visibleSubmenu?(this._hideSubmenu(this._visibleSubmenu),!0):!1}_showSubmenu(e){const t=this._getSubmenuByElement(e);if(this._visibleSubmenu!==t&&this._hideVisibleSubmenu(),t){this._clearTimeouts(),this.focus(),t.show();const{focusedElement:i}=t.option();this.option("focusedElement",i)}this._visibleSubmenu=t,this._hoveredRootItem=e}_hideSubmenu(e){e&&e.hide(),this._visibleSubmenu===e&&(this._visibleSubmenu=null),this._hoveredRootItem=null}_itemMouseMoveHandler(e){var t;if((t=e.pointers)!==null&&t!==void 0&&t.length)return;const i=h(e.currentTarget);m(this._showSubmenuTimer)&&(this._clearTimeouts(),this._showSubmenuTimer=setTimeout((()=>{const n=this._getSubmenuByElement(i);n&&!n.isOverlayVisible()&&this._showSubmenu(i)}),this._getDelay("show")))}_clearTimeouts(){clearTimeout(this._hideSubmenuTimer),clearTimeout(this._showSubmenuTimer)}_getSubmenuByElement(e,t){const i=this._getSubmenuByRootElement(e);if(i)return i;const n=this._dataAdapter.getNodeByItem(t??this._getItemData(e));if(n&&this._hasChildren(n))return this._renderSubmenuItems(n,e)}_updateSubmenuVisibilityOnClick(e){var t;const i=(t=e.args)===null||t===void 0?void 0:t[0];if(!i||this._disabledGetter(i.itemData))return;const n=h(i.itemElement),s=this._getSubmenuByElement(n,i.itemData);if(this._updateSelectedItemOnClick(e),this._visibleSubmenu){if(this._visibleSubmenu===s){const{showFirstSubmenuMode:o}=this.option();o==="onClick"&&this._hideSubmenu(this._visibleSubmenu);return}this._hideSubmenu(this._visibleSubmenu)}s&&(s.isOverlayVisible()||this._showSubmenu(n))}_optionChanged(e){if(Ul.includes(e.name)){this._initActions();return}switch(e.name){case"orientation":case"submenuDirection":this._invalidate();break;case"showFirstSubmenuMode":case"hideSubmenuOnMouseLeave":break;case"showSubmenuMode":this._changeSubmenusOption(e);break;case"adaptivityEnabled":e.value?this._initAdaptivity():this._removeAdaptivity();break;case"width":if(this._isAdaptivityEnabled()){var t,i;(t=this._treeView)===null||t===void 0||t.option(e.name,e.value),(i=this._overlay)===null||i===void 0||i.option(e.name,e.value)}super._optionChanged(e),this._dimensionChanged();break;case"animation":if(this._isAdaptivityEnabled()){var n;(n=this._treeView)===null||n===void 0||n.option("animationEnabled",!!e.value)}super._optionChanged(e);break;default:if(this._isAdaptivityEnabled()&&(e.name===e.fullName||e.name==="items")){var s;(s=this._treeView)===null||s===void 0||s.option(e.fullName,e.value)}super._optionChanged(e)}}_changeSubmenusOption(e){let{name:t,value:i}=e;x(this._submenus,((n,s)=>{s.option(t,i)}))}selectItem(e){this._hideSubmenu(this._visibleSubmenu),super.selectItem(e)}unselectItem(e){this._hideSubmenu(this._visibleSubmenu),super.unselectItem(e)}}_e("dxMenu",zo);const ao={"=":"filter-operation-equals","<>":"filter-operation-not-equals","<":"filter-operation-less","<=":"filter-operation-less-equal",">":"filter-operation-greater",">=":"filter-operation-greater-equal",default:"filter-operation-default",notcontains:"filter-operation-not-contains",contains:"filter-operation-contains",startswith:"filter-operation-starts-with",endswith:"filter-operation-ends-with",between:"filter-operation-between"},ql={"=":"equal","<>":"notEqual","<":"lessThan","<=":"lessThanOrEqual",">":"greaterThan",">=":"greaterThanOrEqual",startswith:"startsWith",contains:"contains",notcontains:"notContains",endswith:"endsWith",between:"between"},tw="dx-filter-menu",zi="input:not([type='hidden'])",iw=["date","datetime","number"];function Ri(r){return r.option("filterRow.applyFilter")==="onClick"}const lo=function(r){const e=r==null?void 0:r.children(),t=e==null?void 0:e.data("dxComponents"),i=(t==null?void 0:t.length)&&e.data(t[0]);return i instanceof gn?i:null},co=function(r,e){let t="",i="";const n=Sr(r,e),s=y.getFormatOptionsByColumn(e,"filterRow");return Array.isArray(n)?(t=y.formatValue(n[0],s),i=y.formatValue(n[1],s),i!==""&&(t+=` - ${i}`)):m(n)&&(t=y.formatValue(n,s)),t};function Sr(r,e){if(e)return Ri(r)&&e.bufferedFilterValue!==void 0?e.bufferedFilterValue:e.filterValue}const tt=function(r,e){if(e)return Ri(r)&&e.bufferedSelectedFilterOperation!==void 0?e.bufferedSelectedFilterOperation:e.selectedFilterOperation},nw=function(r,e){return e&&iw.includes(e.dataType)&&Array.isArray(r)?!1:r!==void 0},Ko=function(r,e,t){const i=r._columnsController.columnOption(e),n=Sr(r,i),s=t.closest(`.${r.addWidgetPrefix("filter-range-overlay")}`).length,o=t.hasClass(r.addWidgetPrefix("filter-range-start"));return n&&Array.isArray(n)&&tt(r,i)==="between"?o?n[0]:n[1]:!s&&nw(n,i)?n:null},sw=function(r,e,t,i){if(tt(r,t)==="between"){const n=Sr(r,t);return i.hasClass(r.addWidgetPrefix("filter-range-start"))?[e,Array.isArray(n)?n[1]:void 0]:[Array.isArray(n)?n[0]:n,e]}return e},ow=function(r,e){const t=e.value===""?null:e.value,i=e.container,n=r._columnsController.columnOption(e.column.index),s=Ko(r,n.index,i);if(!m(s)&&!m(t))return;r._applyFilterViewController.setHighLight(i,s!==t);const o=Ri(r)?"bufferedFilterValue":"filterValue",a=sw(r,t,n,i),l=tt(r,n)==="between",d=e.notFireEvent||l&&Array.isArray(a)&&a.includes(void 0);r._columnsController.columnOption(n.index,o,a,d)},rw=r=>class extends r{init(){super.init(),this._applyFilterViewController=this.getController("applyFilter")}optionChanged(e){switch(e.name){case"filterRow":case"showColumnLines":this._invalidate(!0,!0),e.handled=!0;break;case"syncLookupFilterValues":e.value?this.updateLookupDataSource():this.render(),e.handled=!0;break;default:super.optionChanged(e)}}_updateEditorValue(e,t){const i=lo(t);i&&i.option("value",Ko(this,e.index,t))}_columnOptionChanged(e){const t=this,{optionNames:i}=e;let n,s,o,a;if(y.checkChanges(i,["filterValue","bufferedFilterValue","selectedFilterOperation","bufferedSelectedFilterOperation","filterValues","filterType"])&&e.columnIndex!==void 0){const l=t._columnsController.getVisibleIndex(e.columnIndex),d=t._columnsController.columnOption(e.columnIndex);if(n=t._getCellElement(t.element().find(`.${t.addWidgetPrefix("filter-row")}`).index(),l)??h(),s=n.find(".dx-editor-container").first(),i.filterValue||i.bufferedFilterValue){t._updateEditorValue(d,s);const c=n.find(`.${t.addWidgetPrefix("filter-range-overlay")}`).data("dxOverlay");c&&(o=c.$content().find(".dx-editor-container"),t._updateEditorValue(d,o.first()),t._updateEditorValue(d,o.last())),c!=null&&c.option("visible")||t._updateFilterRangeContent(n,co(t,d))}(i.selectedFilterOperation||i.bufferedSelectedFilterOperation)&&l>=0&&d&&(a=n.find(".dx-menu"),a.length&&(t._updateFilterOperationChooser(a,d,s),tt(t,d)==="between"?t._renderFilterRangeContent(n,d):s.find(".dx-filter-range-content").length&&(t._renderEditor(s,t._getEditorOptions(s,d)),t._hideFilterRange())));return}super._columnOptionChanged(e)}_renderCore(){return this._filterRangeOverlayInstance=null,super._renderCore.apply(this,arguments)}_resizeCore(){var e;super._resizeCore.apply(this,arguments),(e=this._filterRangeOverlayInstance)===null||e===void 0||e.repaint()}isFilterRowVisible(){return this._isElementVisible(this.option("filterRow"))}isVisible(){return super.isVisible()||this.isFilterRowVisible()}_initFilterRangeOverlay(e,t){const i=this,n={},s=e.find(".dx-editor-container"),o=i.addWidgetPrefix("filter-range-overlay"),a=h("<div>").addClass(o).appendTo(e);return i._createComponent(a,wi,{height:"auto",shading:!1,showTitle:!1,focusStateEnabled:!1,hideOnOutsideClick:!0,hideOnParentScroll:!0,_hideOnParentScrollTarget:a,wrapperAttr:{class:o},animation:!1,position:{my:"top",at:"top",of:s.length&&s||e,offset:"0 -1"},contentTemplate(l){let d,c=h("<div>").addClass(`dx-editor-container ${i.addWidgetPrefix("filter-range-start")}`).appendTo(l);return t=i._columnsController.columnOption(t.index),d=i._getEditorOptions(c,t),d.sharedData=n,i._renderEditor(c,d),v.on(c.find(zi),"keydown",(u=>{let p=e.find("[tabindex]").not(u.target).first();Ie(u)==="tab"&&u.shiftKey&&(u.preventDefault(),i._hideFilterRange(),p.length||(p=e.prev().find("[tabindex]").last()),v.trigger(p,"focus"))})),c=h("<div>").addClass(`dx-editor-container ${i.addWidgetPrefix("filter-range-end")}`).appendTo(l),d=i._getEditorOptions(c,t),d.sharedData=n,i._renderEditor(c,d),v.on(c.find(zi),"keydown",(u=>{Ie(u)==="tab"&&!u.shiftKey&&(u.preventDefault(),i._hideFilterRange(),v.trigger(e.next().find("[tabindex]").first(),"focus"))})),h(l).addClass(i.getWidgetContainerClass())},onShown(l){const d=l.component.$content().find(".dx-editor-container").first();v.trigger(d.find(zi),"focus")},onHidden(){t=i._columnsController.columnOption(t.index),e.find(".dx-menu").parent().addClass("dx-editor-with-menu"),tt(i,t)==="between"&&(i._updateFilterRangeContent(e,co(i,t)),i.component.updateDimensions())}})}_updateFilterRangeOverlay(e){const t=this._filterRangeOverlayInstance;t==null||t.option(e)}_showFilterRange(e,t){const i=this,n=e.children(`.${i.addWidgetPrefix("filter-range-overlay")}`);let s=n.length&&n.data("dxOverlay");if(!s&&t&&(s=i._initFilterRangeOverlay(e,t)),!s.option("visible")){var o,a;(o=i._filterRangeOverlayInstance)===null||o===void 0||o.hide(),i._filterRangeOverlayInstance=s,i._updateFilterRangeOverlay({width:ge(e,!0)+1}),(a=i._filterRangeOverlayInstance)===null||a===void 0||a.show()}}_hideFilterRange(){const e=this._filterRangeOverlayInstance;e==null||e.hide()}getFilterRangeOverlayInstance(){return this._filterRangeOverlayInstance}_createRow(e){const t=super._createRow(e);return e.rowType==="filter"&&(t.addClass(this.addWidgetPrefix("filter-row")),this.option("useLegacyKeyboardNavigation")||v.on(t,"keydown",(i=>or("filterRow",this,i)))),t}_getRows(){const e=super._getRows();return this.isFilterRowVisible()&&e.push({rowType:"filter"}),e}_renderFilterCell(e,t){var i;const n=this,{column:s}=t,o=h(e);n.component.option("showColumnHeaders")&&n.setAria("describedby",s.headerId,o),n.setAria("label",w.format("dxDataGrid-ariaFilterCell"),o),o.addClass("dx-editor-cell");const a=h("<div>").appendTo(o),l=h("<div>").addClass("dx-editor-container").appendTo(a);if(tt(n,s)==="between")n._renderFilterRangeContent(o,s);else{const c=n._getEditorOptions(l,s);n._renderEditor(l,c)}const{alignment:d}=s;d&&d!=="center"&&o.find(zi).first().css("textAlign",s.alignment),(i=s.filterOperations)!==null&&i!==void 0&&i.length&&n._renderFilterOperationChooser(a,s,l)}_renderCellContent(e,t){const i=this,{column:n}=t;if(t.rowType==="filter"){if(n.command)e.html("&nbsp;");else if(n.allowFiltering){i.renderTemplate(e,i._renderFilterCell.bind(i),t).done((()=>{i._updateCell(e,t)}));return}}super._renderCellContent.apply(this,arguments)}_getEditorOptions(e,t){const i=this,n={editorOptions:{inputAttr:i._getFilterInputAccessibilityAttributes(t)}},s=b(n,t,{value:Ko(i,t.index,e),parentType:"filterRow",showAllText:i.option("filterRow.showAllText"),updateValueTimeout:i.option("filterRow.applyFilter")==="onClick"?0:700,width:null,setValue(o,a){ow(i,{column:t,value:o,container:e,notFireEvent:a})}});return tt(i,t)==="between"&&(e.hasClass(i.addWidgetPrefix("filter-range-start"))?s.placeholder=i.option("filterRow.betweenStartText"):s.placeholder=i.option("filterRow.betweenEndText")),s}_getFilterInputAccessibilityAttributes(e){const t=w.format("dxDataGrid-ariaFilterCell");return this.component.option("showColumnHeaders")?{"aria-label":t,"aria-describedby":e.headerId}:{"aria-label":t}}_renderEditor(e,t){e.empty();const i=h("<div>").appendTo(e),n=this._dataController.dataSource();if(t.lookup&&this.option("syncLookupFilterValues")){this._applyFilterViewController.setCurrentColumnForFiltering(t);const s=this._dataController.getCombinedFilter();this._applyFilterViewController.setCurrentColumnForFiltering(null);const o=y.getWrappedLookupDataSource(t,n,s),a=T({},t,{lookup:T({},t.lookup,{dataSource:o})});return this._editorFactoryController.createEditor(i,a)}return this._editorFactoryController.createEditor(i,t)}_renderFilterRangeContent(e,t){const i=this,n=e.find(".dx-editor-container").first();n.empty();const s=h("<div>").addClass("dx-filter-range-content").attr("tabindex",this.option("tabIndex"));v.on(s,"focusin",(()=>{i._showFilterRange(e,t)})),s.appendTo(n),i._updateFilterRangeContent(e,co(i,t))}_updateFilterRangeContent(e,t){const i=e.find(".dx-filter-range-content");i.length&&(t===""?i.html("&nbsp;"):i.text(t))}_updateFilterOperationChooser(e,t,i){var n;const s=this;let o;const a=function(){const c=zo.getInstance(e);c&&c.option("focusedElement",null),o&&s._focusEditor(i)},l=this._editorFactoryController,d=w.format("dxDataGrid-ariaSearchBox");s._createComponent(e,zo,{integrationOptions:{},activeStateEnabled:!1,selectionMode:"single",cssClass:`${s.getWidgetContainerClass()} dx-cell-focus-disabled ${tw}`,showFirstSubmenuMode:"onHover",hideSubmenuOnMouseLeave:!0,items:[{name:tt(s,t)||d,disabled:!((n=t.filterOperations)!==null&&n!==void 0&&n.length),icon:ao[tt(s,t)||"default"],selectable:!1,items:s._getFilterOperationMenuItems(t)}],onItemRendered:c=>{let{itemElement:u,itemData:p}=c;if(p!=null&&p.items&&p!==null&&p!==void 0&&p.name){const g=s._getOperationDescriptionFromDescriptor(p.name)||d;this.setAria("label",g,h(u))}},onItemClick(c){var u;const p=c.itemData.name,g=tt(s,t);let _=!1;const f=Ri(s),C={};if(c.itemData.items||p&&p===g)return;p?(C[f?"bufferedSelectedFilterOperation":"selectedFilterOperation"]=p,(p==="between"||g==="between")&&(_=p==="between",C[f?"bufferedFilterValue":"filterValue"]=null)):(C[f?"bufferedFilterValue":"filterValue"]=null,C[f?"bufferedSelectedFilterOperation":"selectedFilterOperation"]=t.defaultSelectedFilterOperation||null);const E=!((u=c.itemData)!==null&&u!==void 0&&u.name)?!1:void 0;if(s._columnsController.columnOption(t.index,C,void 0,E),s._applyFilterViewController.setHighLight(i,!0),!p){const D=lo(i);D&&D.NAME==="dxDateBox"&&!D.option("isValid")&&(D.clear(),D.option("isValid",!0))}_?s._showFilterRange(i.closest(".dx-editor-cell"),t):s._focusEditor(i)},onSubmenuShowing(){o=s._isEditorFocused(i),l.loseFocus()},onSubmenuHiding(){v.trigger(e,"blur"),a()},onContentReady(c){v.on(e,"blur",(()=>{c.component._hideSubmenuAfterTimeout(),a()}))},rtlEnabled:s.option("rtlEnabled")})}_isEditorFocused(e){return e.hasClass("dx-focused")||e.parents(".dx-focused").length}_focusEditor(e){this._editorFactoryController.focus(e),v.trigger(e.find(zi),"focus")}_renderFilterOperationChooser(e,t,i){const n=this;let s;n.option("filterRow.showOperationChooser")&&(e.addClass("dx-editor-with-menu"),s=h("<div>").prependTo(e),n._updateFilterOperationChooser(s,t,i))}_getFilterOperationMenuItems(e){var t;const i=this;let n=[{}];const s=i.option("filterRow");if((t=e.filterOperations)!==null&&t!==void 0&&t.length){const o=e.filterOperations.filter((a=>m(ql[a])));n=wt(o,(a=>({name:a,selected:(tt(i,e)||e.defaultFilterOperation)===a,text:i._getOperationDescriptionFromDescriptor(a),icon:ao[a]}))),n.push({name:null,text:s==null?void 0:s.resetOperationText,icon:ao.default})}return n}_getOperationDescriptionFromDescriptor(e){const t=this.option("filterRow"),i=(t==null?void 0:t.operationDescriptions)||{},n=ql[e];return i[n]}_handleDataChanged(e){var t,i,n,s,o;const a=(t=this._dataController)===null||t===void 0||(i=t.dataSource)===null||i===void 0?void 0:i.call(t),l=a==null||(n=a.lastLoadOptions)===null||n===void 0?void 0:n.call(a);if(super._handleDataChanged.apply(this,arguments),(s=e.operationTypes)!==null&&s!==void 0&&s.filtering||(o=e.operationTypes)!==null&&o!==void 0&&o.fullReload){var d;this.updateLookupDataSource(((d=e.operationTypes)===null||d===void 0?void 0:d.filtering)||(l==null?void 0:l.filter))}}updateLookupDataSource(e){if(!this.option("syncLookupFilterValues")||!this.element())return;const t=this._columnsController.getVisibleColumns(),i=this._dataController.dataSource(),n=this._applyFilterViewController,s=this.element().find(`.${this.addWidgetPrefix("filter-row")}`).index();s!==-1&&t.forEach(((o,a)=>{if(!o.lookup||o.calculateCellValue!==o.defaultCalculateCellValue)return;const l=this._getCellElement(s,a),d=lo(l==null?void 0:l.find(".dx-editor-container"));if(d){n.setCurrentColumnForFiltering(o);const c=this._dataController.getCombinedFilter()||null;n.setCurrentColumnForFiltering(null);const u=d.option("dataSource");if(!e||!ae(u.__dataGridSourceFilter||null,c)){const g=y.getWrappedLookupDataSource(o,i,c);d.option("dataSource",g)}}}))}getColumnElements(e,t){var i;const n=this._getRows();return(n==null||(i=n[e])===null||i===void 0?void 0:i.rowType)==="filter"&&arguments.length<2?this.getCellElements(e):super.getColumnElements(e,t)}isFilterRowCell(e){return!!e.closest(`.${this.addWidgetPrefix("filter-row")}`).length}},aw=r=>class extends r{skipCalculateColumnFilters(){return!1}_calculateAdditionalFilter(){if(this.skipCalculateColumnFilters())return super._calculateAdditionalFilter();const e=[super._calculateAdditionalFilter()],t=this._columnsController.getVisibleColumns(null,!0),i=this._applyFilterController;return x(t,(function(){var n;const s=((n=i.getCurrentColumnForFiltering())===null||n===void 0?void 0:n.index)===this.index;if(this.allowFiltering&&this.calculateFilterExpression&&m(this.filterValue)&&!s){const o=this.createFilterExpression(this.filterValue,this.selectedFilterOperation||this.defaultFilterOperation,"filterRow");e.push(o)}})),y.combineFilters(e)}};class lw extends j.ViewController{init(){this._columnsController=this.getController("columns")}_getHeaderPanel(){return this._headerPanel||(this._headerPanel=this.getView("headerPanel")),this._headerPanel}setHighLight(e,t){Ri(this)&&(e!=null&&e.toggleClass("dx-highlight-outline",t)&&e.closest(".dx-editor-cell").toggleClass("dx-filter-modified",t),this._getHeaderPanel().enableApplyButton(t))}applyFilter(){const e=this._columnsController.getColumns();this._columnsController.beginUpdate();for(let t=0;t<e.length;t++){const i=e[t];i.bufferedFilterValue!==void 0&&(this._columnsController.columnOption(t,"filterValue",i.bufferedFilterValue),i.bufferedFilterValue=void 0),i.bufferedSelectedFilterOperation!==void 0&&(this._columnsController.columnOption(t,"selectedFilterOperation",i.bufferedSelectedFilterOperation),i.bufferedSelectedFilterOperation=void 0)}this._columnsController.endUpdate(),this.removeHighLights()}removeHighLights(){if(Ri(this)){const e=this.getView("columnHeadersView").element();e.find(`.${this.addWidgetPrefix("filter-row")} .dx-highlight-outline`).removeClass("dx-highlight-outline"),e.find(`.${this.addWidgetPrefix("filter-row")} .dx-filter-modified`).removeClass("dx-filter-modified"),this._getHeaderPanel().enableApplyButton(!1)}}setCurrentColumnForFiltering(e){this._currentColumn=e}getCurrentColumnForFiltering(){return this._currentColumn}}const dw=r=>class extends r{_startResizing(){const e=this;if(super._startResizing.apply(e,arguments),e.isResizing()){const t=e._columnHeadersView.getFilterRangeOverlayInstance();if(t){const i=t.$element().closest("td").index();(i===e._targetPoint.columnIndex||i===e._targetPoint.columnIndex+1)&&t.$content().hide()}}}_endResizing(){const e=this;let t;if(e.isResizing()){const i=e._columnHeadersView.getFilterRangeOverlayInstance();i&&(t=i.$element().closest("td"),e._columnHeadersView._updateFilterRangeOverlay({width:ge(t,!0)+1}),i.$content().show())}super._endResizing.apply(e,arguments)}},cw=r=>class extends r{updateFieldValue(e){return e.column.lookup&&(this._needUpdateLookupDataSource=!0),super.updateFieldValue.apply(this,arguments)}_afterSaveEditData(e){if(this._needUpdateLookupDataSource&&!e){var t;(t=this.getView("columnHeadersView"))===null||t===void 0||t.updateLookupDataSource()}return this._needUpdateLookupDataSource=!1,super._afterSaveEditData.apply(this,arguments)}_afterCancelEditData(){return this._needUpdateLookupDataSource=!1,super._afterCancelEditData.apply(this,arguments)}},uw=r=>class extends r{init(){super.init(),this._dataController=this.getController("data"),this._applyFilterViewController=this.getController("applyFilter")}optionChanged(e){e.name==="filterRow"?(this._invalidate(),e.handled=!0):super.optionChanged(e)}_getToolbarItems(){const e=super._getToolbarItems();return this._prepareFilterItem().concat(e)}_prepareFilterItem(){const e=this,t=[];if(e._isShowApplyFilterButton()){const i=e.option("filterRow.applyFilterText"),l={widget:"dxButton",options:{icon:"apply-filter",disabled:!e._columnsController.getColumns().filter((d=>d.bufferedFilterValue!==void 0)).length,onClick:function(){e._applyFilterViewController.applyFilter()},hint:i,text:i,onInitialized:function(d){h(d.element).addClass(e._getToolbarButtonClass("dx-apply-button"))}},showText:"inMenu",name:"applyFilterButton",location:"after",locateInMenu:"auto",sortIndex:10};t.push(l)}return t}_isShowApplyFilterButton(){const e=this.option("filterRow");return!!(e!=null&&e.visible)&&e.applyFilter==="onClick"}enableApplyButton(e){this.setToolbarItemDisabled("applyFilterButton",!e)}},qS={defaultOptions:()=>({syncLookupFilterValues:!0,filterRow:{visible:!1,showOperationChooser:!0,showAllText:w.format("dxDataGrid-filterRowShowAllText"),resetOperationText:w.format("dxDataGrid-filterRowResetOperationText"),applyFilter:"auto",applyFilterText:w.format("dxDataGrid-applyFilterText"),operationDescriptions:{equal:w.format("dxDataGrid-filterRowOperationEquals"),notEqual:w.format("dxDataGrid-filterRowOperationNotEquals"),lessThan:w.format("dxDataGrid-filterRowOperationLess"),lessThanOrEqual:w.format("dxDataGrid-filterRowOperationLessOrEquals"),greaterThan:w.format("dxDataGrid-filterRowOperationGreater"),greaterThanOrEqual:w.format("dxDataGrid-filterRowOperationGreaterOrEquals"),startsWith:w.format("dxDataGrid-filterRowOperationStartsWith"),contains:w.format("dxDataGrid-filterRowOperationContains"),notContains:w.format("dxDataGrid-filterRowOperationNotContains"),endsWith:w.format("dxDataGrid-filterRowOperationEndsWith"),between:w.format("dxDataGrid-filterRowOperationBetween"),isBlank:w.format("dxFilterBuilder-filterOperationIsBlank"),isNotBlank:w.format("dxFilterBuilder-filterOperationIsNotBlank")},betweenStartText:w.format("dxDataGrid-filterRowOperationBetweenStartText"),betweenEndText:w.format("dxDataGrid-filterRowOperationBetweenEndText")}}),controllers:{applyFilter:lw},extenders:{controllers:{data:aw,columnsResizer:dw,editing:cw},views:{columnHeadersView:rw,headerPanel:uw}}};ms.setEditorClass(tr);const Yl=Symbol("HANDLER_DECORATED_KEY");function wu(r){r=r||[];for(let e=0;e<r.length;e++)r[e].selected=!1,wu(r[e].items)}function Er(r){const e=r.NAME==="dxTreeView"?".dx-treeview-select-all-item":".dx-list-select-all-checkbox";return r.$element().find(e).dxCheckBox("instance")}function hw(r,e){const t=r.option("onValueChanged");if(t!=null&&t[Yl])return t;const i=n=>{const{event:s,value:o}=n,a=!!s;switch(s==null||s.stopPropagation(),!0){case(a&&o===!0):e.selectAll();return;case(a&&o===!1):e.unselectAll();return;default:t==null||t(n)}};return i[Yl]=!0,i}function pw(r){const e=Er(r);if(!e)return;const t=hw(e,r);e.option("onValueChanged",t)}function jl(r,e){if(r.option("searchValue"))return;const t=Er(r);t&&e!==null&&e!==void 0&&e.length&&t.option("value",void 0)}function gw(r,e,t){if(e^t){if(r.selected=!0,t&&r.items){for(let i=0;i<r.items.length;i++)if(!r.items[i].selected){r.selected=void 0;break}}}else(t||r.selected)&&(r.selected=!1,wu(r.items))}let mw=class extends j.View{getPopupContainer(){return this._popupContainer}getListComponent(){return this._listComponent}applyHeaderFilter(e){const t=this.getListComponent(),i=t.option("searchValue"),n=Er(t),s=!i&&!e.isFilterBuilder&&(n==null?void 0:n.option("value")),o=[],a=function(l,d,c){x(d,((u,p)=>{if(p.selected!==void 0&&!!p.selected^c){const g=t._getNode(p),f=t._hasChildren(g)&&p.items&&p.items.some((C=>C.selected));if(!i||!f){l.push(p.value);return}}p.items&&p.items.length&&a(l,p.items,c)}))};s?(e.type==="tree"&&(e.filterType="exclude"),Array.isArray(e.filterValues)&&(e.filterValues=[])):e.type==="tree"&&(e.filterType&&(e.filterType="include"),a(o,t.option("items"),!1),e.filterValues=o),e.filterValues&&!e.filterValues.length&&(e.filterValues=null),e.apply(),this.hideHeaderFilterMenu()}showHeaderFilterMenu(e,t){const i=this;if(t){i._initializePopupContainer(t);const n=i.getPopupContainer();i.hideHeaderFilterMenu(),i.updatePopup(e,t),n.show()}}hideHeaderFilterMenu(){const e=this.getPopupContainer();e&&e.hide()}updatePopup(e,t){const i=this,n=this.option("showColumnLines"),s=t.alignment==="right"^!n?"left":"right";i._popupContainer.setAria({role:"dialog",label:w.format("dxDataGrid-headerFilterLabel")}),i._popupContainer&&(i._cleanPopupContent(),i._popupContainer.option("position",{my:`${s} top`,at:`${s} bottom`,of:e,collision:"fit fit"}))}_getSearchExpr(e,t){const{lookup:i}=e,{useDefaultSearchExpr:n}=e,s=t.dataSource,o=t.search.searchExpr;if(o)return o;if(n||m(s)&&!B(s))return"text";if(i)return i.displayExpr||"this";if(e.dataSource){const{group:a}=e.dataSource;if(Array.isArray(a)&&a.length>0)return a[0].selector;if(B(a)&&!e.remoteFiltering)return a}return e.dataField||e.selector}_cleanPopupContent(){this._popupContainer&&this._popupContainer.$content().empty()}_initializePopupContainer(e){const t=this,i=t.element(),n=this._normalizeHeaderFilterOptions(e),{hidePopupCallback:s}=e,{height:o,width:a}=n,l={width:a,height:o,visible:!1,shading:!1,showTitle:!1,showCloseButton:!1,hideOnParentScroll:!1,dragEnabled:!1,hideOnOutsideClick:!0,wrapperAttr:{class:"dx-header-filter-menu"},focusStateEnabled:!1,toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:n.texts.ok,onClick(){t.applyHeaderFilter(e)}}},{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:n.texts.cancel,onClick(){t.hideHeaderFilterMenu(),s==null||s()}}}],resizeEnabled:!0,onShowing(d){d.component.$content().parent().addClass("dx-dropdowneditor-overlay"),t._initializeListContainer(e,n),e.onShowing&&e.onShowing(d)},onShown(){t.getListComponent().focus()},onHidden:e.onHidden,onInitialized(d){const{component:c}=d;c.option("animation",c._getDefaultOptions().animation)},_loopFocus:!0};m(t._popupContainer)?t._popupContainer.option(l):t._popupContainer=t._createComponent(i,ni,l)}_initializeListContainer(e,t){const i=this,n=i._popupContainer.$content(),s=!e.isFilterBuilder&&t.allowSelectAll,o={searchEnabled:t.search.enabled,searchTimeout:t.search.timeout,searchEditorOptions:t.search.editorOptions,searchMode:t.search.mode||"",dataSource:e.dataSource,onContentReady(){i.renderCompleted.fire()},itemTemplate(c,u,p){const g=h(p);return e.encodeHtml!==!1?g.text(c.text):g.html(c.text)}},a=()=>s&&i.option("headerFilter.hideSelectAllOnSearch")!==!1,l=c=>{switch(!0){case(c.fullName==="searchValue"&&a()):c.component.option("showCheckBoxesMode",c.value?"normal":"selectAll");break;case c.fullName==="showCheckBoxesMode":Promise.resolve().then((()=>{c.component.getSearchBoxController().focus()})).catch((()=>{}))}},d=c=>{c.fullName==="searchValue"&&a()&&c.component.option("selectionMode",c.value?"multiple":"all")};e.type==="tree"?i._listComponent=i._createComponent(h("<div>").appendTo(n),_n,b(o,{showCheckBoxesMode:s?"selectAll":"normal",onOptionChanged:l,keyExpr:"id"})):i._listComponent=i._createComponent(h("<div>").appendTo(n),$d,b(o,{searchExpr:i._getSearchExpr(e,t),pageLoadMode:"scrollBottom",showSelectionControls:!0,selectionMode:s?"all":"multiple",onOptionChanged:d,onSelectionChanged(c){const{component:u}=c,p=u.option("items"),g=u.option("selectedItems");if(!u._selectedItemsUpdating&&!u.option("searchValue")&&!e.isFilterBuilder){const _=e.filterValues||[],f=e.filterType==="exclude";g.length===0&&p.length&&(_.length<=1||f&&_.length===p.length-1)?(e.filterType="include",e.filterValues=[]):g.length===p.length&&(e.filterType="exclude",e.filterValues=[])}x(p,((_,f)=>{const C=y.getIndexByKey(f,g,null)>=0;if(!!f.selected!==C){f.selected=C,e.filterValues=e.filterValues||[];const E=y.getIndexByKey(f.value,e.filterValues,null);E>=0&&e.filterValues.splice(E,1);const D=e.filterType==="exclude";C^D&&e.filterValues.push(f.value)}})),jl(u,e.filterValues)},onContentReady(c){const{component:u}=c,p=u.option("items"),g=[];x(p,(function(){this.selected&&g.push(this)})),u._selectedItemsUpdating=!0,u.option("selectedItems",g),u._selectedItemsUpdating=!1,pw(u),jl(u,e.filterValues)}}))}_normalizeHeaderFilterOptions(e){const t=this.option("headerFilter")||{},i=e.headerFilter||{},n={search:{enabled:t.allowSearch,timeout:t.searchTimeout}},s={search:{enabled:i.allowSearch,mode:i.searchMode,timeout:i.searchTimeout}};return b(!0,{},t,n,i,s)}_renderCore(){this.element().addClass("dx-header-filter-menu")}};const Ts=function(r){return m(r.allowHeaderFiltering)?r.allowHeaderFiltering:r.allowFiltering},bu=r=>class extends r{optionChanged(e){if(e.name==="headerFilter"){const t=this.name==="columnHeadersView";this._invalidate(t,t),e.handled=!0}else super.optionChanged(e)}_applyColumnState(e){let t;const{rootElement:i}=e,{column:n}=e;if(e.name==="headerFilter"){if(i.find(".dx-header-filter").remove(),Ts(n)){t=super._applyColumnState(e).toggleClass("dx-header-filter-empty",this._isHeaderFilterEmpty(n)),this.option("useLegacyKeyboardNavigation")||t.attr("tabindex",this.option("tabindex")||0);const s=w.format("dxDataGrid-headerFilterIndicatorLabel",n.caption);t.attr("aria-label",s),t.attr("aria-haspopup","dialog"),t.attr("role","button")}return t}return super._applyColumnState(e)}_isHeaderFilterEmpty(e){return!e.filterValues||!e.filterValues.length}_getIndicatorClassName(e){return e==="headerFilter"?"dx-header-filter":super._getIndicatorClassName(e)}_renderIndicator(e){const t=e.container,i=e.indicator;if(e.name==="headerFilter"){const n=this.option("rtlEnabled");if(t.children().length&&(!n&&e.columnAlignment==="right"||n&&e.columnAlignment==="left")){t.prepend(i);return}}super._renderIndicator(e)}},_w={month:r=>P.getMonthNames()[r-1],quarter:r=>P.format(new Date(2e3,3*r-1),"quarter")};function yu(r,e,t){return e=e||[],t=t||[],r.forEach((i=>{if(m(i.key)){const n=e.length===1;if(e.push(n?i.key-1:i.key),i.items)yu(i.items,e,t);else{const s=new Date(Date.UTC.apply(Date,e));t.push(s)}e.pop()}else t.push(null)})),t}function fw(r,e){const t=yu(r),i=Xi(t),n=y.getHeaderFilterGroupParameters(T({},e,{calculateCellValue:s=>s}));return kd.queryByOptions(i,{group:n}).toArray()}function Cw(r){return(r==null?void 0:r.slice(-1))==="Z"||(r==null?void 0:r.slice(-3))==="'Z'"}const vw=function(r,e,t){const i=si.getGroupInterval(e),n=y.getFormatOptionsByColumn(e,"headerFilter");return i&&(n.groupInterval=i[t],y.isDateType(e.dataType)?n.format=_w[i[t]]:e.dataType==="number"&&(n.getDisplayFormat=function(){const s={format:e.format,target:"headerFilter"},o=y.formatValue(r,s),a=r+i[t],l=y.formatValue(a,s);return o&&l?`${o} - ${l}`:""})),n};class xw extends j.ViewController{init(){this._columnsController=this.getController("columns"),this._dataController=this.getController("data"),this._headerFilterView=this.getView("headerFilterView")}_updateSelectedState(e,t){let i=e.length;const n=t.filterType==="exclude";for(;i--;){const s=e[i];"items"in e[i]&&this._updateSelectedState(e[i].items,t),gw(s,y.getIndexByKey(e[i].value,t.filterValues,null)>-1,n)}}_normalizeGroupItem(e,t,i){let n,s;const{path:o}=i,{valueSelector:a}=i,{displaySelector:l}=i,{column:d}=i;return a&&l?(n=a(e),s=l(e)):(n=e.key,s=n),L(e)?e=b({},e):e={},o.push(n),o.length===1?e.value=o[0]:e.value=o.join("/"),e.text=this.getHeaderItemText(s,d,t,i.headerFilterOptions),e}getHeaderItemText(e,t,i,n){let s=y.formatValue(e,vw(e,t,i));return s||(s=n.texts.emptyValue),s}_processGroupItems(e,t,i,n){const s=this;let o,a;const{column:l}=n,{lookup:d}=l,{level:c}=n;i=i||[],t=t||0,d&&(o=Pe(d.displayExpr),a=Pe(d.valueExpr));for(let u=0;u<e.length;u++)e[u]=s._normalizeGroupItem(e[u],t,{column:n.column,headerFilterOptions:n.headerFilterOptions,displaySelector:o,valueSelector:a,path:i}),"items"in e[u]&&(t===c||!m(e[u].value)?delete e[u].items:s._processGroupItems(e[u].items,t+1,i,n)),i.pop()}getDataSource(e){var t;const i=this._dataController.dataSource(),n=i==null?void 0:i.remoteOperations().grouping,s=y.getHeaderFilterGroupParameters(e,n),o=(t=e.headerFilter)===null||t===void 0?void 0:t.dataSource,a=this.option("headerFilter");let l=!1;const d={component:this.component};if(!i)return;if(m(o)&&!B(o))d.dataSource=pn(o);else if(e.lookup)if(l=!0,this.option("syncLookupFilterValues")){this._currentColumn=e;const p=this._dataController.getCombinedFilter();this._currentColumn=null,d.dataSource=y.getWrappedLookupDataSource(e,i,p)}else d.dataSource=y.normalizeLookupDataSource(e.lookup);else{const p=Array.isArray(s)?s.length-1:0;this._currentColumn=e;const g=this._dataController.getCombinedFilter();this._currentColumn=null,d.dataSource={filter:g,group:s,useDefaultSearch:!0,load:_=>{const f=new S;return _.dataField=e.dataField||e.name,i.load(_).done((C=>{n&&Cw(e.serializationFormat)&&p>3&&(C=fw(C,e)),u._processGroupItems(C,null,null,{level:p,column:e,headerFilterOptions:a}),f.resolve(C)})).fail(f.reject),f}}}B(o)&&o.call(e,d);const c=d.dataSource.postProcess,u=this;return d.dataSource.postProcess=function(p){let g=p;return l&&(g=g.filter((_=>_[e.lookup.valueExpr]!==null)),this.pageIndex()===0&&!this.searchValue()&&(g=g.slice(0),g.unshift(null)),u._processGroupItems(g,null,null,{level:0,column:e,headerFilterOptions:a})),g=c&&c.call(this,g)||g,u._updateSelectedState(g,e),g},d.dataSource}getCurrentColumn(){return this._currentColumn}showHeaderFilterMenu(e,t){const i=this._columnsController,n=b(!0,{},this._columnsController.getColumns()[e]);if(n){const s=i.getVisibleIndex(e),a=(t?this.getView("headerPanel"):this.getView("columnHeadersView")).getColumnElements().eq(t?n.groupIndex:s);this.showHeaderFilterMenuBase({columnElement:a,column:n,applyFilter:!0,apply(){i.columnOption(e,{filterValues:this.filterValues,filterType:this.filterType})}})}}showHeaderFilterMenuBase(e){const t=this,{column:i}=e;if(i){const n=si.getGroupInterval(i),s=t._dataController.dataSource(),o=s&&s.remoteOperations().filtering,a=e.onHidden;b(e,i,{type:n&&n.length>1?"tree":"list",remoteFiltering:o,onShowing:l=>{const d=l.component.$overlayContent().dxResizable("instance");d&&d.option("onResizeEnd",(c=>{let u=this._columnsController.columnOption(e.dataField,"headerFilter");u=u||{},u.width=c.width,u.height=c.height,this._columnsController.columnOption(e.dataField,"headerFilter",u,!0)}))},onHidden:()=>{a==null||a(),nc(this)}}),e.dataSource=t.getDataSource(e),e.isFilterBuilder&&(e.dataSource.filter=null,e.alignment="right"),t._headerFilterView.showHeaderFilterMenu(e.columnElement,e)}}hideHeaderFilterMenu(){this._headerFilterView.hideHeaderFilterMenu()}}const ww=r=>class extends bu(r){_renderCellContent(e,t){const i=this;let n;const{column:s}=t;!s.command&&Ts(s)&&i.option("headerFilter.visible")&&t.rowType==="header"&&(n=i._applyColumnState({name:"headerFilter",rootElement:e,column:s,showColumnLines:i.option("showColumnLines")}),n&&i._subscribeToIndicatorEvent(n,s,"headerFilter")),super._renderCellContent.apply(this,arguments)}_subscribeToIndicatorEvent(e,t,i){i==="headerFilter"&&v.on(e,Q,this.createAction((n=>{n.event.stopPropagation(),Jd(e,this),this._headerFilterController.showHeaderFilterMenu(t.index,!1)})))}_updateIndicator(e,t,i){const n=super._updateIndicator(e,t,i);n&&this._subscribeToIndicatorEvent(n,t,i)}_updateHeaderFilterIndicators(){this.option("headerFilter.visible")&&this._updateIndicators("headerFilter")}_needUpdateFilterIndicators(){return!0}_columnOptionChanged(e){const{optionNames:t}=e,i=y.checkChanges(t,["filterValues","filterValue"]),n=y.checkChanges(t,["filterValues","filterType"]);(i||n)&&this._needUpdateFilterIndicators()&&this._updateHeaderFilterIndicators(),n||super._columnOptionChanged(e)}},bw=r=>class extends bu(r){_createGroupPanelItem(e,t){const i=this,n=super._createGroupPanelItem.apply(i,arguments);let s;return!t.command&&Ts(t)&&i.option("headerFilter.visible")&&(s=i._applyColumnState({name:"headerFilter",rootElement:n,column:{alignment:cn(i.option("rtlEnabled")),filterValues:t.filterValues,allowHeaderFiltering:!0,caption:t.caption},showColumnLines:!0}),s&&v.on(s,Q,i.createAction((o=>{const{event:a}=o;a.stopPropagation(),this._headerFilterController.showHeaderFilterMenu(t.index,!0)})))),n}},yw=r=>class extends r{skipCalculateColumnFilters(){return!1}_calculateAdditionalFilter(){if(this.skipCalculateColumnFilters())return super._calculateAdditionalFilter();const e=[super._calculateAdditionalFilter()],t=this._columnsController.getVisibleColumns(null,!0),n=this._headerFilterController.getCurrentColumn();return x(t,((s,o)=>{let a;if(!(n&&n.index===o.index)&&Ts(o)&&o.calculateFilterExpression&&Array.isArray(o.filterValues)&&o.filterValues.length){let l=[];x(o.filterValues,((d,c)=>{Array.isArray(c)?a=c:(o.deserializeValue&&!y.isDateType(o.dataType)&&o.dataType!=="number"&&(c=o.deserializeValue(c)),a=o.createFilterExpression(c,"=","headerFilter")),a&&(a.columnIndex=o.index),l.push(a)})),l=y.combineFilters(l,"or"),e.push(o.filterType==="exclude"?["!",l]:l)}})),y.combineFilters(e)}},jS={defaultOptions:()=>({syncLookupFilterValues:!0,headerFilter:{visible:!1,width:252,height:325,allowSelectAll:!0,search:{enabled:!1,timeout:500,mode:"contains",editorOptions:{}},texts:{emptyValue:w.format("dxDataGrid-headerFilterEmptyValue"),ok:w.format("dxDataGrid-headerFilterOK"),cancel:w.format("dxDataGrid-headerFilterCancel")}}}),controllers:{headerFilter:xw},views:{headerFilterView:mw},extenders:{controllers:{data:yw},views:{columnHeadersView:ww,headerPanel:bw}}};function Iw(r,e){const t=h("<div>").addClass("dx-filterbuilder-range-start"),i=h("<div>").addClass("dx-filterbuilder-range-end");let n=r.value||[];const s=function(a){return a&&a.length>0?a[0]:null},o=function(a){return a&&a.length===2?a[1]:null};e.append(t),e.append(h("<span>").addClass("dx-filterbuilder-range-separator").text("â")),e.append(i),e.addClass("dx-filterbuilder-range"),this._editorFactory.createEditor.call(this,t,b({},r.field,r,{value:s(n),parentType:"filterBuilder",setValue(a){n=[a,o(n)],r.setValue(n)}})),this._editorFactory.createEditor.call(this,i,b({},r.field,r,{value:o(n),parentType:"filterBuilder",setValue(a){n=[s(n),a],r.setValue(n)}}))}function Xl(r,e){return{name:"between",caption:r,icon:"range",valueSeparator:"â",dataTypes:["number","date","datetime"],editorTemplate:Iw.bind(e),notForLookup:!0}}const Sw={"=":"equal","<>":"notequal","<":"less","<=":"lessorequal",">":"greater",">=":"greaterorequal",notcontains:"doesnotcontain",contains:"contains",startswith:"startswith",endswith:"endswith",isblank:"isblank",isnotblank:"isnotblank"},Ew={"=":"equal","<>":"notEqual","<":"lessThan","<=":"lessThanOrEqual",">":"greaterThan",">=":"greaterThanOrEqual",startswith:"startsWith",contains:"contains",notcontains:"notContains",endswith:"endsWith",isblank:"isBlank",isnotblank:"isNotBlank",between:"between"},Iu={getIconByFilterOperation:r=>Sw[r],getNameByFilterOperation:r=>Ew[r]},Tw={number:["=","<>","<",">","<=",">=","isblank","isnotblank"],string:["contains","notcontains","startswith","endswith","=","<>","isblank","isnotblank"],date:["=","<>","<",">","<=",">=","isblank","isnotblank"],datetime:["=","<>","<",">","<=",">=","isblank","isnotblank"],boolean:["=","<>","isblank","isnotblank"],object:["isblank","isnotblank"]},Dw={date:"shortDate",datetime:"shortDateShortTime"},Rw=["=","<>","isblank","isnotblank"],Vw=["caption","customizeText","dataField","dataType","editorTemplate","falseText","editorOptions","filterOperations","format","lookup","trueText","calculateFilterExpression","name"];function Ow(r,e){const t=r.format||Dw[r.dataType];if(Io(e)){const i=r.trueText||w.format("dxDataGrid-trueText"),n=r.falseText||w.format("dxDataGrid-falseText");return e?i:n}return r.dataType==="date"||r.dataType==="datetime"?Vo.format(new Date(e),t):Vo.format(e,t)}function Nt(r){return r&&r.length>1&&r[0]==="!"&&!we(r)}function Ht(r){return Nt(r)?r[1]:r}function Fw(r,e){return Nt(r)?r[1]=e:r=e,r}function Aw(r,e){(function(t){return t.indexOf("!")!==-1})(e)?Nt(r)||(function(t){const i=t.slice(0);t.length=0,t.push("!",i)})(r):Nt(r)&&(function(t){const i=Ht(t);t.length=0,[].push.apply(t,i)})(r)}function Pw(r,e){Aw(r,e);const t=Ht(r);let i;return e=(function(n){return n.indexOf("!")===-1?n:n.substring(1)})(e),(function(n,s){for(i=0;i<n.length;i++)Array.isArray(n[i])||(n[i]=s)})(t,e),r}function kw(r,e){const t=ri(r);return e.filter((i=>i.value===t))[0]}function Su(r){if(we(r))return"and";let e="";for(let t=0;t<r.length;t++){const i=r[t];if(!Array.isArray(i)){if(e&&e!==i)throw Hp.Error("E4019");i!=="!"&&(e=i)}}return e}function ri(r){const e=Ht(r);let t=Su(e);return t||(t="and"),e!==r&&(t=`!${t}`),t}function Mw(r){return r.lookup&&Rw||Tw[r.dataType||"string"]}function Bw(r){return Array.isArray(r)&&r.length}function Eu(r){const e=Bw(r.filterOperations)?r.filterOperations:Mw(r);return b([],e)}function Go(r,e){const t=Iu.getNameByFilterOperation(r);return e&&e[t]?e[t]:t}function Nw(r,e){for(let t=0;t<e.length;t++)if(e[t].value===r)return e[t];throw new se.Error("E1048",r)}function Ct(r,e){const t=r.filter((i=>i.name===e));return t.length?t[0]:null}function Lw(r,e,t){const i=Eu(r),n=!!r.lookup;return t.forEach((s=>{if(!r.filterOperations&&i.indexOf(s.name)===-1){const o=s&&s.dataTypes;!(n?!!s.notForLookup:!1)&&o&&o.indexOf(r.dataType||"string")>=0&&i.push(s.name)}})),i.map((s=>{const o=Ct(t,s);return o?{icon:o.icon||"icon-none",text:o.caption||rn(o.name),value:o.name,isCustom:!0}:{icon:Iu.getIconByFilterOperation(s)||"icon-none",text:Go(s,e),value:s}}))}function Tr(r){return r.defaultFilterOperation||Eu(r)[0]}function $w(r,e){const t=[r.dataField,"",""],i=Tr(r);return qo(t,i,e),t}function Uo(r,e){const t=Ht(r),i=t.indexOf(e);return t.splice(i,1),t.length!==1&&t.splice(i,1),r}function Tu(r){const e=Dr(r),t=e?Rr(r):r;return e?["!",[t]]:[t]}function ls(r,e){const t=Ht(e),i=ri(t);return t.length===1?t.unshift(r):t.push(r,i),e}function ds(r,e){for(let i=0;i<e.length;i++)if(e[i].name===r||e[i].dataField.toLowerCase()===r.toLowerCase())return e[i];const t=Au(e,!0).filter((i=>i.dataField.toLowerCase()===r.toLowerCase()));if(t.length>0)return t[0];throw new se.Error("E1047",r)}function Wt(r){return Array.isArray(r)?r.length<2||Array.isArray(r[0])||Array.isArray(r[1]):!1}function we(r){return Array.isArray(r)?r.length>1&&!Array.isArray(r[0])&&!Array.isArray(r[1]):!1}function Zl(r,e,t){t=t||"and";const i=Su(r).toLowerCase()||t;let n=[];for(let s=0;s<r.length;s++)Wt(r[s])?(n.push(Vr(r[s],e,t)),n=ho(n,i)):we(r[s])&&(n.push(cs(r[s],e)),n=ho(n,i));return n.length===0&&(n=ho(n,i)),n}function Hw(r,e){const t=Ct(e,r[1]);return t&&t.name===r[1]}function cs(r,e){return Hw(r,e)||r.length<3&&(r[2]=r[1],r[1]="="),r}function Dr(r){return r.indexOf("not")!==-1}function Rr(r){return r.substring(3).toLowerCase()}function uo(r,e){const t=Dr(e);return e=t?Rr(e):e,t?["!",r,e]:[r,e]}function ho(r,e){const t=Dr(e);e=t?Rr(e):e,r.push(e);let i=r;return t&&(i=["!",i]),i}function Vr(r,e,t){return t=t||"and",r?(r=b(!0,[],r),we(r)?uo(cs(r,e),t):Nt(r)?["!",we(r[1])?uo(cs(r[1],e),t):Nt(r[1])?uo(Vr(r[1],e),t):Zl(r[1],e,t)]:Zl(r,e,t)):Tu(t)}function Ww(r){return r.reduce(((e,t)=>{if(m(t.dataField)){const i={};for(const n in t)t[n]&&Vw.includes(n)&&(i[n]=t[n]);i.defaultCalculateFilterExpression=si.defaultCalculateFilterExpression,m(i.dataType)||(i.dataType="string"),m(i.trueText)||(i.trueText=w.format("dxDataGrid-trueText")),m(i.falseText)||(i.falseText=w.format("dxDataGrid-falseText")),e.push(i)}return e}),[])}function Ql(r,e,t,i){const n=ds(r[0],e),s=cs(r,t),o=t.length&&Ct(t,s[1]);return o&&o.calculateFilterExpression?o.calculateFilterExpression.apply(o,[s[2],n,e]):n.createFilterExpression?n.createFilterExpression.apply(n,[s[2],s[1],i]):n.calculateFilterExpression?n.calculateFilterExpression.apply(n,[s[2],s[1],i]):n.defaultCalculateFilterExpression.apply(n,[s[2],s[1],i])}function Vi(r,e,t,i){if(!m(r))return null;if(Nt(r))return["!",Vi(r[1],e,t,i)];const n=Ht(r);if(we(n))return Ql(n,e,t,i)||null;let s=[],o;const a=ri(n);for(let l=0;l<n.length;l++)Wt(n[l])?(o=Vi(n[l],e,t,i),o&&(l&&s.push(a),s.push(o))):we(n[l])&&(o=Ql(n[l],e,t,i),o&&(s.length&&s.push(a),s.push(o)));return s.length===1&&(s=s[0]),s.length?s:null}function Ji(r){const e=Ht(r);let t;if(e.length===0)return null;const i=[];for(t=0;t<e.length;t++)if(Wt(e[t])){const n=Ji(e[t]);n?e[t]=n:i.push(e[t])}else we(e[t])&&(Kw(e[t])||i.push(e[t]));for(t=0;t<i.length;t++)Uo(e,i[t]);return e.length===1||(e.splice(e.length-1,1),e.length===1&&(r=Fw(r,e[0])),r.length===0)?null:r}function Du(r,e,t){if(e===""){t("");return}const{lookup:i}=r;if(i.items)t(i.calculateCellValue(e)||"");else{const n=B(i.dataSource)?i.dataSource({}):i.dataSource;new Ei(n).loadSingle(i.valueExpr,e).done((o=>{let a="";o&&(a=i.displayExpr?Pe(i.displayExpr)(o):o),r.customizeText&&(a=r.customizeText({value:e,valueText:a})),t(a)})).fail((()=>{t("")}))}}function Ru(r,e,t,i,n){let s=Ow(r,e);return r.customizeText&&(s=r.customizeText.call(r,{value:e,valueText:s,target:i})),t&&t.customizeText&&(s=t.customizeText.call(t,{value:e,valueText:s,field:r,target:i},n)),s}function zw(r,e,t,i){const n={values:e};return e.map((s=>Ru(r,s,t,i,n)))}function po(r){return r===""||r===null}function Vu(r,e,t){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"filterBuilder";if(po(e))return"";if(Array.isArray(e)){const n=new S;return O.apply(this,zw(r,e,t,i)).done((function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=o.some((d=>!po(d)))?o.map((d=>po(d)?"?":d)):"";n.resolve(l)})),n}return Ru(r,e,t,i)}function Jl(r,e){return r.some((t=>t.dataField===e))}function Ou(r,e,t){const{dataField:i}=t;Or(i)&&(t.parentId=Pu(i),!Jl(e,t.parentId)&&!Jl(r,t.parentId)&&Ou(r,e,{id:t.parentId,dataType:"object",dataField:t.parentId,caption:Fu(t.parentId,!0),filterOperations:["isblank","isnotblank"],defaultCalculateFilterExpression:si.defaultCalculateFilterExpression})),e.push(t)}function Fu(r,e){let t="";if(e)r=r.substring(r.lastIndexOf(".")+1);else if(Or(r))return r.split(".").forEach(((i,n,s)=>{t+=rn(i),n!==s.length-1&&(t+=".")})),t;return rn(r)}function Au(r,e){const t=[];for(let i=0;i<r.length;i++){const n=b(!0,{caption:Fu(r[i].dataField,e)},r[i]);n.id=n.name||n.dataField,e?Ou(r,t,n):t.push(n)}return t}function Or(r){return r.lastIndexOf(".")!==-1}function Pu(r){return r.substring(0,r.lastIndexOf("."))}function ku(r,e){if(Or(r.dataField)){const t=Pu(r.dataField);for(let i=0;i<e.length;i++)if(e[i].dataField===t)return`${ku(e[i],e)}.${r.caption}`}return r.caption}function qo(r,e,t){let i=Ct(t,e);return i?(i.hasValue===!1?(r[1]=e,r.length=2):(r[1]=e,r[2]=""),r):(e==="isblank"?(r[1]="=",r[2]=null):e==="isnotblank"?(r[1]="<>",r[2]=null):(i=Ct(t,r[1]),(i||r.length===2||r[2]===null)&&(r[2]=""),r[1]=e),r)}function ed(r){let e;return r[2]===null?r[1]==="="?e="isblank":e="isnotblank":e=r[1],e}function Kw(r){return r[2]!==""}function Gw(r,e,t){const i=b(!0,[],r);let n=-1;return i.some(((s,o)=>{if(s.name==="between")return n=o,!0})),n!==-1?i[n]=b(Xl(e,t),i[n]):i.unshift(Xl(e,t)),i}function ln(r,e){return r[0]===e}function Yo(r,e){return!r||r.length===0?null:we(r)?ln(r,e)?null:r:Mu(r,[e],!1)}function Mu(r,e,t){const i=[],n=Nt(r);return r.forEach((s=>{we(s)?ln(s,e[0])?t?(i.push(e),t=!1):i.splice(i.length-1,1):i.push(s):(i.length||Wt(s))&&i.push(s)})),i.length===0?null:(t&&(i.push("and"),i.push(e)),n?["!",i.length===1?i[0]:i]:i.length===1?i[0]:i)}function td(r,e){return r===null||r.length===0?e:we(r)?ln(r,e[0])?e:[r,"and",e]:ri(r)!=="and"?[e,"and",r]:Mu(r,e,!0)}function Uw(r,e){return r===null||r.length===0?[]:we(r)?ln(r,e)?[r]:[]:ri(r)!=="and"?[]:r.filter((n=>we(n)&&ln(n,e)))}function Bu(r,e){return r===null||r.length===0?!1:we(r)?r[0]===e:r.some((t=>(we(t)||Wt(t))&&Bu(t,e)))}const jo=function(r,e,t){if(Array.isArray(e)){const i=e.length-1;r.empty(),e.forEach(((n,s)=>{h("<span>").addClass("dx-filterbuilder-text-part").text(n).appendTo(r),s!==i&&h("<span>").addClass("dx-filterbuilder-text-separator").text(t&&t.valueSeparator?t.valueSeparator:"|").addClass("dx-filterbuilder-text-separator-empty").appendTo(r)}))}else e?r.text(e):r.text(w.format("dxFilterBuilder-enterValueText"))};function Nu(r){const e=function(n,s){return s?`${s}/${n}`:n},t=function(n,s){let o=[];return n.forEach((a=>{if(a.items){const l=t(a.items,e(a.text,s));o=o.concat(l)}a.selected&&o.push(e(a.text,s))})),o},i=r&&r.getController("headerFilter");return{dataTypes:["string","date","datetime","number","boolean","object"],calculateFilterExpression:function(n,s,o){const a=[],l=n.length-1;return n&&n.forEach(((d,c)=>{if(we(d)||Wt(d)){const u=Vi(d,o,[],"headerFilter");a.push(u)}else{const u=Vi([s.dataField,"=",d],o,[],"headerFilter");a.push(u)}c!==l&&a.push("or")})),a.length===1?a[0]:a},editorTemplate(n,s){const o=h("<div>").addClass("dx-filterbuilder-item-value-text").appendTo(s),a=b(!0,{},r.columnOption(n.field.dataField));return jo(o,n.text&&n.text.split("|")),a.filterType="include",a.filterValues=n.value?n.value.slice():[],i.showHeaderFilterMenuBase({columnElement:o,column:a,apply(){l=this.filterValues,n.setValue(l);var l;i.hideHeaderFilterMenu(),n.closeEditor()},onHidden(){n.closeEditor()},isFilterBuilder:!0}),s},customizeText:function(n,s){s=s||{};const{value:o}=n;let a=r.columnOption(n.field.dataField);const l=a&&a.headerFilter,d=a&&a.lookup,c=s.values||[o];if(l&&l.dataSource||d&&d.dataSource){const p=new S,g=s.items||new S;if(!s.items){a=b({},a,{filterType:"include",filterValues:c});const _=i.getDataSource(a);_.paginate=!1;const f=new Ei(_),C=f.store().key();if(C){const{values:I}=s;if(I&&I.length>1){const E=I.reduce(((D,k)=>(D.length&&D.push("or"),D.push([C,"=",k]),D)),[]);f.filter(E)}else f.filter([C,"=",n.value])}else n.field.calculateDisplayValue&&se.log("W1017");s.items=g,f.load().done(g.resolve)}return g.done((_=>{const f=c.indexOf(n.value);p.resolve(t(_,null)[f])})),p}return i.getHeaderItemText(o,a,0,r.option("headerFilter"))}}}function qw(r){return b(Nu(r),{name:"anyof",icon:"selectall",caption:w.format("dxFilterBuilder-filterOperationAnyOf")})}function Yw(r){const e=Nu(r);return b({},e,{calculateFilterExpression(t,i,n){const s=e.calculateFilterExpression(t,i,n);return!s||s.length===0?null:s[0]==="!"?s:["!",s]},name:"noneof",icon:"unselectall",caption:w.format("dxFilterBuilder-filterOperationNoneOf")})}const jw=["=","<>","<","<=",">",">=","notcontains","contains","startswith","endswith","between"];function lt(r){return r.name||r.dataField}function Xw(r){r.forEach((e=>{const t=lt(e);if(!m(t)&&e.allowFiltering)throw new se.Error("E1049",e.caption)}))}const go=function(){return{filterType:"include",filterValues:void 0}},Lu=function(r){const e=r.filterValues||[];return!si.getGroupInterval(r)&&!(r.headerFilter&&r.headerFilter.dataSource)||e.length===1&&e[0]===null},Zw=function(r,e){if(!r)return go();let t;const i=r[1],n=r[2],s=Array.isArray(n);if(!s&&!Lu(e))return go();switch(i){case"anyof":case"=":t="include";break;case"noneof":case"<>":t="exclude";break;default:return go()}return{filterType:t,filterValues:s?n:[n]}},id=function(r){const e=r.filterValue;if(m(e)){const t=r.selectedFilterOperation||r.defaultFilterOperation||Tr(r);return[lt(r),t,r.filterValue]}return null},nd=function(r){let e,t;const{filterValues:i}=r;return i?(i.length===1&&Lu(r)&&!Array.isArray(i[0])?(r.filterType==="exclude"?e="<>":e="=",t=i[0]):(r.filterType==="exclude"?e="noneof":e="anyof",t=i),[lt(r),e,t]):null},sd=function(r,e,t){const i=Zw(t,e);r.columnOption(lt(e),i)},od=function(r,e,t){let i,n=t==null?void 0:t[1];const s=t==null?void 0:t[2],o=e.filterOperations||e.defaultFilterOperations,a=!o||o.indexOf(n)>=0,l=n===e.defaultFilterOperation,d=jw.includes(n);(a||l)&&d&&(s!==null&&s!=="")?(l&&!m(e.selectedFilterOperation)&&(n=e.selectedFilterOperation),i={filterValue:s,selectedFilterOperation:n}):i={filterValue:void 0,selectedFilterOperation:void 0},r.columnOption(lt(e),i)};class Qw extends j.Controller{init(){this._dataController=this.getController("data"),this._columnsController=this.getController("columns"),this._dataController.isFilterSyncActive()&&(this._columnsController.isAllDataTypesDefined()?this._initSync():this._dataController.dataSourceChanged.add((()=>this._initSync())))}publicMethods(){return["getCustomFilterOperations"]}syncFilterValue(){const e=this,t=this._columnsController.getFilteringColumns();this._skipSyncColumnOptions=!0,t.forEach((i=>{const n=Uw(e.option("filterValue"),lt(i));if(n.length===1){const s=n[0];sd(this._columnsController,i,s),od(this._columnsController,i,s)}else m(i.filterValues)&&sd(this._columnsController,i,null),m(i.filterValue)&&od(this._columnsController,i,null)})),this._skipSyncColumnOptions=!1}_initSync(){const e=this._columnsController.getColumns(),t=this._dataController.pageIndex();if(Xw(e),!this.option("filterValue")){const i=this._columnsController.getFilteringColumns(),n=this.getFilterValueFromColumns(i);this._silentOption("filterValue",n)}this.syncFilterValue(),this._dataController.pageIndex(t)}_getSyncFilterRow(e,t){const i=id(t);return m(i)?td(e,i):Yo(e,lt(t))}_getSyncHeaderFilter(e,t){const i=nd(t);return i?td(e,i):Yo(e,lt(t))}getFilterValueFromColumns(e){if(!this._dataController.isFilterSyncActive())return null;const t=["and"];return e&&e.forEach((i=>{const n=nd(i),s=id(i);n&&ls(n,t),s&&ls(s,t)})),Ji(t)}syncFilterRow(e,t){this.option("filterValue",this._getSyncFilterRow(this.option("filterValue"),e))}syncHeaderFilter(e){this.option("filterValue",this._getSyncHeaderFilter(this.option("filterValue"),e))}getCustomFilterOperations(){const e=this.option("filterBuilder.customOperations")??[];return[qw(this.component),Yw(this.component)].concat(e)}}const Jw=r=>class extends r{optionChanged(e){switch(e.name){case"filterValue":this._applyFilter(),this.isFilterSyncActive()&&this._filterSyncController.syncFilterValue(),e.handled=!0;break;case"filterSyncEnabled":e.handled=!0;break;case"columns":if(this.isFilterSyncActive()){const t=this._columnsController.getColumnByPath(e.fullName);if(t&&!this._filterSyncController._skipSyncColumnOptions){const i=this._parseColumnPropertyName(e.fullName);this._filterSyncController._skipSyncColumnOptions=!0,i==="filterType"?(e.value==="exclude"||e.previousValue==="exclude")&&this._filterSyncController.syncHeaderFilter(t):i==="filterValues"?this._filterSyncController.syncHeaderFilter(t):["filterValue","selectedFilterOperation"].includes(i)&&this._filterSyncController.syncFilterRow(t,t.filterValue),this._filterSyncController._skipSyncColumnOptions=!1}}super.optionChanged(e);break;default:super.optionChanged(e)}}isFilterSyncActive(){const e=this.option("filterSyncEnabled");return e==="auto"?this.option("filterPanel.visible"):e}skipCalculateColumnFilters(){return(m(this.option("filterValue"))||this._filterSyncController._skipSyncColumnOptions)&&this.isFilterSyncActive()}_calculateAdditionalFilter(){if(this.option("filterPanel.filterEnabled")===!1)return super._calculateAdditionalFilter();const e=[super._calculateAdditionalFilter()],t=this._columnsController.getFilteringColumns();let i=this.option("filterValue");if(this.isFilterSyncActive()){const o=this._headerFilterController.getCurrentColumn(),a=this._applyFilterController.getCurrentColumnForFiltering(),l=o||a;(o||m(a==null?void 0:a.filterValue))&&i&&(i=Yo(i,lt(l)))}const n=this._filterSyncController.getCustomFilterOperations(),s=Vi(i,t,n,"filterBuilder");return s&&e.push(s),y.combineFilters(e)}_parseColumnPropertyName(e){const t=e.match(/.*\.(.*)/);return t?t[1]:null}clearFilter(e){this.component.beginUpdate(),arguments.length>0?(e==="filterValue"&&this.option("filterValue",null),super.clearFilter(e)):(this.option("filterValue",null),super.clearFilter()),this.component.endUpdate()}_applyFilter(){return this._filterSyncController._skipSyncColumnOptions?new S().resolve():super._applyFilter.apply(this,arguments)}},eb=r=>class extends r{optionChanged(e){e.name==="filterValue"?this._updateHeaderFilterIndicators():super.optionChanged(e)}_isHeaderFilterEmpty(e){return this._dataController.isFilterSyncActive()?!Bu(this.option("filterValue"),lt(e)):super._isHeaderFilterEmpty(e)}_needUpdateFilterIndicators(){return!this._dataController.isFilterSyncActive()}},XS={defaultOptions:()=>({filterValue:null,filterSyncEnabled:"auto"}),controllers:{filterSync:Qw},extenders:{controllers:{data:Jw},views:{columnHeadersView:eb}}},rd="dx-filterbuilder-action-icon",Pn="dx-state-active",ad="filterBuilder",tb="dx-treeview-node-container",ib=[{name:"onEditorPreparing",config:{excludeValidators:["disabled","readOnly"],category:"rendering"}},{name:"onEditorPrepared",config:{excludeValidators:["disabled","readOnly"],category:"rendering"}},{name:"onValueChanged",config:{excludeValidators:["disabled","readOnly"]}}],ld={and:"and",or:"or",notAnd:"!and",notOr:"!or"},nb=Yc(class{});class $u extends Lt{_getDefaultOptions(){return b(super._getDefaultOptions(),{onEditorPreparing:null,onEditorPrepared:null,onValueChanged:null,fields:[],groupOperations:["and","or","notAnd","notOr"],maxGroupLevel:void 0,value:null,allowHierarchicalFields:!1,groupOperationDescriptions:{and:w.format("dxFilterBuilder-and"),or:w.format("dxFilterBuilder-or"),notAnd:w.format("dxFilterBuilder-notAnd"),notOr:w.format("dxFilterBuilder-notOr")},customOperations:[],closePopupOnTargetScroll:!0,filterOperationDescriptions:{between:w.format("dxFilterBuilder-filterOperationBetween"),equal:w.format("dxFilterBuilder-filterOperationEquals"),notEqual:w.format("dxFilterBuilder-filterOperationNotEquals"),lessThan:w.format("dxFilterBuilder-filterOperationLess"),lessThanOrEqual:w.format("dxFilterBuilder-filterOperationLessOrEquals"),greaterThan:w.format("dxFilterBuilder-filterOperationGreater"),greaterThanOrEqual:w.format("dxFilterBuilder-filterOperationGreaterOrEquals"),startsWith:w.format("dxFilterBuilder-filterOperationStartsWith"),contains:w.format("dxFilterBuilder-filterOperationContains"),notContains:w.format("dxFilterBuilder-filterOperationNotContains"),endsWith:w.format("dxFilterBuilder-filterOperationEndsWith"),isBlank:w.format("dxFilterBuilder-filterOperationIsBlank"),isNotBlank:w.format("dxFilterBuilder-filterOperationIsNotBlank")}})}_optionChanged(e){switch(e.name){case"closePopupOnTargetScroll":break;case"onEditorPreparing":case"onEditorPrepared":case"onValueChanged":this._initActions();break;case"customOperations":this._initCustomOperations(),this._invalidate();break;case"fields":case"maxGroupLevel":case"groupOperations":case"allowHierarchicalFields":case"groupOperationDescriptions":case"filterOperationDescriptions":this._invalidate();break;case"value":if(e.value!==e.previousValue){const t=this._disableInvalidateForValue;t||(this._initModel(),this._invalidate()),this._disableInvalidateForValue=!1,this.executeAction("onValueChanged",{value:e.value,previousValue:e.previousValue}),this._disableInvalidateForValue=t}break;default:super._optionChanged(e)}}getFilterExpression(){const e=this._getNormalizedFields(),t=b(!0,[],this._model);return Vi(Ji(t),e,this._customOperations,ad)}_getNormalizedFields(){return Ww(this.option("fields"))}_updateFilter(){this._disableInvalidateForValue=!0;const e=b(!0,[],this._model),t=Ji(e),i=Ji(this._getModel(this.option("value")));JSON.stringify(i)!==JSON.stringify(t)&&this.option("value",t),this._disableInvalidateForValue=!1,this._fireContentReadyAction()}_init(){this._initCustomOperations(),this._initModel(),this._initEditorFactory(),this._initActions(),super._init()}_initEditorFactory(){this._editorFactory=new nb}_initCustomOperations(){this._customOperations=Gw(this.option("customOperations"),this.option("filterOperationDescriptions.between"),this)}_getDefaultGroupOperation(){var e;return((e=this.option("groupOperations"))===null||e===void 0?void 0:e[0])??ld.and}_getModel(e){return Vr(e,this._customOperations,this._getDefaultGroupOperation())}_initModel(){this._model=this._getModel(this.option("value"))}_initActions(){const e=this;e._actions={},ib.forEach((t=>{const i=b({},t.config);e._actions[t.name]=e._createActionByOption(t.name,i)}))}executeAction(e,t){const i=this._actions[e];return i&&i(t)}_initMarkup(){this.$element().addClass("dx-filterbuilder"),super._initMarkup(),this._addAriaAttributes(this.$element(),w.format("dxFilterBuilder-filterAriaRootElement"),"group"),this._createGroupElementByCriteria(this._model).appendTo(this.$element())}_addAriaAttributes(e,t,i,n,s,o){if(!e||!e.length)return;const a={role:i};t&&(e.text().length>0?a.title=t:a["aria-label"]=t),m(n)&&(a["aria-haspopup"]=`${n}`),m(s)&&(a["aria-expanded"]=`${s}`),m(o)&&(a["aria-level"]=`${o}`),e.attr(a)}_createConditionElement(e,t,i){return h("<div>").addClass("dx-filterbuilder-group").append(this._createConditionItem(e,t,i)).attr("role","group")}_createGroupElementByCriteria(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=this._createGroupElement(e,t,i),s=n.find(".dx-filterbuilder-group-content"),o=Ht(e);for(let a=0;a<o.length;a++){const l=o[a];Wt(l)?this._createGroupElementByCriteria(l,e,i+1).appendTo(s):we(l)&&this._createConditionElement(l,e,`${i+1}`).appendTo(s)}return n}_createGroupElement(e,t,i){const n=new Te,s=h("<div>").addClass("dx-filterbuilder-group-item"),o=h("<div>").addClass("dx-filterbuilder-group-content").attr("id",`${n}`),a=h("<div>").addClass("dx-filterbuilder-group").append(s).append(o);t!=null&&this._createRemoveButton((()=>{Uo(t,e),a.remove(),this._updateFilter()}),"group").appendTo(s);let l=i;return i===0&&(this._addAriaAttributes(a,"","tree"),l+=1),this._addAriaAttributes(s,w.format("dxFilterBuilder-filterAriaGroupItem"),"treeitem",null,null,l),s.attr("aria-owns",`${n}`),this._createGroupOperationButton(e).appendTo(s),this._createAddButton((()=>{const d=Tu(this._getDefaultGroupOperation());ls(d,e),this._createGroupElement(d,e,i+1).appendTo(o),this._updateFilter()}),(()=>{const d=this.option("fields")[0],c=$w(d,this._customOperations);ls(c,e),this._createConditionElement(c,e,i+1).appendTo(o),this._updateFilter()}),i).appendTo(s),a}_createButton(e){return h("<div>").text(e)}_createGroupOperationButton(e){const t=this._getGroupOperations(e);let i=kw(e,t);const n=i.text,s=t&&t.length<2?this._createButton(n).addClass("dx-state-disabled"):this._createButtonWithMenu({caption:n,menu:{items:t,displayExpr:"text",keyExpr:"value",onItemClick:o=>{i!==o.itemData&&(Pw(e,o.itemData.value),s.text(o.itemData.text),i=o.itemData,this._updateFilter())},onContentReady(o){o.component.selectItem(i)},cssClass:"dx-filterbuilder-group-operations"}});return this._addAriaAttributes(s,w.format("dxFilterBuilder-filterAriaOperationButton"),"combobox",!0,!1),s.addClass("dx-filterbuilder-text").addClass("dx-filterbuilder-group-operation").attr("tabindex",0)}_createButtonWithMenu(e){const t=this,i=function(){t.$element().find(`.${Pn}`).removeClass(Pn).attr("aria-expanded","false"),t.$element().find(".dx-overlay .dx-treeview").remove(),t.$element().find(".dx-overlay").remove()},n=this.option("rtlEnabled"),s=n?"right":"left",o=this._createButton(e.caption),a=new Te;o.attr("aria-controls",`${a}`),b(e.menu,{id:a,focusStateEnabled:!0,selectionMode:"single",onItemClick:(l=e.menu.onItemClick,function(d){l(d),d.event.type==="dxclick"&&i()}),onHiding(){o.removeClass(Pn).attr("aria-expanded","false")},position:{my:`${s} top`,at:`${s} bottom`,offset:"0 1",of:o,collision:"flip"},animation:null,onHidden(){i()},cssClass:`dx-filterbuilder-overlay ${e.menu.cssClass}`,rtlEnabled:n});var l;return e.popup={onShown(d){const u=h(d.component.content()).find(".dx-treeview");u.length&&t._applyAccessibilityAttributes(u),v.on(u,"keyup keydown",(g=>{const _=Ie(g);(g.type==="keydown"&&_==="tab"||g.type==="keyup"&&(_==="escape"||_==="enter"))&&(d.component.hide(),v.trigger(e.menu.position.of,"focus"))}));const p=u.dxTreeView("instance");p.focus(),p.option("focusedElement",null)}},this._subscribeOnClickAndEnterKey(o,(()=>{i(),t._createPopupWithTreeView(e,t.$element()),o.addClass(Pn).attr("aria-expanded","true")})),o}_hasValueButton(e){const t=Ct(this._customOperations,e[1]);return t?t.hasValue!==!1:e[2]!==null}_createOperationButtonWithMenu(e,t){const i=this,n=Lw(t,this.option("filterOperationDescriptions"),this._customOperations);let s=Nw(ed(e),n);const o=this._createButtonWithMenu({caption:s.text,menu:{items:n,displayExpr:"text",onItemRendered(a){a.itemData.isCustom&&h(a.itemElement).addClass("dx-filterbuilder-menu-custom-operation")},onContentReady(a){a.component.selectItem(s)},onItemClick:a=>{if(s!==a.itemData){s=a.itemData,qo(e,s.value,i._customOperations);const l=o.siblings().filter(".dx-filterbuilder-item-value");i._hasValueButton(e)?(l.length!==0&&l.remove(),i._createValueButton(e,t).appendTo(o.parent())):l.remove(),o.text(s.text),this._updateFilter()}},cssClass:"dx-filterbuilder-operations"}}).addClass("dx-filterbuilder-text").addClass("dx-filterbuilder-item-operation").attr("tabindex",0);return this._addAriaAttributes(o,w.format("dxFilterBuilder-filterAriaItemOperation"),"combobox",!0,!1),o}_createOperationAndValueButtons(e,t,i){this._createOperationButtonWithMenu(e,t).appendTo(i),this._hasValueButton(e)&&this._createValueButton(e,t).appendTo(i)}_createFieldButtonWithMenu(e,t,i){const n=this,s=this.option("allowHierarchicalFields"),o=Au(e,s);let a=ds(i.name||i.dataField,o);const l=function(c,u){return s?ku(c,u):c.caption};t[0]=a.name||a.dataField;const d=this._createButtonWithMenu({caption:l(a,o),menu:{items:o,dataStructure:"plain",keyExpr:"id",parentId:"parentId",displayExpr:"caption",onItemClick:c=>{if(a!==c.itemData){a=c.itemData,t[0]=a.name||a.dataField,t[2]=a.dataType==="object"?null:"",qo(t,Tr(a),n._customOperations),d.siblings().filter(".dx-filterbuilder-text").remove(),n._createOperationAndValueButtons(t,a,d.parent());const u=l(a,c.component.option("items"));d.text(u),this._updateFilter()}},onContentReady(c){c.component.selectItem(a)},cssClass:"dx-filterbuilder-fields"}}).addClass("dx-filterbuilder-text").addClass("dx-filterbuilder-item-field").attr("tabindex",0);return this._addAriaAttributes(d,w.format("dxFilterBuilder-filterAriaItemField"),"combobox",!0,!1),d}_createConditionItem(e,t,i){const n=h("<div>").addClass("dx-filterbuilder-group-item"),s=this._getNormalizedFields(),o=ds(e[0],s);return this._addAriaAttributes(n,"","treeitem",null,null,i),this._createRemoveButton((()=>{Uo(t,e),n.parent().children().length===1?n.parent().remove():n.remove(),this._updateFilter()}),"condition").appendTo(n),this._createFieldButtonWithMenu(s,e,o).appendTo(n),this._createOperationAndValueButtons(e,o,n),n}_getGroupOperations(e){let t=this.option("groupOperations");const i=this.option("groupOperationDescriptions");return(!t||!t.length)&&(t=[ri(e).replace("!","not")]),t.map((n=>({text:i[n],value:ld[n]})))}_createRemoveButton(e,t){const i=h("<div>").addClass(rd).addClass("dx-icon-remove").addClass("dx-filterbuilder-action").attr("tabindex",0);if(t){const n=w.format("dxFilterBuilder-filterAriaRemoveButton",t);this._addAriaAttributes(i,n,"button")}return this._subscribeOnClickAndEnterKey(i,e),i}_createAddButton(e,t,i){let n;const s=this.option("maxGroupLevel");return m(s)&&i>=s?(n=this._createButton(),this._subscribeOnClickAndEnterKey(n,t)):n=this._createButtonWithMenu({menu:{items:[{caption:w.format("dxFilterBuilder-addCondition"),click:t},{caption:w.format("dxFilterBuilder-addGroup"),click:e}],displayExpr:"caption",onItemClick(o){o.itemData.click()},cssClass:"dx-filterbuilder-add-condition"}}),this._addAriaAttributes(n,w.format("dxFilterBuilder-filterAriaAddButton"),"combobox",!0,!1),n.addClass(rd).addClass("dx-icon-plus").addClass("dx-filterbuilder-action").attr("tabindex",0)}_createValueText(e,t,i){const n=this,s=h("<div>").html("&nbsp;").addClass("dx-filterbuilder-item-value-text").attr("tabindex",0).appendTo(i);this._addAriaAttributes(s,w.format("dxFilterBuilder-filterAriaItemValue"),"button",!0);const o=e[2],a=Ct(n._customOperations,e[1]);return!a&&t.lookup?Du(t,o,(l=>{jo(s,l)})):O(Vu(t,o,a)).done((l=>{jo(s,l,a)})),n._subscribeOnClickAndEnterKey(s,(l=>{l.type==="keyup"&&l.stopPropagation(),n._createValueEditorWithEvents(e,t,i)})),s}_updateConditionValue(e,t,i){e[2]!==t&&(e[2]=t),i(),this._updateFilter()}_addDocumentKeyUp(e,t){let i=!1,n=!1;const s=M.getDocument(),o=l=>{if(i||n){n=!1;return}t(l)};v.on(s,"keyup",o);const a=e.find("input");v.on(a,"compositionstart",(()=>{i=!0})),v.on(a,"compositionend",(()=>{i=!1,n=!0})),v.on(a,"keydown",(l=>{l.which!==229&&(n=!1)})),this._documentKeyUpHandler=o}_addDocumentClick(e,t){const i=M.getDocument(),n=s=>{this._isFocusOnEditorParts(e,s.target)||(v.trigger(e.find("input"),"change"),t())};v.on(i,"dxpointerdown",n),this._documentClickHandler=n}_isFocusOnEditorParts(e,t){const i=t||M.getActiveElement();return h(i).closest(e.children()).length||h(i).closest(".dx-dropdowneditor-overlay").length}_removeEvents(){const e=M.getDocument();m(this._documentKeyUpHandler)&&v.off(e,"keyup",this._documentKeyUpHandler),m(this._documentClickHandler)&&v.off(e,"dxpointerdown",this._documentClickHandler)}_dispose(){this._removeEvents(),super._dispose()}_createValueEditorWithEvents(e,t,i){let n=e[2];const s=()=>(i.empty(),this._removeEvents(),this._createValueText(e,t,i)),o=()=>{this._updateConditionValue(e,n,(()=>{s()}))},a={value:n===""?null:n,filterOperation:ed(e),setValue(d){n=d===null?"":d},closeEditor:o,text:i.text()};i.empty();const l=this._createValueEditor(i,t,a);v.trigger(l.find("input").not(":hidden").eq(0),"focus"),this._removeEvents(),this._addDocumentClick(l,o),this._addDocumentKeyUp(l,(d=>{const c=Ie(d);if(c==="tab"){if(this._isFocusOnEditorParts(l))return;this._updateConditionValue(e,n,(()=>{s(),d.shiftKey&&v.trigger(i.prev(),"focus")}))}c==="escape"&&v.trigger(s(),"focus"),c==="enter"&&this._updateConditionValue(e,n,(()=>{v.trigger(s(),"focus")}))})),this._fireContentReadyAction()}_createValueButton(e,t){const i=h("<div>").addClass("dx-filterbuilder-text").addClass("dx-filterbuilder-item-value");return this._createValueText(e,t,i),i}_createValueEditor(e,t,i){const n=h("<div>").attr("tabindex",0).appendTo(e),s=Ct(this._customOperations,i.filterOperation),o=s&&s.editorTemplate?s.editorTemplate:t.editorTemplate;return o?this._getTemplate(o).render({model:b({field:t},i),container:n}):this._editorFactory.createEditor.call(this,n,b({},t,i,{parentType:ad})),n}_createPopupWithTreeView(e,t){const i=this,n=h("<div>").addClass(e.menu.cssClass).appendTo(t);this._createComponent(n,ni,{onHiding:e.menu.onHiding,onHidden:e.menu.onHidden,rtlEnabled:e.menu.rtlEnabled,position:e.menu.position,animation:e.menu.animation,contentTemplate(s){const o=h("<div>").appendTo(s);i._createComponent(o,_n,e.menu),o.attr("id",`${e.menu.id}`),this.repaint()},_ignoreFunctionValueDeprecation:!0,maxHeight:()=>xu(e.menu.position.of),visible:!0,focusStateEnabled:!1,preventScrollEvents:!1,container:n,hideOnOutsideClick:!0,onShown:e.popup.onShown,shading:!1,width:"auto",height:"auto",showTitle:!1,_wrapperClassExternal:e.menu.cssClass,_ignorePreventScrollEventsDeprecation:!0})}_subscribeOnClickAndEnterKey(e,t){v.on(e,"dxclick",t),v.on(e,"keyup",(i=>{Ie(i)==="enter"&&t(i)}))}_applyAccessibilityAttributes(e){var t;const i=e.closest(".dx-overlay-content");i==null||i.removeAttr("role");const n=i==null||(t=i.find)===null||t===void 0?void 0:t.call(i,`.${tb}`);n==null||n.attr("role","presentation")}}_e("dxFilterBuilder",$u);class sb extends j.View{init(){super.init(),this._columnsController=this.getController("columns"),this._filterSyncController=this.getController("filterSync")}optionChanged(e){switch(e.name){case"filterBuilder":case"filterBuilderPopup":this._invalidate(),e.handled=!0;break;default:super.optionChanged(e)}}_renderCore(){this._updatePopupOptions()}_updatePopupOptions(){this.option("filterBuilderPopup.visible")?this._initPopup():this._filterBuilderPopup&&this._filterBuilderPopup.hide()}_disposePopup(){this._filterBuilderPopup&&(this._filterBuilderPopup.dispose(),this._filterBuilderPopup=void 0),this._filterBuilder&&(this._filterBuilder.dispose(),this._filterBuilder=void 0)}_initPopup(){const e=this;e._disposePopup(),e._filterBuilderPopup=e._createComponent(e.element(),ni,b({title:w.format("dxDataGrid-filterBuilderPopupTitle"),contentTemplate:t=>e._getPopupContentTemplate(t),onOptionChanged(t){t.name==="visible"&&e.option("filterBuilderPopup.visible",t.value)},toolbarItems:e._getPopupToolbarItems()},e.option("filterBuilderPopup"),{onHidden(){nc(e),e._disposePopup()}}))}_getPopupContentTemplate(e){const t=h(e),i=h("<div>").appendTo(h(e));this._filterBuilder=this._createComponent(i,$u,b({value:this.option("filterValue"),fields:this._columnsController.getFilteringColumns()},this.option("filterBuilder"),{customOperations:this._filterSyncController.getCustomFilterOperations()})),this._createComponent(t,Wp,{direction:"both"})}_getPopupToolbarItems(){const e=this;return[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:w.format("OK"),onClick(){const t=e._filterBuilder.option("value");e.option("filterValue",t),e._filterBuilderPopup.hide()}}},{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:w.format("Cancel"),onClick(){e._filterBuilderPopup.hide()}}}]}}const ZS={defaultOptions:()=>({filterBuilder:{groupOperationDescriptions:{and:w.format("dxFilterBuilder-and"),or:w.format("dxFilterBuilder-or"),notAnd:w.format("dxFilterBuilder-notAnd"),notOr:w.format("dxFilterBuilder-notOr")},filterOperationDescriptions:{between:w.format("dxFilterBuilder-filterOperationBetween"),equal:w.format("dxFilterBuilder-filterOperationEquals"),notEqual:w.format("dxFilterBuilder-filterOperationNotEquals"),lessThan:w.format("dxFilterBuilder-filterOperationLess"),lessThanOrEqual:w.format("dxFilterBuilder-filterOperationLessOrEquals"),greaterThan:w.format("dxFilterBuilder-filterOperationGreater"),greaterThanOrEqual:w.format("dxFilterBuilder-filterOperationGreaterOrEquals"),startsWith:w.format("dxFilterBuilder-filterOperationStartsWith"),contains:w.format("dxFilterBuilder-filterOperationContains"),notContains:w.format("dxFilterBuilder-filterOperationNotContains"),endsWith:w.format("dxFilterBuilder-filterOperationEndsWith"),isBlank:w.format("dxFilterBuilder-filterOperationIsBlank"),isNotBlank:w.format("dxFilterBuilder-filterOperationIsNotBlank")}},filterBuilderPopup:{}}),views:{filterBuilderView:sb}};class ob extends j.View{init(){this._dataController=this.getController("data"),this._columnsController=this.getController("columns"),this._filterSyncController=this.getController("filterSync"),this._dataController.dataSourceChanged.add((()=>this.render()))}isVisible(){return this.option("filterPanel.visible")&&this._dataController.dataSource()}_renderCore(){const e=this.element();if(e.empty(),!!!this._columnsController.getColumns().length)return;e.addClass(this.addWidgetPrefix("filter-panel"));const i=h("<div>").addClass(this.addWidgetPrefix("filter-panel-left")).appendTo(e);this._renderFilterBuilderText(e,i)}_renderFilterBuilderText(e,t){const i=this._getFilterElement(),n=this._getTextElement();if(this.option("filterValue")||this._filterValueBuffer){const s=this._getCheckElement(),o=this._getRemoveButtonElement();t.append(s).append(i).append(n),e.append(o);return}t.append(i).append(n)}_getCheckElement(){const e=this,t=h("<div>").addClass(this.addWidgetPrefix("filter-panel-checkbox"));return e._createComponent(t,So,{value:e.option("filterPanel.filterEnabled"),onValueChanged(i){e.option("filterPanel.filterEnabled",i.value)}}),t.attr("title",this.option("filterPanel.texts.filterEnabledHint")),t}_getFilterElement(){const e=this,t=h("<div>").addClass("dx-icon-filter");return v.on(t,"click",(()=>e._showFilterBuilder())),Hn("filterPanel",e,t,void 0,(()=>e._showFilterBuilder())),e._addTabIndexToElement(t),t}_getTextElement(){const e=this,t=h("<div>").addClass(e.addWidgetPrefix("filter-panel-text"));let i;const n=e.option("filterValue");return n?O(e.getFilterText(n,this._filterSyncController.getCustomFilterOperations())).done((s=>{const o=e.option("filterPanel.customizeText");if(o){const a=o({component:e.component,filterValue:n,text:s});typeof a=="string"&&(s=a)}t.text(s)})):(i=e.option("filterPanel.texts.createFilter"),t.text(i)),v.on(t,"click",(()=>e._showFilterBuilder())),Hn("filterPanel",e,t,void 0,(()=>e._showFilterBuilder())),e._addTabIndexToElement(t),t}_showFilterBuilder(){this.option("filterBuilderPopup.visible",!0)}_getRemoveButtonElement(){const e=this,t=()=>e.option("filterValue",null),i=h("<div>").addClass(e.addWidgetPrefix("filter-panel-clear-filter")).text(e.option("filterPanel.texts.clearFilter"));return v.on(i,"click",t),Hn("filterPanel",this,i,void 0,t),e._addTabIndexToElement(i),i}_addTabIndexToElement(e){if(!this.option("useLegacyKeyboardNavigation")){const t=this.option("tabindex")||0;e.attr("tabindex",t)}}optionChanged(e){switch(e.name){case"filterValue":this._invalidate(),this.option("filterPanel.filterEnabled",!0),e.handled=!0;break;case"filterPanel":this._invalidate(),e.handled=!0;break;default:super.optionChanged(e)}}_getConditionText(e,t,i){let n=`[${e}] ${t}`;return m(i)&&(n+=i),n}_getValueMaskedText(e){return Array.isArray(e)?`('${e.join("', '")}')`:` '${e}'`}_getValueText(e,t,i){const n=new S,s=t&&t.customizeText;if(m(i)||s)if(!s&&e.lookup)Du(e,i,(o=>{n.resolve(this._getValueMaskedText(o))}));else{const o=Array.isArray(i)?i:y.getDisplayValue(e,i,null);O(Vu(e,o,t,"filterPanel")).done((a=>{n.resolve(this._getValueMaskedText(a))}))}else n.resolve("");return n.promise()}getConditionText(e,t){const i=this,n=e[1],s=new S,o=Ct(t.customOperations,n);let a;const l=ds(e[0],t.columns),d=l.caption||"",c=e[2];return o?a=o.caption||Od.captionize(o.name):c===null?a=Go(n==="="?"isblank":"isnotblank",t.filterOperationDescriptions):a=Go(n,t.filterOperationDescriptions),this._getValueText(l,o,c).done((u=>{s.resolve(i._getConditionText(d,a,u))})),s}getGroupText(e,t,i){const n=this,s=new S,o=[],a=ri(e);return e.forEach((l=>{we(l)?o.push(n.getConditionText(l,t)):Wt(l)&&o.push(n.getGroupText(l,t,!0))})),O.apply(this,o).done((function(){let l;for(var d=arguments.length,c=new Array(d),u=0;u<d;u++)c[u]=arguments[u];a.startsWith("!")?l=`${t.groupOperationDescriptions[`not${a.substring(1,2).toUpperCase()}${a.substring(2)}`].split(" ")[0]} ${c[0]}`:l=c.join(` ${t.groupOperationDescriptions[a]} `),i&&(l=`(${l})`),s.resolve(l)})),s}getFilterText(e,t){const i={customOperations:t,columns:this._columnsController.getFilteringColumns(),filterOperationDescriptions:this.option("filterBuilder.filterOperationDescriptions"),groupOperationDescriptions:this.option("filterBuilder.groupOperationDescriptions")};return we(e)?this.getConditionText(e,i):this.getGroupText(e,i)}}const rb=r=>class extends r{optionChanged(e){e.name==="filterPanel"?(this._applyFilter(),e.handled=!0):super.optionChanged(e)}},QS={defaultOptions:()=>({filterPanel:{visible:!1,filterEnabled:!0,texts:{createFilter:w.format("dxDataGrid-filterPanelCreateFilter"),clearFilter:w.format("dxDataGrid-filterPanelClearFilter"),filterEnabledHint:w.format("dxDataGrid-filterPanelFilterEnabledHint")}}}),views:{filterPanelView:ob},extenders:{controllers:{data:rb}}};function Hu(r){return!!(r.allowSearch??r.allowFiltering)}function Wu(r,e){const{lookup:t}=r;return r.parseValue?t?r.parseValue.call(t,e):r.parseValue(e):e}const ab=r=>class extends r{optionChanged(e){switch(e.fullName){case"searchPanel.text":case"searchPanel":this._applyFilter(),e.handled=!0;break;default:super.optionChanged(e)}}publicMethods(){return super.publicMethods().concat(["searchByText"])}_calculateAdditionalFilter(){var e,t,i;const n=(e=this._dataController)===null||e===void 0||(t=e.getDataSource)===null||t===void 0?void 0:t.call(e),s=n==null||(i=n.loadOptions)===null||i===void 0||(i=i.call(n))===null||i===void 0?void 0:i.langParams,o=super._calculateAdditionalFilter(),a=this.calculateSearchFilter(this.option("searchPanel.text"),s);return y.combineFilters([o,a])}searchByText(e){this.option("searchPanel.text",e)}calculateSearchFilter(e,t){let i;const n=this._columnsController.getColumns(),s=this.option("searchPanel.searchVisibleColumnsOnly");let o;const a=[];if(!e)return null;function l(c){const u=Pe(o.valueExpr);for(let p=0;p<c.length;p++){const g=u(c[p]);a.push(i.createFilterExpression(g,null,"search"))}}for(let c=0;c<n.length;c++)if(i=n[c],!(s&&!i.visible)&&Hu(i)&&i.calculateFilterExpression){var d;o=i.lookup;const u=Wu(i,e);(d=o)!==null&&d!==void 0&&d.items?Xi(o.items,{langParams:t}).filter(i.createFilterExpression.call({dataField:o.displayExpr,dataType:o.dataType,calculateFilterExpression:i.calculateFilterExpression},u,null,"search")).enumerate().done(l):u!==void 0&&a.push(i.createFilterExpression(u,null,"search"))}return a.length===0?["!"]:y.combineFilters(a,"or")}},lb=r=>class extends r{optionChanged(e){if(e.name==="searchPanel"){if(e.fullName==="searchPanel.text"){const t=this.getSearchTextEditor();t&&t.option("value",e.value)}else this._invalidate();e.handled=!0}else super.optionChanged(e)}_getToolbarItems(){const e=super._getToolbarItems();return this._prepareSearchItem(e)}_prepareSearchItem(e){const t=this,i=this._dataController,n=this.option("searchPanel");if(n&&n.visible){const s={template(o,a,l){const d=h("<div>").addClass(t.addWidgetPrefix("search-panel")).appendTo(l);t._editorFactoryController.createEditor(d,{width:n.width,placeholder:n.placeholder,parentType:"searchPanel",value:t.option("searchPanel.text"),updateValueTimeout:700,setValue(c){i.searchByText(c)},editorOptions:{inputAttr:{"aria-label":w.format(`${t.component.NAME}-ariaSearchInGrid`)}}}),t.resize()},name:"searchPanel",location:"after",locateInMenu:"never",sortIndex:40};e.push(s)}return e}getSearchTextEditor(){const e=this,t=e.element(),i=t.find(`.${e.addWidgetPrefix("search-panel")}`).filter((function(){return h(this).closest(`.${e.addWidgetPrefix("header-panel")}`).is(t)}));return i.length?i.dxTextBox("instance"):null}},db=r=>class extends r{init(){super.init.apply(this,arguments),this._searchParams=[],this._dataController=this.getController("data")}dispose(){clearTimeout(this._highlightTimer),super.dispose()}_getFormattedSearchText(e,t){const i=Wu(e,t),n=y.getFormatOptionsByColumn(e,"search");return y.formatValue(i,n)}_getStringNormalizer(){var e,t,i;const n=this.option("searchPanel.highlightCaseSensitive"),s=(e=this._dataController)===null||e===void 0||(t=e.getDataSource)===null||t===void 0?void 0:t.call(e),o=s==null||(i=s.loadOptions)===null||i===void 0||(i=i.call(s))===null||i===void 0?void 0:i.langParams;return a=>Gt(a,n,o)}_findHighlightingTextNodes(e,t,i){var n;const s=this;let o=t.parent(),a;const l=this._getStringNormalizer(),d=l(i),c=[];if(!o.length)o=h("<div>").append(t);else if(e)if(e.groupIndex>=0&&!e.showWhenGrouped)a=t;else{const u=s._columnsController.getVisibleIndex(e.index);a=o.children("td").eq(u).find("*")}return a=(n=a)!==null&&n!==void 0&&n.length?a:o.find("*"),a.each(((u,p)=>{const g=h(p).contents();for(let _=0;_<g.length;_++){const f=g.get(_);f.nodeType===3&&l(f.textContent??f.nodeValue??"").includes(d)&&c.push(f)}})),c}_highlightSearchTextCore(e,t){const i=this,n=h("<span>").addClass(i.addWidgetPrefix("search-text")),s=e.text(),o=e[0],a=this._getStringNormalizer(),l=a(s).indexOf(a(t));if(l>=0)return o.textContent?o.textContent=s.substr(0,l):o.nodeValue=s.substr(0,l),e.after(n.text(s.substr(l,t.length))),e=h(M.createTextNode(s.substr(l+t.length))).insertAfter(n),i._highlightSearchTextCore(e,t)}_highlightSearchText(e,t,i){const n=this,s=this._getStringNormalizer();let o=n.option("searchPanel.text");t&&i&&(o=o&&n._getFormattedSearchText(i,o)),o&&n.option("searchPanel.highlightSearchText")&&n._findHighlightingTextNodes(i,e,o).forEach((l=>{t?s(h(l).text())===s(o??"")&&h(l).replaceWith(h("<span>").addClass(n.addWidgetPrefix("search-text")).text(h(l).text())):n._highlightSearchTextCore(h(l),o)}))}_renderCore(){const e=super._renderCore.apply(this,arguments);return(this.option().rowTemplate||this.option("dataRowTemplate"))&&(this.option("templatesRenderAsynchronously")?(clearTimeout(this._highlightTimer),this._highlightTimer=setTimeout((()=>{this._highlightSearchText(this.getTableElement())}))):this._highlightSearchText(this.getTableElement())),e}_updateCell(e,t){const{column:i}=t,s=(i.lookup&&i.lookup.dataType||i.dataType)!=="string";Hu(i)&&!t.isOnForm&&(this.option("templatesRenderAsynchronously")?(this._searchParams.length||(clearTimeout(this._highlightTimer),this._highlightTimer=setTimeout((()=>{this._searchParams.forEach((o=>{this._highlightSearchText.apply(this,o)})),this._searchParams=[]}))),this._searchParams.push([e,s,i])):this._highlightSearchText(e,s,i)),super._updateCell(e,t)}},JS={defaultOptions:()=>({searchPanel:{visible:!1,width:160,placeholder:w.format("dxDataGrid-searchPanelPlaceholder"),highlightSearchText:!0,highlightCaseSensitive:!1,text:"",searchVisibleColumnsOnly:!1}}),extenders:{controllers:{data:ab},views:{headerPanel:lb,rowsView:db}}},cb=T({},Wd,{isGridCompatibilityMode:!1,showInfo:!1,displayMode:"adaptive",maxPagesCount:10,pageCount:1,visible:!0,hasKnownLastPage:!0,pagesNavigatorVisible:"auto",showPageSizeSelector:!0,allowedPageSizes:[5,10],showNavigationButtons:!1,itemCount:1,label:w.format("dxPagination-ariaLabel")}),de=T({},cb,{pageSize:5,pageIndex:1,pageIndexChangedInternal:()=>{},pageSizeChangedInternal:()=>{}}),ub="dx-pager",hb="dx-pagination",pb="dx-light-mode",gb="dx-pages",mb="dx-page-indexes",_b="dx-page",fb="dx-selection",Cb="dx-page-size",vb="dx-page-sizes",xb="dx-page-size dx-selection",wb="dx-first-child",en=zd(void 0),tn=zd(void 0),bb={};class zu extends $t{constructor(){super(...arguments),this.state={}}getConfig(){return{isGridCompatibilityMode:this.props.isGridCompatibilityMode}}getChildContext(){return T({},this.context,{[tn.id]:this.getConfig()||tn.defaultValue})}render(){return this.props.children}}zu.defaultProps=bb;function yb(r){return r[tn.id]?r[tn.id]:tn.defaultValue}function Ku(r){var e;return!!((e=yb(r))!==null&&e!==void 0&&e.isGridCompatibilityMode)}function dt(r,e){let t=e;return Ku(r)&&(t=e.replace("dxPagination","dxPager")),w.getFormatter(t)()}const Ib="dx-info",Sb={pageCount:de.pageCount,pageIndex:de.pageIndex,itemCount:de.itemCount};class Gu extends $t{constructor(){super(...arguments),this.state={},this.refs=null,this.rootElementRef=He()}getInfoText(){return this.props.infoText??dt(this.context,"dxPagination-infoText")}getText(){const{pageCount:e,pageIndex:t,itemCount:i}=this.props;return hn(this.getInfoText(),(t+1).toString(),e==null?void 0:e.toString(),i==null?void 0:i.toString())}render(){return Pt(1,"div","dx-info",this.getText(),0,null,null,this.props.rootElementRef)}}Gu.defaultProps=Sb;const Eb={className:"",label:"",tabIndex:0,selected:!1};class dn extends Oi{constructor(e){super(e),this.state={},this.refs=null,this.widgetRef=He(),this.keyboardEffect=this.keyboardEffect.bind(this),this.subscribeToClick=this.subscribeToClick.bind(this)}getComponentProps(){return this.props}getKeyboardContext(){return this.context[en.id]?this.context[en.id]:en.defaultValue}componentWillUpdate(e,t,i){super.componentWillUpdate(e,t,i)}createEffects(){return[new kt(this.keyboardEffect,[this.getKeyboardContext(),this.props.onClick]),new kt(this.subscribeToClick,[this.props.onClick])]}updateEffects(){var e,t;(e=this._effects[0])===null||e===void 0||e.update([this.getKeyboardContext(),this.props.onClick]),(t=this._effects[1])===null||t===void 0||t.update([this.props.onClick])}keyboardEffect(){return this.getKeyboardContext().registerKeyboardAction(this.widgetRef.current,this.props.onClick)}subscribeToClick(){return zp(this.widgetRef.current,this.props.onClick)}render(){return Pt(1,"div",this.props.className,this.props.children,0,{tabindex:this.props.tabIndex,role:"button","aria-label":this.props.label,"aria-current":this.props.selected?"page":void 0},null,this.widgetRef)}}dn.defaultProps=Eb;const Tb={allowedPageSizes:[],pageSize:de.pageSize,pageSizeChangedInternal:de.pageSizeChangedInternal};class Uu extends $t{constructor(e){super(e),this.state={},this.refs=null,this.__getterCache={pageSizesText:void 0},this.state={},this.onPageSizeChange=this.onPageSizeChange.bind(this)}getPageSizesText(){if(this.__getterCache.pageSizesText!==void 0)return this.__getterCache.pageSizesText;const e=(()=>{const{pageSize:t,allowedPageSizes:i}=this.props;return i.map(((n,s)=>{const{text:o,value:a}=n;return{className:fs({[a===t?xb:Cb]:!0,[wb]:s===0}),click:this.onPageSizeChange(a),label:hn(dt(this.context,"dxPagination-pageSize"),a||dt(this.context,"dxPagination-pageSizesAllText")),text:o}}))})();return this.__getterCache.pageSizesText=e,e}onPageSizeChange(e){return()=>(this.props.pageSizeChangedInternal(e),this.props.pageSize)}componentWillUpdate(e){(this.props.pageSize!==e.pageSize||this.props.allowedPageSizes!==e.allowedPageSizes||this.props.pageSizeChangedInternal!==e.pageSizeChangedInternal)&&(this.__getterCache.pageSizesText=void 0)}render(){return sr(this.getPageSizesText().map((e=>{let{text:t,className:i,label:n,click:s}=e;return xe(2,dn,{className:i,label:n,onClick:s,children:t},t)})),0)}}Uu.defaultProps=Tb;const qu={label:"",labelMode:Fi(Se())?"floating":"static"},Db={className:"",activeStateEnabled:!1,disabled:!1,focusStateEnabled:!1,hoverStateEnabled:!1,tabIndex:0,visible:!0,rtlEnabled:!1},dd=T({},Wd,{_feedbackHideTimeout:400,_feedbackShowTimeout:30,cssText:"",aria:{},classes:"",name:"",addWidgetClass:!0}),Yu=T({},Db,{aria:dd.aria,classes:dd.classes,readOnly:!1,name:"",value:null,validationError:null,validationErrors:null,validationMessageMode:"auto",validationMessagePosition:"bottom",validationStatus:"valid",isValid:!0,isDirty:!1,inputAttr:{}}),ju={hoverStateEnabled:!0,activeStateEnabled:!0,focusStateEnabled:G.real().deviceType==="desktop"&&!G.isSimulator()},Rb=T({},Yu,ju,qu,{placeholder:"",hoverStateEnabled:!0,searchEnabled:!1,value:null,isReactComponentWrapper:!0});class Xu extends $t{constructor(){super(...arguments),this.state={},this.refs=null}get componentProps(){return this.props}render(){return xe(2,Kd,{componentType:Ld,componentProps:this.componentProps,templateNames:["dropDownButtonTemplate","groupTemplate","itemTemplate"]})}}Xu.defaultProps=Rb;function Zu(r,e){return r+10*Math.max(...e).toString().length}function Vb(r){var e;const t=oe();return r?(e=t.getComputedStyle)===null||e===void 0?void 0:e.call(t,r):null}function Ob(r){return r?Number(r.replace("px","")):0}function vt(r,e){const t=Vb(e)??{};return Ob(t[r])}function Fb(r){const e=vt("paddingLeft",r)+vt("paddingRight",r);return vt("width",r)-e}function Xn(r){const e=vt("marginLeft",r)+vt("marginRight",r),t=vt("width",r);return e+t}function Qu(r){return vt("minWidth",r)}const Ab={allowedPageSizes:[]},Pb=T({},Ab,{pageSize:de.pageSize,pageSizeChangedInternal:de.pageSizeChangedInternal});class Ju extends Oi{constructor(e){super(e),this.state={minWidth:10},this.refs=null,this.updateWidth=this.updateWidth.bind(this)}componentWillUpdate(e,t,i){super.componentWillUpdate(e,t,i)}createEffects(){const e=[this.props,this.state.minWidth,this.props.pageSize,this.props.pageSizeChangedInternal,this.props.allowedPageSizes];return[new kt(this.updateWidth,e)]}updateEffects(){var e;const t=[this.props,this.state.minWidth,this.props.pageSize,this.props.pageSizeChangedInternal,this.props.allowedPageSizes];(e=this._effects[0])===null||e===void 0||e.update(t)}updateWidth(){var e;const t=Qu((e=this.props.parentRef)===null||e===void 0?void 0:e.current);this.setState((i=>({minWidth:t>0?t:i.minWidth})))}getWidth(){var e;return Zu(this.state.minWidth,(e=this.props.allowedPageSizes)===null||e===void 0?void 0:e.map((t=>t.value)))}getInputAttributes(){return{"aria-label":dt(this.context,"dxPagination-ariaPageSize")}}render(){const{allowedPageSizes:e,pageSize:t,pageSizeChangedInternal:i}=this.props;return xe(2,Xu,{displayExpr:"text",valueExpr:"value",dataSource:e,value:t,valueChange:i,width:this.getWidth(),inputAttr:this.getInputAttributes()})}}Ju.defaultProps=Pb;const kb={isLargeDisplayMode:!0,pageSize:de.pageSize,pageSizeChangedInternal:de.pageSizeChangedInternal,allowedPageSizes:de.allowedPageSizes};class eh extends Oi{constructor(e){super(e),this.state={},this.refs=null,this.rootElementRef=He(),this.htmlRef=He(),this.__getterCache={normalizedPageSizes:void 0},this.setRootElementRef=this.setRootElementRef.bind(this)}createEffects(){return[new kt(this.setRootElementRef,[])]}setRootElementRef(){const{rootElementRef:e}=this.props;e&&(e.current=this.htmlRef.current)}getAllText(){return dt(this.context,"dxPagination-pageSizesAllText")}getNormalizedPageSizes(){if(this.__getterCache.normalizedPageSizes!==void 0)return this.__getterCache.normalizedPageSizes;const e=this.props.allowedPageSizes.map((t=>t==="all"||t===0?{text:this.getAllText(),value:0}:{text:String(t),value:t}));return this.__getterCache.normalizedPageSizes=e,e}componentWillUpdate(e){super.componentWillUpdate(),this.props.allowedPageSizes!==e.allowedPageSizes&&(this.__getterCache.normalizedPageSizes=void 0)}render(){const e=this.getNormalizedPageSizes(),{pageSize:t,pageSizeChangedInternal:i,isLargeDisplayMode:n}=this.props;return Pt(1,"div",vb,[n&&xe(2,Uu,{allowedPageSizes:e,pageSize:t,pageSizeChangedInternal:i}),!n&&xe(2,Ju,{parentRef:this.htmlRef,allowedPageSizes:e,pageSize:t,pageSizeChangedInternal:i})],0,null,null,this.htmlRef)}}eh.defaultProps=kb;const Mb={index:0,selected:!1,className:_b};class Fr extends $t{constructor(){super(...arguments),this.state={},this.refs=null}getLabel(){return hn(dt(this.context,"dxPagination-page"),this.getValue())}getValue(){return this.props.index+1}getClassName(){return fs({[`${this.props.className}`]:!!this.props.className,[fb]:!!this.props.selected})}render(){return xe(2,dn,{className:this.getClassName(),label:this.getLabel(),onClick:this.props.onClick,selected:this.props.selected,children:this.getValue()})}}Fr.defaultProps=Mb;const Bb={maxPagesCount:de.maxPagesCount,pageCount:de.pageCount,pageIndex:de.pageIndex,pageIndexChangedInternal:de.pageIndexChangedInternal};function cd(r,e,t){switch(!0){case r===1:return"high";case r+e===t-1:return"low";default:return"both"}}function th(r,e,t){let i=[],n=[];switch(t){case"none":i=[...r];break;case"both":i=[0,"low",...r,"high",e-1],n=r.slice(1,-1);break;case"high":i=[0,...r,"high",e-1],n=r.slice(0,-1);break;case"low":i=[0,"low",...r,e-1],n=r.slice(1)}return{slidingWindowIndexes:r,indexesForReuse:n,pageIndexes:i}}function ud(r,e,t,i){const n=[];for(let s=0;s<e;s+=1)n.push(s+r);return th(n,t,i)}class ih extends $t{constructor(e){super(e),this.state={},this.refs=null,this.canReuseSlidingWindow=this.canReuseSlidingWindow.bind(this),this.generatePageIndexes=this.generatePageIndexes.bind(this),this.isSlidingWindowMode=this.isSlidingWindowMode.bind(this),this.onPageClick=this.onPageClick.bind(this)}getConfig(){return this.context[Rt.id]?this.context[Rt.id]:Rt.defaultValue}getSlidingWindowState(){const e=this.slidingWindowStateHolder;return e||{indexesForReuse:[],slidingWindowIndexes:[]}}canReuseSlidingWindow(e,t){const{indexesForReuse:i}=this.getSlidingWindowState(),n=i.slice(-1)[0]<e-1,s=i.includes(t);return n&&s}generatePageIndexes(){const{pageCount:e,pageIndex:t}=this.props;let i=0;const{slidingWindowIndexes:n}=this.getSlidingWindowState();t===n[0]?i=t-1:t===n[n.length-1]?i=t+2-4:t<4?i=1:t>=e-4?i=e-4-1:i=t-1;const s=cd(i,4,e),o=ud(i,4,e,s),{pageIndexes:a}=o;return this.slidingWindowStateHolder=o,a}isSlidingWindowMode(){const{maxPagesCount:e,pageCount:t}=this.props;return t<=4||t<=e}onPageClick(e){this.props.pageIndexChangedInternal(e)}getPageIndexes(){const{pageCount:e}=this.props;if(this.isSlidingWindowMode())return ud(0,e,e,"none").pageIndexes;if(this.canReuseSlidingWindow(e,this.props.pageIndex)){const{slidingWindowIndexes:t}=this.getSlidingWindowState(),i=cd(t[0],4,e);return th(t,e,i).pageIndexes}return this.generatePageIndexes()}getPages(){var e;const{pageIndex:t}=this.props,i=o=>{const a=o==="low"||o==="high"?null:{index:o,onClick:()=>this.onPageClick(o),selected:t===o};return{key:o.toString(),pageProps:a}},n=this.getPageIndexes();return((e=this.getConfig())!==null&&e!==void 0&&e.rtlEnabled?[...n].reverse():n).map((o=>i(o)))}render(){const e=this.getPages().map((t=>{let{key:i,pageProps:n}=t;return n?xe(2,Fr,{index:n.index,selected:n.selected,onClick:n.onClick},i):Pt(1,"div","dx-separator",". . .",16,null,i)}));return sr(e,0)}}ih.defaultProps=Bb;const Nb=T({},Yu,ju,qu,{value:0,isReactComponentWrapper:!0});class nh extends $t{constructor(){super(...arguments),this.state={},this.refs=null}get componentProps(){return this.props}render(){return xe(2,Kd,{componentType:os,componentProps:this.componentProps,templateNames:[]})}}nh.defaultProps=Nb;const Lb=`${Ib}  dx-info-text`,$b={pageIndex:de.pageIndex,pageCount:de.pageCount,pageIndexChangedInternal:de.pageIndexChangedInternal};class sh extends Oi{constructor(e){super(e),this.state={minWidth:10},this.refs=null,this.pageIndexRef=He(),this.updateWidth=this.updateWidth.bind(this),this.selectLastPageIndex=this.selectLastPageIndex.bind(this),this.valueChange=this.valueChange.bind(this)}componentWillUpdate(e,t,i){super.componentWillUpdate(e,t,i)}createEffects(){return[new kt(this.updateWidth,[this.state.minWidth])]}updateEffects(){var e;(e=this._effects[0])===null||e===void 0||e.update([this.state.minWidth])}updateWidth(){var e;const t=(e=this.pageIndexRef.current)===null||e===void 0?void 0:e.querySelector(".dx-page-index"),i=t?Qu(t):0;this.setState((n=>({minWidth:i>0?i:n.minWidth})))}getValue(){return this.props.pageIndex+1}getWidth(){return Zu(this.state.minWidth,[this.props.pageCount])}getPagesCountText(){return(this.props.pagesCountText??"")||dt(this.context,"dxPagination-pagesCountText")}getInputAttributes(){return{"aria-label":dt(this.context,"dxPagination-ariaPageNumber")}}selectLastPageIndex(){this.props.pageIndexChangedInternal(this.props.pageCount-1)}valueChange(e){this.props.pageIndexChangedInternal(e-1)}render(){return Pt(1,"div","dx-light-pages",[xe(2,nh,{className:"dx-page-index",min:1,max:Math.max(this.props.pageCount,this.getValue()),width:this.getWidth(),value:this.getValue(),valueChange:this.valueChange,inputAttr:this.getInputAttributes()}),Pt(1,"span",Lb,this.getPagesCountText(),0),xe(2,Fr,{className:"dx-pages-count",selected:!1,index:this.props.pageCount-1,onClick:this.selectLastPageIndex})],4,null,null,this.pageIndexRef)}}sh.defaultProps=$b;const Hb={nextEnabledClass:"dx-navigate-button dx-next-button",prevEnabledClass:"dx-navigate-button dx-prev-button",nextDisabledClass:"dx-button-disable dx-navigate-button dx-next-button",prevDisabledClass:"dx-button-disable dx-navigate-button dx-prev-button"},Wb={next:"prev",prev:"next"};function zb(r){return r==="next"?1:-1}const Kb={isLargeDisplayMode:!0,maxPagesCount:de.maxPagesCount,pageCount:de.pageCount,pageIndex:de.pageIndex,pageIndexChangedInternal:de.pageIndexChangedInternal,showNavigationButtons:de.showNavigationButtons,itemCount:de.itemCount};class oh extends $t{constructor(e){super(e),this.state={},this.refs=null,this.__getterCache={prevButtonProps:void 0,nextButtonProps:void 0},this.pageIndexChangedInternal=this.pageIndexChangedInternal.bind(this),this.getButtonProps=this.getButtonProps.bind(this),this.canNavigateToPage=this.canNavigateToPage.bind(this),this.getNextPageIndex=this.getNextPageIndex.bind(this),this.canNavigateTo=this.canNavigateTo.bind(this),this.navigateToPage=this.navigateToPage.bind(this)}getConfig(){return this.context[Rt.id]?this.context[Rt.id]:Rt.defaultValue}pageIndexChangedInternal(e){this.canNavigateToPage(e)&&this.props.pageIndexChangedInternal(e)}getButtonProps(e){var t;const i=(t=this.getConfig())!==null&&t!==void 0&&t.rtlEnabled?Wb[e]:e,n=this.canNavigateTo(i);return{className:Hb[`${e}${n?"Enabled":"Disabled"}Class`],tabIndex:n?0:-1,navigate:()=>this.navigateToPage(i)}}canNavigateToPage(e){return this.props.hasKnownLastPage?e>=0&&e<=this.props.pageCount-1:e>=0}getNextPageIndex(e){return this.props.pageIndex+zb(e)}canNavigateTo(e){return this.canNavigateToPage(this.getNextPageIndex(e))}navigateToPage(e){this.pageIndexChangedInternal(this.getNextPageIndex(e))}getRenderPrevButton(){const{isLargeDisplayMode:e,showNavigationButtons:t}=this.props;return(!e||t)??!1}getRenderNextButton(){return this.getRenderPrevButton()||!this.props.hasKnownLastPage}getPrevButtonProps(){if(this.__getterCache.prevButtonProps!==void 0)return this.__getterCache.prevButtonProps;const e=this.getButtonProps("prev");return this.__getterCache.prevButtonProps=e,e}getNextButtonProps(){if(this.__getterCache.nextButtonProps!==void 0)return this.__getterCache.nextButtonProps;const e=this.getButtonProps("next");return this.__getterCache.nextButtonProps=e,e}componentWillUpdate(e,t,i){(this.context[Rt.id]!==i[Rt.id]||this.props.hasKnownLastPage!==e.hasKnownLastPage||this.props.pageCount!==e.pageCount||this.props.pageIndex!==e.pageIndex||this.props.pageIndexChangedInternal!==e.pageIndexChangedInternal)&&(this.__getterCache.prevButtonProps=void 0,this.__getterCache.nextButtonProps=void 0)}getPrevButtonLabel(){return dt(this.context,"dxPagination-prevPage")}getNextButtonLabel(){return dt(this.context,"dxPagination-nextPage")}render(){const{className:e,tabIndex:t,navigate:i}=this.getPrevButtonProps(),{isLargeDisplayMode:n,maxPagesCount:s,pageCount:o,pageIndex:a,pagesCountText:l}=this.props;return sr([this.getRenderPrevButton()&&xe(2,dn,{label:this.getPrevButtonLabel(),className:e,tabIndex:t,onClick:i}),n&&xe(2,ih,{maxPagesCount:s,pageCount:o,pageIndex:a,pageIndexChangedInternal:this.pageIndexChangedInternal}),!n&&xe(2,sh,{pageCount:o,pageIndex:a,pageIndexChangedInternal:this.pageIndexChangedInternal,pagesCountText:l}),this.getRenderNextButton()&&xe(2,dn,{label:this.getNextButtonLabel(),className:this.getNextButtonProps().className,tabIndex:this.getNextButtonProps().tabIndex,onClick:this.getNextButtonProps().navigate})],0)}}oh.defaultProps=Kb;const Gb=T({},de,{infoTextVisible:!0,isLargeDisplayMode:!0});class rh extends Oi{constructor(e){super(e),this.state={},this.refs=null,this.widgetElementRef=He(),this.widgetRootElementRef=He(),this.pagesRef=He(),this.infoTextRef=He(),this.__getterCache={keyboardAction:void 0},this.state={},this.__getterCache={},this.setRootElementRef=this.setRootElementRef.bind(this),this.createFakeInstance=this.createFakeInstance.bind(this)}createEffects(){return[new kt(this.setRootElementRef,[])]}getChildContext(){return T({},this.context,{[en.id]:this.getKeyboardAction()||en.defaultValue})}setRootElementRef(){const{rootElementRef:e}=this.props;e&&this.widgetRootElementRef&&(e.current=this.widgetRootElementRef.current)}getWidgetRootElement(){var e;return(e=this.widgetRootElementRef)===null||e===void 0?void 0:e.current}createFakeInstance(){return{option:()=>!1,element:()=>this.getWidgetRootElement(),component:this.props._getParentComponentRootNode?{element:()=>{var e,t;return(e=(t=this.props)._getParentComponentRootNode)===null||e===void 0?void 0:e.call(t)}}:{element:()=>this.getWidgetRootElement()},_createActionByOption:()=>e=>{var t,i;(t=(i=this.props).onKeyDown)===null||t===void 0||t.call(i,e)}}}getKeyboardAction(){return{registerKeyboardAction:(e,t)=>{const i=this.createFakeInstance();return ic("pager",i,e,void 0,t)}}}getInfoVisible(){const{infoTextVisible:e,showInfo:t}=this.props;return!!t&&e}getPageIndexSelectorVisible(){return this.props.pageSize!==0}getNormalizedDisplayMode(){const{displayMode:e,lightModeEnabled:t}=this.props;return e==="adaptive"&&t!==void 0?t?"compact":"full":e??"adaptive"}getPagesContainerVisible(){return!!this.props.pagesNavigatorVisible&&this.props.pageCount>0}getPagesContainerVisibility(){if(this.props.pagesNavigatorVisible==="auto"&&this.props.pageCount===1&&this.props.hasKnownLastPage)return"hidden"}getIsLargeDisplayMode(){const e=this.getNormalizedDisplayMode();let t=!1;return e==="adaptive"?t=this.props.isLargeDisplayMode:t=e==="full",t}getClasses(){const e={[`${this.props.className}`]:!!this.props.className,[ub]:!!this.props.isGridCompatibilityMode,[hb]:!this.props.isGridCompatibilityMode,[pb]:!this.getIsLargeDisplayMode()};return fs(e)}getAria(){return{role:"navigation",label:this.props.label??""}}componentWillUpdate(e){super.componentWillUpdate(),this.props.onKeyDown!==e.onKeyDown&&(this.__getterCache.keyboardAction=void 0)}render(){const{isGridCompatibilityMode:e,rtlEnabled:t,visible:i,showPageSizeSelector:n,allowedPageSizesRef:s,pageSize:o,pageSizeChangedInternal:a,allowedPageSizes:l,infoTextRef:d,infoText:c,pageCount:u,pageIndex:p,itemCount:g,pagesRef:_,hasKnownLastPage:f,maxPagesCount:C,pageIndexChangedInternal:I,pagesCountText:E,showNavigationButtons:D,style:k,width:A,height:F,elementAttr:z,hint:ee,disabled:q,tabIndex:ce,accessKey:ue,activeStateEnabled:te,focusStateEnabled:be,hoverStateEnabled:Ge}=this.props,Oe=Gd(xe(2,Kp,T({rootElementRef:this.widgetRootElementRef,rtlEnabled:t,classes:this.getClasses(),visible:i,aria:this.getAria(),style:k,width:A,height:F,hint:ee,disabled:q,tabIndex:ce,accessKey:ue,activeStateEnabled:te,focusStateEnabled:be,hoverStateEnabled:Ge},z,{children:[n&&xe(2,eh,{rootElementRef:s,isLargeDisplayMode:this.getIsLargeDisplayMode(),itemCount:g,pageSize:o,pageSizeChangedInternal:a,allowedPageSizes:l}),this.getPagesContainerVisible()&&Pt(1,"div",gb,[this.getInfoVisible()&&xe(2,Gu,{rootElementRef:d,infoText:c,pageCount:u,pageIndex:p,itemCount:g}),this.getPageIndexSelectorVisible()&&Pt(1,"div",mb,xe(2,oh,{hasKnownLastPage:f,isLargeDisplayMode:this.getIsLargeDisplayMode(),maxPagesCount:C,pageCount:u,pageIndex:p,pageIndexChangedInternal:I,pagesCountText:E,showNavigationButtons:D,itemCount:g}),2,null,null,_)],0,{style:{visibility:this.getPagesContainerVisibility()}})]})));return xe(2,zu,{isGridCompatibilityMode:e,children:Oe})}}rh.defaultProps=Gb;function Ub(r){let{parent:e,allowedPageSizes:t,pages:i}=r;return e-(t+i)>0}function qb(r){let{parent:e,allowedPageSizes:t,pages:i,info:n}=r;const s=t+i+n;return e-s>0}function Yb(r){let{parent:e,allowedPageSizes:t,pages:i,info:n}=r;const s=Fb(e),o=Xn(t),a=Xn(n),l=Xn(i);return{parent:s,allowedPageSizes:o,info:a+vt("marginLeft",n)+vt("marginRight",n),pages:l}}const jb={paginationProps:T({},de)};class ah extends Oi{constructor(e){super(e),this.state={infoTextVisible:!0,isLargeDisplayMode:!0},this.refs=null,this.parentRef=He(),this.infoTextRef=He(),this.pagesRef=He(),this.allowedPageSizesRef=He(),this.elementsWidth={},this.actualIsLargeDisplayMode=!0,this.actualInfoTextVisible=!0,this.subscribeToResize=this.subscribeToResize.bind(this),this.effectUpdateChildProps=this.effectUpdateChildProps.bind(this),this.updateAdaptivityProps=this.updateAdaptivityProps.bind(this)}componentWillUpdate(e,t,i){super.componentWillUpdate(e,t,i)}createEffects(){return[new kt(this.subscribeToResize,[this.state.infoTextVisible,this.state.isLargeDisplayMode]),new kt(this.effectUpdateChildProps,[this.props,this.state.infoTextVisible,this.state.isLargeDisplayMode,this.props.paginationProps,this.props.contentTemplate])]}updateEffects(){var e,t;(e=this._effects[0])===null||e===void 0||e.update([this.state.infoTextVisible,this.state.isLargeDisplayMode]),(t=this._effects[1])===null||t===void 0||t.update([this.props,this.state.infoTextVisible,this.state.isLargeDisplayMode,this.props.paginationProps,this.props.contentTemplate])}subscribeToResize(){const e=()=>{this.getParentWidth()>0&&this.updateAdaptivityProps()};return Lr.add(e),()=>{Lr.remove(e)}}effectUpdateChildProps(){this.getParentWidth()>0&&this.updateAdaptivityProps()}getContentAttributes(){const{className:e,displayMode:t,isGridCompatibilityMode:i,_getParentComponentRootNode:n,hasKnownLastPage:s,infoText:o,label:a,lightModeEnabled:l,maxPagesCount:d,onKeyDown:c,pageCount:u,pageIndex:p,pageIndexChangedInternal:g,pageSize:_,pageSizeChangedInternal:f,allowedPageSizes:C,pagesCountText:I,pagesNavigatorVisible:E,rtlEnabled:D,showInfo:k,showNavigationButtons:A,showPageSizeSelector:F,itemCount:z,visible:ee,style:q,width:ce,height:ue,elementAttr:te,hint:be,disabled:Ge,tabIndex:Oe,accessKey:ai,activeStateEnabled:kr,focusStateEnabled:Mr,hoverStateEnabled:Eh}=this.props.paginationProps;return{pageSize:_,pageIndex:p,pageIndexChangedInternal:g,pageSizeChangedInternal:f,isGridCompatibilityMode:i,_getParentComponentRootNode:n,className:e,showInfo:k,infoText:o,lightModeEnabled:l,displayMode:t,maxPagesCount:d,pageCount:u,pagesCountText:I,visible:ee,hasKnownLastPage:s,pagesNavigatorVisible:E,showPageSizeSelector:F,allowedPageSizes:C,rtlEnabled:D,showNavigationButtons:A,itemCount:z,onKeyDown:c,label:a,style:q,width:ce,height:ue,elementAttr:te,hint:be,disabled:Ge,tabIndex:Oe,accessKey:ai,activeStateEnabled:kr,focusStateEnabled:Mr,hoverStateEnabled:Eh}}getParentWidth(){var e;return(e=this.parentRef)!==null&&e!==void 0&&e.current?Xn(this.parentRef.current):0}updateAdaptivityProps(){var e,t,i,n;const s=Yb({parent:(e=this.parentRef)===null||e===void 0?void 0:e.current,allowedPageSizes:(t=this.allowedPageSizesRef)===null||t===void 0?void 0:t.current,info:(i=this.infoTextRef)===null||i===void 0?void 0:i.current,pages:(n=this.pagesRef)===null||n===void 0?void 0:n.current});if(this.actualInfoTextVisible!==this.state.infoTextVisible||this.actualIsLargeDisplayMode!==this.state.isLargeDisplayMode)return;const o=!m(this.elementsWidth);o&&(this.elementsWidth={}),(o||this.state.isLargeDisplayMode)&&(this.elementsWidth.allowedPageSizes=s.allowedPageSizes,this.elementsWidth.pages=s.pages),(o||this.state.infoTextVisible)&&(this.elementsWidth.info=s.info),this.actualIsLargeDisplayMode=Ub({parent:s.parent,allowedPageSizes:this.elementsWidth.allowedPageSizes,pages:this.elementsWidth.pages}),this.actualInfoTextVisible=qb(T({},s,{info:this.elementsWidth.info})),this.setState((()=>({infoTextVisible:this.actualInfoTextVisible}))),this.setState((()=>({isLargeDisplayMode:this.actualIsLargeDisplayMode})))}render(){const{infoTextVisible:e,isLargeDisplayMode:t}=this.state,{props:{contentTemplate:i}}=this;return Gd(xe(2,i,T({rootElementRef:this.parentRef,allowedPageSizesRef:this.allowedPageSizesRef,infoTextRef:this.infoTextRef,pagesRef:this.pagesRef,infoTextVisible:e,isLargeDisplayMode:t},this.getContentAttributes())))}}ah.defaultProps=jb;let lh=class extends Gp{constructor(e){super(e),this.__getterCache={},this.pageIndexChangedInternal=this.pageIndexChangedInternal.bind(this),this.pageSizeChangedInternal=this.pageSizeChangedInternal.bind(this)}createEffects(){return[Up()]}pageIndexChangedInternal(e){const t=e+1;this.setState((()=>({pageIndex:t}))),this.props.pageIndexChangedInternal(t)}getPageIndex(){return this.props.pageIndex-1}pageSizeChangedInternal(e){this.setState((()=>({pageSize:e}))),this.props.pageSizeChangedInternal(e)}getClassName(){return fs({"dx-datagrid-pager":Ku(this.context),[`${this.props.className}`]:!!this.props.className})}getPaginationProps(){return T({},this.props,{className:this.getClassName(),pageIndex:this.getPageIndex(),pageIndexChangedInternal:e=>this.pageIndexChangedInternal(e),pageSizeChangedInternal:e=>this.pageSizeChangedInternal(e)})}render(){return xe(2,ah,{contentTemplate:rh,paginationProps:this.getPaginationProps()})}};lh.defaultProps=de;function Xb(r){return r<0?1:r}function Zb(r){return r<0?0:r}function dh(r,e){return r>0&&e>0?Math.max(1,Math.ceil(e/r)):1}function Qb(r,e,t){if(r<1)return 1;const i=dh(e,t);return Math.min(r,i)}function Jb(r,e,t){const i=Xb(r),n=Zb(t),s=dh(i,t),o=Qb(e,i,n);return{pageSize:i,pageIndex:o,itemCount:n,pageCount:s}}const ey=["pageSize","pageIndex","itemCount"];class ty extends qp{_optionChanged(e){switch(e.name){case"pageIndex":{const t=this.option("pageIndexChanged");t&&t(e.value);break}case"pageSize":{const t=this.option("pageSizeChanged");t&&t(e.value);break}}super._optionChanged(e)}getPageCount(){return this.option("pageCount")}_validateOptions(e){if(e._skipValidation||this.option("_skipValidation"))return e;const t=super._validateOptions(e);let{pageSize:i,pageIndex:n,itemCount:s}=t,o=Jo(t,ey);i===void 0&&(i=this.option("pageSize")),n===void 0&&(n=this.option("pageIndex")),s===void 0&&(s=this.option("itemCount"));const a=Jb(i,n,s);return T({},o,a)}}class iy extends ty{getProps(){const e=super.getProps();return e.onKeyDown=this._wrapKeyDownHandler(e.onKeyDown),e}get _propsInfo(){return{twoWay:[["pageSize","defaultPageSize","pageSizeChangedInternal","pageSizeChanged"],["pageIndex","defaultPageIndex","pageIndexChangedInternal","pageIndexChanged"]],allowNull:[],elements:[],templates:[],props:["defaultPageSize","pageSizeChanged","pageSizeChangedInternal","defaultPageIndex","pageIndexChanged","pageIndexChangedInternal","isGridCompatibilityMode","className","showInfo","infoText","lightModeEnabled","displayMode","maxPagesCount","pageCount","pagesCountText","visible","hasKnownLastPage","pagesNavigatorVisible","showPageSizeSelector","allowedPageSizes","rtlEnabled","showNavigationButtons","itemCount","label","onKeyDown","pageSize","pageIndex","width","height","elementAttr","hint","disabled","tabIndex","accessKey","activeStateEnabled","focusStateEnabled","hoverStateEnabled","_skipValidation","_getParentComponentRootNode"]}}get _viewComponent(){return lh}}const hd=function(r){return 1+(parseInt(r.pageIndex())||0)};class ny extends j.View{init(){const e=this.getController("data");e.changed.add((t=>{if(t&&t.repaintChangesOnly){const i=this._pager;i?i.option({pageIndex:hd(e),pageSize:e.pageSize(),pageCount:e.pageCount(),itemCount:e.totalCount(),hasKnownLastPage:e.hasKnownLastPage()}):this.render()}else(!t||t.changeType!=="update"&&t.changeType!=="updateSelection"&&t.changeType!=="updateFocusedRow")&&(this._pager=null,this.render())}))}dispose(){this._pager=null}optionChanged(e){const{name:t}=e,i=t==="pager",n=t==="paging",s=t==="dataSource",o=t==="scrolling",a=this.getController("data");if(i||n||o||s){if(e.handled=!0,a.skipProcessingPagingChange(e.fullName))return;(i||n)&&(this._pageSizes=null),s||(this._pager=null,this._invalidate(),pe()&&i&&this.component&&this.component.resize())}}_renderCore(){const e=this,t=e.element().addClass(e.addWidgetPrefix("pager")),i=e.option("pager")??{},n=e.getController("data"),s=e.getController("keyboardNavigation"),o={maxPagesCount:10,pageIndex:hd(n),pageCount:n.pageCount(),pageSize:n.pageSize(),showPageSizeSelector:i.showPageSizeSelector,showInfo:i.showInfo,displayMode:i.displayMode,pagesNavigatorVisible:i.visible,showNavigationButtons:i.showNavigationButtons,label:i.label,allowedPageSizes:e.getPageSizes(),itemCount:n.totalCount(),hasKnownLastPage:n.hasKnownLastPage(),rtlEnabled:e.option("rtlEnabled"),isGridCompatibilityMode:!0,_getParentComponentRootNode:()=>this.component.element(),_skipValidation:!0,pageIndexChanged(a){n.pageIndex()!==a-1&&n.pageIndex(a-1)},pageSizeChanged(a){n.pageSize(a)},onKeyDown:a=>s&&s.executeAction("onKeyDown",a)};if(m(i.infoText)&&(o.infoText=i.infoText),this._pager){this._pager.repaint();return}pe()?this._pager=e._createComponent(t,iy,o):t.addClass("dx-pager").html('<div class="dx-pages"><div class="dx-page"></div></div>')}getPager(){return this._pager}getPageSizes(){const e=this,t=e.getController("data"),i=e.option("pager"),n=i&&i.allowedPageSizes,s=t.pageSize();return(!m(e._pageSizes)||!e._pageSizes.includes(s))&&(e._pageSizes=[],i&&(Array.isArray(n)?e._pageSizes=n:n&&s>1&&(e._pageSizes=[Math.floor(s/2),s,2*s]))),e._pageSizes}isVisible(){const e=this.getController("data"),t=this.option("pager");let i=t&&t.visible;const n=this.option("scrolling");return i==="auto"&&(n&&(n.mode==="virtual"||n.mode==="infinite")?i=!1:i=e.pageCount()>1||e.isLoaded()&&!e.hasKnownLastPage()),!!i}getHeight(){return this.getElementHeight()}}const tE={defaultOptions:()=>({pager:{visible:"auto",showPageSizeSelector:!1,allowedPageSizes:"auto",label:w.format("dxPager-ariaLabel")}}),views:{pagerView:ny}},pd="columns-separator-transparent",Be="dxDataGridResizingReordering",nn=function(r){return r.option("allowColumnResizing")||r.getController("columns").isColumnOptionUsed("allowResizing")},ch=function(r){return r.option("allowColumnReordering")||r.getController("columns").isColumnOptionUsed("allowReordering")};class sy extends j.View{init(){super.init(),this._tablePositionController=this.getController("tablePosition"),this._subscribeToCallback()}dispose(){this._unsubscribeFromCallback(),super.dispose()}optionChanged(e){e.name==="allowColumnResizing"&&(this._unsubscribeFromCallback(),e.value&&(this._subscribeToCallback(),this._invalidate())),super.optionChanged(e)}_renderCore(){const e=super._renderCore();return this.element().addClass(this.addWidgetPrefix("tracker")),this.hide(),e}_unsubscribeFromCallback(){this._positionChanged&&this._tablePositionController.positionChanged.remove(this._positionChanged)}_subscribeToCallback(){const e=this;e._positionChanged=function(t){const i=e.element();i!=null&&i.hasClass(e.addWidgetPrefix("tracker"))&&(i.css({top:t.top}),ti(i,t.height))},this._tablePositionController.positionChanged.add(e._positionChanged)}isVisible(){return nn(this)}show(){this.element().show()}hide(){var e;(e=this.element())===null||e===void 0||e.hide()}setHeight(e){ti(this.element(),e)}}class uh extends j.View{_renderSeparator(){}_renderCore(e){const t=super._renderCore(e);return this._isShown=!0,this._renderSeparator(),this.hide(),t}show(){this._isShown=!0}hide(){this._isShown=!1}height(e){const t=this.element();if(t)if(m(e))ti(t,e);else return X(t)}width(e){const t=this.element();if(t)if(m(e))on(t,e);else return H(t)}}class oy extends uh{init(){super.init(),this._tablePositionController=this.getController("tablePosition"),this._init()}dispose(){this._unsubscribeFromCallback(),super.dispose()}optionChanged(e){e.name==="allowColumnResizing"&&(e.value?(this._init(),this._invalidate(),this.hide(!0)):(this._unsubscribeFromCallback(),this._isTransparent=nn(this),this.hide(!0))),super.optionChanged(e)}_renderSeparator(){super._renderSeparator(),this.element().addClass(this.addWidgetPrefix("columns-separator"))}_subscribeToCallback(){const e=this;let t;e._positionChanged=function(i){t=e.element(),t&&(t.css({top:i.top}),ti(t,i.height))},e._tablePositionController.positionChanged.add(e._positionChanged)}_unsubscribeFromCallback(){this._positionChanged&&this._tablePositionController.positionChanged.remove(this._positionChanged)}_init(){this._isTransparent=nn(this),this.isVisible()&&this._subscribeToCallback()}isVisible(){return this.option("showColumnHeaders")&&(ch(this)||nn(this))}show(){const e=this,t=this.element();t&&!e._isShown&&(e._isTransparent?t.removeClass(e.addWidgetPrefix(pd)):t.show()),super.show()}hide(e){const t=this.element(),i=this.addWidgetPrefix(pd);t&&(this._isShown||e)&&(this._isTransparent?(t.addClass(i),t.css("left",""),t.show()):(t.hasClass(i)&&t.removeClass(i),t.hide())),super.hide()}moveByX(e){const t=this.element();t&&t.css("left",e===null?0:e-this._parentElement().offset().left)}changeCursor(e){e=m(e)?e:"";const t=this.element();t&&t.css("cursor",e)}}class ry extends uh{init(){super.init(),this.getController("data").loadingChanged.add((t=>{t||this.hide()}))}_renderSeparator(){super._renderSeparator(),this.element().addClass("dx-block-separator").html("&nbsp;")}hide(){const e=this,t=this._parentElement(),i=this.element();i&&this._isShown&&i.css("display","none"),t&&!t.children(".dx-block-separator").length&&t.prepend(e.element()),super.hide()}isVisible(){const e=this.option("groupPanel"),t=this.option("columnChooser");return(e==null?void 0:e.visible)||(t==null?void 0:t.enabled)}show(e){const t=this.element();if(t&&!this._isShown)switch(e){case"group":this.element().css("display","block");break;case"columnChooser":(function(i){ve.stop(t,!0),ve.animate(t,{type:"slide",from:{width:0,display:i.display},to:i,duration:300,easing:"swing"})})({width:"100%",display:"block"});break;default:t.css("display","")}super.show()}}class ay extends j.View{init(){super.init();const e=this.getController("data");this._controller=this.getController("draggingHeader"),this._columnsResizerViewController=this.getController("columnsResizer"),this._columnsController=this.getController("columns"),this._isDragging=!1,e.loadingChanged.add((t=>{const i=this.element();!t&&i&&i.hide()}))}isDragging(){return this._isDragging}_getDraggingPanelByPos(e){let t;return x(this._dragOptions.draggingPanels,((i,n)=>{if(n){const s=n.getBoundingRect();if(s&&(s.bottom===void 0||e.y<s.bottom)&&(s.top===void 0||e.y>s.top)&&(s.left===void 0||e.x>s.left)&&(s.right===void 0||e.x<s.right))return t=n,!1}})),t}_renderCore(){this.element().addClass(`${this.addWidgetPrefix("drag-header")} ${this.addWidgetPrefix("text-content")} dx-widget`).hide()}_resetTargetColumnOptions(){const e=this._dropOptions;e.targetColumnIndex=-1,delete e.targetColumnElement,delete e.isLast,delete e.posX,delete e.posY}_getVisibleIndexObject(e,t){return m(e)?{columnIndex:t,rowIndex:e}:t}dispose(){const e=this.element();this._dragOptions=null,e==null||e.parent().find(`.${this.addWidgetPrefix("drag-header")}`).remove()}isVisible(){const e=this._columnsController.getCommonSettings();return this.option("showColumnHeaders")&&(ch(this)||e.allowGrouping||e.allowHiding)}dragHeader(e){const{columnElement:t}=e,i=!!e.sourceColumn.type;this._isDragging=!0,this._dragOptions=e,this._dropOptions={sourceIndex:e.index,sourceColumnIndex:this._getVisibleIndexObject(e.rowIndex,e.columnIndex),sourceColumnElement:e.columnElement,sourceLocation:e.sourceLocation};const n=M.getDocument();this._onSelectStart=n.onselectstart,n.onselectstart=function(){return!1},this._controller.drag(this._dropOptions),this.element().css({textAlign:t==null?void 0:t.css("textAlign"),height:t&&(i&&t.get(0).clientHeight||X(t)),width:t&&(i&&t.get(0).clientWidth||H(t)),whiteSpace:t==null?void 0:t.css("whiteSpace")}).addClass(this.addWidgetPrefix("drag-action")).toggleClass("dx-drag-command-cell",i).text(i?"":e.sourceColumn.caption),this.element().appendTo(qh.getSwatchContainer(t))}moveHeader(e){const t=e.event,{that:i}=t.data,n=Zn(t),s=i._columnsResizerViewController?i._columnsResizerViewController.isResizing():!1,o=i._dragOptions;if(i._isDragging&&!s){const a=i.element(),l=Math.abs(n.x-o.columnElement.offset().left-o.deltaX),d=Math.abs(n.y-o.columnElement.offset().top-o.deltaY);if(a.is(":visible")||l>5||d>5){a.show();const c=n.x-o.deltaX,u=n.y-o.deltaY;a.css({left:c,top:u}),i.dockHeader(n)}t.preventDefault()}}dockHeader(e){const t=this,i=t._getDraggingPanelByPos(e),n=t._controller,s=t._dropOptions,o=t._dragOptions;if(i){const a=t.option("rtlEnabled"),l=i.getName()==="columnChooser",d=l?"y":"x",c=i.getName(),u=c==="headers"?o.rowIndex:void 0,{sourceColumn:p}=o,g=i.getColumnElements(u,p==null?void 0:p.ownerBand)||[],_=o.pointsByTarget=o.pointsByTarget||{},f=c==="columnChooser"?[]:_[c]||n._generatePointsByColumns(b({},o,{targetDraggingPanel:i,columns:i.getColumns(u),columnElements:g,isVerticalOrientation:l,startColumnIndex:c==="headers"?h(g[0]).index():0}));if(_[c]=f,s.targetLocation=c,f.length>0)for(let C=0;C<f.length;C++){const I=f[C+1]&&(f[C][d]+f[C+1][d])/2;if(I===void 0||(a&&d==="x"?e[d]>I:e[d]<I)){s.targetColumnIndex=t._getVisibleIndexObject(u,f[C].columnIndex),g[C]?(s.targetColumnElement=g.eq(C),s.isLast=!1):(s.targetColumnElement=g.last(),s.isLast=!0),s.posX=f[C].x,s.posY=f[C].y,n.dock(s);break}}else t._resetTargetColumnOptions(),n.dock(s)}}dropHeader(e){const t=e.event,{that:i}=t.data,n=i._controller;i.element().hide(),n&&i._isDragging&&n.drop(i._dropOptions),i.element().appendTo(i._parentElement()),i._dragOptions=null,i._dropOptions=null,i._isDragging=!1,M.getDocument().onselectstart=i._onSelectStart||null}}const Ki=function(r){return r.option("columnResizingMode")!=="widget"};class ly extends j.ViewController{init(){this._subscribesToCallbacks=[],nn(this)&&this._init()}dispose(){this._unsubscribes(),super.dispose()}optionChanged(e){super.optionChanged(e),e.name==="allowColumnResizing"&&(e.value?(this._init(),this._subscribeToEvents()):this._unsubscribes())}_isHeadersRowArea(e){if(this._columnHeadersView){const t=this._columnHeadersView.element();if(t){const i=t.offset().top,n=this._columnHeadersView.getHeadersRowHeight();return e>=i&&e<=i+n}}return!1}_isRtlParentStyle(){var e;return this.option("rtlEnabled")&&((e=this._$parentContainer)===null||e===void 0?void 0:e.parent().css("direction"))==="rtl"}_correctColumnIndexForPoint(e,t,i){e.columnIndex-=t}_pointCreated(e,t,i){const n=Ki(this),s=this.option("rtlEnabled"),o=this._isRtlParentStyle(),a=!n&&s&&!o?0:1;if(e.index>=a&&e.index<t+(!n&&(!s||o)?1:0)){this._correctColumnIndexForPoint(e,a,i);const l=i[e.columnIndex]||{},d=i[e.columnIndex+1]||{};return!(n?l.allowResizing&&d.allowResizing:l.allowResizing)}return!0}_getTargetPoint(e,t,i){if(e){for(let n=0;n<e.length;n++)if(!(e[n].x===e[0].x&&e[n+1]&&e[n].x===e[n+1].x)&&e[n].x-i<=t&&t<=e[n].x+i)return e[n]}return null}getSeparatorOffsetX(e){var t;const i=Ki(this),n=this.option("rtlEnabled"),s=this._isRtlParentStyle(),o=e[0].getBoundingClientRect().width;return(((t=e.offset())===null||t===void 0?void 0:t.left)??0)+((i||s)&&n?0:o)}_moveSeparator(e){var t;const i=e.event,n=i.data,s=n._columnsSeparatorView.width(),o=Ki(n),a=s/2,l=n._$parentContainer.offset(),d=l.left,c=Zn(i),u=this._isRtlParentStyle(),p=(t=n._draggingHeaderView)===null||t===void 0?void 0:t.isDragging();if(n._isResizing&&n._resizingInfo){if((d<=c.x||!o&&u)&&(!o||c.x<=d+H(n._$parentContainer))&&n._updateColumnsWidthIfNeeded(c.x)){const g=n._columnHeadersView.getColumnElements().eq(n._resizingInfo.currentColumnIndex);if(g.length){const _=this.getSeparatorOffsetX(g);n._columnsSeparatorView.moveByX(_),n._tablePositionController.update(n._targetPoint.y),i.preventDefault()}}}else p||(n._isHeadersRowArea(c.y)?(n._previousParentOffset&&(n._previousParentOffset.left!==l.left||n._previousParentOffset.top!==l.top)&&n.pointsByColumns(null),n._targetPoint=n._getTargetPoint(n.pointsByColumns(),c.x,s),n._previousParentOffset=l,n._isReadyResizing=!1,n._targetPoint?(n._columnsSeparatorView.changeCursor("col-resize"),n._columnsSeparatorView.moveByX(n._targetPoint.x-a),n._tablePositionController.update(n._targetPoint.y),n._isReadyResizing=!0,i.preventDefault()):(n._columnsSeparatorView.changeCursor(),n._columnsSeparatorView.moveByX(null))):(n.pointsByColumns(null),n._isReadyResizing=!1,n._columnsSeparatorView.changeCursor(),n._columnsSeparatorView.moveByX(null)))}_endResizing(e){const i=e.event.data;i._isResizing&&(i.pointsByColumns(null),i._resizingInfo=null,i._columnsSeparatorView.hide(),i._columnsSeparatorView.changeCursor(),i._trackerView.hide(),i._isReadyResizing=!1,i._isResizing=!1)}_getNextColumnIndex(e){return e+1}_setupResizingInfo(e){const t=this._targetPoint.columnIndex,i=this._getNextColumnIndex(t),n=this._columnHeadersView.getHeaderElement(t),s=this._columnHeadersView.getHeaderElement(i);this._resizingInfo={startPosX:e,currentColumnIndex:t,currentColumnWidth:n!=null&&n.length?re(n[0]).width:0,nextColumnIndex:i,nextColumnWidth:s!=null&&s.length?re(s[0]).width:0,needToInvertResizing:this._needToInvertResizing(n)}}_startResizing(e){const t=e.event,i=t.data,n=Zn(t);if(Yh(t)&&(i._isHeadersRowArea(n.y)?(i._targetPoint=i._getTargetPoint(i.pointsByColumns(),n.x,10),i._targetPoint&&(i._columnsSeparatorView.moveByX(i._targetPoint.x-i._columnsSeparatorView.width()/2),i._isReadyResizing=!0)):i._isReadyResizing=!1),i._isReadyResizing){i._setupResizingInfo(n.x),i._isResizing=!0,i._tablePositionController.update(i._targetPoint.y),i._columnsSeparatorView.show(),i._trackerView.show();const s=i.component.getScrollable();s&&i._isRtlParentStyle()&&(i._scrollRight=H(s.$content())-H(s.container())-s.scrollLeft()),t.preventDefault(),t.stopPropagation()}this.isResizing()&&this._editorFactoryController.loseFocus()}_generateColumnsTopYIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this,i=t._columnsController.getRowCount(),n={},s=o=>{const a=Math.ceil(o.x);return n[a]||(n[a]=o.y),!0};for(let o=0;o<i-1;o++){const a=t._columnHeadersView.getColumnElements(o);a&&a.length>0&&y.getPointsByColumns(a,s,!1,0,e)}return n}_generatePointsByColumns(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this,i=t._generateColumnsTopYIndex(e),n=t._columnsController?t._columnsController.getVisibleColumns():[],s=t._columnHeadersView.getColumnElements();t._pointsByColumns=[],s&&s.length>0&&(t._pointsByColumns=y.getPointsByColumns(s,(o=>t._pointCreated((a=>{const l=Math.ceil(a.x);return i[l]&&(a.y=i[l]),a})(o),s.length,n)),!1,0,e))}_needToInvertResizing(e){const t=this.option("rtlEnabled"),i=this._isRtlParentStyle();return(Ki(this)||i)&&t}_unsubscribeFromEvents(){this._moveSeparatorHandler&&v.off(M.getDocument(),V(Z.move,Be),this._moveSeparatorHandler),this._startResizingHandler&&v.off(this._$parentContainer,V(Z.down,Be),this._startResizingHandler),this._endResizingHandler&&(v.off(this._columnsSeparatorView.element(),V(Z.up,Be),this._endResizingHandler),v.off(M.getDocument(),V(Z.up,Be),this._endResizingHandler))}_subscribeToEvents(){this._moveSeparatorHandler=this.createAction(this._moveSeparator),this._startResizingHandler=this.createAction(this._startResizing),this._endResizingHandler=this.createAction(this._endResizing),v.on(M.getDocument(),V(Z.move,Be),this,this._moveSeparatorHandler),v.on(this._$parentContainer,V(Z.down,Be),this,this._startResizingHandler),v.on(this._columnsSeparatorView.element(),V(Z.up,Be),this,this._endResizingHandler),v.on(M.getDocument(),V(Z.up,Be),this,this._endResizingHandler)}_updateColumnsWidthIfNeeded(e){let t,i=!1,n=this._rowsView.contentWidth();const s=this._resizingInfo,o=this._columnsController,a=o.getVisibleColumns(),l=this._columnsSeparatorView.width(),d=Ki(this),c=d&&this.option("adaptColumnWidthByRatio")&&!this.option("columnAutoWidth"),u=this._isRtlParentStyle(),p=a[s.currentColumnIndex],g=a[s.nextColumnIndex],{needToInvertResizing:_}=s;function f(D){return W(D)&&D.endsWith("%")}function C(D,k,A,F){if(D){const z=D.width;z&&(F=f(z)),F?(o.columnOption(D.index,"visibleWidth",k),o.columnOption(D.index,"width",`${(k/A*100).toFixed(3)}%`)):(o.columnOption(D.index,"visibleWidth",null),o.columnOption(D.index,"width",k))}}t=e-s.startPosX,_&&(t=-t);let{cellWidth:I,nextCellWidth:E}=(function(D){let k,A,F;const z=s.currentColumnWidth+D,ee=(p==null?void 0:p.minWidth)||l,q={};return z>=ee?q.cellWidth=z:(q.cellWidth=ee,F=!0),d&&(A=s.nextColumnWidth-D,k=(g==null?void 0:g.minWidth)||l,A>=k?F?q.nextCellWidth=s.nextColumnWidth-(D+ee-z):q.nextCellWidth=A:(q.nextCellWidth=k,q.cellWidth=s.currentColumnWidth+(D-k+A))),q})(t);if(i=p.width!==I,i){if(o.beginUpdate(),I=Math.floor(I),n=(function(D,k){if(k.every((F=>F.width))){const F=k.reduce(((z,ee)=>(f(ee.width)&&(z+=parseFloat(ee.width)),z)),0);F>100&&(D=D/F*100)}return D})(n,a),C(p,I,n,c),d)E=Math.floor(E),C(g,E,n,c);else{const D=this._columnHeadersView.getColumnWidths();if(D[s.currentColumnIndex]=I,!(D.reduce(((A,F)=>A+F),0)>this._rowsView.contentWidth())){const A=y.getLastResizableColumnIndex(a);A>=0&&o.columnOption(a[A].index,"visibleWidth","auto")}for(let A=0;A<D.length;A++)a[A]&&a[A]!==p&&a[A].width===void 0&&o.columnOption(a[A].index,"width",D[A])}if(o.endUpdate(),!d){this.component.updateDimensions();const D=this.component.getScrollable();if(D&&u){const k=H(D.$content())-H(D.container())-this._scrollRight;D.scrollTo({left:k})}}}return i}_subscribeToCallback(e,t){e.add(t),this._subscribesToCallbacks.push({callback:e,handler:t})}_unsubscribeFromCallbacks(){for(let e=0;e<this._subscribesToCallbacks.length;e++){const t=this._subscribesToCallbacks[e];t.callback.remove(t.handler)}this._subscribesToCallbacks=[]}_unsubscribes(){this._unsubscribeFromEvents(),this._unsubscribeFromCallbacks()}_init(){const e=()=>{this._isResizing||this.pointsByColumns(null)},t=s=>{this._scrollLeft!==s.left&&(this._scrollLeft=s.left,this.pointsByColumns(null))};this._columnsSeparatorView=this.getView("columnsSeparatorView"),this._columnHeadersView=this.getView("columnHeadersView"),this._trackerView=this.getView("trackerView"),this._rowsView=this.getView("rowsView"),this._columnsController=this.getController("columns"),this._tablePositionController=this.getController("tablePosition"),this._editorFactoryController=this.getController("editorFactory"),this._draggingHeaderView=this.component.getView("draggingHeaderView"),this._$parentContainer=this.component.$element(),this._subscribeToCallback(this._columnHeadersView.renderCompleted,e),this._subscribeToCallback(this._columnHeadersView.resizeCompleted,e),this._subscribeToCallback(this._columnsSeparatorView.renderCompleted,(()=>{this._unsubscribeFromEvents(),this._subscribeToEvents()})),this._subscribeToCallback(this._rowsView.renderCompleted,(()=>{this._rowsView.scrollChanged.remove(t),this._rowsView.scrollChanged.add(t)}));let i=this._rowsView.getScrollbarWidth()!==0,n=0;this._subscribeToCallback(this._tablePositionController.positionChanged,(s=>{if(this._isResizing&&!this._rowsView.isResizing){const o=this._rowsView.getScrollbarWidth()!==0;i!==o||n&&n!==s.height?(i=o,n=s.height,this.component.updateDimensions()):this._rowsView.updateFreeSpaceRowHeight()}n=s.height}))}isResizing(){return this._isResizing}pointsByColumns(e){if(e!==void 0)this._pointsByColumns=e;else return this._pointsByColumns||this._generatePointsByColumns(),this._pointsByColumns}}class dy extends j.ViewController{constructor(e){super(e),this.positionChanged=$e()}init(){super.init(),this._columnsResizerController=this.getController("columnsResizer"),this._columnHeadersView=this.getView("columnHeadersView"),this._rowsView=this.getView("rowsView"),this._pagerView=this.getView("pagerView"),this._rowsView.resizeCompleted.add((()=>{if(this.option("allowColumnResizing")){const e=this._columnsResizerController._targetPoint;this.update(e?e.y:null)}}))}update(e){const t={},i=this._columnHeadersView.element(),n=i==null?void 0:i.offset(),s=(n==null?void 0:n.top)||0,o=m(e)?Math.abs(e-s):0,a=this._columnHeadersView?this._columnHeadersView.getHeight():0,l=this._rowsView.getScrollbarWidth(!0),d=this._rowsView?this._rowsView.height()-l:0,c=this.component.getView("draggingHeaderView");t.height=a,(this._columnsResizerController.isResizing()||c.isDragging())&&(t.height+=d-o),e!==null&&i!==null&&i!==void 0&&i.length&&(t.top=i[0].offsetTop+o),this.positionChanged.fire(t)}}class cy extends j.ViewController{init(){var e,t;super.init(),this._columnsController=this.getController("columns"),this._tablePositionController=this.getController("tablePosition"),this._columnHeadersView=this.getView("columnHeadersView"),this._columnsSeparatorView=this.getView("columnsSeparatorView"),this._draggingHeaderView=this.getView("draggingHeaderView"),this._rowsView=this.getView("rowsView"),this._blockSeparatorView=this.getView("blockSeparatorView"),this._headerPanelView=this.getView("headerPanel"),this._columnChooserView=this.getView("columnChooserView");const i=()=>{if(this._draggingHeaderView){const n=[this._columnChooserView,this._columnHeadersView,this._headerPanelView];this._unsubscribeFromEvents(this._draggingHeaderView,n),this._subscribeToEvents(this._draggingHeaderView,n)}};this._columnHeadersView.renderCompleted.add(i),(e=this._headerPanelView)===null||e===void 0||e.renderCompleted.add(i),(t=this._columnChooserView)===null||t===void 0||t.renderCompleted.add(i)}dispose(){this._draggingHeaderView&&this._unsubscribeFromEvents(this._draggingHeaderView,[this._columnChooserView,this._columnHeadersView,this._headerPanelView])}_generatePointsByColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.isCustomGroupColumnPosition=this.checkIsCustomGroupColumnPosition(e),y.getPointsByColumns(e.columnElements,(n=>this._pointCreated(n,e.columns,e.targetDraggingPanel.getName(),e.sourceColumn)),e.isVerticalOrientation,e.startColumnIndex,t)}checkIsCustomGroupColumnPosition(e){let t=!0;for(let i=0;i<e.columns.length;i+=1){const n=e.columns[i];if(n.command==="expand"&&!t)return!0;n.command||(t=!1)}return!1}_pointCreated(e,t,i,n){const s=t[e.columnIndex],o=t[e.columnIndex-1],a=(o==null?void 0:o.command)==="expand",l=(s==null?void 0:s.command)==="expand"&&(o==null?void 0:o.command)!=="expand",d=n&&!n.allowReordering,c=!(s!=null&&s.allowReordering)&&!(o!=null&&o.allowReordering);switch(i){case"columnChooser":return!0;case"headers":if(d)return!0;if(!l)return a||c;if(this.isCustomGroupColumnPosition)return!1;for(;((u=t[e.columnIndex])===null||u===void 0?void 0:u.command)==="expand";){var u;e.columnIndex+=1}return!1;default:return t.length===0}}_subscribeToEvents(e,t){const i=this;x(t,((n,s)=>{if(s){let o;const a=s.getRowCount?s.getRowCount():1,l=s.getName(),d=function(c,u){if(!u)return;const p=h(u),g=o[c];g&&s.allowDragging(g)&&(p.addClass(i.addWidgetPrefix("drag-action")),v.on(p,V(xo,Be),i.createAction((_=>{const f=_.event,C=Zn(f);e.dragHeader({deltaX:C.x-h(f.currentTarget).offset().left,deltaY:C.y-h(f.currentTarget).offset().top,sourceColumn:g,index:g.index,columnIndex:c,columnElement:p,sourceLocation:l,draggingPanels:t,rowIndex:i._columnsController.getRowIndex(g.index,!0)})}))),v.on(p,V(wo,Be),{that:e},i.createAction(e.moveHeader)),v.on(p,V(bo,Be),{that:e},i.createAction(e.dropHeader)))};for(let c=0;c<a;c++){const u=s.getColumnElements(c)||[];u.length&&(o=s.getColumns(c)||[],x(u,d))}}}))}_unsubscribeFromEvents(e,t){const i=this;x(t,((n,s)=>{if(s){const o=s.getColumnElements()||[];x(o,((a,l)=>{const d=h(l);v.off(d,V(xo,Be)),v.off(d,V(wo,Be)),v.off(d,V(bo,Be)),d.removeClass(i.addWidgetPrefix("drag-action"))}))}}))}_getSeparator(e){return e==="headers"?this._columnsSeparatorView:this._blockSeparatorView}hideSeparators(e){const t=this._blockSeparatorView,i=this._columnsSeparatorView;this._animationColumnIndex=void 0,t&&t.hide(),e!=="block"&&i&&i.hide()}allowDrop(e){return this._columnsController.allowMoveColumn(e.sourceColumnIndex,e.targetColumnIndex,e.sourceLocation,e.targetLocation)}drag(e){const{sourceIndex:t}=e,{sourceLocation:i}=e,{sourceColumnElement:n}=e,s=this._columnHeadersView,o=this._rowsView;n&&(n.addClass(this.addWidgetPrefix(Jn.draggableColumn)),i==="headers"&&(s&&s.toggleDraggableColumnClass(t,!0),o&&o.toggleDraggableColumnClass(t,!0)))}dock(e){const t=this,i=L(e.targetColumnIndex)?e.targetColumnIndex.columnIndex:e.targetColumnIndex,{sourceLocation:n}=e,{targetLocation:s}=e,o=t._getSeparator(s),a=i>=0;t._columnHeadersView.element().find(".dx-header-row").toggleClass(t.addWidgetPrefix("drop-highlight"),n!=="headers"&&s==="headers"&&!a),o&&(t.allowDrop(e)&&a?s==="group"||s==="columnChooser"?(function(){t._animationColumnIndex!==i&&(t.hideSeparators(),o.element()[e.isLast?"insertAfter":"insertBefore"](e.targetColumnElement),t._animationColumnIndex=i,o.show(s))})():(t.hideSeparators("block"),t._tablePositionController.update(e.posY),o.moveByX(e.posX-o.width()),o.show()):t.hideSeparators())}drop(e){const{sourceColumnElement:t}=e;if(t&&(t.removeClass(this.addWidgetPrefix(Jn.draggableColumn)),this._columnHeadersView.toggleDraggableColumnClass(e.sourceIndex,!1),this._rowsView.toggleDraggableColumnClass(e.sourceIndex,!1),this._columnHeadersView.element().find(".dx-header-row").removeClass(this.addWidgetPrefix("drop-highlight"))),this.allowDrop(e)){const i=this._getSeparator(e.targetLocation);i&&i.hide(),this._columnsController.moveColumn(e.sourceColumnIndex,e.targetColumnIndex,e.sourceLocation,e.targetLocation)}}}const uy=r=>class extends r{_needUpdateRowHeight(e){const t=this.option("wordWrapEnabled"),i=this._columnsResizerController.isResizing();return super._needUpdateRowHeight.apply(this,arguments)||e>0&&!!t&&!!i}},hy=r=>class extends r{renderFocusOverlay(){if(!this._columnsResizerController.isResizing())return super.renderFocusOverlay.apply(this,arguments)}},iE={views:{columnsSeparatorView:oy,blockSeparatorView:ry,draggingHeaderView:ay,trackerView:sy},controllers:{draggingHeader:cy,tablePosition:dy,columnsResizer:ly},extenders:{views:{rowsView:uy},controllers:{editorFactory:hy}}},py=(r,e)=>r.length===e.length&&!Object.keys(r).some((t=>r[t]!==e[t])),gy=(r,e)=>ae(r,e,{maxDepth:4}),my=(r,e,t,i)=>{let n=r,s=e;return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return i(a,n)||(n=a,s=t(...n)),s}},_y={compareType:"reference"},gd=function(r){let{compareType:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_y,t=null;return function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];if(!t){const o=r(...n);return t=my(n,o,r,e==="reference"?py:gy),o}return t(...n)}},fy=r=>r.attr(To.dragCell)!==void 0,Cy=r=>[`[${To.ariaColIndex}="${r+1}"]`,`:not([${To.dragCell}])`,":not([aria-hidden=true])"].join(""),vy=(r,e)=>r.filter(Cy(e)).first(),hh={isDragCell:fy,getCellToFocus:vy};function xi(r){return r&&r.hasClass(Jp)}function ph(r){return r&&r.hasClass("dx-datagrid-group-footer")}function xy(r){return r&&r.hasClass(qd)}function wy(r){return r&&r.hasClass(og)}function by(r){return r&&r.hasClass(qd)&&r.hasClass(Qp)}function mi(r){return r&&r.hasClass(Ud)}function yy(r){return!r||r.hasClass(Yd)||r.hasClass(ig)}function md(r,e){return!r._isRowEditMode()&&e&&!e.hasClass(jd)&&e.hasClass(Ss)}function Ye(r){return m(r)&&r.length>0}function Xo(){return G.current().deviceType!=="desktop"}function _d(r){return!!r.parent(`.${eg}`).length}function Iy(r,e){return r.option("rtlEnabled")?!(e.fixedPosition==="right"||m(e.command)&&!m(e.fixedPosition)):!(!m(e.fixedPosition)||e.fixedPosition==="left")}function gh(r){const e=r.getController("keyboardNavigation");return e._isVirtualScrolling()?r.option("focusedRowIndex")===e.getRowIndex():!1}let mh=class extends j.ViewController{constructor(){super(...arguments),this.needToRestoreFocus=!1}_applyColumnIndexBoundaries(e){const t=this._columnsController.getVisibleColumns(null,!0).length;return e<0?e=0:e>=t&&(e=t-1),e}unsubscribeFromKeyDownEvent(){this.keyDownListener&&Os.off(this.keyDownListener)}subscribeToKeyDownEvent(){const e=this.getFocusedViewElement();e&&(this.keyDownListener=Os.on(e,null,(t=>this.keyDownHandler(t))))}resizeCompleted(){}getColumnIndexOffset(e){let t=0;const i=this._columnsController.getVisibleColumns()[e];return i!=null&&i.fixed?t=this._getFixedColumnIndexOffset(i):e>=0&&(t=this._columnsController.getColumnIndexOffset()),t}getFocusedViewElement(){var e;return(e=this.getFocusedView())===null||e===void 0?void 0:e.element()}keyDownHandler(e){}initKeyDownHandler(){this.unsubscribeFromKeyDownEvent(),this.subscribeToKeyDownEvent()}unsubscribeFromFocusinEvent(){const e=this.getFocusedViewElement();e&&v.off(e,"focusin",this.focusinHandlerContext)}subscribeToFocusinEvent(){const e=this.getFocusedViewElement(),t=this.getFocusinSelector();e&&v.on(e,"focusin",t,this.focusinHandlerContext)}getFocusinSelector(){return""}focusinHandler(e){}initHandlers(){var e,t;const i=this.getFocusedView();if(this.unsubscribeFromKeyDownEvent(),i==null||(e=i.renderCompleted)===null||e===void 0||e.remove(this.renderCompletedWithContext),(t=this._resizeController)===null||t===void 0||(t=t.resizeCompleted)===null||t===void 0||t.remove(this.resizeCompletedWithContext),this.isKeyboardEnabled()){var n,s;i==null||(n=i.renderCompleted)===null||n===void 0||n.add(this.renderCompletedWithContext),(s=this._resizeController)===null||s===void 0||(s=s.resizeCompleted)===null||s===void 0||s.add(this.resizeCompletedWithContext)}}getFocusedView(){}_getCell(e){}_getRowIndex(e){return e==null?void 0:e.index()}getCellIndex(e,t){return e==null?void 0:e.index()}_getFixedColumnIndexOffset(e){const t=this._columnsController.getVisibleColumns(null,!0).length;return Iy(this,e)?t-this._columnsController.getVisibleColumns().length:0}getNewVisibleIndex(e,t,i){return i==="previous"?e-1:e+1}_getCellPosition(e,t){const i=Ye(e)&&e.closest("tr");if(Ye(i)){const n=this._getRowIndex(i);let s=this.getCellIndex(e,n);return s+=this.getColumnIndexOffset(s),t&&(s=this.getNewVisibleIndex(s,n,t),s=this._applyColumnIndexBoundaries(s)),{rowIndex:n,columnIndex:s}}}_getColumnByCellElement(e,t){const n=this.getCellIndex(e)+this._columnsController.getColumnIndexOffset();return this._columnsController.getVisibleColumns(t,!0)[n]}processOnKeyDown(e){const{originalEvent:t}=e,i={handled:!1,event:t};return this.executeAction("onKeyDown",i),e.ctrl=t.ctrlKey,e.alt=t.altKey,e.shift=t.shiftKey,!!i.handled}setFocusedColumnIndex(e){this._focusedCellPosition||(this._focusedCellPosition={}),this._focusedCellPosition.columnIndex=e}_updateFocusedCellPosition(e,t){const i=this._getCellPosition(e,t);return i&&(!e.length||i.rowIndex>=0&&i.columnIndex>=0)&&this.setFocusedCellPosition(i.rowIndex,i.columnIndex),i}renderCompleted(e){this.initKeyDownHandler(),this.unsubscribeFromFocusinEvent(),this.subscribeToFocusinEvent()}init(){this._columnsController=this.getController("columns"),this._resizeController=this.getController("resizing"),this._focusedCellPosition={},this.isKeyboardEnabled()&&this.createAction("onKeyDown"),this.renderCompletedWithContext=this.renderCompletedWithContext??this.renderCompleted.bind(this),this.resizeCompletedWithContext=this.resizeCompletedWithContext??this.resizeCompleted.bind(this),this.focusinHandlerContext=this.focusinHandlerContext??this.focusinHandler.bind(this),this.initHandlers()}dispose(){Os.off(this.keyDownListener)}setFocusedRowIndex(e){this._focusedCellPosition||(this._focusedCellPosition={}),this._focusedCellPosition.rowIndex=e}setFocusedCellPosition(e,t){this.setFocusedRowIndex(e),this.setFocusedColumnIndex(t)}optionChanged(e){switch(e.name){case"keyboardNavigation":e.fullName==="keyboardNavigation.enabled"&&this.init(),e.handled=!0;break;case"useLegacyKeyboardNavigation":this.init(),e.handled=!0;break;default:super.optionChanged(e)}}isKeyboardEnabled(){return this.option("keyboardNavigation.enabled")}_getFocusedCell(){return h(this._getCell(this._focusedCellPosition))}getDirectionByKeyName(e){const t=this.option("rtlEnabled");switch(e){case"leftArrow":return t?Ne.Next:Ne.Previous;case"rightArrow":return t?Ne.Previous:Ne.Next;default:return Ne.Next}}};const Sy=r=>class extends r{focusinHandler(e){const t=h(e.target);this.translateFocusIfNeed(e,t),super.focusinHandler(e)}focusOutHandler(e){super.focusOutHandler(e),this.makeScrollableFocusableIfNeed()}translateFocusIfNeed(e,t){const i=this.isScrollableNeedFocusable(),n=this._isFixedColumn(0);if(!i||!n)return;const s=this._rowsView.getCell({rowIndex:0,columnIndex:0}),o=!!s.attr("tabindex"),a=t.is(this._$firstNotFixedCell);o&&a&&(e.preventDefault(),this._focus(s))}renderCompleted(e){this._$firstNotFixedCell=this.getFirstNotFixedCell(),this.makeScrollableFocusableIfNeed(),super.renderCompleted(e)}_focus(e,t,i){super._focus(e,t,i),this.makeScrollableFocusableIfNeed()}_tabKeyHandler(e,t){const n=!(m(this._focusedCellPosition)&&!nt(this._focusedCellPosition))||!e.shift&&this._isLastValidCell(this._focusedCellPosition)||e.shift&&this._isFirstValidCell(this._focusedCellPosition),s=this.isScrollableNeedFocusable();if(n&&s){var o;(o=this._$firstNotFixedCell)===null||o===void 0||o.removeAttr("tabIndex")}super._tabKeyHandler(e,t)}getFirstNotFixedCell(){var e;const i=this._columnsController.getVisibleColumns().findIndex((s=>{let{fixed:o}=s;return!o})),n=(e=this._editingController)===null||e===void 0?void 0:e.isEditing();return i===-1||n?void 0:this._rowsView._getCellElement(0,i)}isScrollableNeedFocusable(){var e,t;const i=!!this._rowsView.getScrollable(),n=!!((e=this._rowsView._fixedTableElement)!==null&&e!==void 0&&e.length),s=!!((t=this._rowsView.getCellElements(0))!==null&&t!==void 0&&t.length);return i&&n&&s}makeScrollableFocusableIfNeed(){!this.isScrollableNeedFocusable()||!this._$firstNotFixedCell||this._applyTabIndexToElement(this._$firstNotFixedCell)}};class Ey extends mh{constructor(){super(...arguments),this._needNavigationToCell=!1}init(){if(this._dataController=this.getController("data"),this._selectionController=this.getController("selection"),this._editingController=this.getController("editing"),this._headerPanel=this.getView("headerPanel"),this._editorFactory=this.getController("editorFactory"),this._focusController=this.getController("focus"),this._adaptiveColumnsController=this.getController("adaptiveColumns"),this._columnResizerController=this.getController("columnsResizer"),this._rowsView=this.getView("rowsView"),super.init(),this._memoFireFocusedCellChanged=gd(this._memoFireFocusedCellChanged.bind(this),{compareType:"value"}),this._memoFireFocusedRowChanged=gd(this._memoFireFocusedRowChanged.bind(this),{compareType:"value"}),this.focusedHandlerWithContext=this.focusedHandlerWithContext||this.focusedHandler.bind(this),this.focusOutHandlerContext=this.focusOutHandlerContext??this.focusOutHandler.bind(this),this._updateFocusTimeout=null,this._fastEditingStarted=!1,this._canceledCellPosition=null,this.isKeyboardEnabled()){var e;fg(),(e=this._editorFactory)===null||e===void 0||e.focused.add(this.focusedHandlerWithContext)}else{var t;Jr(),(t=this._editorFactory)===null||t===void 0||t.focused.remove(this.focusedHandlerWithContext)}this.initDocumentHandlers()}dispose(){super.dispose(),this._resetFocusedView(),v.off(M.getDocument(),V(Z.down,"dxDataGridKeyboardNavigation"),this._documentClickHandler),clearTimeout(this._updateFocusTimeout),Jr()}focusedHandler(e){this.setupFocusedView(),this._isNeedScroll&&e.is(":visible")&&this._focusedView&&this._focusedView.getScrollable()&&(this._focusedView._scrollToElement(e),this._isNeedScroll=!1)}focusinHandler(e){const t=h(e.target),i=h(e.relatedTarget).closest(this._rowsView.element()).length,n=t.is("a");if(e.relatedTarget&&n&&!i&&this._isEventInCurrentGrid(e)){let a=this._getFocusedCell();a=Ye(a)?a:this._rowsView.getCellElements(0).filter("[tabindex]").eq(0),t.closest(a).length||(e.preventDefault(),v.trigger(a,"focus"))}const s=t.is("td"),o=(this.option("focusedRowIndex")??-1)<0;s&&o&&this._updateFocusedCellPosition(t)}focusOutHandler(e){const{relatedTarget:t}=e;this._toggleInertAttr(!1),t&&!this.isInsideFocusedView(h(t))&&(this._isNeedFocus=!1,this._isHiddenFocus=!1,this._isNeedScroll=!1)}subscribeToRowsViewFocusEvent(){var e;const t=(e=this._rowsView)===null||e===void 0?void 0:e.element();v.on(t,"focusin",this.focusinHandlerContext),v.on(t,"focusout",this.focusOutHandlerContext)}unsubscribeFromRowsViewFocusEvent(){var e;const t=(e=this._rowsView)===null||e===void 0?void 0:e.element();v.off(t,"focusin",this.focusinHandlerContext),v.off(t,"focusout",this.focusOutHandlerContext)}resizeCompleted(){var e;if(this.navigationToCellInProgress()&&this._resizeController.resetLastResizeTime(),!this.needToRestoreFocus)return;const t=((e=this._rowsView)===null||e===void 0||(e=e.getScrollable())===null||e===void 0?void 0:e.scrollLeft())??0;this._columnsController.isNeedToRenderVirtualColumns(t)||(this.needToRestoreFocus=!1,this.focusFirstOrLastCell())}renderCompleted(e){const t=this._rowsView.element(),i=!e||e.changeType==="refresh",n=this._focusedView&&this._focusedView.name===this._rowsView.name;let s=!1;const o=e&&(e.changeType==="append"||e.changeType==="prepend"),l=h(M.getRootNode(t.get&&t.get(0))).find(":focus"),d=this._isFocusedElementCorrect(l,t,e);if(this.unsubscribeFromRowsViewFocusEvent(),this.subscribeToRowsViewFocusEvent(),this.initPointerEventHandler(),this.initKeyDownHandler(),this._setRowsViewAttributes(),n&&d&&(s=this._isNeedFocus?!o:this._isHiddenFocus&&i&&!(e!=null&&e.virtualColumnsScrolling),s)){var c;const u=!!(e!=null&&(c=e.event)!==null&&c!==void 0&&c.type),p=(e==null?void 0:e.virtualColumnsScrolling)&&u;this._updateFocus(!0,p)}}_isFocusedElementCorrect(e,t,i){if(e.length&&!e.closest(t).length)return!1;if(!e.length&&i!==null&&i!==void 0&&i.virtualColumnsScrolling){var n;const s=((n=this._focusedCellPosition)===null||n===void 0?void 0:n.columnIndex)??-1;return this._isColumnRendered(s)}return!0}initHandlers(){this.unsubscribeFromRowsViewFocusEvent(),this.unsubscribeFromPointerEvent(),super.initHandlers()}initDocumentHandlers(){const e=M.getDocument();this._documentClickHandler=this._documentClickHandler||this.createAction((t=>{var i;const n=h(t.event.target),s=`.${this.addWidgetPrefix(Zp)}`,o=`.${this.addWidgetPrefix(As)}`,a=`.${ng}`;if(!!n.closest(s).length&&!un(n)){t.event.preventDefault();return}const d=this._isEventInCurrentGrid(t.event)&&!!n.closest(o).length,c=!!n.closest(a).length,u=!!((i=this._columnResizerController)!==null&&i!==void 0&&i.isResizing());!d&&!c&&!u&&((!this._focusedView||n.closest(this._focusedView.element()).length===0)&&this._resetFocusedCell(!0),this._resetFocusedView())})),v.off(e,V(Z.down,"dxDataGridKeyboardNavigation"),this._documentClickHandler),this.isKeyboardEnabled()&&v.on(e,V(Z.down,"dxDataGridKeyboardNavigation"),this._documentClickHandler)}_setRowsViewAttributes(){const e=this._getRowsViewElement();!this._dataController.getVisibleRows().length&&this._applyTabIndexToElement(e)}unsubscribeFromPointerEvent(){const e=Xo()?Q:Z.down,t=this._getRowsViewElement();this._pointerEventAction&&v.off(t,V(e,"dxDataGridKeyboardNavigation"),this._pointerEventAction)}subscribeToPointerEvent(){const e=Xo()?Q:Z.down,t=this._getRowsViewElement(),i=`.${Tt} > td, .${Tt}`;v.on(t,V(e,"dxDataGridKeyboardNavigation"),i,this._pointerEventAction)}initPointerEventHandler(){this._pointerEventAction=this._pointerEventAction||this.createAction(this._pointerEventHandler),this.unsubscribeFromPointerEvent(),this.subscribeToPointerEvent()}isRowFocusType(){return this.focusType===Kr}isCellFocusType(){return this.focusType===Gr}setRowFocusType(){this.option("focusedRowEnabled")&&(this.focusType=Kr)}setCellFocusType(){this.focusType=Gr}keyDownHandler(e){var t;let i=!0;this._isNeedFocus=!0,this._isNeedScroll=!0;let n=this.processOnKeyDown(e);const s=(t=this._editingController)===null||t===void 0?void 0:t.isEditing(),{originalEvent:o}=e;if(o.isDefaultPrevented()){this._isNeedFocus=!1,this._isNeedScroll=!1;return}if(!cg.includes(e.keyName)&&this._updateFocusedCellPositionByTarget(o.target),!n){switch(e.keyName){case"leftArrow":case"rightArrow":this._leftRightKeysHandler(e,s),n=!0;break;case"upArrow":case"downArrow":e.ctrl?or("rowsView",this,o):this._upDownKeysHandler(e,s),n=!0;break;case"pageUp":case"pageDown":this._pageUpDownKeyHandler(e),n=!0;break;case"space":n=this._spaceKeyHandler(e,s);break;case"A":Ae(e.originalEvent)?(this._ctrlAKeyHandler(e,s),n=!0):n=this._beginFastEditing(e.originalEvent);break;case"tab":this._tabKeyHandler(e,s),n=!0;break;case"enter":this._enterKeyHandler(e,s),n=!0;break;case"escape":n=this._escapeKeyHandler(e,s);break;case"F":Ae(e.originalEvent)?(this._ctrlFKeyHandler(e),n=!0):n=this._beginFastEditing(e.originalEvent);break;case"F2":this._f2KeyHandler(),n=!0;break;case"del":case"backspace":this._isFastEditingAllowed()&&!this._isFastEditingStarted()&&(n=this._beginFastEditing(o,!0));break;case"home":case"end":this.homeOrEndKeyHandler(e)}!n&&!this._beginFastEditing(o)&&(this._isNeedFocus=!1,this._isNeedScroll=!1,i=!1),i&&o.stopPropagation()}}_closeEditCell(){const e=S();return setTimeout((()=>{this._editingController.closeEditCell().always(e.resolve)})),e}_leftRightKeysHandler(e,t){const i=this.getVisibleRowIndex(),n=e.originalEvent,s=this._focusedView&&this._focusedView.getRow(i),o=this._getDirectionCodeByKey(e.keyName),a=this._isFastEditingStarted();if((!t||a)&&mi(s)){this.setCellFocusType(),a&&this._closeEditCell(),this._isVirtualColumnRender()&&this._processVirtualHorizontalPosition(o);const d=this._getNextCell(o);Ye(d)&&this._arrowKeysHandlerFocusCell(n,d,o),n&&n.preventDefault()}}isInsideMasterDetail(e){const t=e.closest(`.${Ps}`);return!!t.get(0)&&this.elementIsInsideGrid(t)&&!e.is(t)}_upDownKeysHandler(e,t){var i,n;const s=this.getVisibleRowIndex(),o=this._focusedView&&this._focusedView.getRow(s),a=e.originalEvent,l=e.keyName==="upArrow",d=this._dataController.dataSource(),c=(i=this._editingController)===null||i===void 0||(n=i.isEditRowByIndex)===null||n===void 0?void 0:n.call(i,s),u=this._isFastEditingStarted(),p=this.isInsideMasterDetail(h(a==null?void 0:a.target));if((!c||!t||u)&&o&&!by(o)&&!p){if(u&&this._closeEditCell(),!this._navigateNextCell(a,e.keyName)&&this._isVirtualRowRender()&&l&&d&&!d.isLoading()){const _=Y(o),f=this._focusedCellPosition.rowIndex-1;this._scrollBy(0,-_,f,a)}a&&a.preventDefault()}}_pageUpDownKeyHandler(e){const t=this._dataController.pageIndex(),i=this._dataController.pageCount(),n=this.option("paging.enabled"),s=e.keyName==="pageUp",o=s?-1:1,a=this._rowsView.getScrollable();n&&!this._isVirtualScrolling()?(s?t>0:t<i-1)&&!this._isVirtualScrolling()&&(this._dataController.pageIndex(t+o),e.originalEvent.preventDefault()):a&&X(a.container())<X(a.$content())&&(this._scrollBy(0,X(a.container())*o),e.originalEvent.preventDefault())}_spaceKeyHandler(e,t){const i=this.getVisibleRowIndex(),n=h(e.originalEvent&&e.originalEvent.target);if(this.option("selection")&&this.option("selection").mode!=="none"&&!t){const s=this._getElementType(n)==="row"&&this.isRowFocusType()&&mi(n);return n.hasClass(jd)&&this.option("selection.showCheckBoxesMode")==="onClick"&&this._selectionController.startSelectionWithCheckboxes(),s||n.parent().hasClass(Ud)||n.hasClass(this.addWidgetPrefix(As))?(this._selectionController.changeItemSelection(i,{shift:e.shift,control:e.ctrl}),e.originalEvent.preventDefault(),!0):!1}return this._beginFastEditing(e.originalEvent)}_ctrlAKeyHandler(e,t){!t&&!e.alt&&this.option("selection.mode")==="multiple"&&this.option("selection.allowSelectAll")&&(this._selectionController.selectAll(),e.originalEvent.preventDefault())}_toggleInertAttr(e){}_tabKeyHandler(e,t){const i=this.option("editing"),n=e.shift?"previous":"next",s=m(this._focusedCellPosition)&&!nt(this._focusedCellPosition),o=e.shift&&this._isFirstValidCell(this._focusedCellPosition),a=!e.shift&&this._isLastValidCell(this._focusedCellPosition);let l=!s||o||a;const d=e.originalEvent.target,c=this._focusedView&&this._focusedView.element();if(!this._handleTabKeyOnMasterDetailCell(d,n)){if(h(c).addClass(Hr),i&&d&&!l)if(h(d).hasClass(this.addWidgetPrefix(As))&&this._resetFocusedCell(),this._isVirtualColumnRender()&&this._processVirtualHorizontalPosition(n),t){if(!this._editingCellTabHandler(e,n))return}else this._targetCellTabHandler(e,n)&&(l=!0);if(l){const p=this._getFocusedCell().is(ks);a&&!p&&this._toggleInertAttr(!0),this._editorFactory.loseFocus(),this._editingController.isEditing()&&!this._isRowEditMode()&&(this._resetFocusedCell(!0),this._resetFocusedView(),this._closeEditCell())}else e.originalEvent.preventDefault()}}_getMaxVerticalOffset(){const e=this.component.getScrollable();return e?e.scrollHeight()-X(this._rowsView.element()):0}_getMaxHorizontalOffset(){const e=this.component.getScrollable();return e?e.scrollWidth()-H(this._rowsView.element()):0}_isColumnRendered(e){const t=this._columnsController.getVisibleColumns(null,!0),i=this._columnsController.getVisibleColumns(),n=t[e];let s=!1;return n&&(s=i.indexOf(n)>=0),s}_isFixedColumn(e){const i=this._columnsController.getVisibleColumns(null,!0)[e];return!!i&&!!i.fixed}_isColumnVirtual(e){const t=e-this._columnsController.getColumnIndexOffset(),n=this._columnsController.getVisibleColumns()[t];return!!n&&n.command==="virtual"}_processVirtualHorizontalPosition(e){const t=this.component.getScrollable(),i=this.getColumnIndex();let n,s=0,o=!1;switch(e){case"next":case"nextInRow":{const a=this._getVisibleColumnCount();n=i+1,s=this.option("rtlEnabled")?this._getMaxHorizontalOffset():0,e==="next"?o=a===n||this._isFixedColumn(i)&&!this._isColumnRendered(n):o=a>n&&this._isFixedColumn(i)&&!this._isColumnRendered(n);break}case"previous":case"previousInRow":if(n=i-1,s=this.option("rtlEnabled")?0:this._getMaxHorizontalOffset(),e==="previous"){const a=this._columnsController.getColumnIndexOffset();o=n<0&&a===0||this._isFixedColumn(i)&&!this._isColumnRendered(n)}else o=n>=0&&this._isFixedColumn(i)&&!this._isColumnRendered(n)}o?t.scrollTo({left:s}):m(n)&&m(e)&&this._isColumnVirtual(n)&&(s=this._getHorizontalScrollPositionOffset(e),s!==0&&t.scrollBy({left:s,top:0}))}_getHorizontalScrollPositionOffset(e){let t=0;const i=this._getCell(this._focusedCellPosition),n=i&&ge(i);if(n>0){const s=this.option("rtlEnabled")?-1:1;t=e==="nextInRow"||e==="next"?n*s:n*s*-1}return t}_editingCellTabHandler(e,t){const i=e.originalEvent.target,n=this._getCellElementFromTarget(i);if(n.is(ks))return!this._targetCellTabHandler(e,t);this._updateFocusedCellPosition(n);const o=this._getElementType(i),a=this._getNextCellByTabKey(e.originalEvent,t,o),l=a.$cell;if(!l||this._handleTabKeyOnMasterDetailCell(l,t))return!1;let d=!1;const c=this._getColumnByCellElement(l);if(c!=null&&c.allowEditing){const p=l.parent(),g=this._getLocalRowIndex(p),_=this._dataController.items()[g],f=!_||_.rowType==="data";d=this._editingController.allowUpdating({row:_})?f:_==null?void 0:_.isNewRow}return d||this._closeEditCell(),this._focusCell(l,!a.isHighlighted)&&(!this._isRowEditMode()&&d?this._editFocusedCell():this._focusInteractiveElement(l,e.shift)),!0}_targetCellTabHandler(e,t){const i=e.originalEvent;let n=i.target,s=this._getElementType(n),o=this._getCellElementFromTarget(n);const a=s==="cell"&&this._getInteractiveElement(o,!e.shift);let l=!1;if(!md(this,o)&&a!==null&&a!==void 0&&a.length&&n!==a.get(0))l=!0;else{this._focusedCellPosition.rowIndex===void 0&&h(n).hasClass(Tt)&&this._updateFocusedCellPosition(o),s=this._getElementType(n),this.isRowFocusType()&&(this.setCellFocusType(),s==="row"&&mi(h(n))&&(n=this.getFirstValidCellInRow(h(n)),s=this._getElementType(n)));const d=this._getNextCellByTabKey(i,t,s);if(o=d.$cell,!o||(o=this._checkNewLineTransition(i,o),!o))return!1;this._focusCell(o,!d.isHighlighted),md(this,o)||this._focusInteractiveElement(o,e.shift)}return l}_getNextCellByTabKey(e,t,i){let n=this._getNextCell(t,i);const s=n&&this._fireFocusedCellChanging(e,n,!0);return!s||s.cancel?{}:(s.$newCellElement&&(n=s.$newCellElement),{$cell:n,isHighlighted:s.isHighlighted})}_checkNewLineTransition(e,t){const i=this.getVisibleRowIndex(),n=t.parent();if(i!==this._getRowIndex(n)){const s=this._getCellPosition(t),o=this._fireFocusedRowChanging(e,n);if(o.cancel)return;o.rowIndexChanged&&s&&(this.setFocusedColumnIndex(s.columnIndex),t=this._getFocusedCell())}return t}_enterKeyHandler(e,t){var i,n;const s=this.getVisibleRowIndex(),o=this._dataController.getKeyByRowIndex(s),a=(i=this._focusedView)===null||i===void 0?void 0:i.getRow(s),l=this._getFocusedCell(),d=this.option("grouping.allowCollapsing")&&xi(a),c=this.option("masterDetail.enabled")&&(l==null?void 0:l.hasClass(xn)),u=l==null?void 0:l.hasClass(sg);if(d||c){const p=this._dataController.items()[s],g=(p==null?void 0:p.data)&&!p.data.isContinuation;m(o)&&g&&this._dataController.changeRowExpand(o)}else u?(this._adaptiveColumnsController.toggleExpandAdaptiveDetailRow(o),this._updateFocusedCellPosition(l)):(n=this.getMasterDetailCell(l))!==null&&n!==void 0&&n.is(l)?l.is(":focus")&&this.focusFirstInteractiveElementInside(l):l!=null&&l.hasClass(Xd)||this._processEnterKeyForDataCell(e,t)}focusFirstInteractiveElementInside(e){e.find(qi).get(0).focus()}_processEnterKeyForDataCell(e,t){const i=this._getEnterKeyDirection(e),n=this._allowEditingOnEnterKey();t||!n&&i?this._handleEnterKeyEditingCell(e.originalEvent).done((()=>{i==="next"||i==="previous"?this._targetCellTabHandler(e,i):(i==="upArrow"||i==="downArrow")&&this._navigateNextCell(e.originalEvent,i)})):n&&this._startEditing(e)}_getEnterKeyDirection(e){const t=this.option("keyboardNavigation.enterKeyDirection"),i=e.shift;if(t==="column")return i?"upArrow":"downArrow";if(t==="row")return i?"previous":"next"}_handleEnterKeyEditingCell(e){const t=S(),{target:i}=e,n=this._getCellElementFromTarget(i),s=this._isRowEditMode();return this._updateFocusedCellPosition(n),s?(this._focusEditFormCell(n),setTimeout(this._editingController.saveEditData.bind(this._editingController)),t.resolve()):(v.trigger(h(i),"change"),this._closeEditCell().always(t.resolve),e.preventDefault()),t}_escapeKeyHandler(e,t){const i=this._getCellElementFromTarget(e.originalEvent.target);if(t)return this._updateFocusedCellPosition(i),this._isRowEditMode()?(this._focusEditFormCell(i),this._editingController.cancelEditData(),this._dataController.items().length===0&&(this._resetFocusedCell(),this._editorFactory.loseFocus())):this._editingController.getEditMode()==="cell"?this._editingController.cancelEditData():this._closeEditCell(),e.originalEvent.preventDefault(),!0;const n=this.getMasterDetailCell(i);return n?(this._focusCell(n),!0):!1}_ctrlFKeyHandler(e){if(this.option("searchPanel.visible")){const t=this._headerPanel.getSearchTextEditor();t&&(t.focus(),e.originalEvent.preventDefault())}}_f2KeyHandler(){const e=this._editingController.isEditing(),t=this.getVisibleRowIndex(),i=this._focusedView&&this._focusedView.getRow(t);!e&&mi(i)&&this._startEditing()}_navigateNextCell(e,t){const i=this._getNextCell(t),n=this._getDirectionCodeByKey(t);return i&&this._isCellValid(i)?this._arrowKeysHandlerFocusCell(e,i,n):!1}_arrowKeysHandlerFocusCell(e,t,i){const n=i==="prevRow"||i==="nextRow",s=this._fireFocusChangingEvents(e,t,n,!0);return t=s.$newCellElement,!s.cancel&&this._isCellValid(t)?(this._focus(t,!s.isHighlighted),!0):!1}_beginFastEditing(e,t){if(!this._isFastEditingAllowed()||e.altKey||e.ctrlKey||this._editingController.isEditing())return!1;if(t)this._startEditing(e,Ms);else{const{key:i}=e,n=e.keyCode||e.which,s=i||n&&String.fromCharCode(n);s&&(s.length===1||s===Ms)&&this._startEditing(e,s)}return!0}isQuickNavigationPossible(){var e,t,i;const n=this.getVisibleRowIndex(),s=(e=this._rowsView)===null||e===void 0?void 0:e.getRow(n),o=this.option("dataRowTemplate");return!((t=this._editingController)===null||t===void 0||(i=t.isEditRowByIndex)===null||i===void 0?void 0:i.call(t,n))&&!o&&mi(s)}getFirstOrLastColumnIndex(e){const t=this._columnsController.getVisibleColumns(null,!0),i=n=>this.isFocusableColumn(n);return e?t.findIndex(i):t.findLastIndex(i)}getFirstOrLastRowIndex(e){var t;const i=this._isVirtualScrolling()?this._dataController.totalItemsCount():(t=this._dataController.items(!0))===null||t===void 0?void 0:t.length;return e?0:i-1}calculateScrollLeft(e){var t;const i=e?0:this._getMaxHorizontalOffset();return((t=this._columnsController)===null||t===void 0?void 0:t.isNeedToRenderVirtualColumns(i))?i:-1}calculateScrollTop(e){const t=this._getMaxVerticalOffset(),i=t>0;return this._isVirtualRowRender()&&i?e?0:t:-1}scrollTo(e){var t;const i=(t=this._rowsView)===null||t===void 0?void 0:t.getScrollable();i==null||i.scrollTo(e)}focusFirstOrLastCell(e){var t;const i=this._getFocusedCell();this._focusElement(i,!0,e),(t=this._rowsView.getScrollable())===null||t===void 0||t.update()}navigateToFirstOrLastRow(e,t){const i=this.calculateScrollTop(e),n=this.getFirstOrLastRowIndex(e),s=this.getFirstOrLastColumnIndex(e);this.silentUpdateFocusedCellPosition({columnIndex:s,rowIndex:n}),i>=0?(this._needNavigationToCell=!0,this.scrollTo({top:i})):this.navigateToFirstOrLastCell(e,t)}homeOrEndKeyHandler(e){if(!this.isQuickNavigationPossible())return;const t=e.keyName==="home",{originalEvent:i}=e;Ae(i)?this.navigateToFirstOrLastRow(t,i):this.navigateToFirstOrLastCell(t,i),i.preventDefault()}isFocusableColumn(e){return e.type!==ug}navigateToFirstOrLastCell(e,t){const i=this.getFirstOrLastColumnIndex(e);if(this._needNavigationToCell=!1,i<0)return;const n=this.calculateScrollLeft(e);this.silentUpdateFocusedCellPosition({columnIndex:i}),n>=0?(this.needToRestoreFocus=!0,this.scrollTo({left:n})):this.focusFirstOrLastCell(t)}isQuickNavigationToFirstCell(){var e;const t=this.getFirstOrLastColumnIndex(!0);return((e=this._focusedCellPosition)===null||e===void 0?void 0:e.columnIndex)===t}_pointerEventHandler(e){var t;const i=e.event||e;let n=h(i.currentTarget);const s=(t=this._rowsView)===null||t===void 0?void 0:t.element(),o=n.parent(),a=h(i.target).is(qi),l=!!h(i.target).closest(`.${lg}`).length,d=n.hasClass(xn);this._isEventInCurrentGrid(i)&&(!l&&(this._isCellValid(n,!a)||d)?(n=this._isInsideEditForm(n)?h(i.target):n,this._focusView(),h(s).removeClass(Hr),o.hasClass(Yd)?(this._updateFocusedCellPosition(n),this._applyTabIndexToElement(this._focusedView.element()),this._focusedView.focus(!0)):this.getMasterDetailCell(n)?this._updateFocusedCellPosition(n):this._clickTargetCellHandler(i,n)):n.is("td")&&this._resetFocusedCell())}_clickTargetCellHandler(e,t){const i=this._getColumnByCellElement(t),n=this._isCellEditMode(),s=this._editingController.isEditing();this.setCellFocusType();const o=this._fireFocusChangingEvents(e,t,!0);if(t=o.$newCellElement,o.cancel)this.setRowFocusType(),this.setFocusedRowIndex(o.prevRowIndex),s&&n&&this._closeEditCell();else{if(o.resetFocusedRow){this._focusController._resetFocusedRow();return}if(o.rowIndexChanged&&(t=this._getFocusedCell()),!o.isHighlighted&&!n&&this.setRowFocusType(),this._updateFocusedCellPosition(t),this._allowRowUpdating()&&n&&i&&i.allowEditing)this._isNeedFocus=!1,this._isHiddenFocus=!1;else{t=this._getFocusedCell();const a=e&&h(e.target).closest(`${zr}, td`),l=a&&a.not(t).is(zr),c=!(!(i!=null&&i.command)&&s&&t.hasClass(Ss))&&(!o.isHighlighted||l);this._focus(t,c,l)}}}_allowRowUpdating(){const e=this.getVisibleRowIndex(),t=this._dataController.items()[e];return this._editingController.allowUpdating({row:t},"click")}focus(e){let t;const i=this.option("focusedRowEnabled"),n=this._isCellElement(h(e));e||(t=".dx-datagrid-rowsview .dx-row[tabindex]",i||(t+=", .dx-datagrid-rowsview .dx-row > td[tabindex]"),e=this.component.$element().find(t).first()),e&&this._focusElement(h(e),n)}getFocusedView(){return this.getView("rowsView")}setupFocusedView(){this.isKeyboardEnabled()&&!m(this._focusedView)&&this._focusView()}_focusElement(e,t,i){const n=h(this._getRowsViewElement()),s=e.closest(n),o=this.isRowFocusType();let a={};!s.length||this._isCellElement(e)&&!this._isCellValid(e)||(this._focusView(),this._isNeedFocus=!0,this._isNeedScroll=!0,(this._isCellElement(e)||xi(e))&&(this.setCellFocusType(),a=this._fireFocusChangingEvents(i,e,!0,t),e=a.$newCellElement,o&&!a.isHighlighted&&this.setRowFocusType()),a.cancel||(this._focus(e,!a.isHighlighted),this._focusInteractiveElement(e)))}isInsideFocusedView(e){var t;return e.closest((t=this._focusedView)===null||t===void 0?void 0:t.element()).length!==0}_focusView(){this._focusedView=this._rowsView}_resetFocusedView(){this.setRowFocusType(),this._focusedView=null}_focusInteractiveElement(e,t){if(!e)return;const i=this._getInteractiveElement(e,t);y.focusAndSelectElement(this,i)}_focus(e,t,i){const n=e&&!e.hasClass(Tt)?e.closest(`.${Tt}`):e;if(n&&yy(n))return;const s=this._focusedView,o=s&&s.element();let a;this._isHiddenFocus=t;const l=xi(n)||ph(n)||this.isRowFocusType();l?(a=n,s&&this.setFocusedRowIndex(this._getRowIndex(n))):this._isCellElement(e)&&(a=e,this._updateFocusedCellPosition(e)),a&&(o&&o.find(".dx-row[tabindex], .dx-row > td[tabindex]").filter(((d,c)=>y.isElementInCurrentGrid(this,h(c)))).not(a).removeClass(Ai).removeClass(Wr).removeAttr("tabindex"),v.one(a,"blur",(d=>{d.relatedTarget&&a.removeClass(Ai).removeClass(Wr)})),i||(this._applyTabIndexToElement(a),v.trigger(a,"focus")),t?(a.addClass(Ai),l&&e.addClass(Ai)):this._editorFactory.focus(a))}_updateFocus(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._updateFocusTimeout=setTimeout((()=>{if(this._needFocusEditingCell()){this._editingController._focusEditingCell();return}let i=this._getFocusedCell();const n=this._editingController.isEditing();if(!this.getMasterDetailCell(i)||this._isRowEditMode()){if(this._hasSkipRow(i.parent())){const s=this._focusedCellPosition&&this._focusedCellPosition.rowIndex>0?"upArrow":"downArrow";i=this._getNextCell(s)}if(Ye(i))if(i.is("td")||i.hasClass(this.addWidgetPrefix(tg))){const s=i.is(ks),o=i.find(":focus"),a=Ye(o),l=this._getColumnByCellElement(i);if((e||!s)&&this._editorFactory.focus()){if(s&&a){y.focusAndSelectElement(this,o);return}!a&&this._focus(i,!1,t)}else!a&&(this._isNeedFocus||this._isHiddenFocus)&&this._focus(i,this._isHiddenFocus,t);n&&!(l!=null&&l.showEditorAlways)&&this._focusInteractiveElement.bind(this)(i)}else v.trigger(i,"focus")}}))}_needFocusEditingCell(){const e=this._editingController.getEditMode()===Bo,t=this._editingController.getEditMode()===Mo,i=e&&this._editingController.hasChanges(),n=t&&this._editingController.isNewRowInEditMode(),s=this._getFocusedCell();return(s.children().length===0||s.find(Cr).length>0)&&(i||n)}_updateFocusedCellPositionByTarget(e){var t;if(this._getElementType(e)==="row"&&m((t=this._focusedCellPosition)===null||t===void 0?void 0:t.columnIndex)){const n=h(e);this._focusedView&&xi(n)&&this.setFocusedRowIndex(this._getRowIndex(n))}else this._updateFocusedCellPosition(this._getCellElementFromTarget(e))}_focusCell(e,t){if(this._isCellValid(e))return this._focus(e,t),!0}_focusEditFormCell(e){e.hasClass(Ps)&&this._editorFactory.focus(e,!0)}_resetFocusedCell(e){var t;const i=this._getFocusedCell();Ye(i)&&i.removeAttr("tabindex").removeClass(Ai),this._isNeedFocus=!1,this._isNeedScroll=!1,this._focusedCellPosition={},clearTimeout(this._updateFocusTimeout),(t=this._focusedView)===null||t===void 0||t.renderFocusState({preventScroll:e})}restoreFocusableElement(e,t){const i=this;let n,s;const o=m(e),a=this._rowsView.element(),{columnIndex:l}=i._focusedCellPosition,d=i._dataController.getRowIndexOffset();e=o?e:this._rowsView.getTopVisibleItemIndex()+d,o?(s=this._rowsView.getRow(e-d),n=i._fireFocusedRowChanging(t,s),!n.cancel&&n.rowIndexChanged&&(e=n.newRowIndex)):(i._editorFactory.loseFocus(),i._applyTabIndexToElement(a),v.trigger(a,"focus")),(!o||!n.cancel)&&i.setFocusedCellPosition(e,l),o&&i._updateFocus()}silentUpdateFocusedCellPosition(e){this._focusedCellPosition=T({},this._focusedCellPosition??{},e)}_getNewPositionByCode(e,t,i){let{columnIndex:n}=e,{rowIndex:s}=e,o;if(e.rowIndex===void 0&&i==="next")return{columnIndex:0,rowIndex:0};switch(i){case"nextInRow":case"next":o=this._getVisibleColumnCount(),n<o-1&&t!=="row"&&this._hasValidCellAfterPosition({columnIndex:n,rowIndex:s})?n++:!this._isLastRow(s)&&i==="next"&&(n=0,s++);break;case"previousInRow":case"previous":n>0&&t!=="row"&&this._hasValidCellBeforePosition({columnIndex:n,rowIndex:s})?n--:s>0&&i==="previous"&&(s--,o=this._getVisibleColumnCount(),n=o-1);break;case"upArrow":s=s>0?s-1:s;break;case"downArrow":s=this._isLastRow(s)?s:s+1}return{columnIndex:n,rowIndex:s}}getRowIndex(){return this._focusedCellPosition?this._focusedCellPosition.rowIndex:-1}getColumnIndex(){return this._focusedCellPosition?this._focusedCellPosition.columnIndex:-1}getVisibleRowIndex(){var e;const t=(e=this._focusedCellPosition)===null||e===void 0?void 0:e.rowIndex;return!m(t)||t<0?-1:t-this._dataController.getRowIndexOffset()}getVisibleColumnIndex(){var e;const t=(e=this._focusedCellPosition)===null||e===void 0?void 0:e.columnIndex;return m(t)?t-this._columnsController.getColumnIndexOffset():-1}_isCellByPositionValid(e){const t=h(this._getCell(e));return this._isCellValid(t)}_isLastRow(e){const t=this._dataController;if(this._isVirtualRowRender())return e>=t.getMaxRowIndex();const i=Math.max(...t.items().map(((n,s)=>n.visible!==!1?s:-1)));return e===i}_isFirstValidCell(e){let t=!1;return e.rowIndex===0&&e.columnIndex>=0&&(t=t||!this._hasValidCellBeforePosition(e)),t}_hasValidCellBeforePosition(e){let{columnIndex:t}=e,i=!1;for(;t>0&&!i;){const n={columnIndex:--t,rowIndex:e.rowIndex};i=this._isCellByPositionValid(n)}return i}_hasValidCellAfterPosition(e){let{columnIndex:t}=e,i=!1;const n=this._getVisibleColumnCount();for(;t<n-1&&!i;){const s={columnIndex:++t,rowIndex:e.rowIndex};i=this._isCellByPositionValid(s)}return i}_isLastValidCell(e){const t=e.columnIndex>=0?e.columnIndex+1:0,{rowIndex:i}=e,n={columnIndex:t,rowIndex:i},s=this._dataController.getVisibleRows(),o=s&&s[i];return this._isLastRow(i)?((o==null?void 0:o.rowType)==="group"||(o==null?void 0:o.rowType)==="groupFooter")&&e.columnIndex>0||e.columnIndex===this._getVisibleColumnCount()-1?!0:this._isCellByPositionValid(n)?!1:this._isLastValidCell(n):!1}_isCellValid(e,t){if(Ye(e)){const i=e.parent(),n=this._rowsView.getCellIndex(e)+this._columnsController.getColumnIndexOffset(),s=this._getColumnByCellElement(e),o=this._getVisibleColumnCount(),a=this._editingController,l=xy(i),d=s&&s.showWhenGrouped,c=s&&!e.hasClass(xn)&&mi(i),u=function(){return!l&&s&&(!m(s.groupIndex)||d&&c)||parseInt(e.attr("colspan"),10)>1};if(hh.isDragCell(e))return!1;if(this.getMasterDetailCell(e))return!0;if(o>n&&u()){const g=this._dataController.items(),_=this._rowsView.getRowIndex(i),f=g[_],C=a&&this._isCellEditMode()&&a.isEditing(),I=a&&a.isEditRow(_),E=I||C;return s.command?this._isLegacyNavigation()?!E&&s.command==="expand":C?!1:I?s.command!=="select":!E:C&&f&&f.rowType!=="data"?!1:!E||s.allowEditing||t}}}getFirstValidCellInRow(e,t){const i=this,n=e.find("> td");let s,o;t=t||0;for(let a=t;a<n.length;++a)if(s=n.eq(a),i._isCellValid(s)){o=s;break}return o}_getNextCell(e,t,i){const n=i||this._focusedCellPosition,s=this.isRowFocusType(),o=s||["next","previous"].includes(e);let a,l;if(this._focusedView&&n){const d=this._getNewPositionByCode(n,t,e);a=h(this._getCell(d));const c=e==="previous"?this._isFirstValidCell(d):this._isLastValidCell(d);if(Ye(a)&&!this._isCellValid(a)&&this._isCellInRow(d,o)&&!c&&(s?a=this.getFirstValidCellInRow(a.parent(),d.columnIndex):a=this._getNextCell(e,"cell",d)),l=Ye(a)&&a.parent(),this._hasSkipRow(l)){const u=this._getRowIndex(l);if(!this._isLastRow(u))a=this._getNextCell(e,"row",{columnIndex:n.columnIndex,rowIndex:u});else return null}return Ye(a)?a:null}return null}_startEditing(e,t){const i=this._focusedCellPosition,n=this.getVisibleRowIndex(),s=this.getVisibleColumnIndex(),o=this._dataController.items()[n],a=this._columnsController.getVisibleColumns()[s];this._isAllowEditing(o,a)&&(this._isRowEditMode()?this._editingController.editRow(n):i&&this._startEditCell(e,t))}_isAllowEditing(e,t){return this._editingController.allowUpdating({row:e})&&t&&t.allowEditing}_editFocusedCell(){const e=this.getVisibleRowIndex(),t=this.getVisibleColumnIndex();return this._editingController.editCell(e,t)}_startEditCell(e,t){this._fastEditingStarted=m(t);const i=this._editFocusedCell(),n=pp(i);if(!this._isFastEditingStarted()||!n&&!i)return;const o=n&&t===Ms?"":t,a=n?i:S().resolve(),l=this._rowsView.waitAsyncTemplates(!0);O(a,l).done((()=>{this._editingCellHandler(e,o)}))}_editingCellHandler(e,t){var i;const n=this._getFocusedCell().find(qi).eq(0),s=n.get(0);if(!s)return;const o=Ui(e,{type:"keydown",target:s}),a=Ui(e,{type:"keypress",target:s}),l=Ui(e,{type:"input",target:s});if(l.originalEvent&&(l.originalEvent=Ui(l.originalEvent,{data:t})),(i=s.select)===null||i===void 0||i.call(s),v.trigger(n,o),!o.isDefaultPrevented()&&(v.trigger(n,a),!a.isDefaultPrevented())){const d=me.mozilla?25:0;setTimeout((()=>{const c=this._getKeyPressInputValue(n,t);n.val(c);const u=n.closest(`.${ag}`);v.off(u,"focusout"),v.one(u,"focusout",(()=>{v.trigger(n,"change")})),v.trigger(n,l)}),d)}}_getKeyPressInputValue(e,t){const i=e.val();return t==="-"&&i==="-0"?"-0":t}_fireFocusChangingEvents(e,t,i,n){let s={};const o=this._getCellPosition(t)??{};return this.isCellFocusType()&&(s=this._fireFocusedCellChanging(e,t,n),s.cancel||(o.columnIndex=s.newColumnIndex,o.rowIndex=s.newRowIndex,n=s.isHighlighted,t=h(this._getCell(o)))),!s.cancel&&i&&t&&(s=this._fireFocusedRowChanging(e,t.parent()),s.cancel||(o.rowIndex=s.newRowIndex,s.isHighlighted=n)),s.$newCellElement=h(this._getCell(o)),s.$newCellElement.length||(s.$newCellElement=t),s}_fireFocusedCellChanging(e,t,i){const n=this.option("focusedColumnIndex"),s=this.option("focusedRowIndex"),o=this._getCellPosition(t),a=o?o.columnIndex:-1,l=o?o.rowIndex:-1,d=this._dataController.getVisibleRows(),c=this._columnsController.getVisibleColumns(),u={cellElement:t,prevColumnIndex:n,prevRowIndex:s,newColumnIndex:a,newRowIndex:l,rows:d,columns:c,event:e,isHighlighted:i||!1,cancel:!1};return this._canceledCellPosition=null,this.executeAction("onFocusedCellChanging",u),(u.newColumnIndex!==a||u.newRowIndex!==l)&&(u.$newCellElement=h(this._getCell({columnIndex:u.newColumnIndex,rowIndex:u.newRowIndex}))),u.cancel&&(this._canceledCellPosition={rowIndex:l,columnIndex:a}),u}_fireFocusedCellChanged(e){const t=this._rowsView.getCellIndex(e),i=e==null?void 0:e.parent().data("options"),n=i==null?void 0:i.key;this._memoFireFocusedCellChanged(n,t)}_memoFireFocusedCellChanged(e,t){const i=this._getFocusedCell(),n=i==null?void 0:i.parent(),s=this.getRowIndex(),o=Math.min(this._getLocalRowIndex(n),this._dataController.items().length-1);if(this._editingController.isEditCell(o,t))return;const l=this._dataController.items()[o],d=this._columnsController.getVisibleColumns()[t];this.executeAction("onFocusedCellChanged",{cellElement:i?$(i):void 0,columnIndex:t,rowIndex:s,row:l,column:d})}_fireFocusedRowChanging(e,t){const i=this._getRowIndex(t),n=this.option("focusedRowIndex"),s=this._dataController.loadingOperationTypes(),o={rowElement:t,prevRowIndex:n,newRowIndex:i,event:e,rows:this._dataController.getVisibleRows(),cancel:!1},a=s.sorting||s.grouping||s.filtering||s.paging;return!this._dataController||this._dataController.isLoading()&&a?(o.cancel=!0,o):(this.option("focusedRowEnabled")&&(this.executeAction("onFocusedRowChanging",o),!o.cancel&&o.newRowIndex!==i&&(o.resetFocusedRow=o.newRowIndex<0,o.resetFocusedRow||this.setFocusedRowIndex(o.newRowIndex),o.rowIndexChanged=!0)),o)}_fireFocusedRowChanged(){var e;const t=this.option("focusedRowEnabled"),i=this.option("focusedRowKey"),n=(e=this._focusController)===null||e===void 0?void 0:e.getFocusedRowIndexByKey(i);!t||m(i)&&n<0||this._memoFireFocusedRowChanged(i,n)}_memoFireFocusedRowChanged(e,t){const i=t-this._dataController.getRowIndexOffset();this.executeAction("onFocusedRowChanged",{rowElement:t<0?void 0:this._rowsView.getRowElement(i),rowIndex:t,row:t<0?void 0:this._dataController.getVisibleRows()[i]})}_isEventInCurrentGrid(e){return y.isElementInCurrentGrid(this,h(e.target))}_isRowEditMode(){const e=this._editingController.getEditMode();return e===Qi||e===vr}_isCellEditMode(){const e=this._editingController.getEditMode();return e===Bo||e===Mo}_isFastEditingAllowed(){return this._isCellEditMode()&&this.option("keyboardNavigation.editOnKeyPress")}_getInteractiveElement(e,t){const i=e.find(qi).filter(":visible");return t?i.last():i.first()}_applyTabIndexToElement(e){const t=this.option("tabIndex")??0;e.attr("tabindex",t)}_getCell(e){if(this._focusedView&&e){const t=this._dataController.getRowIndexOffset(),i=this._columnsController.getVisibleColumns(null,!0)[e.columnIndex],n=i&&i.fixed?this._getFixedColumnIndexOffset(i):this._columnsController.getColumnIndexOffset(),s=e.rowIndex>=0?e.rowIndex-t:-1,o=e.columnIndex>=0?e.columnIndex-n:-1;return this._focusedView.getCell({rowIndex:s,columnIndex:o})}}_getRowIndex(e){let t=this._getLocalRowIndex(e);return t>=0&&(t+=this._dataController.getRowIndexOffset()),t}_getLocalRowIndex(e){return this._rowsView.getRowIndex(e)}getCellIndex(e,t){return this._rowsView.getCellIndex(e,t)}_hasSkipRow(e){const t=e&&e.get(0);return t&&t.style.display==="none"}_allowEditingOnEnterKey(){return this.option("keyboardNavigation.enterKeyAction")==="startEdit"}_isLegacyNavigation(){return this.option("useLegacyKeyboardNavigation")}_getDirectionCodeByKey(e){let t;switch(e){case"upArrow":t="prevRow";break;case"downArrow":t="nextRow";break;case"leftArrow":t=this.option("rtlEnabled")?"nextInRow":"previousInRow";break;case"rightArrow":t=this.option("rtlEnabled")?"previousInRow":"nextInRow"}return t}_isVirtualScrolling(){const e=this.option("scrolling.mode");return e==="virtual"||e==="infinite"}_isVirtualRowRender(){return this._isVirtualScrolling()||y.isVirtualRowRendering(this)}_isVirtualColumnRender(){return this.option("scrolling.columnRenderingMode")==="virtual"}_scrollBy(e,t,i,n){const s=this,o=this._rowsView.getScrollable();if(s._focusedCellPosition){const a=function(){o.off("scroll",a),setTimeout(s.restoreFocusableElement.bind(s,i,n))};o.on("scroll",a)}return o.scrollBy({left:e,top:t})}_isInsideEditForm(e){const t=h(e).closest(`.${this.addWidgetPrefix(_r)}`);return t.length&&this.elementIsInsideGrid(t)}getMasterDetailCell(e){const t=h(e).closest(`.${Ps}`);return t.length&&this.elementIsInsideGrid(t)?t:null}_processNextCellInMasterDetail(e,t){!this._isInsideEditForm(e)&&e&&this._applyTabIndexToElement(e)}_handleTabKeyOnMasterDetailCell(e,t){if(this.getMasterDetailCell(e)){this._updateFocusedCellPosition(h(e),t);const i=this._getNextCell(t,"row");return this._processNextCellInMasterDetail(i,h(e)),!0}return!1}_getElementType(e){return h(e).is("tr")?"row":"cell"}_isFastEditingStarted(){return this._isFastEditingAllowed()&&this._fastEditingStarted}_getVisibleColumnCount(){return this._columnsController.getVisibleColumns(null,!0).length}_isCellInRow(e,t){const{columnIndex:i}=e,n=this._getVisibleColumnCount();return t?i>=0&&i<=n-1:i>0&&i<n-1}_isCellElement(e){return e.length&&e[0].tagName==="TD"}_getCellElementFromTarget(e){const t=this._getElementType(e),i=h(e);let n;return t==="cell"?n=i.closest(`.${Tt} > td`):n=i.children().not(`.${xn}`).first(),n}_getRowsViewElement(){var e;return(e=this._rowsView)===null||e===void 0?void 0:e.element()}_processCanceledEditCellPosition(e,t){if(this._canceledCellPosition){const i=this._canceledCellPosition.rowIndex===e&&this._canceledCellPosition.columnIndex===t;return this._canceledCellPosition=null,i}}updateFocusedRowIndex(){const e=this._dataController,t=this.getVisibleRowIndex(),i=e.items(),n=i.length?i.length-1:-1,s=e.getRowIndexOffset();n>=0&&t>n&&this.setFocusedRowIndex(n+s)}needNavigationToCell(){return this._needNavigationToCell}navigationToCellInProgress(){return this.needToRestoreFocus||this.needNavigationToCell()}}const Ty=r=>class extends r{_rowClick(e){const t=this._editingController.getEditRowIndex(),i=this._keyboardNavigationController.isKeyboardEnabled();t===e.rowIndex&&this._keyboardNavigationController.setCellFocusType(),(Xo()||!i)&&this.option("focusedRowEnabled")&&this._triggerPointerDownEventHandler(e,!i),super._rowClick.apply(this,arguments)}_triggerPointerDownEventHandler(e,t){const{originalEvent:i}=e.event;if(i){const n=h(i.target),s=this.getCellIndex(n),o=this._columnsController.getVisibleColumns()[s],a=this._dataController.items()[e.rowIndex];if(this._keyboardNavigationController._isAllowEditing(a,o)||t){const l=Ui(i,{currentTarget:i.target});this._keyboardNavigationController._pointerEventHandler(l)}}}renderFocusState(e){if(super.renderFocusState(e),this._keyboardNavigationController.navigationToCellInProgress())return;const{preventScroll:t,pageSizeChanged:i}=e??{},n=this.element();n&&!Dd(n)&&n.attr("tabindex",null),i&&this._keyboardNavigationController.updateFocusedRowIndex();let s=this._keyboardNavigationController.getVisibleRowIndex();(!m(s)||s<0)&&(s=0);const o=this.getCellElements(s);this._keyboardNavigationController.isKeyboardEnabled()&&o!==null&&o!==void 0&&o.length&&this.updateFocusElementTabIndex(o,t)}updateFocusElementTabIndex(e,t){const i=e.eq(0).parent();if(xi(i))this._keyboardNavigationController._applyTabIndexToElement(i);else{let n=this._keyboardNavigationController.getColumnIndex();(!m(n)||n<0)&&(n=0),this._updateFocusedCellTabIndex(e,n)}}_updateFocusedCellTabIndex(e,t){const i=this._keyboardNavigationController,n=e?e.length:-1,s=function(a){const l=!!i.getMasterDetailCell(a),d=i._isCellValid(a);if(!l&&d&&i._isCellElement(a))return i._applyTabIndexToElement(a),i.setCellFocusType(),!0},o=hh.getCellToFocus(e,t);if(o.length)s(o);else{n<=t&&(t=n-1);for(let a=t;a<n&&!s(h(e[a]));++a);}}renderDelayedTemplates(e){super.renderDelayedTemplates.apply(this,arguments),this.waitAsyncTemplates().done((()=>{this._renderFocusByChange(e)}))}_renderFocusByChange(e){var t;const{operationTypes:i,repaintChangesOnly:n}=e??{},{fullReload:s,pageSize:o}=i??{},a=!!(e!=null&&(t=e.changeTypes)!==null&&t!==void 0&&t.find((l=>l==="insert"||l==="remove")));if(!e||!n||s||o||a){const l=gh(this);this.renderFocusState({preventScroll:l,pageSizeChanged:o})}}_renderCore(e){const t=super._renderCore.apply(this,arguments);return this._renderFocusByChange(e),t}_editCellPrepared(e){var t;const i=this._getEditorInstance(e),n=(t=this._keyboardNavigationController)===null||t===void 0?void 0:t._isFastEditingStarted();i&&n&&this._handleEditingNavigationMode(i),super._editCellPrepared.apply(this,arguments)}_handleEditingNavigationMode(e){["downArrow","upArrow"].forEach((i=>{const n=e._supportedKeys()[i];e.registerKeyHandler(i,(s=>{if(e._input().attr("aria-expanded")==="true")return n&&n.call(e,s)}))})),e.registerKeyHandler("leftArrow",Ce),e.registerKeyHandler("rightArrow",Ce),e.NAME===rg&&e.option("useMaskBehavior")&&e.registerKeyHandler("enter",Ce)}_getEditorInstance(e){const t=e.find(".dx-texteditor").eq(0);return y.getWidgetInstance(t)}_handleScroll(e){super._handleScroll(e),this._keyboardNavigationController.needNavigationToCell()&&this._keyboardNavigationController.navigateToFirstOrLastCell(this._keyboardNavigationController.isQuickNavigationToFirstCell())}init(){super.init(),this._resizeController=this.getController("resizing")}},Dy=r=>class extends r{editCell(e,t){if(this._keyboardNavigationController._processCanceledEditCellPosition(e,t))return!1;const i=super.editCell(e,t);return i&&this._keyboardNavigationController.setupFocusedView(),i}editRow(e){const t=this._keyboardNavigationController.getVisibleColumnIndex(),i=this._columnsController.getVisibleColumns()[t];(i&&i.type||this.option("editing.mode")===vr)&&this._keyboardNavigationController._resetFocusedCell(),super.editRow(e)}addRow(e){return this._keyboardNavigationController.setupFocusedView(),this._keyboardNavigationController.setCellFocusType(),super.addRow.apply(this,arguments)}getFocusedCellInRow(e){let t=super.getFocusedCellInRow(e);const i=this._dataController.getRowIndexOffset(),n=this._keyboardNavigationController._focusedCellPosition.rowIndex-i;if(this._keyboardNavigationController.isKeyboardEnabled()&&n===e){const s=this._keyboardNavigationController._getFocusedCell();Ye(s)&&!s.hasClass(Xd)&&(t=s)}return t}_processCanceledEditingCell(){this.closeEditCell().done((()=>{this._keyboardNavigationController._updateFocus()}))}closeEditCell(){const e=this._keyboardNavigationController;e._fastEditingStarted=!1;const t=super.closeEditCell.apply(this,arguments);return!!this._getFocusedElement().closest(`.${this.addWidgetPrefix(av)}`).length||e._updateFocus(),t}_getFocusedElement(){var e,t;return h((e=(t=this.component).element)===null||e===void 0?void 0:e.call(t)).find(":focus")}_delayedInputFocus(){this._keyboardNavigationController._isNeedScroll=!0,super._delayedInputFocus.apply(this,arguments)}_isEditingStart(){const e=super._isEditingStart.apply(this,arguments);if(e&&!this._keyboardNavigationController._isNeedFocus){const t=this._keyboardNavigationController._getFocusedCell();this._keyboardNavigationController._focus(t,!0)}return e}},Ry=r=>class extends r{_correctRowIndices(e){const t=this._keyboardNavigationController._focusedCellPosition;if(super._correctRowIndices.apply(this,arguments),t&&t.rowIndex>=0){const i=e(t.rowIndex);i&&(t.rowIndex+=i,this._editorFactoryController.refocus())}}getMaxRowIndex(){let e=this.items().length-1;const t=this.virtualItemsCount();if(t){const i=this.getRowIndexOffset();e+=i+t.end}return e}},Vy=r=>class extends r{_showHiddenCellsInView(e){let{viewName:t,$cells:i,isCommandColumn:n}=e;super._showHiddenCellsInView.apply(this,arguments),t===Ur&&!n&&i.each(((s,o)=>{const a=h(o);_d(a)&&a.attr("tabindex",0)}))}_hideVisibleCellInView(e){let{viewName:t,$cell:i,isCommandColumn:n}=e;super._hideVisibleCellInView.apply(this,arguments),t===Ur&&!n&&_d(i)&&i.removeAttr("tabindex")}_hideVisibleColumnInView(e){let{view:t,isCommandColumn:i,visibleIndex:n}=e;super._hideVisibleColumnInView({view:t,isCommandColumn:i,visibleIndex:n}),t.name===dg&&this._rowsView.renderFocusState({preventScroll:gh(this)})}},sE={defaultOptions:()=>({useLegacyKeyboardNavigation:!1,keyboardNavigation:{enabled:!0,enterKeyAction:"startEdit",enterKeyDirection:"none",editOnKeyPress:!1}}),controllers:{keyboardNavigation:Ey},extenders:{views:{rowsView:Ty},controllers:{editing:Dy,data:Ry,adaptiveColumns:Vy,keyboardNavigation:Sy}}},Oy=(r,e)=>{r.addClass(e(J.stickyColumnBorderLeft))},Fy=(r,e)=>{r.addClass(e(J.stickyColumnBorderRight))},Ay=(r,e,t)=>{switch(e){case U.Right:r.addClass(t(J.stickyColumnRight));break;case U.Sticky:r.addClass(t(J.stickyColumn));break;default:r.addClass(t(J.stickyColumnLeft))}},Py=(r,e,t)=>{r.toggleClass(t(J.firstHeader),e)},ky=(r,e,t)=>{r.toggleClass(t(J.columnNoBorder),e)},My=(r,e,t)=>{r.toggleClass(t(J.stickyColumns),e)},Ds=(r,e,t)=>{if(!r.hasClass(t(J.stickyColumn)))return!1;const n=parseFloat(r[0].style.left),s=re(r[0]),o=re(e[0]),a=s.left-o.left;return Math.round(n)>=Math.round(a)},Cn=(r,e,t)=>{if(!r.hasClass(t(J.stickyColumn)))return!1;const n=parseFloat(r[0].style.right),s=re(r[0]),a=re(e[0]).right-s.right;return Math.round(n)>=Math.round(a)},By=(r,e,t)=>Ds(r,e,t)||Cn(r,e,t),Ny=(r,e,t)=>r.hasClass(t(J.stickyColumnRight))||Cn(r,e,t),_h=(r,e)=>r.hasClass(e(J.stickyColumnLeft))&&r.hasClass(e(J.stickyColumnBorderRight)),fh=(r,e)=>r.hasClass(e(J.stickyColumnRight))&&r.hasClass(e(J.stickyColumnBorderLeft)),Ly=(r,e)=>r.hasClass(e(J.stickyColumn)),Ch=(r,e)=>r.hasClass(e(J.stickyColumnLeft))||r.hasClass(e(J.stickyColumnRight))||r.hasClass(e(J.stickyColumn)),$y=(r,e)=>r.filter(((t,i)=>h(i).hasClass(e(J.stickyColumnLeft)))),Hy=(r,e)=>r.filter(((t,i)=>h(i).hasClass(e(J.stickyColumnRight)))),Wy=(r,e)=>r.filter(((t,i)=>h(i).hasClass(e(J.stickyColumn))||!Ch(h(i),e))),zy=(r,e,t)=>{const s=(e.css("direction")==="rtl"?r.toArray():r.toArray().reverse()).find((o=>Ds(h(o),e,t)||_h(h(o),t)));return h(s??"")},Ky=(r,e,t)=>{const s=(e.css("direction")==="rtl"?r.toArray().reverse():r.toArray()).find((o=>Cn(h(o),e,t)||fh(h(o),t)));return h(s??"")},vn=(r,e,t)=>{const i=re(e.get(0)),n={left:i.left,right:i.right};if(r!=null&&r.length){const s=zy(r,e,t),o=Ky(r,e,t);s!=null&&s.length&&(n.left=Math.round(re(s[0]).right)),o!=null&&o.length&&(n.right=Math.round(re(o[0]).left))}return n},Gy=(r,e,t)=>{let{point:i,column:n,nextColumn:s}=e;const{item:o,isLeftBoundary:a,isRightBoundary:l}=i,d=h(o),c=Math.round(i.x),u=r.option("rtlEnabled"),p=m(a)||m(l),g=h(r.getColumnElements()??""),_=h(r.getContent()),f=(n==null?void 0:n.fixed)&&(s==null?void 0:s.fixed),C=vn(g,_,t);if(f||_c(i,n,s))return!1;if(p){if(_h(d,t)||Ds(d,_,t))return a;if(fh(d,t)||Cn(d,_,t))return l}const I=c<C.left||c>C.right,E=c===C.left||c===C.right,D=u?i.index===0:i.index===g.length;return I||!D&&E},Uy=(r,e,t,i)=>{const{item:n,isLeftBoundary:s,isRightBoundary:o}=r,a=h(n),l=Math.round(r.x),d=m(s)||m(o),c=vn(e,t,i);return Ds(a,t,i)?d&&!s:Cn(a,t,i)?d&&!o:l<c.left||l>c.right},qy=r=>{const t=r.parent().children().filter((n=>n<r.index()));return r.attr("colspan")-t.length===1},Yy=(r,e,t)=>{const i=re(e.get(0)),n=vn(r,e,t);return{left:n.left-i.left,right:i.right-n.right}},jy=(r,e,t,i)=>{const n=re(r.get(0)),s=Math.round(n.left),o=Math.round(n.right),a=vn(e,t,i);return s<a.left||o>a.right},Xy=r=>{if(!r.is("td"))return!1;const e=r.parent().children().last();return r[0]===e[0]},Zy=r=>!r.is("[tabindex]"),Qy=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"next",t=r,i=r.parent();do t=e==="next"?t.next():t.prev(),t.length||(i=e==="next"?i.next():i.prev(),i.length&&(t=e==="next"?i.children().first():i.children().last()));while(t.length&&Zy(t));return t},ne={toggleFirstHeaderClass:Py,toggleColumnNoBorderClass:ky,addStickyColumnClass:Ay,addStickyColumnBorderLeftClass:Oy,addStickyColumnBorderRightClass:Fy,doesGroupCellEndInFirstColumn:qy,toggleStickyColumnsClass:My,getLeftFixedCells:$y,getRightFixedCells:Hy,getNonFixedAndStickyCells:Wy,getNonFixedAreaBoundingRect:vn,getScrollPadding:Yy,getNextHeaderCell:Qy,noNeedToCreateResizingPoint:Gy,isFixedCellPinnedToRight:Ny,noNeedToCreateReorderingPoint:Uy,isFixedCell:Ch,isStickyCell:Ly,isStickyCellPinned:By,isOutsideVisibleArea:jy,isLastCell:Xy};class Jy extends vs{constructor(){super(...arguments),this.keyboardNavigationControllers=[]}registerKeyboardNavigationController(e){this.keyboardNavigationControllers.push(e)}updateFocusPosition(e,t){m(t)?e.updateFocusPosition(t):this.keyboardNavigationControllers.forEach((i=>{i!==e&&i.updateFocusPosition()}))}restoreFocus(e){e.getFirstFocusableVisibleIndex()>=0?e.restoreFocus():this.keyboardNavigationControllers.forEach((t=>{if(t===e)return;t.getFirstFocusableVisibleIndex()>=0&&t.restoreFocus()}))}}class eI extends mh{keyDownHandler(e){return this.processOnKeyDown(e)}getVisibleIndex(e,t){const i=this._columnsController.getVisibleIndex(e.index,t),n=this.getColumnIndexOffset(i);return i>=0?i+n:-1}getNewVisibleIndex(e,t,i){return i==="previous"?e-1:e+2}getNewFocusedColumnIndex(e,t){return t===Ne.Next?e-1:e}resizeCompleted(){this.needToRestoreFocus&&this.restoreFocus()}resetFocusedCellPosition(){this._focusedCellPosition={}}canReorderColumn(e,t,i){return!1}init(){var e;super.init(),this.columnFocusDispatcher=this.getController("columnFocusDispatcher"),(e=this.columnFocusDispatcher)===null||e===void 0||e.registerKeyboardNavigationController(this)}moveColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ne.Next,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const n=this.getFocusedView().getName(),s=this.getVisibleIndex(e,i),o=this.getNewVisibleIndex(s,i,t),a=this.getNewFocusedColumnIndex(o,t);this.updateViewFocusPosition({rowIndex:i,columnIndex:a}),this._columnsController.moveColumn({columnIndex:s,rowIndex:i},{columnIndex:o,rowIndex:i},n,n)}getFirstFocusableVisibleIndex(){return-1}updateViewFocusPosition(e){var t;(t=this.columnFocusDispatcher)===null||t===void 0||t.updateFocusPosition(this,e)}updateFocusPosition(e){this.needToRestoreFocus=!0,m(e)?this.setFocusedCellPosition(e.rowIndex,e.columnIndex):this.resetFocusedCellPosition()}restoreViewFocus(){var e;(e=this.columnFocusDispatcher)===null||e===void 0||e.restoreFocus(this)}restoreFocus(){var e;this.needToRestoreFocus=!1,nt(this._focusedCellPosition)&&this.setFocusedCellPosition(0,this.getFirstFocusableVisibleIndex());const t=this._getFocusedCell();t==null||(e=t[0])===null||e===void 0||e.focus({preventScroll:!0})}}class tI extends eI{constructor(){super(...arguments),this.isOutsideVisibleArea=(e,t)=>{const i=re(e.get(0)),n=Math.round(i.left),s=Math.round(i.right),o=this.getContainerBoundingRect(t);return n<o.left||s>o.right}}leftRightKeysHandler(e){const{originalEvent:t}=e;if(Ae(t)){const i=h(t.target).closest("td"),n=this.getDirectionByKeyName(e.keyName),s=this._getRowIndex(i.parent()),o=this._getColumnByCellElement(i,s);this.canReorderColumn(o,n,s)&&this.moveColumn(o,n,s),t==null||t.preventDefault()}}getColumnVisibleIndexCorrection(e,t,i){return 0}getNewVisibleIndex(e,t,i){const n=super.getNewVisibleIndex(e,t,i),s=this.getColumnVisibleIndexCorrection(e,t,i);return n+s}getDraggableColumns(e,t){var i;const n=this._columnsController,s=(i=n.getVisibleColumns(t,!0))===null||i===void 0?void 0:i.filter((o=>o.ownerBand===(e==null?void 0:e.ownerBand)&&(!m(o.type)||n.isCustomCommandColumn(o))));if(e!=null&&e.fixed){const o=Mt(n,e);if(o!==U.Sticky)return s.filter((a=>a.fixed&&Mt(n,a)===o))}return s.filter((o=>!o.fixed||o.fixedPosition===U.Sticky))}keyDownHandler(e){let t=super.keyDownHandler(e);if(t)return!0;switch(e.keyName){case"tab":this.tabKeyHandler(e),t=!0;break;case"leftArrow":case"rightArrow":this.leftRightKeysHandler(e),t=!0}return t}tabKeyHandler(e){}getCellIndex(e){return this._columnHeadersView.getCellIndex(e)}_getCell(e){var t;const i=this.getColumnIndexOffset(e.columnIndex),n=e.columnIndex>=0?e.columnIndex-i:-1;return(t=this._columnHeadersView)===null||t===void 0?void 0:t.getCell({rowIndex:e.rowIndex,columnIndex:n})}getFocusedView(){return this.getView("columnHeadersView")}focusinHandler(e){this._updateFocusedCellPosition(h(e.target))}getFocusinSelector(){return".dx-header-row > td"}getFocusableColumns(e,t){const n=this._columnsController.getVisibleColumns(e).filter((s=>!m(s.type)||this._columnsController.isCustomCommandColumn(s)));return m(t)?n.filter((s=>s.ownerBand===t)):n}getContainerBoundingRect(e){const t=re(e.get(0));return{left:t.left,right:t.right}}getScrollPadding(e){const t=re(e.get(0)),i=this.getContainerBoundingRect(e);return{left:i.left-t.left,right:t.right-i.right}}scrollToColumn(e){var t;const i=(t=this.getView("rowsView"))===null||t===void 0?void 0:t.getScrollable();if(!i)return;const n=this.getScrollPadding(h(i.container())),s=Yp(e[0],"horizontal",h(this._columnHeadersView.getContent())[0],i.scrollOffset(),n,this.addWidgetPrefix("table"));i.scrollTo({x:s})}init(){super.init(),this._columnHeadersView=this.getView("columnHeadersView")}canReorderColumn(e,t,i){if(!this._columnHeadersView.isColumnReorderingEnabled(e))return!1;const s=this.getDraggableColumns(e,i),o=e.index===s[0].index,a=e.index===s[s.length-1].index;return t===Ne.Next?!a:!o}getFirstFocusableVisibleIndex(){const e=this.getFocusableColumns();return e!=null&&e.length?this._columnsController.getVisibleIndex(e[0].index):-1}restoreFocus(){const e=this._getFocusedCell();if(ne.isFixedCell(e,this.addWidgetPrefix.bind(this))){super.restoreFocus();return}e.length&&this.isOutsideVisibleArea(e,h(this._columnHeadersView.getContent()))?this.scrollToColumn(e):super.restoreFocus()}needToFocus(){return this.needToRestoreFocus}}const iI=r=>class extends r{handleScroll(e){var t,i;if(super.handleScroll(e),!((t=this._headersKeyboardNavigation)!==null&&t!==void 0&&t.needToFocus()))return;((i=this._columnsController)===null||i===void 0?void 0:i.isNeedToRenderVirtualColumns(e.target.scrollLeft))||this._headersKeyboardNavigation.restoreFocus()}},oE={controllers:{headersKeyboardNavigation:tI,columnFocusDispatcher:Jy},extenders:{views:{columnHeadersView:iI}}},Ar=r=>class extends r{_addStickyColumnBorderLeftClass(e,t,i){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4?arguments[4]:void 0;sm(this._columnsController,t,i,n,s)&&ne.addStickyColumnBorderLeftClass(e,this.addWidgetPrefix.bind(this))}_addStickyColumnBorderRightClass(e,t,i){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4?arguments[4]:void 0;om(this._columnsController,t,i,n,s)&&ne.addStickyColumnBorderRightClass(e,this.addWidgetPrefix.bind(this))}updateBorderCellClasses(e,t,i){const n=this._columnsController,s=this.name==="rowsView",o=nm(n,t,i,s),a=n==null?void 0:n.isFirstColumn(t,i);ne.toggleColumnNoBorderClass(e,o,this.addWidgetPrefix.bind(this)),ne.toggleFirstHeaderClass(e,a,this.addWidgetPrefix.bind(this))}_updateBorderClasses(){const e=this.name==="columnHeadersView";this._getRowElementsCore().not(`.${Xe.detailRow}`).toArray().forEach(((i,n)=>{const s=e?n:null,o=h(i).children("td").toArray();let a=this.getColumns(s);a=ua(this._columnsController,a),o.forEach(((l,d)=>{const c=h(l),u=a[d];u.visibleWidth!==rr&&this.updateBorderCellClasses(c,u,s)}))}))}_renderCore(e){const t=super._renderCore(e),i=this.element(),n=this.hasStickyColumns();return ne.toggleStickyColumnsClass(i,n,this.addWidgetPrefix.bind(this)),n?t.done((()=>{this.setStickyOffsets()})):t}_createCell(e){const{column:t}=e,{rowType:i}=e,n=super._createCell(e),s=this.hasStickyColumns(),o=i==="header"?e.rowIndex:null,a=i==="groupFooter"||i==="totalFooter"||i==="group",l=t.command&&t.command==="expand";if(s&&!ar(this._columnsController,t)&&(this.updateBorderCellClasses(n,t,o),t.fixed)){const d=Mt(this._columnsController,t);if(ne.addStickyColumnClass(n,d,this.addWidgetPrefix.bind(this)),!a&&!l)switch(d){case U.Right:this._addStickyColumnBorderLeftClass(n,t,o,!1,U.Right);break;case U.Sticky:this._addStickyColumnBorderLeftClass(n,t,o,!0),this._addStickyColumnBorderRightClass(n,t,o,!0);break;default:this._addStickyColumnBorderRightClass(n,t,o,!1,U.Left)}}return n}setStickyOffsets(e,t){const i=this._columnsController,n=this.option("rtlEnabled"),s=this.option("showColumnHeaders");let o=this.getColumnWidths(void 0,e),a=this.getColumns(s?e:void 0);a=ua(this._columnsController,a),n&&(a=n?[...a].reverse():a,o=n?[...o].reverse():o),a.forEach(((l,d)=>{if(l.fixed){const c=n?a.length-d-1:d,u=gc(i,a,o,d,t);t&&(t[l.index]=u);const p=mc(u);this.setCellProperties(p,c,e)}}))}setColumnWidths(e){const t=this.hasStickyColumns(),i=this.getController("columnsResizer"),n=i==null?void 0:i.isResizing();super.setColumnWidths(e),t&&n&&this.setStickyOffsets()}_resizeCore(){const e=this.hasStickyColumns(),t=this.getController("adaptiveColumns"),i=t==null?void 0:t.getHidingColumnsQueue();super._resizeCore.apply(this,arguments),e&&(this.setStickyOffsets(),i!=null&&i.length&&this._updateBorderClasses())}hasStickyColumns(){var e;const t=(e=this._columnsController)===null||e===void 0?void 0:e.getStickyColumns();return this.option("columnFixing.legacyMode")!==!0&&!!t.length}},nI=r=>class extends Ar(r){setStickyOffsets(){const e={},t=this._getRows();for(let n=0;n<t.length;n++){var i;const s=(t==null||(i=t[n])===null||i===void 0?void 0:i.rowType)==="filter";super.setStickyOffsets(n,s?void 0:e)}}getContextMenuItems(e){const{column:t}=e,i=this._columnsController,n=this.option("columnFixing");let s=super.getContextMenuItems(e);if(e.row&&e.row.rowType==="header"&&n.enabled===!0&&t&&t.allowFixing){const o=l=>{switch(l.itemData.value){case"none":this._columnsController.columnOption(t.index,"fixed",!1);break;case"left":this._columnsController.columnOption(t.index,{fixed:!0,fixedPosition:"left"});break;case"right":this._columnsController.columnOption(t.index,{fixed:!0,fixedPosition:"right"});break;case"sticky":this._columnsController.columnOption(t.index,{fixed:!0,fixedPosition:"sticky"})}},a=[{text:n.texts.leftPosition,icon:n.icons.leftPosition,value:"left",disabled:t.fixed&&(!t.fixedPosition||t.fixedPosition==="left"),onItemClick:o},{text:n.texts.rightPosition,icon:n.icons.rightPosition,value:"right",disabled:t.fixed&&t.fixedPosition==="right",onItemClick:o}];this.option("columnFixing.legacyMode")!==!0&&!i.isVirtualMode()&&a.push({text:n.texts.stickyPosition,icon:n.icons.stickyPosition,value:"sticky",disabled:t.fixed&&t.fixedPosition===U.Sticky,onItemClick:o}),s=s||[],s.push({text:n.texts.fix,icon:n.icons.fix,beginGroup:!0,items:a},{text:n.texts.unfix,icon:n.icons.unfix,value:"none",disabled:!t.fixed,onItemClick:o})}return s}},sI=r=>class extends Ar(r){_getMasterDetailWidth(){const e=H(this.component.$element())??0,t=y.getComponentBorderWidth(this,this._$element);return e-t-this.getScrollbarWidth()}_renderMasterDetailCell(e,t,i){const n=super._renderMasterDetailCell(e,t,i);if(this.hasStickyColumns()){const s=`.${this.addWidgetPrefix(Xe.detailContainer)}`,o=n.find(s);o.addClass(this.addWidgetPrefix(J.stickyColumnLeft)),on(o,this._getMasterDetailWidth())}return n}_updateMasterDetailWidths(){const e=this._getRowElements().children(`.${Xe.detailCell}`).children(`.${this.addWidgetPrefix(Xe.detailContainer)}`),t=this._getMasterDetailWidth();on(e,`${t}px`)}setStickyOffsets(e,t){super.setStickyOffsets(e,t),this.setStickyOffsetsForGroupCells()}setStickyOffsetsForGroupCells(){const e=this._columnsController.getGroupColumns();let t=this.getColumns(),i=this.getColumnWidths();const n=this._getColumnsCountBeforeGroups(t),s=this.option("rtlEnabled");s&&(t=s?[...t].reverse():t,i=s?[...i].reverse():i);const o=this.getTableElement();e.forEach((a=>{const l=n+a.groupIndex+1,d=s?t.length-l-1:l,c=gc(this._columnsController,t,i,d),u=mc(c),p=o.children().children(".dx-group-row").find(`.dx-group-cell[aria-colindex='${l+1}']`);for(let g=0;g<p.length;g+=1){const _=p.get(g),f=h(_).find(".dx-datagrid-group-row-container").get(0);Object.assign(_.style,u),Object.assign(f.style,u)}}))}_resizeCore(){const e=this.hasStickyColumns();super._resizeCore.apply(this,arguments),e&&this._updateMasterDetailWidths()}_renderCellContent(e,t,i){const n=this.hasStickyColumns(),s=Fo(t),o=Ao(t);if(!n||!(s||o))return super._renderCellContent(e,t,i);const l=h("<div>").toggleClass(this.addWidgetPrefix(J.groupRowContainer),s).toggleClass(this.addWidgetPrefix(Xe.detailContainer),o).appendTo(e);return super._renderCellContent(l,t,i)}_renderGroupSummaryCellsCore(e,t,i,n){super._renderGroupSummaryCellsCore(e,t,i,n);const s=`.${this.addWidgetPrefix(J.stickyColumn)}`;e.parent().find(s).length&&ne.doesGroupCellEndInFirstColumn(e)&&ne.addStickyColumnBorderRightClass(e,this.addWidgetPrefix.bind(this))}_handleScroll(e){const t=this.hasStickyColumns();if(super._handleScroll(e),t){const i=this.getController("editorFactory");if(i.hasOverlayElements()){const s=i.focus();i.focus(s)}}}_scrollToElement(e,t){let i=t;const n=this.getScrollable();if(this.hasStickyColumns()&&n){const o=ne.isFixedCell(e,this.addWidgetPrefix.bind(this));if(!e.is("td")||o)return;const a=e==null?void 0:e.closest("tr"),l=a==null?void 0:a.children();i=ne.getScrollPadding(l,h(n.container()),this.addWidgetPrefix.bind(this))}super._scrollToElement(e,i)}},oI=r=>class extends Ar(r){},rI=r=>class extends r{getSeparatorOffsetX(e){var t;if((t=this._columnHeadersView)===null||t===void 0?void 0:t.hasStickyColumns()){const s=h(this._columnHeadersView.getContent()),o=ne.isFixedCellPinnedToRight(e,s,this.addWidgetPrefix.bind(this));if(this.option("columnResizingMode")==="widget"&&o){var n;return((n=e.offset())===null||n===void 0?void 0:n.left)??0}}return super.getSeparatorOffsetX(e)}_correctColumnIndexForPoint(e,t,i){const n=this.option("rtlEnabled"),s=this.option("columnResizingMode")==="widget",o=Math.max(e.index-1,0),a=i[o],l=this._getNextColumnIndex(o),d=i[l];if(s&&!_c(e,a,d)){const c=h(this._columnHeadersView.getContent());if(ne.isFixedCellPinnedToRight(h(e.item),c,this.addWidgetPrefix.bind(this))){e.columnIndex-=n?1:0;return}}super._correctColumnIndexForPoint(e,t,i)}_needToInvertResizing(e){const t=super._needToInvertResizing(e),i=this.option("columnResizingMode")==="widget";if(!t&&i){const n=h(this._columnHeadersView.getContent());return ne.isFixedCellPinnedToRight(e,n,this.addWidgetPrefix.bind(this))}return t}_generatePointsByColumns(){var e;const t=(e=this._columnHeadersView)===null||e===void 0?void 0:e.hasStickyColumns();super._generatePointsByColumns(t)}_pointCreated(e,t,i){var n;const s=(n=this._columnHeadersView)===null||n===void 0?void 0:n.hasStickyColumns(),o=super._pointCreated(e,t,i);if(s&&t>0&&!o){const l=i[e.index-1],d=this._getNextColumnIndex(e.index-1),c=i[d];return ne.noNeedToCreateResizingPoint(this._columnHeadersView,{point:e,column:l,nextColumn:c},this.addWidgetPrefix.bind(this))}return o}},aI=r=>class extends r{_generatePointsByColumns(e){var t;const i=(t=this._columnHeadersView)===null||t===void 0?void 0:t.hasStickyColumns(),{sourceLocation:n,sourceColumn:s,targetDraggingPanel:o}=e,a=n==="headers"&&(o==null?void 0:o.getName())==="headers";if(i&&a){const l=Mt(this._columnsController,s);switch(!0){case(s.fixed&&l===U.Left):e.columnElements=ne.getLeftFixedCells(e.columnElements,this.addWidgetPrefix.bind(this)),e.startColumnIndex=e.columnElements.eq(0).index();break;case(s.fixed&&l===U.Right):e.columnElements=ne.getRightFixedCells(e.columnElements,this.addWidgetPrefix.bind(this)),e.startColumnIndex=e.columnElements.eq(0).index();break;default:e.columnElements=ne.getNonFixedAndStickyCells(e.columnElements,this.addWidgetPrefix.bind(this)),e.startColumnIndex=e.columnElements.eq(0).index()}}return super._generatePointsByColumns(e,i)}_pointCreated(e,t,i,n){const s=this._columnHeadersView.hasStickyColumns(),o=this._columnHeadersView.getColumnElements(),a=s&&i==="headers"&&(o==null?void 0:o.length)&&(!n.fixed||n.fixedPosition===U.Sticky),l=super._pointCreated(e,t,i,n);return a&&!l?ne.noNeedToCreateReorderingPoint(e,o,h(this._columnHeadersView.getContent()),this.addWidgetPrefix.bind(this)):l}},lI=r=>class extends r{getOverlayContainerIfNeeded(e){const t=this._rowsView.hasStickyColumns(),i=ne.isFixedCell(e,this.addWidgetPrefix.bind(this));if(t&&i)return e.closest(`.${this.addWidgetPrefix(J.stickyColumns)}`)}updateFocusOverlaySize(e,t){this._rowsView.hasStickyColumns()||super.updateFocusOverlaySize(e,t)}getFocusOverlaySize(e){if(this._rowsView.hasStickyColumns()){const i=re(e.get(0)),n=ne.isLastCell(e),s=ne.isFixedCell(e,this.addWidgetPrefix.bind(this));return{width:i.right-i.left+(n||s?0:1),height:i.bottom-i.top}}return super.getFocusOverlaySize(e)}getValidationMessageContainer(e){return this.getOverlayContainerIfNeeded(e)??super.getValidationMessageContainer(e)}getRevertButtonContainer(e){return this.getOverlayContainerIfNeeded(e)??super.getRevertButtonContainer(e)}getFocusOverlayContainer(e){return this.getOverlayContainerIfNeeded(e)??super.getFocusOverlayContainer(e)}overlayPositionedHandler(e,t){const i=this.getView("columnHeadersView"),n=i.hasStickyColumns();if(super.overlayPositionedHandler(e,t),n){const s=h(e.element).closest("td");if(!ne.isFixedCell(s,this.addWidgetPrefix.bind(this))){const o=e.component.$wrapper(),a=e.component.$content(),l=ne.isOutsideVisibleArea(a,h(i.getColumnElements()),h(i.getContent()),this.addWidgetPrefix.bind(this));o.css("zIndex",l?1:(this===null||this===void 0?void 0:this.getOverlayBaseZIndex())??0)}}}updateFocusOverlay(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!t){const i=ne.isFixedCell(e,this.addWidgetPrefix.bind(this));this._$focusOverlay.toggleClass(J.focusedFixedElement,i);const n=xi(e),s=ph(e),o=wy(e);(i||n||s||o)&&this._$focusOverlay.toggleClass(J.focusedFixedElement,!0)}super.updateFocusOverlay(e,t)}},dI=r=>class extends r{resize(){const e=super.resize();return this._columnHeadersView.hasStickyColumns()&&this!==null&&this!==void 0&&this.hasResizeTimeout()&&this._rowsView.setStickyOffsets(),e}},cI=r=>class extends r{getContainerBoundingRect(e){var t;if((t=this._columnHeadersView)===null||t===void 0?void 0:t.hasStickyColumns()){const n=h(this._columnHeadersView.getColumnElements());return ne.getNonFixedAreaBoundingRect(n,e,this.addWidgetPrefix.bind(this))}return super.getContainerBoundingRect(e)}tabKeyHandler(e){var t,i;let{originalEvent:n,shift:s}=e;const o=(t=this._columnHeadersView)===null||t===void 0?void 0:t.hasStickyColumns(),a=(i=this.getView("rowsView"))===null||i===void 0?void 0:i.getScrollable();if(!o||!a)return;const l=h(n.target).closest("td"),d=ne.getNextHeaderCell(l,s?"previous":"next");if(ne.isFixedCell(d,this.addWidgetPrefix.bind(this)))return;d.length&&this.isOutsideVisibleArea(d,h(this._columnHeadersView.getContent()))&&this.scrollToColumn(d)}},rE={extenders:{views:{columnHeadersView:nI,rowsView:sI,footerView:oI},controllers:{columnsResizer:rI,draggingHeader:aI,editorFactory:lI,resizing:dI,headersKeyboardNavigation:cI}}},uI="dx-master-detail-row",ft=function(r){let e=-1;return x(r,((t,i)=>{if(i.command==="transparent")return e=t,!1})),e},vh=function(r,e,t){let i=0;if(r&&e&&t)for(let n=0;n<r.length;n++)r[n].command==="transparent"?i+=r[n].colspan:(e[i]<t[n]&&(e[i]=t[n]),i++);return e},Pr=r=>class extends r{init(){super.init(),this._isFixedTableRendering=!1,this._isFixedColumns=!1}_createCol(e){return super._createCol(e).toggleClass("dx-col-fixed",!!(this._isFixedTableRendering&&(e.fixed||e.command&&e.command!=="transparent")))}isIndicesArray(e){return Array.isArray(e)&&e.length>0}_correctColumnIndicesForFixedColumns(e,t){var i;const n=t==null?void 0:t.columnIndices;if(!this.isIndicesArray(n))return;const s=ft(e),o=e[s].colspan,a=s+o,l=t==null||(i=t.items)===null||i===void 0?void 0:i.map((d=>{let{rowType:c}=d;return c}));t.columnIndices=n.map(((d,c)=>this.isIndicesArray(d)?l&&l[c]==="group"?[...d]:d.reduce(((p,g)=>{switch(!0){case g<s:p.push(g);break;case g>=a:p.push(g-o+1)}return p}),[]):d))}_partialUpdateFixedTable(e,t){const i=this._fixedTableElement,n=this._getRowElementsCore(i);i.children("colgroup").replaceWith(this._createColGroup(e));for(let o=0;o<t.length;o++)this._partialUpdateFixedRow(h(n[o]),e,t[o])}_partialUpdateFixedRow(e,t,i){const n=e.get(0).childNodes,s=ft(t),o=t[s],a=this._columnsController.getColumnIndexOffset();let l,d=a+1,{colspan:c}=o;if(e.hasClass(uI)){var u;n[0].setAttribute("colspan",(u=this._columnsController.getVisibleColumns())===null||u===void 0?void 0:u.length);return}if(e.hasClass("dx-group-row"))if(l=this._getGroupCellOptions({row:i,columns:this._columnsController.getVisibleColumns()}),i.summaryCells.length>0){const g=this._getAlignByColumnCellCount(l.colspan,{columns:this._columnsController.getVisibleColumns(),row:i,isFixed:!0});c=l.colspan-g}else c=l.colspan-Math.max(0,n.length-(l.columnIndex+2));for(let p=0;p<n.length;p++){const g=l?p===l.columnIndex+1:p===s;n[p].setAttribute("aria-colindex",d),g?(n[p].setAttribute("colspan",c),d+=c):d++}}_renderTable(e){let t;const i=this.getFixedColumns();this._isFixedColumns=this.isFixedColumns();const n=super._renderTable(e);if(this._isFixedColumns){var s;const a=e==null?void 0:e.change,l=this._getRowElements(this._fixedTableElement),d=(a==null?void 0:a.virtualColumnsScrolling)&&l.length===(a==null||(s=a.items)===null||s===void 0?void 0:s.length);if(this._isFixedTableRendering=!0,d&&this.option("scrolling.legacyMode")!==!0){var o;this._partialUpdateFixedTable(i,e==null||(o=e.change)===null||o===void 0?void 0:o.items),this._isFixedTableRendering=!1}else{const c=a==null?void 0:a.columnIndices;this._correctColumnIndicesForFixedColumns(i,a),t=this._createTable(i),this._renderRows(t,b({},e,{columns:i})),this._updateContent(t,a,!0),c&&(a.columnIndices=c),this._isFixedTableRendering=!1}}else this._fixedTableElement&&this._fixedTableElement.parent().remove(),this._fixedTableElement=null;return n}_renderRow(e,t){let i,{cells:n}=t.row;if(super._renderRow.apply(this,arguments),this._isFixedTableRendering&&n&&n.length){i=0;const s=t.row.cells||[];n=n.slice(),t.row.cells=n;for(let o=0;o<s.length;o++){if(s[o].column&&s[o].column.command==="transparent"){i=(s[o].column.colspan||1)-1;continue}n[o+i]=s[o]}}}_createCell(e){const t=this,{column:i}=e,n=i&&i.command,{rowType:s}=e,o=super._createCell.apply(t,arguments);let a,l,d;(t._isFixedTableRendering||s==="filter")&&(a=t.getFixedColumns(),d=ft(a),l=a[d-1]),t._isFixedTableRendering?n==="transparent"&&(o.addClass("dx-pointer-events-none").toggleClass("dx-first-cell",d===0||l&&l.command==="expand").toggleClass("dx-last-cell",a.length&&d===a.length-1),s!=="freeSpace"&&y.setEmptyText(o)):s==="filter"&&o.toggleClass("dx-first-cell",e.columnIndex===d);const c=t.option("rowAlternationEnabled")&&e.isAltRow,u=t.option("selection.mode")==="multiple"&&e.columnIndex===0&&e.rowType==="header";return me.mozilla&&e.column.fixed&&e.rowType!=="group"&&!c&&!u&&o.addClass("dx-col-fixed"),o}_wrapTableInScrollContainer(e,t){const i=super._wrapTableInScrollContainer.apply(this,arguments);return(this._isFixedTableRendering||t)&&i.addClass(this.addWidgetPrefix("content-fixed")),i}_renderCellContent(e,t){let i;const{column:n}=t,s=this._isFixedTableRendering,o=t.rowType==="group"&&m(n.groupIndex);if(s&&o&&!n.command&&!n.groupCellTemplate&&e.css("pointerEvents","none"),!s&&this._isFixedColumns){if(i=n.fixed||n.command&&n.fixed!==!1,o&&(i=!1,t.row.summaryCells&&t.row.summaryCells.length)){var a;const l=this._columnsController.getVisibleColumns(),d=((a=this._getAlignByColumnCellCount)===null||a===void 0?void 0:a.call(this,n.colspan,{columns:l,row:t.row,isFixed:!0}))??0;if(d>0){const c=ft(this._columnsController.getFixedColumns());i=l.length-d<c}}if(i){if(n.command&&n.type!=="buttons"||t.rowType==="group"){e.html("&nbsp;").addClass(n.cssClass);return}e.addClass("dx-hidden-cell")}}n.command!=="transparent"&&super._renderCellContent.apply(this,arguments)}getContent(e){var t;return e?(t=this._fixedTableElement)===null||t===void 0?void 0:t.parent():super.getContent.apply(this,arguments)}_getCellElementsCore(e){const t=super._getCellElementsCore.apply(this,arguments),i=t==null?void 0:t.parent().hasClass("dx-group-row"),n=this.name==="columnHeadersView"?e:void 0;if(this._fixedTableElement&&t){const s=this.getFixedColumns(n),o=this._getRowElements(this._fixedTableElement).eq(e).children("td");x(o,((a,l)=>{if(i)t[a]&&l.style.visibility!=="hidden"&&(t[a]=l);else{const d=s[a];if(d)if(d.command==="transparent")o.eq(a).hasClass("dx-master-detail-cell")&&(t[a]=l||t[a]);else{const c=this._columnsController.getVisibleIndexByColumn(d,n);t[c]=l||t[c]}}}))}return t}getColumnWidths(e,t){const i=super.getColumnWidths(e,t),n=this.getFixedColumns(),s=this._fixedTableElement&&i.length?super.getColumnWidths(this._fixedTableElement):void 0;return vh(n,i,s)}getTableElement(e){return e=this._isFixedTableRendering||e,e?this._fixedTableElement:super.getTableElement()}setTableElement(e,t){this._isFixedTableRendering||t?this._fixedTableElement=e.addClass("dx-pointer-events-none"):super.setTableElement(e)}getColumns(e){const t=this.getTableElement();return this._isFixedTableRendering?this.getFixedColumns(e):super.getColumns(e,t)}getRowIndex(e){const t=this._fixedTableElement;return t&&t.find(e).length?this._getRowElements(t).index(e):super.getRowIndex(e)}getTableElements(){let e=super.getTableElements.apply(this,arguments);return this._fixedTableElement&&(e=h([e.get(0),this._fixedTableElement.get(0)])),e}getFixedColumns(e){return this._columnsController.getFixedColumns(e)}getFixedColumnsOffset(){let e={left:0,right:0},t;if(this._fixedTableElement){t=this.getTransparentColumnElement();const i=t.position();e={left:i.left,right:ge(this.element(),!0)-(ge(t,!0)+i.left)}}return e}getTransparentColumnElement(){return this._fixedTableElement&&this._fixedTableElement.find(".dx-pointer-events-none").first()}getFixedTableElement(){return this._fixedTableElement}_resizeCore(){super._resizeCore(),this.synchronizeRows()}setColumnWidths(e){var t;const{widths:i}=e,n=this._columnsController.getVisibleColumns(),s=(i==null?void 0:i.length)&&n.some((d=>m(d.visibleWidth))),o=(t=e.optionNames)===null||t===void 0?void 0:t.width;if(super.setColumnWidths(e),this._fixedTableElement){const u=(i==null?void 0:i.some((p=>p==="auto"||!m(p))))&&(!s||!this.isScrollbarVisible(!0))?n:this.getFixedColumns();this.setFixedTableColumnWidths(u,i)}const a=this.option("wordWrapEnabled");(s||o&&a)&&this.synchronizeRows()}setFixedTableColumnWidths(e,t){if(!this._fixedTableElement||!t)return;const i=this._fixedTableElement.children("colgroup").children("col");i.toArray().forEach((s=>s.removeAttribute("style")));let n=0;e.forEach((s=>{if(s.colspan){n+=s.colspan;return}const o=cc(t[n]);m(o)&&Co(i.eq(n),o),n+=1}))}_getClientHeight(e){const t=e.getBoundingClientRect&&re(e);return t&&t.height?t.height:e.clientHeight}synchronizeRows(){const e=[],t=[];let i,n,s,o;this.waitAsyncTemplates(!0).done((()=>{if(this._isFixedColumns&&this._tableElement&&this._fixedTableElement){const a=this._getClientHeight(this._tableElement.get(0)),l=this._getClientHeight(this._fixedTableElement.get(0));if(n=this._getRowElements(this._tableElement),s=this._getRowElements(this._fixedTableElement),o=this._findContentElement(),a!==l){for(o&&o.css("height",a),n.css("height",""),s.css("height",""),i=0;i<n.length;i++)e.push(this._getClientHeight(n.get(i))),t.push(this._getClientHeight(s.get(i)));for(i=0;i<n.length;i++){const d=e[i],c=t[i];d>c?s.eq(i).css("height",d):d<c&&n.eq(i).css("height",c)}o&&o.css("height","")}}}))}setScrollerSpacing(e,t){const i=this.option("rtlEnabled");super.setScrollerSpacing(e),this.element().children(`.${this.addWidgetPrefix("content-fixed")}`).css({paddingLeft:i?e:"",paddingRight:i?"":e})}isFixedColumns(){const e=this.getFixedColumns();return this.option("columnFixing.legacyMode")===!0&&!!e.length}},hI=r=>class extends Pr(r){_getRowVisibleColumns(e){return this._isFixedTableRendering?this.getFixedColumns(e):super._getRowVisibleColumns(e)}getFixedColumnElements(e){const t=this;if(!this._isFixedColumns)return;if(m(e))return this._fixedTableElement&&this._getRowElements(this._fixedTableElement).eq(e).children();const i=t.getColumnElements(),n=t.getTransparentColumnElement();if(i&&n&&n.length){var s;const o=ft(t.getFixedColumns());[].splice.apply(i,[o,(s=n.get(0))===null||s===void 0?void 0:s.colSpan,n.get(0)])}return i}getColumnWidths(e,t){const i=this;let n;const s=super.getColumnWidths(e,t),o=i.getFixedColumnElements(),a=i.getFixedColumns();return i._fixedTableElement&&(o&&o.length?n=i._getWidths(o):n=super.getColumnWidths(i._fixedTableElement)),vh(a,s,n)}},pI=r=>class extends Pr(r){dispose(){super.dispose.apply(this,arguments),clearTimeout(this._fixedScrollTimeout)}optionChanged(e){super.optionChanged(e),e.name==="hoverStateEnabled"&&this._isFixedColumns&&(e.value?this._attachHoverEvents():this._detachHoverEvents())}_detachHoverEvents(){const e=this.element();this._fixedTableElement&&this._tableElement&&v.off(e,"mouseover mouseout",".dx-data-row")}_attachHoverEvents(){this._fixedTableElement&&this._tableElement&&v.on(this.element(),"mouseover mouseout",".dx-data-row",this.createAction((e=>{const{event:t}=e,i=this.getRowIndex(h(t.target).closest(".dx-row")),n=t.type==="mouseover";i>=0&&(this._tableElement&&this._getRowElements(this._tableElement).eq(i).toggleClass("dx-state-hover",n),this._fixedTableElement&&this._getRowElements(this._fixedTableElement).eq(i).toggleClass("dx-state-hover",n))})))}_getScrollDelay(){var e;return((e=this._resizingController)===null||e===void 0?void 0:e.hasResizeTimeout())?this.option("scrolling.updateTimeout"):me.mozilla?60:0}_findContentElement(e){let t,i;const n=this.addWidgetPrefix("content"),s=this.element();if(e=this._isFixedTableRendering||e,s&&e){t=s.children(`.${n}`);const o=this.getScrollable();return!t.length&&o&&(t=h("<div>").addClass(n),v.on(t,"scroll",(a=>{const{target:l}=a,d=this._getScrollDelay();clearTimeout(this._fixedScrollTimeout),this._fixedScrollTimeout=setTimeout((()=>{i=h(l).scrollTop(),o.scrollTo({y:i})}),d)})),v.on(t,jh,(a=>{const l=h(a.target).closest(".dx-scrollable");let d=!1;if(o&&o.$element().is(l))d=!0;else{const c=l.length&&it.getInstance(l.get(0)),u=c&&c.scrollHeight()-c.clientHeight()>0;d=c&&!u}if(d){i=o.scrollTop(),o.scrollTo({y:i-a.delta});const c=o.scrollTop()+o.clientHeight(),u=o.scrollHeight()+this.getScrollbarWidth();if(o.scrollTop()>0&&c<u)return!1}})),t.appendTo(s)),t}return super._findContentElement()}_updateScrollable(){super._updateScrollable();const e=this.getScrollable();if(e!=null&&e._disposed)return;const t=e&&e.scrollOffset().top;this._updateFixedTablePosition(t)}_renderContent(e,t,i){return this._isFixedTableRendering||i?e.empty().addClass(`${this.addWidgetPrefix("content")} ${this.addWidgetPrefix("content-fixed")}`).append(t):super._renderContent(e,t)}_getGroupCellOptions(e){return this._isFixedTableRendering?super._getGroupCellOptions(b({},e,{columns:this._columnsController.getVisibleColumns()})):super._getGroupCellOptions(e)}_renderGroupedCells(e,t){return super._renderGroupedCells(e,b({},t,{columns:this._columnsController.getVisibleColumns()}))}_renderGroupSummaryCells(e,t){this._isFixedTableRendering?super._renderGroupSummaryCells(e,b({},t,{columns:this._columnsController.getVisibleColumns()})):super._renderGroupSummaryCells(e,t)}_hasAlignByColumnSummaryItems(e,t){const i=super._hasAlignByColumnSummaryItems.apply(this,arguments),n=t.columns[e];return t.isFixed?n.fixed&&(i||n.fixedPosition==="right"):i&&(!this._isFixedColumns||!n.fixed)}_renderGroupSummaryCellsCore(e,t,i,n){let s;if(this._isFixedTableRendering){t.isFixed=!0,s=this._getAlignByColumnCellCount(i,t),t.isFixed=!1;const o=t.columns.length-s;t=b({},t,{columns:this.getFixedColumns()});const a=ft(t.columns);o<a?(s-=t.columns[a].colspan-1||0,i-=t.columns[a].colspan-1||0):n>0&&e.css("visibility","hidden"),n=s}super._renderGroupSummaryCellsCore(e,t,i,n)}_getSummaryCellIndex(e,t){if(this._isFixedTableRendering){const i=ft(t);return e>i&&(e+=t[i].colspan-1),e}return super._getSummaryCellIndex.apply(this,arguments)}_renderCore(e){this._detachHoverEvents();const t=super._renderCore(e),i=this._isFixedColumns;return this.element().toggleClass("dx-fixed-columns",i),this.option("hoverStateEnabled")&&i&&this._attachHoverEvents(),t}setAriaOwns(e,t,i){if(i){var n;const s=this.addWidgetPrefix("content-fixed"),o=(n=this.element())===null||n===void 0?void 0:n.children(`.${s}`),a=this.getFixedTableElement();o.length&&a!==null&&a!==void 0&&a.length&&this.setAria("owns",`${e??""} ${a.attr("id")??""} ${t??""}`.trim(),o)}else super.setAriaOwns.apply(this,arguments)}toggleDraggableColumnClass(e,t){if(super.toggleDraggableColumnClass(e,t),this.isFixedColumns()){const i=this._getRowElements(this._fixedTableElement);this._toggleDraggableSourceColumnClass(i,this.getFixedColumns(),e,t)}}getCellIndex(e){const t=this._fixedTableElement;let i=0;if(t&&e.is("td")&&e.closest(t).length){const n=this.getFixedColumns();return x(n,((s,o)=>{if(s===e[0].cellIndex)return!1;if(o.colspan){i+=o.colspan;return}i++})),i}return super.getCellIndex.apply(this,arguments)}_updateFixedTablePosition(e,t){if(this._fixedTableElement&&this._tableElement){let i;this._fixedTableElement.parent().scrollTop(e),t&&this._editorFactoryController&&(i=this._editorFactoryController.focus(),i&&this._editorFactoryController.focus(i))}}setScrollerSpacing(e,t){const i=this,n={marginBottom:0},s=i.element().children(`.${this.addWidgetPrefix("content-fixed")}`);s.length&&i._fixedTableElement&&(s.css(n),i._fixedTableElement.css(n),n[i.option("rtlEnabled")?"marginLeft":"marginRight"]=e,n.marginBottom=t,(i._scrollable&&i._scrollable.option("useNative")?s:i._fixedTableElement).css(n))}_getElasticScrollTop(e){let t=0;if(e.scrollOffset.top<0)t=-e.scrollOffset.top;else if(e.reachedBottom){const i=h(e.component.content()),n=h(e.component.container()),s=Math.max(i.get(0).clientHeight-n.get(0).clientHeight,0);t=Math.min(s-e.scrollOffset.top,0)}return Math.floor(t)}_applyElasticScrolling(e){if(this._fixedTableElement){const t=this._getElasticScrollTop(e);Math.ceil(t)!==0?jt(this._fixedTableElement,{top:t}):this._fixedTableElement.css("transform","")}}_handleScroll(e){this._updateFixedTablePosition(e.scrollOffset.top,!0),this._applyElasticScrolling(e),super._handleScroll(e)}_updateContentPosition(e){super._updateContentPosition.apply(this,arguments),e||this._updateFixedTablePosition(this._scrollTop)}_afterRowPrepared(e){this._isFixedTableRendering||super._afterRowPrepared(e)}_scrollToElement(e,t){const i=this.isFixedColumns()?this.getFixedColumnsOffset():t;super._scrollToElement(e,i)}},gI=r=>class extends Pr(r){},mI=function(r,e,t){const i=ft(e),n=r.length-e.length;return x(t,((s,o)=>{o.index>i&&(o.columnIndex+=n,o.index+=n)})),t},_I=r=>class extends r{_generatePointsByColumns(e,t){const i=e.columns,{targetDraggingPanel:n}=e;if(n&&n.getName()==="headers"&&n.isFixedColumns()&&e.sourceColumn.fixed){e.rowIndex||(e.columnElements=n.getFixedColumnElements(0)),e.columns=n.getFixedColumns(e.rowIndex);const s=super._generatePointsByColumns(e,t);return mI(i,e.columns,s),s}return super._generatePointsByColumns(e,t)}_pointCreated(e,t,i,n){const s=super._pointCreated.apply(this,arguments),o=t[e.columnIndex],a=this._columnHeadersView.getTransparentColumnElement();if(!s&&i==="headers"&&a&&a.length){const l=re(a.get(0));return n&&n.fixed?n.fixedPosition==="right"?e.x<l.right:e.x>l.left:o&&o.fixed&&o.fixedPosition!=="right"?!0:e.x<l.left||e.x>l.right}return s}},fI=r=>class extends r{_generatePointsByColumns(e){const t=this,i=t._columnsController,n=i&&t._columnsController.getVisibleColumns(),s=i&&t._columnsController.getFixedColumns(),o=ft(s),a=n.length-s.length,l=t._columnHeadersView.getFixedColumnElements();super._generatePointsByColumns(e),l&&l.length>0&&(t._pointsByFixedColumns=y.getPointsByColumns(l,(d=>(d.index>o&&(d.columnIndex+=a,d.index+=a),t._pointCreated(d,n.length,n)))))}_getTargetPoint(e,t,i){const n=this._columnHeadersView.getTransparentColumnElement();if(n&&n.length){const s=re(n.get(0));if(t<=s.left||t>=s.right)return super._getTargetPoint(this._pointsByFixedColumns,t,i)}return super._getTargetPoint(e,t,i)}},CI=r=>class extends r{_setAriaOwns(){var e,t,i;super._setAriaOwns.apply(this,arguments);const n=(e=this._columnHeadersView)===null||e===void 0?void 0:e.getFixedTableElement(),s=(t=this._footerView)===null||t===void 0?void 0:t.getFixedTableElement();(i=this._rowsView)===null||i===void 0||i.setAriaOwns(n==null?void 0:n.attr("id"),s==null?void 0:s.attr("id"),!0)}},vI=r=>class extends r{_toggleInertAttr(e){var t;const i=(t=this._rowsView)===null||t===void 0?void 0:t.getFixedContentElement();e?i==null||i.attr("inert",!0):i==null||i.removeAttr("inert")}},xI=r=>class extends r{getValidationMessageContainer(e){return this._rowsView.isFixedColumns()?this._rowsView.element():super.getValidationMessageContainer(e)}},aE={defaultOptions:()=>({columnFixing:{enabled:!1,legacyMode:!1,texts:{fix:w.format("dxDataGrid-columnFixingFix"),unfix:w.format("dxDataGrid-columnFixingUnfix"),leftPosition:w.format("dxDataGrid-columnFixingLeftPosition"),rightPosition:w.format("dxDataGrid-columnFixingRightPosition"),stickyPosition:w.format("dxDataGrid-columnFixingStickyPosition")},icons:{fix:"fix-column",unfix:"unfix-column",leftPosition:"fix-column-left",rightPosition:"fix-column-right",stickyPosition:"stick-column"}}}),extenders:{views:{columnHeadersView:hI,rowsView:pI,footerView:gI},controllers:{draggingHeader:_I,columnsResizer:fI,resizing:CI,keyboardNavigation:vI,editorFactory:xI}}},xh="rowsView",wI="footerView",mo=["columnHeadersView",xh,wI],bI="dxDataGridAdaptivity",wh="dxDataGrid-ariaAdaptiveExpand",yI="dxDataGrid-ariaAdaptiveCollapse",II="scrolling.legacyMode";function kn(r,e){return r._columnsController.getColumnId(e)}function SI(r){return r.find("td:not(.dx-datagrid-hidden-column):not([class*='dx-command-'])")}function EI(r,e){let t;const i=h(r),n=e.component.getController("adaptiveColumns");e.rowType==="data"?(t=h("<span>").addClass(n.addWidgetPrefix("adaptive-more")),v.on(t,V(Q,bI),n.createAction((()=>{n.toggleExpandAdaptiveDetailRow(e.key)}))),t.appendTo(i)):y.setEmptyText(i)}function Zo(r){var e;const t=(e=r.data)===null||e===void 0?void 0:e.$nextCell;v.off(t,"focus",Zo),v.trigger(t,"dxclick")}class TI extends j.ViewController{init(){this._columnsController=this.getController("columns"),this._dataController=this.getController("data"),this._editingController=this.getController("editing"),this._keyboardNavigationController=this.getController("keyboardNavigation"),this._rowsView=this.getView("rowsView"),this._columnsController.addCommandColumn({type:"adaptive",command:"adaptive",visible:!0,adaptiveHidden:!0,cssClass:"dx-command-adaptive",alignment:"center",width:"auto",cellTemplate:EI,fixedPosition:"right"}),this._columnsController.columnsChanged.add((()=>{const e=!!this.updateHidingQueue(this._columnsController.getColumns()).length;this._columnsController.columnOption("command:adaptive","adaptiveHidden",!e,!0)})),this._hidingColumnsQueue=[],this._hiddenColumns=[],this.createAction("onAdaptiveDetailRowPreparing"),super.init()}optionChanged(e){e.name==="columnHidingEnabled"&&this._columnsController.columnOption("command:adaptive","adaptiveHidden",!e.value),super.optionChanged(e)}publicMethods(){return["isAdaptiveDetailRowExpanded","expandAdaptiveDetailRow","collapseAdaptiveDetailRow"]}_isRowEditMode(){return this._getEditMode()==="row"}_isItemModified(e,t){const i=this._columnsController.getVisibleIndex(e.column.index),n=this._dataController.getRowIndexByKey(t.key),s=this._dataController.items()[n+1];return s&&s.modifiedValues&&m(s.modifiedValues[i])}_renderFormViewTemplate(e,t,i){const n=this,{column:s}=e,o=n.createAction((()=>{n._editingController.isEditing()&&v.trigger(i,Q)})),a=t.row.data,l=s.calculateCellValue(a),d=y.getDisplayValue(s,l,a,t.rowType),c=y.formatValue(d,s),u=this._editingController.isCellOrBatchEditMode(),p=n._rowsView;if(s.allowEditing&&this._keyboardNavigationController.isKeyboardEnabled()&&(i.attr("tabIndex",n.option("tabIndex")),u&&(v.off(i,"focus",o),v.on(i,"focus",o))),s.cellTemplate){const g=b({},t,{value:l,displayValue:d,text:c,column:s});p.renderTemplate(i,s.cellTemplate,g,un(i)).done((()=>{p._cellPrepared(i,t)}))}else{const g=i.get(0);s.encodeHtml?g.textContent=c:g.innerHTML=c,i.addClass("dx-adaptive-item-text"),(!m(c)||c==="")&&i.html("&nbsp;"),n._isRowEditMode()||n._isItemModified(e,t)&&i.addClass("dx-item-modified"),p._cellPrepared(i,t)}}_getTemplate(e,t,i){const n=this,{column:s}=e,o=this._editingController;return function(a,l){const d=h(l),c=n._columnsController.getVisibleIndex(s.index),u=b({},t),p=function(){const g=n._isItemEdited(e);u.value=t.row.values[c],g||s.showEditorAlways?o.renderFormEditorTemplate(u,e,a,d,!g):(u.column=s,u.columnIndex=c,n._renderFormViewTemplate(e,u,d))};if(p(),u.watch){const g=u.watch((()=>({isItemEdited:n._isItemEdited(e),value:t.row.values[c]})),(()=>{d.contents().remove(),d.removeClass("dx-adaptive-item-text"),p()}));v.on(d,ii,g)}}}_isVisibleColumnsValid(e){return!(e<2||e.length-(function(){let t=0;for(let i=0;i<e.length;i++)e[i].command&&t++;return t})()<=1)}_calculatePercentWidths(e,t){const i=this;let n=0;return t.forEach(((s,o)=>{e[o]!=="adaptiveHidden"&&(n+=i._getItemPercentWidth(s))})),n}_isPercentWidth(e){return W(e)&&e.endsWith("%")}_isColumnHidden(e){return this._hiddenColumns.filter((t=>t.index===e.index)).length>0}_getAverageColumnsWidth(e,t,i){const n=this;let s=0,o=0;return t.forEach((a=>{if(!n._isColumnHidden(a)){const{width:l}=a;m(l)&&!isNaN(parseFloat(l))?s+=n._isPercentWidth(l)?n._calculatePercentWidth({visibleIndex:a.visibleIndex,columnsCount:t.length,columnsCanFit:i,bestFitWidth:a.bestFitWidth,columnWidth:l,containerWidth:e}):parseFloat(l):o++}})),(e-s)/o}_calculateColumnWidth(e,t,i,n){const s=kn(this,e),o=this._columnsController.columnOption(s,"width"),a=this._columnsController.columnOption(s,"bestFitWidth"),l=i.length;let d;if(o&&o!=="auto")if(this._isPercentWidth(o))d=this._calculatePercentWidth({visibleIndex:e.visibleIndex,columnsCount:l,columnsCanFit:n,bestFitWidth:a,columnWidth:o,containerWidth:t});else return parseFloat(o);else d=this.option("columnAutoWidth")||e.command?a:this._getAverageColumnsWidth(t,i,n);return d}_calculatePercentWidth(e){const t=e.visibleIndex<e.columnsCount-1&&e.columnsCanFit,i=e.containerWidth*parseFloat(e.columnWidth)/100,n=e.columnsCanFit&&i<e.bestFitWidth?e.bestFitWidth:i;return t?e.containerWidth*parseFloat(e.columnWidth)/100:n}_getNotTruncatedColumnWidth(e,t,i,n){const s=kn(this,e),o=this._columnsController.columnOption(s,"width"),a=this._columnsController.columnOption(s,"bestFitWidth");if(o&&o!=="auto"&&!this._isPercentWidth(o))return parseFloat(o);const l=this._calculateColumnWidth(e,t,i,n);return l<a?null:l}_getItemPercentWidth(e){let t=0;return e.width&&this._isPercentWidth(e.width)&&(t=parseFloat(e.width)),t}_getCommandColumnsWidth(){const e=this,t=e._columnsController.getVisibleColumns();let i=0;return x(t,((n,s)=>{(s.index<0||s.command)&&(i+=e._columnsController.columnOption(kn(e,s),"bestFitWidth")||0)})),i}_isItemEdited(e){if(this.isFormOrPopupEditMode())return!1;if(this._isRowEditMode()){const t=this.option("editing.editRowKey");if(ae(t,this._dataController.adaptiveExpandedKey()))return!0}else{const t=this._dataController.getRowIndexByKey(this._dataController.adaptiveExpandedKey())+1,i=this._columnsController.getVisibleIndex(e.column.index);return this._editingController.isEditCell(t,i)}}_getFormItemsByHiddenColumns(e){const t=[];return x(e,((i,n)=>{t.push({column:n,name:n.name,dataField:n.dataField,visibleIndex:n.visibleIndex})})),t}_getAdaptiveColumnVisibleIndex(e){for(let t=0;t<e.length;t++)if(e[t].command==="adaptive")return t}_hideAdaptiveColumn(e,t){const i=this._getAdaptiveColumnVisibleIndex(t);m(i)&&(e[i]="adaptiveHidden",this._hideVisibleColumn({isCommandColumn:!0,visibleIndex:i}))}_showHiddenCellsInView(e){let{$cells:t,isCommandColumn:i}=e,n=this.addWidgetPrefix("hidden-column");i?(n="dx-command-adaptive-hidden",t.attr({tabIndex:0,"aria-hidden":null}).removeClass(n)):t.removeClass(n)}_showHiddenColumns(){for(let e=0;e<mo.length;e++){const t=this.getView(mo[e]);if(t&&t.isVisible()&&t.element()){const i=t.name,n=t.element().find(".dx-command-adaptive-hidden");this._showHiddenCellsInView({viewName:i,$cells:n,isCommandColumn:!0});const s=t.element().find(`.${this.addWidgetPrefix("hidden-column")}`);this._showHiddenCellsInView({viewName:i,$cells:s})}}}_isCellValid(e){return e&&e.length&&!e.hasClass("dx-master-detail-cell")&&!e.hasClass("dx-group-cell")}_hideVisibleColumn(e){let{isCommandColumn:t,visibleIndex:i}=e;const n=this;mo.forEach((s=>{const o=n.getView(s);o&&n._hideVisibleColumnInView({view:o,isCommandColumn:t,visibleIndex:i})}))}_hideVisibleColumnInView(e){let{view:t,isCommandColumn:i,visibleIndex:n}=e;const s=t.name;let o;const a=this._columnsController.getVisibleColumns()[n],l=this._editingController&&this._editingController.getEditFormRowIndex();if(t&&t.isVisible()&&a){const d=t.getRowsCount(),c=t._getRowElements();for(let u=0;u<d;u++)if(!(u===l&&s===xh&&this.option("editing.mode")!=="popup")){const g=s==="columnHeadersView"?this._columnsController.getVisibleIndex(a.index,u):n;if(g>=0){const _=c.eq(u);o=this._findCellElementInRow(_,g),this._isCellValid(o)&&this._hideVisibleCellInView({viewName:s,isCommandColumn:i,$cell:o})}}}}_findCellElementInRow(e,t){const i=e.children();let n=t,s=!1;if(e.hasClass("dx-group-row")){const a=e.find(".dx-group-cell"),l=a.attr("colspan");if(a.length&&m(l)){const d=parseInt(l),c=a.index()+d-1;t>c?n=t-d+1:s=!0}}return s?void 0:i.eq(n)}_hideVisibleCellInView(e){let{$cell:t,isCommandColumn:i}=e;const n=i?"dx-command-adaptive-hidden":this.addWidgetPrefix("hidden-column");t.attr({tabIndex:-1,"aria-hidden":!0}).addClass(n)}_getEditMode(){return this._editingController.getEditMode()}isFormOrPopupEditMode(){const e=this._getEditMode();return e==="form"||e==="popup"}hideRedundantColumns(e,t,i){const n=this;if(this._hiddenColumns=[],n._isVisibleColumnsValid(t)&&i.length){let s=0;const o=n.component.$element();let a=H(o)-n._getCommandColumnsWidth();const l=(function(){return t.filter((_=>!_.command&&this._hiddenColumns.filter((f=>f.index===_.index)).length===0))}).bind(this);let d=l();const c=d.length;let u,p,g;do{g=!1,s=0;const _=n._calculatePercentWidths(e,t),f=_<100&&_!==0;for(u=0;u<t.length;u++){const C=t[u];let I=n._getNotTruncatedColumnWidth(C,a,d,f);const E=kn(n,C),D=n._columnsController.columnOption(E,"width"),k=n._columnsController.columnOption(E,"minWidth"),A=n._columnsController.columnOption(E,"bestFitWidth");if(e[u]==="adaptiveHidden"){p=!0;continue}if(!I&&!C.command&&!C.fixed){g=!0;break}(!D||D==="auto")&&(I=Math.max(A||0,k||0)),(C.command!=="adaptive"||p)&&(s+=I)}if(g=g||s>H(o),g){const C=i.pop(),I=n._columnsController.getVisibleIndex(C.index);a+=n._calculateColumnWidth(C,a,d,f),n._hideVisibleColumn({visibleIndex:I}),e[I]="adaptiveHidden",this._hiddenColumns.push(C),d=l()}}while(g&&d.length>1&&i.length);c===d.length&&n._hideAdaptiveColumn(e,t)}else n._hideAdaptiveColumn(e,t)}getAdaptiveDetailItems(){return this._$itemContents}getItemContentByColumnIndex(e){let t;for(let i=0;i<this._$itemContents.length;i++){t=this._$itemContents.eq(i);const n=t.data("dx-form-item");if(n&&n.column&&this._columnsController.getVisibleIndex(n.column.index)===e)return t}}toggleExpandAdaptiveDetailRow(e,t){this.isFormOrPopupEditMode()&&this._editingController.isEditing()||this._dataController.toggleExpandAdaptiveDetailRow(e,t)}createFormByHiddenColumns(e,t){const i=this,n=h(e),s={items:i._getFormItemsByHiddenColumns(i._hiddenColumns),formID:`dx-${new Te}`},o=Fi()?{colCount:2}:{};this.executeAction("onAdaptiveDetailRowPreparing",{formOptions:s}),i._$itemContents=null,i._form=i._createComponent(h("<div>").appendTo(n),yr,b(o,s,{customizeItem(a){const l=a.column||i._columnsController.columnOption(a.name||a.dataField);l&&(a.label=a.label||{},a.label.text=a.label.text||l.caption,a.column=l,a.template=i._getTemplate(a,t,i.updateForm.bind(i))),s.customizeItem&&s.customizeItem.call(this,a)},onContentReady(a){s.onContentReady&&s.onContentReady.call(this,a),i._$itemContents=n.find(".dx-field-item-content")}}))}hasAdaptiveDetailRowExpanded(){return m(this._dataController.adaptiveExpandedKey())}updateForm(e){this.hasAdaptiveDetailRowExpanded()&&this._form&&m(this._form._contentReadyAction)&&(e&&e.length?this._form.option("items",this._getFormItemsByHiddenColumns(e)):this._form.repaint())}updateHidingQueue(e){const t=this,i=e.filter((o=>o.visible&&!o.type&&!o.fixed&&!(m(o.groupIndex)&&o.groupIndex>=0)));let n,s;if(t._hidingColumnsQueue=[],t.option("allowColumnResizing")&&t.option("columnResizingMode")==="widget")return t._hidingColumnsQueue;for(s=0;s<i.length;s++)m(i[s].hidingPriority)&&i[s].hidingPriority>=0&&(n=!0,t._hidingColumnsQueue[i[s].hidingPriority]=i[s]);if(n)t._hidingColumnsQueue.reverse();else if(t.option("columnHidingEnabled"))for(s=0;s<i.length;s++){const o=t._columnsController.getVisibleIndex(i[s].index);t._hidingColumnsQueue[o]=i[s]}return t._hidingColumnsQueue=t._hidingColumnsQueue.filter(Object),t._hidingColumnsQueue}getHiddenColumns(){return this._hiddenColumns}hasHiddenColumns(){return this._hiddenColumns.length>0}getHidingColumnsQueue(){return this._hidingColumnsQueue}isAdaptiveDetailRowExpanded(e){const t=this._dataController;return t.adaptiveExpandedKey()&&ae(t.adaptiveExpandedKey(),e)}expandAdaptiveDetailRow(e){this.hasAdaptiveDetailRowExpanded()||this.toggleExpandAdaptiveDetailRow(e)}collapseAdaptiveDetailRow(){this.hasAdaptiveDetailRowExpanded()&&this.toggleExpandAdaptiveDetailRow()}updateCommandAdaptiveAriaLabel(e,t){const i=this._dataController.getRowIndexByKey(e);if(i===-1)return;const n=h(this.component.getRowElement(i));this.setCommandAdaptiveAriaLabel(n,t)}setCommandAdaptiveAriaLabel(e,t){e.find(".dx-command-adaptive").attr("aria-label",w.format(t))}}const DI=r=>class extends r{_isCellValid(e,t){return super._isCellValid(e,t)&&!e.hasClass(this.addWidgetPrefix("hidden-column"))&&!e.hasClass("dx-command-adaptive-hidden")}_processNextCellInMasterDetail(e,t){super._processNextCellInMasterDetail(e,t);const i=this._editingController.isCellOrBatchEditMode();this._editingController.isEditing()&&e&&i&&!this._isInsideEditForm(e)&&(v.off(e,"focus",Zo),v.on(e,"focus",{$nextCell:e},Zo),v.trigger(t,"focus"))}isFocusableColumn(e){return super.isFocusableColumn(e)&&e.visibleWidth!=="adaptiveHidden"}_isCellElement(e){return super._isCellElement(e)||e.hasClass("dx-adaptive-item-text")}},RI=r=>class extends r{_getCellTemplate(e){const t=this,{column:i}=e;return e.rowType==="detailAdaptive"&&i.command==="detail"?function(n,s){t._adaptiveColumnsController.createFormByHiddenColumns(h(n),s)}:super._getCellTemplate(e)}_createRow(e){const t=super._createRow.apply(this,arguments);return e&&e.rowType==="detailAdaptive"&&e.key===this._dataController.adaptiveExpandedKey()&&t.addClass("dx-adaptive-detail-row"),t}_renderCells(e,t){super._renderCells(e,t);const i=this._adaptiveColumnsController,n=i.getHidingColumnsQueue().length,s=i.getHiddenColumns().length;n&&!s&&SI(e).last().addClass("dx-last-data-cell"),t.row.rowType==="data"&&i.setCommandAdaptiveAriaLabel(e,wh)}_getColumnIndexByElementCore(e){const t=e.closest(".dx-field-item-content");if(t.length&&t.closest(this.component.$element()).length){const i=t.length?t.first().data("dx-form-item"):null;return i&&i.column&&this._columnsController.getVisibleIndex(i.column.index)}return super._getColumnIndexByElementCore(e)}_cellPrepared(e,t){super._cellPrepared.apply(this,arguments),t.row.rowType!=="detailAdaptive"&&t.column.visibleWidth==="adaptiveHidden"&&e.addClass(this.addWidgetPrefix("hidden-column"))}getCell(e,t){const i=this._dataController.items()[e==null?void 0:e.rowIndex];if((i==null?void 0:i.rowType)==="detailAdaptive"){const n=this._adaptiveColumnsController.getAdaptiveDetailItems();return super.getCell(e,t,n)}return super.getCell.apply(this,arguments)}_getCellElement(e,t){const i=this._dataController.items()[e];return i&&i.rowType==="detailAdaptive"?this._adaptiveColumnsController.getItemContentByColumnIndex(t):super._getCellElement.apply(this,arguments)}getContextMenuItems(e){var t;if(e.row&&e.row.rowType==="detailAdaptive"){const i=this._columnHeadersView,n=h(e.targetElement).closest(".dx-field-item-label").next().data("dx-form-item");return e.column=n?n.column:e.column,i.getContextMenuItems&&i.getContextMenuItems(e)}return(t=super.getContextMenuItems)===null||t===void 0?void 0:t.call(this,e)}isClickableElement(e){var t;return(((t=super.isClickableElement)===null||t===void 0?void 0:t.call(this,e))??!1)||!!e.closest(".dx-command-adaptive").length}},VI=r=>class extends r{_updateColumnWidth(e,t){super._updateColumnWidth(e,e.visibleWidth==="adaptiveHidden"?e.bestFitWidth:t)}},OI=r=>class extends r{_pointCreated(e,t,i){const n=super._pointCreated(e,t,i),s=i[e.columnIndex]||{},o=this._getNextColumnIndex(e.columnIndex),a=i[o]||{},l=o!==e.columnIndex+1&&a.command,d=s.visibleWidth==="adaptiveHidden"||l;return n||d}_getNextColumnIndex(e){const t=this._columnsController.getVisibleColumns();let i=super._getNextColumnIndex(e);for(;t[i]&&t[i].visibleWidth==="adaptiveHidden";)i++;return i}},FI=r=>class extends r{_pointCreated(e,t,i,n){const s=super._pointCreated(e,t,i,n),a=(t[e.columnIndex-1]||{}).visibleWidth==="adaptiveHidden";return s||a}},AI=r=>class extends r{_isRowEditMode(){return this.getEditMode()==="row"}_getFormEditItemTemplate(e,t){return this.getEditMode()!=="row"&&e.rowType==="detailAdaptive"?(e.columnIndex=this._columnsController.getVisibleIndex(t.index),this.getColumnTemplate(e)):super._getFormEditItemTemplate(e,t)}_closeEditItem(e){const t=e.closest(".dx-field-item-content"),i=this._dataController.getRowIndexByKey(this._dataController.adaptiveExpandedKey())+1,n=t.length?t.first().data("dx-form-item"):null,s=n&&n.column&&this._columnsController.getVisibleIndex(n.column.index);this.isEditCell(i,s)||super._closeEditItem(e)}_beforeUpdateItems(e,t){if(!this._adaptiveColumnsController.isFormOrPopupEditMode()&&this._adaptiveColumnsController.hasHiddenColumns()){const i=this._dataController.items(),n=i[t],s=y.getIndexByKey(this._dataController.adaptiveExpandedKey(),i);this._isForceRowAdaptiveExpand=!this._adaptiveColumnsController.hasAdaptiveDetailRowExpanded(),s>=0&&e.push(s+1),e.push(t+1),this._dataController.adaptiveExpandedKey(n.key)}}_afterInsertRow(e){super._afterInsertRow.apply(this,arguments),this._adaptiveColumnsController.hasHiddenColumns()&&(this._adaptiveColumnsController.toggleExpandAdaptiveDetailRow(e,this.isRowEditMode()),this._isForceRowAdaptiveExpand=!0)}_collapseAdaptiveDetailRow(){this._isRowEditMode()&&this._isForceRowAdaptiveExpand&&(this._adaptiveColumnsController.collapseAdaptiveDetailRow(),this._isForceRowAdaptiveExpand=!1)}_cancelEditAdaptiveDetailRow(){this._adaptiveColumnsController.hasHiddenColumns()&&this._collapseAdaptiveDetailRow()}_afterSaveEditData(){super._afterSaveEditData.apply(this,arguments);const e=new S;return this._isRowEditMode()&&this._adaptiveColumnsController.hasHiddenColumns()?O(this._validatingController.validate(!0)).done((t=>{t&&this._cancelEditAdaptiveDetailRow(),e.resolve()})):e.resolve(),e.promise()}_beforeCancelEditData(){super._beforeCancelEditData(),this._cancelEditAdaptiveDetailRow()}_getRowIndicesForCascadeUpdating(e){const t=super._getRowIndicesForCascadeUpdating.apply(this,arguments);return this._adaptiveColumnsController.isAdaptiveDetailRowExpanded(e.key)&&t.push(e.rowType==="detailAdaptive"?e.rowIndex-1:e.rowIndex+1),t}_beforeCloseEditCellInBatchMode(e){const t=this._dataController._adaptiveExpandedKey;if(t){const i=y.getIndexByKey(t,this._dataController.items());i>-1&&e.unshift(i)}}editRow(e){return this._adaptiveColumnsController.isFormOrPopupEditMode()&&this._adaptiveColumnsController.collapseAdaptiveDetailRow(),super.editRow(e)}deleteRow(e){const t=this._dataController.getKeyByRowIndex(e);this.getEditMode()==="batch"&&this._adaptiveColumnsController.isAdaptiveDetailRowExpanded(t)&&this._adaptiveColumnsController.collapseAdaptiveDetailRow(),super.deleteRow(e)}},PI=r=>class extends r{init(){super.init(),this._adaptiveExpandedKey=void 0}_processItems(e,t){const{changeType:i}=t;if(e=super._processItems.apply(this,arguments),i==="loadingAll"||!m(this._adaptiveExpandedKey))return e;const n=y.getIndexByKey(this._adaptiveExpandedKey,e),s=this.option(II)===!1;if(n>=0){const o=e[n];e.splice(n+1,0,{visible:!0,rowType:"detailAdaptive",key:o.key,data:o.data,node:o.node,modifiedValues:o.modifiedValues,isNewRow:o.isNewRow,values:o.values})}else i==="refresh"&&!(s&&t.repaintChangesOnly)&&(this._adaptiveExpandedKey=void 0);return e}_getRowIndicesForExpand(e){const t=super._getRowIndicesForExpand.apply(this,arguments);if(this._adaptiveColumnsController.isAdaptiveDetailRowExpanded(e)){const i=t[t.length-1];t.push(i+1)}return t}adaptiveExpandedKey(e){if(m(e))this._adaptiveExpandedKey=e;else return this._adaptiveExpandedKey}toggleExpandAdaptiveDetailRow(e,t){let i=y.getIndexByKey(this._adaptiveExpandedKey,this._items),n=y.getIndexByKey(e,this._items);i>=0&&i===n&&!t&&(e=void 0,n=-1);const s=this._adaptiveExpandedKey;this._adaptiveExpandedKey=e,i>=0&&i++,n>=0&&n++;const o=this.getRowIndexDelta();this.updateItems({allowInvisibleRowIndices:!0,changeType:"update",rowIndices:[i-o,n-o]}),this._adaptiveColumnsController.updateCommandAdaptiveAriaLabel(e,yI),this._adaptiveColumnsController.updateCommandAdaptiveAriaLabel(s,wh)}},kI=r=>class extends r{_needHideBorder(e){return super._needHideBorder(e)||(e==null?void 0:e.hasClass("dx-field-item-content"))&&(e==null?void 0:e.find(".dx-checkbox").length)}_getFocusCellSelector(){return`${super._getFocusCellSelector()}, .dx-adaptive-detail-row .dx-field-item > .dx-field-item-content`}_getRevertTooltipsSelector(){return`${super._getRevertTooltipsSelector()}, .dx-field-item-content .${this.addWidgetPrefix("revert-tooltip")}`}},MI=r=>class extends r{_isColumnVisible(e){return super._isColumnVisible(e)&&!e.adaptiveHidden}getVisibleDataColumnsByBandColumn(e){return super.getVisibleDataColumnsByBandColumn(e).filter((t=>t.visibleWidth!=="adaptiveHidden"))}},BI=r=>class extends r{dispose(){super.dispose.apply(this,arguments),clearTimeout(this._updateScrollableTimeoutID)}_needBestFit(){return super._needBestFit()||!!this._adaptiveColumnsController.getHidingColumnsQueue().length}_correctColumnWidths(e,t){const i=this._adaptiveColumnsController,n=i.getHiddenColumns(),s=i.updateHidingQueue(this._columnsController.getColumns());i.hideRedundantColumns(e,t,s);const o=i.getHiddenColumns();return i.hasAdaptiveDetailRowExpanded()&&n.length!==o.length&&i.updateForm(o),!o.length&&i.collapseAdaptiveDetailRow(),super._correctColumnWidths.apply(this,arguments)}_toggleBestFitMode(e){e&&this._adaptiveColumnsController._showHiddenColumns(),super._toggleBestFitMode(e)}_needStretch(){const e=this._adaptiveColumnsController;return super._needStretch.apply(this,arguments)||e.getHidingColumnsQueue().length||e.hasHiddenColumns()}},NI=r=>class extends r{getColumnVisibleIndexCorrection(e,t,i){let n=super.getColumnVisibleIndexCorrection(e,t,i),s=this._columnsController.getVisibleColumns(t);for(s=i==="next"?s.slice(e+1):s.slice(0,e).reverse();((o=s)===null||o===void 0||(o=o.shift())===null||o===void 0?void 0:o.visibleWidth)==="adaptiveHidden";){var o;n+=i==="next"?1:-1}return n}getFocusableColumns(e,t){return super.getFocusableColumns(e,t).filter((i=>i.visibleWidth!=="adaptiveHidden"))}getDraggableColumns(e,t){return super.getDraggableColumns(e,t).filter((i=>i.visibleWidth!=="adaptiveHidden"))}},lE={defaultOptions:()=>({columnHidingEnabled:!1,onAdaptiveDetailRowPreparing:null}),controllers:{adaptiveColumns:TI},extenders:{views:{rowsView:RI},controllers:{export:VI,columnsResizer:OI,draggingHeader:FI,editing:AI,resizing:BI,data:PI,editorFactory:kI,columns:MI,keyboardNavigation:DI,headersKeyboardNavigation:NI}}};function bh(r,e,t,i,n,s){t=t||0,i=i||[],s=s||[],i[t]=i[t]||0;const o=r[t],a=s[t]+1||0;let l=0,d;if(o){for(d=a;d<o.length;d++){const c=o[d],u=d+i[t],p=c.colspan||1;if(bh(r,e,t+(c.rowspan||1),i,p,s),i[t]+=p-1,l+=p,c.rowspan)for(let g=t+1;g<t+c.rowspan;g++)i[g]=i[g]||0,i[g]+=c.colspan||1;if(e(c,u,t,d)===!1||n!==void 0&&l>=n)break}s[t]=d}}function _o(r,e,t){const i=[];bh(r,((n,s,o)=>{let a=n,l;const d=a.colspan||1,c=s+d-1>=e&&s<t;if(i[o]=i[o]||[],c)s<e?(l=d-(e-s),s=e):l=d,s+l>t&&(l=t-s),l!==d&&(a=b({},a,{colspan:l})),i[o].push(a);else if(s>t)return!1}));for(let n=0;n<i.length;n++)i[n]=i[n]||[];return i}const yh=r=>class extends r{_needToSetCellWidths(){let e=super._needToSetCellWidths();return!e&&this._columnsController.isVirtualMode()&&(e=this._columnsController.getColumns().some((i=>i.width==="auto"))),e}},LI=r=>class extends yh(r){_resizeCore(){super._resizeCore.apply(this,arguments),this._columnsController.resize()}_handleScroll(e){const t=this.getScrollable();let{left:i}=e.scrollOffset;this._scrollLeft=i,super._handleScroll.apply(this,arguments),this.option("rtlEnabled")&&t&&(i=H(t.$content())-H(t.$element())-i),this._columnsController.setScrollPosition(i,e.event)}_renderCore(e){if(e!=null&&e.virtualColumnsScrolling){var t,i;const n=this._findContentElement(),s=(t=this._columnsController)===null||t===void 0?void 0:t.getFixedColumns(),o=(i=this._scrollable)===null||i===void 0?void 0:i.option("useNative"),a=this.option("columnFixing.legacyMode");if(s!=null&&s.length){a&&!o?n.css({minHeight:y.getContentHeightLimit(me)}):n.css({minHeight:X(n)});const l=()=>{this.resizeCompleted.remove(l),n.css({minHeight:""})};this.resizeCompleted.add(l)}}return super._renderCore.apply(this,arguments)}},$I=r=>class extends yh(r){_renderCore(){const e=super._renderCore.apply(this,arguments);return this._columnsController.isVirtualMode()&&this._updateScrollLeftPosition(),e}},Mn=function(r){return r.map((e=>e.visibleWidth||parseFloat(e.width)||50))},HI=r=>class extends r{init(){super.init.apply(this,arguments),this._resizingController=this.getController("resizing"),this._beginPageIndex=null,this._endPageIndex=null,this._position??(this._position=0),this._virtualVisibleColumns={}}dispose(){clearTimeout(this._changedTimeout),super.dispose.apply(this,arguments)}resetColumnsCache(){super.resetColumnsCache(),this._virtualVisibleColumns={}}getBeginPageIndex(e){const t=this.getVisibleColumns(void 0,!0),i=Mn(t);let n=0;for(let s=0;s<i.length;s++){if(n>=e)return Math.floor(s/this.getColumnPageSize());n+=i[s]}return 0}getTotalWidth(){const e=this.option("width");return typeof e=="number"?e:this._resizingController._lastWidth||ge(this.component.$element())}getEndPageIndex(e){const t=this.getVisibleColumns(void 0,!0),i=Mn(t);let n=0;e+=this.getTotalWidth();for(let s=0;s<i.length;s++){if(n>=e)return Math.ceil(s/this.getColumnPageSize());n+=i[s]}return Math.ceil(i.length/this.getColumnPageSize())}getColumnPageSize(){return this.option("scrolling.columnPageSize")}_fireColumnsChanged(e){const t=new Date;this.columnsChanged.fire({optionNames:{all:!0,length:1},changeTypes:{columns:!0,virtualColumnsScrolling:!0,length:2,event:e}}),this._renderTime=new Date-t}getScrollingTimeout(){const e=this.option("scrolling.columnRenderingThreshold"),t=this.option("scrolling.renderAsync");let i=0;return(!m(t)&&this._renderTime>e||t)&&(i=this.option("scrolling.timeout")),i}setScrollPosition(e,t){const i=this.getScrollingTimeout();i>0?(clearTimeout(this._changedTimeout),this._changedTimeout=setTimeout((()=>{this._setScrollPositionCore(e,t)}),i)):this._setScrollPositionCore(e,t)}resize(){this._setScrollPositionCore(this._position)}_setScrollPositionCore(e,t){this.isNeedToRenderVirtualColumns(e)&&(this._position=e,this._beginPageIndex=this.getBeginPageIndex(e),this._endPageIndex=this.getEndPageIndex(e),this._fireColumnsChanged(t))}isNeedToRenderVirtualColumns(e){return this.isVirtualMode()?e<this._position?this._beginPageIndex>this.getBeginPageIndex(e):this._endPageIndex<this.getEndPageIndex(e):!1}getFixedColumns(e,t){const i=super.getFixedColumns(e);if(this.isVirtualMode()&&!t&&i.length){const n=i.map((s=>s.command)).indexOf("transparent");return i[n].colspan=this.getVisibleColumns().length-super.getFixedColumns().length+1,i}return i}_compileVisibleColumns(e,t){var i;if(t||!this.isVirtualMode()||!this._shouldReturnVisibleColumns())return super._compileVisibleColumns(e);(i=this._columns)!==null&&i!==void 0&&i.length&&!m(this._beginPageIndex)&&!m(this._endPageIndex)&&(this._beginPageIndex=this.getBeginPageIndex(this._position),this._endPageIndex=this.getEndPageIndex(this._position));const n=this._beginPageIndex,s=this._endPageIndex,o=`${e}-${n}-${s}`;if(this._virtualVisibleColumns[o])return this._virtualVisibleColumns[o];let a=super._compileVisibleColumns();const l=this.getRowCount(),d=this.getColumnPageSize();let c=n*d,u=s*d;const p=this.getFixedColumns(void 0,!0),g=p.map((F=>F.command)).indexOf("transparent"),_=p.length?g:0;let f=a.slice(0,_);const C=a.slice(_,c),I=Mn(C).reduce(((F,z)=>F+z),0);I||(c=0);const E=p.length?p.length-g-1:0;let D=a.slice(a.length-E);const k=a.slice(u,a.length-E),A=Mn(k).reduce(((F,z)=>F+z),0);if(A||(u=a.length),l>1&&typeof e=="number"){const F=[];for(let z=0;z<=l;z++)F.push(super._compileVisibleColumns(z));f=_o(F,0,f.length)[e]||[],D=_o(F,a.length-D.length,a.length)[e]||[],a=_o(F,c,u)[e]||[]}else a=a.slice(c,u);return I&&(a.unshift({command:"virtual",type:"virtual",width:I}),a=f.concat(a)),A&&(a.push({command:"virtual",type:"virtual",width:A}),a=a.concat(D)),this._virtualVisibleColumns[o]=a,a}getColumnIndexOffset(){let e=0;if(this._beginPageIndex>0){const i=this.getFixedColumns().map((s=>s.command)).indexOf("transparent"),n=i>=0?i:0;e=this._beginPageIndex*this.getColumnPageSize()-n-1}return e>0?e:0}isVirtualMode(){return pe()&&this.option("scrolling.columnRenderingMode")==="virtual"}},dE={defaultOptions:()=>({scrolling:{columnRenderingMode:"standard",columnPageSize:5,columnRenderingThreshold:300}}),extenders:{controllers:{columns:HI},views:{columnHeadersView:$I,rowsView:LI}}},WI=(r,e,t)=>{let{isRemoteFiltering:i,dateSerializationFormat:n,getSelector:s}=t;const{selector:o}=r,a=B(o)?o:s(o),l=a?a(e):e[o],d=i&&xt(l)?fe.serializeDate(l,n):l;return{getter:a,rawValue:l,safeValue:d}},zI={getSortFilterValue:WI},KI=".dx-row.dx-row-focused";class GI extends j.ViewController{getKeyboardController(){return this.getController("keyboardNavigation")}getDataController(){return this.getController("data")}init(){this.component._optionsByReference.focusedRowKey=!0}optionChanged(e){const{name:t,value:i,previousValue:n}=e;switch(t){case"focusedRowIndex":this._focusRowByIndex(i),this.getKeyboardController()._fireFocusedRowChanged(),e.handled=!0;break;case"focusedRowKey":if(Array.isArray(i)&&JSON.stringify(i)===JSON.stringify(n))return;this._focusRowByKey(i).done((()=>{this.getKeyboardController()._fireFocusedRowChanged()})),e.handled=!0;break;case"focusedColumnIndex":case"focusedRowEnabled":case"autoNavigateToFocusedRow":e.handled=!0;break;default:super.optionChanged(e)}}publicMethods(){return["navigateToRow","isRowFocused"]}isAutoNavigateToFocusedRow(){return this.option("scrolling.mode")!=="infinite"&&this.option("autoNavigateToFocusedRow")}_focusRowByIndex(e,t){if(!this.option("focusedRowEnabled"))return;const i=this.getDataController().isEmpty(),n=this._getCurrentFocusRowIndex(i,e);n<0?(i||this.isAutoNavigateToFocusedRow())&&this._resetFocusedRow():this._focusRowByIndexCore(n,t)}_getCurrentFocusRowIndex(e,t){let i=t;return i===void 0&&(e?i=-1:i=this.option("focusedRowIndex")),i}_focusRowByIndexCore(e,t){const i=this.getDataController().pageSize(),n=()=>{if(this._isValidFocusedRowIndex(e)){let s=e-this.getDataController().getRowIndexOffset(!0);if(!t||t.paging&&!t.filtering){const a=this.getDataController()._getLastItemIndex();s=Math.min(s,a)}const o=this.getDataController().getKeyByRowIndex(s,!0);m(o)&&!this.isRowFocused(o)&&this.option("focusedRowKey",o)}};if(i>=0)if(this._isLocalRowIndex(e))n();else{const s=Math.floor(e/this.getDataController().pageSize());O(this.getDataController().pageIndex(s),this.getDataController().waitReady()).done((()=>{n()}))}}_isLocalRowIndex(e){if(this.getKeyboardController()._isVirtualScrolling()){const i=Math.floor(e/this.getDataController().pageSize()),n=this.getDataController().virtualItemsCount(),s=n?n.begin:-1,o=this.getDataController().getVisibleRows().length+this.getDataController().getRowIndexOffset(),a=Math.ceil(o/this.getDataController().pageSize());return s<=e&&a>i}return!0}_setFocusedRowKeyByIndex(e){if(this._isValidFocusedRowIndex(e)){const t=Math.min(e-this.getDataController().getRowIndexOffset(),this.getDataController().items().length-1),i=this.getDataController().getKeyByRowIndex(t);m(i)&&!this.isRowFocused(i)&&this.option("focusedRowKey",i)}}_focusRowByKey(e){return m(e)?this._navigateToRow(e,!0):(this._resetFocusedRow(),S().resolve())}_resetFocusedRow(){const e=this.option("focusedRowKey"),t=m(e);!t&&this.option("focusedRowIndex")<0||(t&&this.option("focusedRowKey",null),this.getKeyboardController().setFocusedRowIndex(-1),this.option("focusedRowIndex",-1),this.getDataController().updateItems({changeType:"updateFocusedRow",focusedRowKey:null}),this.getKeyboardController()._fireFocusedRowChanged())}_isValidFocusedRowIndex(e){const t=this.getDataController().getVisibleRows()[e];return!t||t.rowType==="data"||t.rowType==="group"}navigateToRow(e){return this.isAutoNavigateToFocusedRow()||this.option("focusedRowIndex",-1),this._navigateToRow(e,!1)}_navigateToRow(e,t){const i=this,n=i.isAutoNavigateToFocusedRow(),s=new S,o=this.getView("rowsView");if(e===void 0||!this.getDataController().dataSource())return s.reject().promise();const a=i.getFocusedRowIndexByKey(e);return!n&&t||a>=0?i._navigateTo(e,s,t):this.getDataController().getPageIndexByKey(e).done((l=>{if(l<0){s.resolve(-1);return}l===this.getDataController().pageIndex()?this.getDataController().reload().done((()=>{i.isRowFocused(e)&&this.getDataController().getRowIndexByKey(e)>=0?s.resolve(i.getFocusedRowIndexByKey(e)):i._navigateTo(e,s,t)})).fail(s.reject):this.getDataController().pageIndex(l).done((()=>{o.waitAsyncTemplates(!0).done((()=>{i._navigateTo(e,s,t)}))})).fail(s.reject)})).fail(s.reject),s.promise()}_navigateTo(e,t,i){const n=this.getDataController().getRowIndexByKey(e),s=y.isVirtualRowRendering(this);this.isAutoNavigateToFocusedRow()&&s&&n<0?this._navigateToVirtualRow(e,t,i):this._navigateToVisibleRow(e,t,i)}_navigateToVisibleRow(e,t,i){if(i)this._triggerUpdateFocusedRow(e,t);else{const n=this.getFocusedRowIndexByKey(e);this.getView("rowsView").scrollToRowElement(e,t).done((()=>{t.resolve(n)}))}}_navigateToVirtualRow(e,t,i){const n=this.getDataController()._rowsScrollController,s=y.getIndexByKey(e,this.getDataController().items(!0)),o=this.getView("rowsView").getScrollable();if(n&&o&&s>=0){const a=s+this.getDataController().getRowIndexOffset(!0),l=n.getItemOffset(a),d=()=>{this.getDataController().totalCount()&&!this.getDataController().items().length||(this.component.off("contentReady",d),i?this._triggerUpdateFocusedRow(e,t):t.resolve(a))};this.component.on("contentReady",d),this.getView("rowsView").scrollTopPosition(l)}else t.resolve(-1)}_triggerUpdateFocusedRow(e,t){const i=this.getFocusedRowIndexByKey(e);if(this._isValidFocusedRowIndex(i)){let n;this.option("focusedRowEnabled")?this.getDataController().updateItems({changeType:"updateFocusedRow",focusedRowKey:e}):n=this.getView("rowsView").scrollToRowElement(e),O(n).done((()=>{this.getKeyboardController().setFocusedRowIndex(i),t&&t.resolve(i)}))}else t&&t.resolve(-1)}getFocusedRowIndexByKey(e){const t=this.getDataController().getRowIndexByKey(e,!0);return t>=0?t+this.getDataController().getRowIndexOffset(!0):-1}_focusRowByKeyOrIndex(){const e=this.option("focusedRowKey");let t=this.option("focusedRowIndex");if(m(e)){const i=this.getDataController().getRowIndexByKey(e);i>=0?(this.getKeyboardController()._isVirtualScrolling()&&(t=i+this.getDataController().getRowIndexOffset()),this.getKeyboardController().setFocusedRowIndex(t),this._triggerUpdateFocusedRow(e)):this._navigateToRow(e,!0).done((n=>{t>=0&&n<0?this._focusRowByIndex():t<0&&n>=0&&this.getKeyboardController().setFocusedRowIndex(n)}))}else t>=0&&this._focusRowByIndex(t)}isRowFocused(e){const t=this.option("focusedRowKey");if(m(t))return ae(e,this.option("focusedRowKey"))}updateFocusedRow(e){const t=this,i=t.getDataController().getRowIndexByKey(e.focusedRowKey),n=t.getView("rowsView");let s,o;x(n.getTableElements(),((a,l)=>{const d=a===0;s=h(l),t._clearPreviousFocusedRow(s,i);const c=t._prepareFocusedRow({changedItem:t.getDataController().getVisibleRows()[i],$tableElement:s,focusedRowIndex:i});d&&(o=c)})),!e.preventScroll&&o&&n.scrollToElementVertically(o)}_clearPreviousFocusedRow(e,t){const i=e.find(KI).filter(((n,s)=>{const o=h(s).closest(`.${this.addWidgetPrefix("table")}`);return e.is(o)}));i.removeClass("dx-row-focused").removeClass("dx-cell-focus-disabled").removeAttr("tabindex"),i.children("td").removeAttr("tabindex"),t!==0&&h(this.getView("rowsView").getRowElement(0)).removeClass("dx-cell-focus-disabled").removeAttr("tabIndex")}_prepareFocusedRow(e){let t;const{changedItem:i}=e;if(i&&(i.rowType==="data"||i.rowType==="group")){const{focusedRowIndex:n}=e,{$tableElement:s}=e,o=this.option("tabindex")||0,a=this.getView("rowsView");t=h(a._getRowElements(s).eq(n)),t.addClass("dx-row-focused").attr("tabindex",o)}return t}}const UI=r=>class extends r{init(){const e=this.option("focusedRowIndex"),t=this.option("focusedColumnIndex");this.createAction("onFocusedRowChanging",{excludeValidators:["disabled","readOnly"]}),this.createAction("onFocusedRowChanged",{excludeValidators:["disabled","readOnly"]}),this.createAction("onFocusedCellChanging",{excludeValidators:["disabled","readOnly"]}),this.createAction("onFocusedCellChanged",{excludeValidators:["disabled","readOnly"]}),super.init(),this.setRowFocusType(),this._focusedCellPosition={},m(e)&&e>=0&&(this._focusedCellPosition.rowIndex=e),m(t)&&t>=0&&(this._focusedCellPosition.columnIndex=t)}setFocusedRowIndex(e){super.setFocusedRowIndex(e),this.option("focusedRowIndex",e)}setFocusedColumnIndex(e){super.setFocusedColumnIndex(e),this.option("focusedColumnIndex",e)}_escapeKeyHandler(e,t){return t||!this.option("focusedRowEnabled")?super._escapeKeyHandler(e,t):this.isCellFocusType()?(this.setRowFocusType(),this._focus(this._getCellElementFromTarget(e.originalEvent.target),!0),!0):!1}_updateFocusedCellPosition(e,t){const i=super._updateFocusedCellPosition(e,t);return i&&i.columnIndex>=0&&this._fireFocusedCellChanged(e),i}},qI=r=>class extends r{renderFocusOverlay(e,t){var i;const n=this.option("focusedRowEnabled");if(!n||!((i=this._keyboardNavigationController)!==null&&i!==void 0&&i.isRowFocusType())||this._editingController.isEditing()||this._columnHeadersView.isFilterRowCell(e))super.renderFocusOverlay(e,t);else if(n&&this._keyboardNavigationController._getElementType(e)==="row"&&!e.hasClass("dx-row-focused")){const o=this._keyboardNavigationController.getFirstValidCellInRow(e);this._keyboardNavigationController.focus(o)}}},YI=r=>class extends r{getSortDataSourceParameters(e,t){let i=super.getSortDataSourceParameters.apply(this,arguments);const n=this._dataController._dataSource,s=this._dataController.store();let o=s&&s.key();const a=n&&n.remoteOperations()||{},l=Object.keys(a).every((d=>!a[d]));if(o&&(this.option("focusedRowEnabled")&&this._focusController.isAutoNavigateToFocusedRow()!==!1||t)){o=Array.isArray(o)?o:[o];const d=o.filter((c=>!this.columnOption(c,"sortOrder")));d.length&&(i=i||[],l?i.push({selector:n.getDataIndexGetter(),desc:!1}):d.forEach((c=>i.push({selector:c,desc:!1}))))}return i}},jI=r=>class extends r{constructor(){super(...arguments),this._needToUpdateFocusedRowByIndex=!1}_applyChange(e){if(!(e&&e.changeType==="updateFocusedRow"))return super._applyChange.apply(this,arguments)}_fireChanged(e){if(super._fireChanged(e),this.option("focusedRowEnabled")&&this._dataSource){const i=e.changeType==="update"&&e.repaintChangesOnly&&e.changeTypes&&e.changeTypes.indexOf("remove")>=0;this._needToUpdateFocusedRowByIndex?(this._needToUpdateFocusedRowByIndex=!1,this._focusController._focusRowByIndex()):e.changeType==="refresh"&&e.items.length||i?(this._updatePageIndexes(),this._updateFocusedRow(e)):e.changeType==="append"||e.changeType==="prepend"?this._updatePageIndexes():e.changeType==="update"&&e.repaintChangesOnly&&this._updateFocusedRow(e)}}_handleDataPushed(e){super._handleDataPushed(e);const t=this.option("focusedRowKey");this._needToUpdateFocusedRowByIndex=e==null?void 0:e.some((i=>i.type==="remove"&&ae(i.key,t)))}_updatePageIndexes(){const e=this._lastRenderingPageIndex||0,t=this._rowsScrollController?this._rowsScrollController.pageIndex():0;this._lastRenderingPageIndex=t,this._isPagingByRendering=t!==e}isPagingByRendering(){return this._isPagingByRendering}_updateFocusedRow(e){const t=e.operationTypes||{},{reload:i,fullReload:n,pageIndex:s,paging:o}=t,a=this._keyboardNavigationController._isVirtualScrolling(),l=o&&!a,d=this.option("focusedRowKey"),c=this._focusController.isAutoNavigateToFocusedRow();if(i&&s===!1&&!n&&m(d))this._focusController._navigateToRow(d,!0).done((p=>{p<0&&this._focusController._focusRowByIndex(void 0,t)}));else if(l&&c){const p=this.getRowIndexByKey(d),g=this.option("focusedRowIndex"),_=p>=0;g>=0&&(g===p||!_)&&this._focusController._focusRowByIndex(g,t)}else l&&!c&&this.getRowIndexByKey(d)<0?this.option("focusedRowIndex",-1):t.fullReload&&this._focusController._focusRowByKeyOrIndex()}getPageIndexByKey(e){const t=this,i=new S;return t.getGlobalRowIndexByKey(e).done((n=>{i.resolve(n>=0?Math.floor(n/t.pageSize()):-1)})).fail(i.reject),i.promise()}getGlobalRowIndexByKey(e){return this._dataSource.group()?this._calculateGlobalRowIndexByGroupedData(e):this._calculateGlobalRowIndexByFlatData(e)}_calculateGlobalRowIndexByFlatData(e,t,i){const n=this,s=new S,o=n._dataSource;if(Array.isArray(e)||mv(e))return s.resolve(-1).promise();let a=n._generateFilterByKey(e);return o.load({filter:n._concatWithCombinedFilter(a),skip:0,take:1}).done((l=>{l.length>0?(a=n._generateOperationFilterByKey(e,l[0],i),o.load({filter:n._concatWithCombinedFilter(a,t),skip:0,take:1,requireTotalCount:!0}).done(((d,c)=>{s.resolve(c.totalCount)}))):s.resolve(-1)})),s.promise()}_concatWithCombinedFilter(e,t){const i=this.getCombinedFilter();return y.combineFilters([e,i,t])}_generateBooleanFilter(e,t,i){const{desc:n}=i;switch(!0){case(t===!1&&n):return[e,"=",!0];case(t===!1&&!n):return[e,"=",null];case(t===!0&&!n):case(!Io(t)&&n):return[e,"<>",t];default:return}}_generateOperationFilterByKey(e,t,i){const n=this,s=n.option("dateSerializationFormat"),o=n._dataSource.remoteOperations().filtering,a=n._dataSource.remoteOperations().sorting;let l=n._generateFilterByKey(e,"<"),d=n._columnsController.getSortDataSourceParameters(!o,!0);if(i){const c=n._columnsController.getGroupDataSourceParameters(!o);c&&(d=d?c.concat(d):c)}return d&&d.slice().reverse().forEach((c=>{const{selector:u,desc:p,compare:g}=c,{getter:_,rawValue:f,safeValue:C}=zI.getSortFilterValue(c,t,{isRemoteFiltering:o,dateSerializationFormat:s,getSelector:I=>n._columnsController.columnOption(I,"selector")});if(l=[[u,"=",C],"and",l],f===null||Io(f)){const I=n._generateBooleanFilter(u,C,p);I&&(l=[I,"or",l])}else{const I=p?">":"<";let E;g&&!a?E=D=>I==="<"?g(f,_(D))>=1:g(f,_(D))<=-1:(E=[u,I,C],p||(E=[E,"or",[u,"=",null]])),l=[E,"or",l]}})),l}_generateFilterByKey(e,t){const i=this._dataSource.key();let n=[];if(t||(t="="),Array.isArray(i))for(let s=0;s<i.length;++s){const o=e[i[s]];o&&(n.length>0&&n.push("and"),n.push([i[s],t,o]))}else n=[i,t,e];return n}_getLastItemIndex(){return this.items(!0).length-1}},XI=r=>class extends r{_deleteRowCore(e){const t=super._deleteRowCore.apply(this,arguments),i=this._dataController.getKeyByRowIndex(e);t.done((()=>{const n=this._dataController.getRowIndexByKey(i),s=this._dataController.getVisibleRows();n===-1&&!s.length&&this._focusController._resetFocusedRow()}))}},ZI=r=>class extends r{_createRow(e){const t=super._createRow.apply(this,arguments);return this.option("focusedRowEnabled")&&e&&this._focusController.isRowFocused(e.key)&&t.addClass("dx-row-focused"),t}_checkRowKeys(e){if(super._checkRowKeys.apply(this,arguments),this.option("focusedRowEnabled")&&this.option("dataSource")){const t=this._dataController.store();t&&!t.key()&&this._dataController.fireError("E1042","Row focusing")}}_update(e){e.changeType==="updateFocusedRow"?this.option("focusedRowEnabled")&&this._focusController.updateFocusedRow(e):super._update(e)}updateFocusElementTabIndex(e,t){this.option("focusedRowEnabled")?this._setFocusedRowElementTabIndex(t):super.updateFocusElementTabIndex(e)}_setFocusedRowElementTabIndex(e){const t=this.option("focusedRowKey"),i=this.option("tabIndex")??0,n=this._columnsController;let s=this._dataController.getRowIndexByKey(t),o=this.option("focusedColumnIndex");const a=this._findRowElementForTabIndex(),l=this._dataController.dataSource(),d=l==null?void 0:l.operationTypes(),c=!d||d.paging;m(this._scrollToFocusOnResize)||(this._scrollToFocusOnResize=()=>{this.scrollToElementVertically(this._findRowElementForTabIndex()),this.resizeCompleted.remove(this._scrollToFocusOnResize)}),a.attr("tabIndex",i);const u=this.option("focusedRowIndex")-this._dataController.getRowIndexOffset(!0);!c&&s<0&&u>=0&&this._focusController.updateFocusedRow({focusedRowKey:t,preventScroll:e}),s>=0&&!e&&(o<0&&(o=0),s+=this._dataController.getRowIndexOffset(),o+=n.getColumnIndexOffset(),this._keyboardNavigationController.setFocusedCellPosition(s,o),this._focusController.isAutoNavigateToFocusedRow()&&!c&&!this._dataController.isPagingByRendering()&&(this.resizeCompleted.remove(this._scrollToFocusOnResize),this.resizeCompleted.add(this._scrollToFocusOnResize)))}_findRowElementForTabIndex(){const e=this.option("focusedRowKey"),t=this._dataController.getRowIndexByKey(e);return h(this.getRowElement(t>=0?t:0))}scrollToRowElement(e){const t=this._dataController.getRowIndexByKey(e),i=h(this.getRow(t));return this.scrollToElementVertically(i)}scrollToElementVertically(e){const t=this.getScrollable();if(t&&e.length){const i=t.getScrollElementPosition(e,"vertical");return this.scrollTopPosition(i)}return new S().resolve()}scrollTopPosition(e){const t=new S,i=this.getScrollable();if(i){const n=i.scrollTop(),s=()=>{i.off("scroll",s),t.resolve()};if(e!==n)return i.on("scroll",s),this._dataController.resetFilterApplying(),i.scrollTo({top:e}),t.promise()}return t.resolve()}},cE={defaultOptions:()=>({focusedRowEnabled:!1,autoNavigateToFocusedRow:!0,focusedRowKey:null,focusedRowIndex:-1,focusedColumnIndex:-1}),controllers:{focus:GI},extenders:{controllers:{keyboardNavigation:UI,editorFactory:qI,columns:YI,data:jI,editing:XI},views:{rowsView:ZI}}},fd=oe(),ct="dxDraggable",QI=V(xo,ct),JI=V(wo,ct),eS=V(bo,ct),tS=V(Xh,ct),iS=V(Zh,ct),nS=V(Z.down,ct),sS=V("keydown",ct);let fo,Bn;const Qo=r=>({x:r.pageX-h(fd).scrollLeft(),y:r.pageY-h(fd).scrollTop()});class Cd{constructor(e,t){this._$scrollableAtPointer=null,this._preventScroll=!0,this._component=t,e==="vertical"?(this._scrollValue="scrollTop",this._overFlowAttr="overflowY",this._sizeAttr="height",this._scrollSizeProp="scrollHeight",this._clientSizeProp="clientHeight",this._limitProps={start:"top",end:"bottom"}):(this._scrollValue="scrollLeft",this._overFlowAttr="overflowX",this._sizeAttr="width",this._scrollSizeProp="scrollWidth",this._clientSizeProp="clientWidth",this._limitProps={start:"left",end:"right"})}updateScrollable(e,t){let i=!1;e.some((n=>{const s=h(n),o=s.hasClass("dx-overlay-wrapper"),a=s.hasClass("dx-overlay-content");return o||a?!0:(i=this._trySetScrollable(n,t),i)})),i||(this._$scrollableAtPointer=null,this._scrollSpeed=0)}isScrolling(){return!!this._scrollSpeed}isScrollable(e){return(e.css(this._overFlowAttr)==="auto"||e.hasClass("dx-scrollable-container"))&&e.prop(this._scrollSizeProp)>Math.ceil(this._sizeAttr==="width"?H(e):X(e))}_trySetScrollable(e,t){const i=this,n=h(e);let s;const o=i._component.option("scrollSensitivity");let a=i.isScrollable(n);return a&&(s=i._calculateDistanceToBorders(n,t),o>s[i._limitProps.start]?i._preventScroll||(i._scrollSpeed=-i._calculateScrollSpeed(s[i._limitProps.start]),i._$scrollableAtPointer=n):o>s[i._limitProps.end]?i._preventScroll||(i._scrollSpeed=i._calculateScrollSpeed(s[i._limitProps.end]),i._$scrollableAtPointer=n):(a=!1,i._preventScroll=!1)),a}_calculateDistanceToBorders(e,t){const i=e.get(0);let n;return i?(n=re(i),{left:t.x-n.left,top:t.y-n.top,right:n.right-t.x,bottom:n.bottom-t.y}):{}}_calculateScrollSpeed(e){const t=this._component,i=t.option("scrollSensitivity"),n=t.option("scrollSpeed");return Math.ceil(((i-e)/i)**2*n)}scrollByStep(){const e=this;if(e._$scrollableAtPointer&&e._scrollSpeed){if(e._$scrollableAtPointer.hasClass("dx-scrollable-container")){const i=e._$scrollableAtPointer.closest(".dx-scrollable"),n=i.data("dxScrollable")||i.data("dxScrollView");if(n){const s=n.scrollOffset()[e._limitProps.start]+e._scrollSpeed;n.scrollTo({[e._limitProps.start]:s})}}else{const i=e._$scrollableAtPointer[e._scrollValue]()+e._scrollSpeed;e._$scrollableAtPointer[e._scrollValue](i)}const t=e._component._dragMoveArgs;t&&e._component._dragMoveHandler(t)}}reset(){this._$scrollableAtPointer=null,this._scrollSpeed=0,this._preventScroll=!0}isOutsideScrollable(e,t){if(!e)return!1;const i=re(e.get(0)),n=i[this._limitProps.start],s=i[this._sizeAttr],o=Qo(t),a=this._sizeAttr==="width"?o.x:o.y;return a<n||a>n+s}}class oS extends jp{constructor(e){super(),this._strategy=e}_step(){const e=this._strategy._horizontalScrollHelper,t=this._strategy._verticalScrollHelper;e==null||e.scrollByStep(),t==null||t.scrollByStep()}}class Ih extends ps{reset(){}dragMove(e){}dragEnter(){}dragLeave(){}dragEnd(e){return this._getSourceDraggable()._fireRemoveEvent(e),S().resolve()}_fireRemoveEvent(e){}_getDefaultOptions(){return T({},super._getDefaultOptions(),{onDragStart:null,onDragMove:null,onDragEnd:null,onDragEnter:null,onDragLeave:null,onDragCancel:null,onCancelByEsc:!1,onDrop:null,immediate:!0,dragDirection:"both",boundOffset:0,allowMoveByClick:!1,itemData:null,contentTemplate:"content",handle:"",filter:"",clone:!1,autoScroll:!0,scrollSpeed:30,scrollSensitivity:60})}_setOptionsByReference(){super._setOptionsByReference.apply(this,arguments),b(this._optionsByReference,{component:!0,group:!0,itemData:!0,data:!0})}_init(){super._init(),this._attachEventHandlers(),this._scrollAnimator=new oS(this),this._horizontalScrollHelper=new Cd("horizontal",this),this._verticalScrollHelper=new Cd("vertical",this),this._initScrollTop=0,this._initScrollLeft=0}_normalizeCursorOffset(e){return L(e)&&(e={h:e.x,v:e.y}),e=Fd(e).map((t=>parseFloat(t))),{left:e[0],top:e.length===1?e[0]:e[1]}}_getNormalizedCursorOffset(e,t){return B(e)&&(e=e.call(this,t)),this._normalizeCursorOffset(e)}_calculateElementOffset(e){let t,i;const{event:n}=e,s=h(e.itemElement),o=h(e.dragElement),a=this._dragElementIsCloned(),l=this.option("cursorOffset");let d={left:0,top:0};const c=this._initialLocate=Gi(o);return(a||e.initialOffset||l)&&(t=e.initialOffset||s.offset(),l&&(d=this._getNormalizedCursorOffset(l,e),isFinite(d.left)&&(t.left=n.pageX),isFinite(d.top)&&(t.top=n.pageY)),i=o.offset(),t.top-=i.top+(d.top||0)-c.top,t.left-=i.left+(d.left||0)-c.left),t}_initPosition(e){const t=h(e.dragElement),i=this._calculateElementOffset(e);i&&this._move(i,t),this._startPosition=Gi(t)}_startAnimator(){this._scrollAnimator.inProgress()||this._scrollAnimator.start()}_stopAnimator(){this._scrollAnimator.stop()}_addWidgetPrefix(e){const t=this.NAME;return Ad(t)+(e?`-${e}`:"")}_getItemsSelector(){return this.option("filter")||""}_$content(){const e=this.$element(),t=e.children(".dx-template-wrapper");return t.length?t:e}_attachEventHandlers(){if(this.option("disabled"))return;let e=this._$content(),t=this._getItemsSelector();const i=this.option("allowMoveByClick"),n={direction:this.option("dragDirection"),immediate:this.option("immediate"),checkDropTarget:(s,o)=>{const a=this.option("group"),l=this._getSourceDraggable().option("group"),d=this._getScrollable(s);return this._verticalScrollHelper.isOutsideScrollable(d,o)||this._horizontalScrollHelper.isOutsideScrollable(d,o)?!1:l&&l===a}};i&&(e=this._getArea(),v.on(e,nS,n,this._pointerDownHandler.bind(this))),t[0]===">"&&(t=t.slice(1)),v.on(e,QI,t,n,this._dragStartHandler.bind(this)),v.on(e,JI,n,this._dragMoveHandler.bind(this)),v.on(e,eS,n,this._dragEndHandler.bind(this)),v.on(e,tS,n,this._dragEnterHandler.bind(this)),v.on(e,iS,n,this._dragLeaveHandler.bind(this)),this.option("onCancelByEsc")&&v.on(e,sS,this._keydownHandler.bind(this))}_dragElementIsCloned(){var e;return(e=this._$dragElement)===null||e===void 0?void 0:e.hasClass(this._addWidgetPrefix("clone"))}_getDragTemplateArgs(e,t){return{container:$(t),model:{itemData:this.option("itemData"),itemElement:$(e)}}}_createDragElement(e){let t=e;const i=this.option("clone"),n=this._getContainer();let s=this.option("dragTemplate");return s?(s=this._getTemplate(s),t=h("<div>").appendTo(n),s.render(this._getDragTemplateArgs(e,t))):i&&(t=h("<div>").appendTo(n),e.clone().css({width:e.css("width"),height:e.css("height")}).appendTo(t)),t.toggleClass(this._addWidgetPrefix("clone"),t.get(0)!==e.get(0)).toggleClass("dx-rtl",this.option("rtlEnabled"))}_resetDragElement(){if(this._dragElementIsCloned()){var e;(e=this._$dragElement)===null||e===void 0||e.remove()}else this._toggleDraggingClass(!1);this._$dragElement=null}_resetSourceElement(){this._toggleDragSourceClass(!1),this._$sourceElement=null}_detachEventHandlers(){v.off(this._$content(),`.${ct}`),v.off(this._getArea(),`.${ct}`)}_move(e,t){jt(t||this._$dragElement,e)}_getDraggableElement(e){const t=this._getSourceElement();if(t)return t;if(this.option("allowMoveByClick"))return this.$element();let n=h(e==null?void 0:e.target);const s=this._getItemsSelector();if(s[0]===">"){const o=this._$content().find(s);o.is(n)||(n=n.closest(o))}return n}_getSourceElement(){return this._getSourceDraggable()._$sourceElement}_pointerDownHandler(e){if(Qh(e))return;const t={},i=this.$element(),{dragDirection:n}=this.option();(n==="horizontal"||n==="both")&&(t.left=e.pageX-i.offset().left+Gi(i).left-H(i)/2),(n==="vertical"||n==="both")&&(t.top=e.pageY-i.offset().top+Gi(i).top-X(i)/2),this._move(t,i),this._getAction("onDragMove")(this._getEventArgs(e))}_isValidElement(e,t){var i;const{handle:n}=this.option(),s=h((i=e.originalEvent)===null||i===void 0?void 0:i.target);return n&&!s.closest(n).length||!t.length?!1:!t.is(".dx-state-disabled, .dx-state-disabled *")}_dragStartHandler(e){const t=this._getDraggableElement(e);if(this.dragInProgress=!0,!this._isValidElement(e,t)){e.cancel=!0;return}if(this._$sourceElement)return;const i=this._getDragStartArgs(e,t);if(this._getAction("onDragStart")(i),i.cancel){e.cancel=!0;return}this.option("itemData",i.itemData),this._setSourceDraggable(),this._$sourceElement=t;let n=t.offset();!this._hasClonedDraggable()&&this.option("autoScroll")&&(this._initScrollTop=this._getScrollableScrollTop(),this._initScrollLeft=this._getScrollableScrollLeft(),n=this._getDraggableElementOffset(n.left,n.top));const s=this._$dragElement=this._createDragElement(t);this._toggleDraggingClass(!0),this._toggleDragSourceClass(!0),this._setGestureCoverCursor(s.children());const o=s.css("position")==="fixed";this._initPosition(b({},i,{dragElement:s.get(0),initialOffset:o&&n})),this._getAction("onDraggableElementShown")(T({},i,{dragElement:s}));const a=this._getArea(),l=this._getAreaOffset(a),d=this._getBoundOffset(),c=ge(a),u=Y(a),p=H(s),g=X(s),_=s.offset().left-l.left,f=s.offset().top-l.top;a.length&&(e.maxLeftOffset=_-d.left,e.maxRightOffset=c-_-p-d.right,e.maxTopOffset=f-d.top,e.maxBottomOffset=u-f-g-d.bottom),this.option("autoScroll")&&this._startAnimator()}_getAreaOffset(e){return e&&ei.offset(e)||{left:0,top:0}}_toggleDraggingClass(e){var t;(t=this._$dragElement)===null||t===void 0||t.toggleClass(this._addWidgetPrefix("dragging"),e)}_toggleDragSourceClass(e,t){const i=t||this._$sourceElement;i==null||i.toggleClass(this._addWidgetPrefix("source"),e)}_setGestureCoverCursor(e){h(".dx-gesture-cover").css("cursor",e.css("cursor"))}_getBoundOffset(){let e=this.option("boundOffset");return B(e)&&(e=e.call(this)),gp(e)}_getArea(){let e=this.option("boundary");return B(e)&&(e=e.call(this)),h(e)}_getContainer(){let{container:e}=this.option();return e===void 0&&(e=yd()),h(e)}_getDraggableElementOffset(e,t){var i,n;const s=this._initScrollTop,o=this._initScrollLeft,a=this._getScrollableScrollTop(),l=this._getScrollableScrollLeft(),c=h(this.element()).css("position")==="fixed",u={left:(((i=this._startPosition)===null||i===void 0?void 0:i.left)??0)+e,top:(((n=this._startPosition)===null||n===void 0?void 0:n.top)??0)+t};return c||this._hasClonedDraggable()?u:{left:Ee(l)?u.left+l-o:u.left,top:Ee(a)?u.top+a-s:u.top}}_hasClonedDraggable(){return this.option("clone")||this.option("dragTemplate")}_dragMoveHandler(e){if(this._dragMoveArgs=e,!this._$dragElement){e.cancel=!0;return}const t=this._getDraggableElementOffset(e.offset.x,e.offset.y);this._move(t),this._updateScrollable(e);const i=this._getEventArgs(e);if(this._getAction("onDragMove")(i),i.cancel===!0)return;this._getTargetDraggable().dragMove(e,scrollBy)}_updateScrollable(e){const t=this;if(t.option("autoScroll")){const i=Qo(e),n=M.elementsFromPoint(i.x,i.y,this.$element().get(0));t._verticalScrollHelper.updateScrollable(n,i),t._horizontalScrollHelper.updateScrollable(n,i)}}_getScrollable(e){let t;return e.parents().toArray().some((i=>{const n=h(i);return this._horizontalScrollHelper.isScrollable(n)||this._verticalScrollHelper.isScrollable(n)?(t=n,!0):!1})),t}_getScrollableScrollTop(){var e;return((e=this._getScrollable(h(this.element())))===null||e===void 0?void 0:e.scrollTop())??0}_getScrollableScrollLeft(){var e;return((e=this._getScrollable(h(this.element())))===null||e===void 0?void 0:e.scrollLeft())??0}_defaultActionArgs(){const e=super._defaultActionArgs.apply(this,arguments),t=this.option("component");return t&&(e.component=t,e.element=t.element()),e}_getEventArgs(e){const t=this._getSourceDraggable(),i=this._getTargetDraggable();return{event:e,itemData:t.option("itemData"),itemElement:$(t._$sourceElement),fromComponent:t.option("component")||t,toComponent:i.option("component")||i,fromData:t.option("data"),toData:i.option("data")}}_getDragStartArgs(e,t){const i=this._getEventArgs(e);return{event:i.event,itemData:i.itemData,itemElement:t,fromData:i.fromData}}_revertItemToInitialPosition(){!this._dragElementIsCloned()&&this._move(this._initialLocate,this._$sourceElement)}_dragEndHandler(e){const t=S(),i=this._getEventArgs(e),n=this._getEventArgs(e),s=this._getTargetDraggable();let o=!0;this.dragInProgress=!1;try{this._getAction("onDragEnd")(i)}finally{O(_t(i.cancel)).done((a=>{if(!a&&(s!==this&&s._getAction("onDrop")(n),!n.cancel)){o=!1,O(_t(s.dragEnd(i))).always(t.resolve);return}t.resolve()})).fail(t.resolve),t.done((()=>{o&&this._revertItemToInitialPosition(),this._resetDragOptions(s)}))}}_isTargetOverAnotherDraggable(e){const t=this._getSourceDraggable();if(this===t)return!1;const i=t._$dragElement,n=t.$element(),s=this.$element(),o=Qo(e),l=M.elementsFromPoint(o.x,o.y,this.element()).filter((p=>{const g=h(p);return g.hasClass(this._addWidgetPrefix())?!g.closest(i).length:!1}))[0],d=this._getSourceElement(),c=l===n.get(0),u=h(l).closest(d).length;return!l||l===s.get(0)&&!c&&!u}_dragEnterHandler(e){this._fireDragEnterEvent(e),this._isTargetOverAnotherDraggable(e)&&this._setTargetDraggable(),this._getSourceDraggable().dragEnter(e)}_dragLeaveHandler(e){this._fireDragLeaveEvent(e),this._resetTargetDraggable(),this!==this._getSourceDraggable()&&this.reset(),this._getSourceDraggable().dragLeave(e)}_keydownHandler(e){this.dragInProgress&&e.key==="Escape"&&this._keydownEscapeHandler(e)}_keydownEscapeHandler(e){var t;if(!this._getSourceElement())return;const n=this._getEventArgs(e);if(this._getAction("onDragCancel")(n),n.cancel)return;this.dragInProgress=!1,(t=Bn)===null||t===void 0||t._toggleDraggingClass(!1),this._detachEventHandlers(),this._revertItemToInitialPosition();const s=this._getTargetDraggable();this._resetDragOptions(s),this._attachEventHandlers()}_getAction(e){return this[`_${e}Action`]||this._createActionByOption(e)}_getAnonymousTemplateName(){return"content"}_initTemplates(){this.option("contentTemplate")&&(this._templateManager.addDefaultTemplates({content:new Jh}),super._initTemplates.apply(this,arguments))}_render(){super._render(),this.$element().addClass(this._addWidgetPrefix());const e=this._templateManager.anonymousTemplateName===this.option("contentTemplate"),t=this._getTemplateByOption("contentTemplate");t&&h(t.render({container:this.element(),transclude:e}))}_optionChanged(e){const{name:t}=e;switch(t){case"onDragStart":case"onDragMove":case"onDragEnd":case"onDrop":case"onDragEnter":case"onDragLeave":case"onDragCancel":case"onDraggableElementShown":this[`_${t}Action`]=this._createActionByOption(t);break;case"dragTemplate":case"contentTemplate":case"container":case"clone":case"scrollSensitivity":case"scrollSpeed":case"boundOffset":case"handle":case"group":case"data":case"itemData":break;case"allowMoveByClick":case"dragDirection":case"disabled":case"boundary":case"filter":case"immediate":this._resetDragElement(),this._detachEventHandlers(),this._attachEventHandlers();break;case"onCancelByEsc":this._keydownHandler();break;case"autoScroll":this._verticalScrollHelper.reset(),this._horizontalScrollHelper.reset();break;default:super._optionChanged(e)}}_getTargetDraggable(){return fo||this}_getSourceDraggable(){return Bn||this}_setTargetDraggable(){const e=this.option("group"),t=this._getSourceDraggable();e&&e===t.option("group")&&(fo=this)}_setSourceDraggable(){Bn=this}_resetSourceDraggable(){Bn=null}_resetTargetDraggable(){fo=null}_resetDragOptions(e){this.reset(),e.reset(),this._stopAnimator(),this._horizontalScrollHelper.reset(),this._verticalScrollHelper.reset(),this._resetDragElement(),this._resetSourceElement(),this._resetTargetDraggable(),this._resetSourceDraggable()}_dispose(){super._dispose(),this._detachEventHandlers(),this._resetDragElement(),this._resetTargetDraggable(),this._resetSourceDraggable(),this._$sourceElement=null,this._stopAnimator()}_fireDragEnterEvent(e){const t=this._getEventArgs(e);this._getAction("onDragEnter")(t)}_fireDragLeaveEvent(e){const t=this._getEventArgs(e);this._getAction("onDragLeave")(t)}}_e(ct,Ih);const vd=oe(),rS="dxSortable",xd=r=>h(r).is(":visible"),aS=(r,e)=>{var t,i;if(!r)return;const n=((t=e.to)===null||t===void 0?void 0:t.left)||0,s=((i=e.to)===null||i===void 0?void 0:i.top)||0;r.style.transform=`translate(${n}px,${s}px)`,r.style.transition=`transform ${e.duration}ms ${e.easing}`},lS=r=>{r&&(r.style.transform="",r.style.transition="")};function dS(r){const e=r.offset(),{style:t}=r[0],i=parseFloat(t.paddingLeft)||0,n=parseFloat(t.paddingRight)||0,s=parseFloat(t.paddingTop)||0,o=r[0].clientWidth-(i+n),a=X(r),l=e.left+i,d=e.top+s;return{left:l,right:l+o,top:d,bottom:d+a}}class Sh extends Ih{_init(){super._init(),this._sourceScrollHandler=this._handleSourceScroll.bind(this),this._sourceScrollableInfo=null}_getDefaultOptions(){return T({},super._getDefaultOptions(),{clone:!0,filter:"> *",itemOrientation:"vertical",dropFeedbackMode:"push",allowDropInsideItem:!1,allowReordering:!0,moveItemOnDrop:!1,onDragChange:null,onAdd:null,onRemove:null,onReorder:null,onPlaceholderPrepared:null,placeholderClassName:"",animation:{type:"slide",duration:300,easing:"ease"},fromIndex:null,toIndex:null,dropInsideItem:!1,itemPoints:null,fromIndexOffset:0,offset:0,autoUpdate:!1,draggableElementSize:0})}reset(){this.option({dropInsideItem:!1,toIndex:null,fromIndex:null,itemPoints:null,fromIndexOffset:0,draggableElementSize:0}),this._$placeholderElement&&this._$placeholderElement.remove(),this._$placeholderElement=null,!this._isIndicateMode()&&this._$modifiedItem&&(this._$modifiedItem.css("marginBottom",this._modifiedItemMargin),this._$modifiedItem=null)}_getPrevVisibleItem(e,t){return e.slice(0,t).reverse().filter(xd)[0]}_dragStartHandler(e){if(super._dragStartHandler.apply(this,arguments),e.cancel===!0)return;const t=this._getSourceElement();this._updateItemPoints(),this._subscribeToSourceScroll(e),this.option("fromIndex",this._getElementIndex(t)),this.option("fromIndexOffset",this.option("offset"))}_subscribeToSourceScroll(e){const t=this._getScrollable(h(e.target));t&&(this._sourceScrollableInfo={element:t,scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop()},v.off(t,"scroll",this._sourceScrollHandler),v.on(t,"scroll",this._sourceScrollHandler))}_unsubscribeFromSourceScroll(){this._sourceScrollableInfo&&(v.off(this._sourceScrollableInfo.element,"scroll",this._sourceScrollHandler),this._sourceScrollableInfo=null)}_handleSourceScroll(e){const t=this._sourceScrollableInfo;t&&["scrollLeft","scrollTop"].forEach((i=>{if(e.target[i]!==t[i]){const n=e.target[i]-t[i];this._correctItemPoints(n),this._movePlaceholder(),t[i]=e.target[i]}}))}_dragEnterHandler(e){if(super._dragEnterHandler.apply(this,arguments),this!==this._getSourceDraggable()&&(this._subscribeToSourceScroll(e),this._updateItemPoints(),this.option("fromIndex",-1),!this._isIndicateMode())){const t=this.option("itemPoints"),i=t[t.length-1];if(i){const n=this.$element(),s=this._getSourceElement(),o=this._isVerticalOrientation(),a=o?Y(s,!0):ge(s,!0),l=n.get(0)[o?"scrollHeight":"scrollWidth"],d=n.get(0)[o?"scrollTop":"scrollLeft"],c=o?"top":"left",u=i[c],g=n.offset()[c]+l-d-u;if(g<a&&o){const _=this._getItems(),f=h(this._getPrevVisibleItem(_));this._$modifiedItem=f,this._modifiedItemMargin=f.get(0).style.marginBottom,f.css("marginBottom",a-g);const C=f.closest(".dx-sortable"),I=C.data("dxScrollable")||C.data("dxScrollView");I==null||I.update()}}}}_dragLeaveHandler(){super._dragLeaveHandler.apply(this,arguments),this!==this._getSourceDraggable()&&this._unsubscribeFromSourceScroll()}dragEnter(){this!==this._getTargetDraggable()&&this.option("toIndex",-1)}dragLeave(){this!==this._getTargetDraggable()&&this.option("toIndex",this.option("fromIndex"))}_allowDrop(e){const i=this._getTargetDraggable().$element(),n=this._getScrollable(i);if(n){const{left:s,right:o,top:a,bottom:l}=dS(n),d=this.option("toIndex"),c=this.option("itemPoints"),u=c==null?void 0:c.filter((p=>p.index===d))[0];if(u&&u.top!==void 0)return this._isVerticalOrientation()?a<=Math.ceil(u.top)&&Math.floor(u.top)<=l:s<=Math.ceil(u.left)&&Math.floor(u.left)<=o}return!0}dragEnd(e){this._unsubscribeFromSourceScroll();const t=this._getSourceElement(),i=this._getSourceDraggable(),n=i.NAME!==this.NAME,s=this.option("toIndex"),{event:o}=e,a=this._allowDrop(o);if(s!==null&&s>=0&&a){let l,d;if(i!==this&&(l=this._fireAddEvent(o),l||(d=this._fireRemoveEvent(o))),n&&bd(t),this.option("moveItemOnDrop")&&!l&&this._moveItem(t,s,d),i===this)return this._fireReorderEvent(o)}return S().resolve()}dragMove(e){const t=this.option("itemPoints");if(!t)return;const i=this._isVerticalOrientation(),n=i?"top":"left",s=i?e.pageY:e.pageX,o=this.option("rtlEnabled");let a;for(let l=t.length-1;l>=0;l--){const d=t[l+1]&&(t[l][n]+t[l+1][n])/2;if((!i&&o?s>d:d>s)||d===void 0)a=t[l];else break}a&&(this._updatePlaceholderPosition(e,a),this._verticalScrollHelper.isScrolling()&&this._isIndicateMode()&&this._movePlaceholder())}_isIndicateMode(){return this.option("dropFeedbackMode")==="indicate"||this.option("allowDropInsideItem")}_createPlaceholder(){if(!this._isIndicateMode())return;const e=this.option("placeholderClassName");return this._$placeholderElement=h("<div>").addClass(this._addWidgetPrefix("placeholder")).addClass(e??"").insertBefore(this._getSourceDraggable()._$dragElement),this._$placeholderElement}_getItems(){const e=this._getItemsSelector();return this._$content().find(e).not(`.${this._addWidgetPrefix("placeholder")}`).not(`.${this._addWidgetPrefix("clone")}`).toArray()}_allowReordering(){const e=this._getSourceDraggable(),t=this._getTargetDraggable();return e!==t||this.option("allowReordering")}_isValidPoint(e,t,i){const n=this.option("allowDropInsideItem");return!(i||this._allowReordering())&&(e!==0||!n)?!1:this._isIndicateMode()?t===-1||e!==t&&(i||e!==t+1):!0}_getItemPoints(){const e=this;let t=[],i,n,s;const{rtlEnabled:o}=e.option(),a=e._isVerticalOrientation(),l=e._getItems(),d=l.filter(xd),c=d.length,u=this._getDraggableElement(),p=d.indexOf(u.get(0));if(c){for(let g=0;g<=c;g++){const _=!a&&o^g===c,f=a&&g===c;g<c&&(i=h(d[g]),n=i.offset(),s=ge(i)),t.push({dropInsideItem:!1,left:n.left+(_?s:0),top:n.top+(f?t[g-1].height:0),index:g===c?l.length:l.indexOf(i.get(0)),$item:i,width:ge(i),height:Y(i),isValid:e._isValidPoint(g,p)})}if(this.option("allowDropInsideItem")){const g=t;t=[];for(let _=0;_<g.length;_++)t.push(g[_]),g[_+1]&&t.push(b({},g[_],{dropInsideItem:!0,top:Math.floor((g[_].top+g[_+1].top)/2),left:Math.floor((g[_].left+g[_+1].left)/2),isValid:this._isValidPoint(_,p,!0)}))}}else t.push({dropInsideItem:!1,index:0,isValid:!0});return t}_updateItemPoints(e){(e||this.option("autoUpdate")||!this.option("itemPoints"))&&this.option("itemPoints",this._getItemPoints())}_correctItemPoints(e){const t=this.option("itemPoints");if(e&&t&&!this.option("autoUpdate")){const n=this._isVerticalOrientation()?"top":"left";t.forEach((s=>{s[n]-=e}))}}_getElementIndex(e){return this._getItems().indexOf(e.get(0))}_getDragTemplateArgs(e){const t=super._getDragTemplateArgs.apply(this,arguments);return t.model.fromIndex=this._getElementIndex(e),t}_togglePlaceholder(e){var t;(t=this._$placeholderElement)===null||t===void 0||t.toggle(e)}_isVerticalOrientation(){const{itemOrientation:e}=this.option();return e==="vertical"}_normalizeToIndex(e,t){const i=this._getSourceDraggable()!==this._getTargetDraggable(),n=this._getActualFromIndex();return e===null?n:Math.max(i||n>=e||t?e:e-1,0)}_updatePlaceholderPosition(e,t){const i=this._getSourceDraggable(),n=this._normalizeToIndex(t.index,t.dropInsideItem),s=b(this._getEventArgs(e),{toIndex:n,dropInsideItem:t.dropInsideItem});if(t.isValid&&this._getAction("onDragChange")(s),s.cancel||!t.isValid){t.isValid||this.option({dropInsideItem:!1,toIndex:null});return}this.option({dropInsideItem:t.dropInsideItem,toIndex:t.index}),this._getAction("onPlaceholderPrepared")(b(this._getEventArgs(e),{placeholderElement:$(this._$placeholderElement),dragElement:$(i._$dragElement)})),this._updateItemPoints()}_makeWidthCorrection(e,t){if(this._$scrollable=this._getScrollable(e),this._$scrollable){const i=H(this._$scrollable),n=this._$scrollable.offset().left-e.offset().left,s=ge(e)-n-i;n>0&&(t-=n),s>0&&(t-=s)}return t}_updatePlaceholderSizes(e,t){const i=this.option("dropInsideItem"),n=this._isVerticalOrientation();let s="",o="";e.toggleClass(this._addWidgetPrefix("placeholder-inside"),i),(n||i)&&(s=ge(t)),(!n||i)&&(o=Y(t)),s=this._makeWidthCorrection(t,s),e.css({width:s,height:o})}_moveItem(e,t,i){let n;const s=this._getItems(),o=s[t],a=this._getSourceDraggable();i&&(e=e.clone(),a._toggleDragSourceClass(!1,e)),o||(n=s[t-1]),this._moveItemCore(e,o,n)}_moveItemCore(e,t,i){!t&&!i?e.appendTo(this.$element()):i?e.insertAfter(h(i)):e.insertBefore(h(t))}_getDragStartArgs(e,t){return b(super._getDragStartArgs.apply(this,arguments),{fromIndex:this._getElementIndex(t)})}_getEventArgs(e){const t=this._getSourceDraggable(),i=this._getTargetDraggable(),n=i.option("dropInsideItem");return b(super._getEventArgs.apply(this,arguments),{fromIndex:t.option("fromIndex"),toIndex:this._normalizeToIndex(i.option("toIndex"),n),dropInsideItem:n})}_optionChanged(e){const{name:t}=e;switch(t){case"onDragChange":case"onPlaceholderPrepared":case"onAdd":case"onRemove":case"onReorder":this[`_${t}Action`]=this._createActionByOption(t);break;case"fromIndex":[!1,!0].forEach((i=>{const n=i?e.value:e.previousValue;if(n!==null){const s=h(this._getItems()[n]);this._toggleDragSourceClass(i,s)}}));break;case"dropInsideItem":this._optionChangedDropInsideItem(e);break;case"toIndex":this._optionChangedToIndex(e);break;case"itemOrientation":case"allowDropInsideItem":case"moveItemOnDrop":case"dropFeedbackMode":case"itemPoints":case"animation":case"allowReordering":case"fromIndexOffset":case"offset":case"draggableElementSize":case"autoUpdate":case"placeholderClassName":break;default:super._optionChanged(e)}}_optionChangedDropInsideItem(){this._isIndicateMode()&&this._$placeholderElement&&this._movePlaceholder()}_isPositionVisible(e){const t=this.$element();let i;if(t.css("overflow")!=="hidden"?i=t.get(0):t.parents().each((function(){if(h(this).css("overflow")!=="visible")return i=this,!1})),i){const n=re(i),s=this._isVerticalOrientation(),o=s?"top":"left",a=s?"bottom":"right",l=s?vd.pageYOffset:vd.pageXOffset;if(e[o]<n[o]+l||e[o]>n[a]+l)return!1}return!0}_optionChangedToIndex(e){const t=e.value;if(this._isIndicateMode()){const i=t!==null&&t>=0;this._togglePlaceholder(i),i&&this._movePlaceholder()}else this._moveItems(e.previousValue,e.value,e.fullUpdate)}update(){if(this.option("fromIndex")===null&&this.option("toIndex")===null)return;this._updateItemPoints(!0),this._updateDragSourceClass();const e=this.option("toIndex");this._optionChangedToIndex({value:e,fullUpdate:!0})}_updateDragSourceClass(){const e=this._getActualFromIndex(),t=h(this._getItems()[e]);t.length&&(this._$sourceElement=t,this._toggleDragSourceClass(!0,t))}_makeLeftCorrection(e){const t=this._$scrollable;if(t&&this._isVerticalOrientation()){const i=t.offset().left-e;i>0&&(e+=i)}return e}_movePlaceholder(){const e=this,t=e._$placeholderElement||e._createPlaceholder();if(!t)return;const i=e._getItems(),n=e.option("toIndex"),s=e._isVerticalOrientation(),o=this.option("rtlEnabled"),a=e.option("dropInsideItem");let l=null,d=i[n];if(d){const c=h(d);l=c.offset(),!s&&o&&!a&&(l.left+=ge(c,!0))}else{const c=d=this._getPrevVisibleItem(i,n);c&&(l=h(c).offset(),s?l.top+=Y(c,!0):o||(l.left+=ge(c,!0)))}if(e._updatePlaceholderSizes(t,h(d)),l&&!e._isPositionVisible(l)&&(l=null),l){const c=s&&n===i.length,u=Y(t);l.left=e._makeLeftCorrection(l.left),l.top=c&&l.top>=u?l.top-u:l.top,e._move(l,t)}t.toggle(!!l)}_getPositions(e,t,i,n){const s=[];for(let o=0;o<e.length;o++){let a=0;if(n===null||i===null){s.push(a);continue}i===-1?o>=n&&(a=t):n===-1?o>i&&(a=-t):i<n?o>i&&o<n&&(a=-t):i>n&&o>=n&&o<i&&(a=t),s.push(a)}return s}_getDraggableElementSize(e){const t=this._getDraggableElement();let i=this.option("draggableElementSize");return i||(i=e?(Y(t)+Y(t,!0))/2:(ge(t)+ge(t,!0))/2,this.option("autoUpdate")||this.option("draggableElementSize",i)),i}_getActualFromIndex(){const{fromIndex:e,fromIndexOffset:t,offset:i}=this.option();return e==null?null:e+t-i}_moveItems(e,t,i){const n=this._getActualFromIndex(),s=this._isVerticalOrientation(),o=s?"top":"left",a=this._getDraggableElementSize(s),l=this._getItems(),d=this._getPositions(l,a,n,e),c=this._getPositions(l,a,n,t),u=this.option("animation"),p=this.option("rtlEnabled");for(let g=0;g<l.length;g++){const _=l[g],f=d[g],C=c[g];t===null||n===null?lS(_):(f!==C||i&&m(C))&&aS(_,b({},u,{to:{[o]:!s&&p?-C:C}}))}}_toggleDragSourceClass(e,t){const i=t||this._$sourceElement;super._toggleDragSourceClass.apply(this,arguments),this._isIndicateMode()||i==null||i.toggleClass(this._addWidgetPrefix("source-hidden"),e)}_dispose(){this.reset(),super._dispose()}_fireAddEvent(e){const t=this._getEventArgs(e);return this._getAction("onAdd")(t),t.cancel}_fireRemoveEvent(e){const t=this._getSourceDraggable(),i=this._getEventArgs(e);return t._getAction("onRemove")(i),i.cancel}_fireReorderEvent(e){const t=this._getEventArgs(e);return this._getAction("onReorder")(t),t.promise||S().resolve()}}_e(rS,Sh);const cS={dragCell:"dx-drag-cell"},Yt={cellFocusDisabled:"dx-cell-focus-disabled",handleIcon:"drag-icon",commandDrag:"dx-command-drag",sortableWithoutHandle:"dx-sortable-without-handle",rowsView:"rowsview",dragView:"dragview"},uS=r=>(e,t)=>{const i=h(e);if(t.rowType==="data")return i.addClass(Yt.cellFocusDisabled),h("<span>").addClass(r(Yt.handleIcon));y.setEmptyText(i)},hS={createHandleTemplateFunc:uS},pS=r=>class extends r{init(){super.init.apply(this,arguments),this._updateHandleColumn()}optionChanged(e){e.name==="rowDragging"&&(this._updateHandleColumn(),this._invalidate(!0,!0),e.handled=!0),super.optionChanged.apply(this,arguments)}_allowReordering(){const e=this.option("rowDragging");return!!(e&&(e.allowReordering||e.allowDropInsideItem||e.group))}_updateHandleColumn(){const e=this.option("rowDragging"),t=this._allowReordering(),i=this._columnsController,n=t&&e.showDragIcons;i==null||i.addCommandColumn({type:"drag",command:"drag",visibleIndex:-2,alignment:"center",elementAttr:[{name:cS.dragCell,value:""}],cssClass:Yt.commandDrag,width:"auto",cellTemplate:this._getHandleTemplate(),visible:n}),i==null||i.columnOption("type:drag","visible",n)}_renderContent(){const e=this.option("rowDragging"),t=this._allowReordering(),i=super._renderContent.apply(this,arguments),n=this._isFixedTableRendering,s=n?"_sortableFixed":"_sortable",o=n?"_sortable":"_sortableFixed",a=c=>{var u;(u=this._sortableFixed)===null||u===void 0||u.$element().css("pointerEvents",c?"auto":"")},l=".dx-row:not(.dx-freespace-row):not(.dx-virtual-row):not(.dx-header-row):not(.dx-footer-row)",d=this.option("dataRowTemplate")?`> table > tbody${l}`:`> table > tbody > ${l}`;return(t||this[s])&&i.length&&(this[s]=this._createComponent(i,Sh,b({component:this.component,contentTemplate:null,filter:d,cursorOffset:c=>{const{event:u}=c,p=h(this.element()).offset();return{x:u.pageX-p.left}},onDraggableElementShown:c=>{if(e.dragTemplate)return;const p=h(c.dragElement).children(".dx-widget").data(this.component.NAME);this._synchronizeScrollLeftPosition(p)},dragTemplate:this._getDraggableRowTemplate(),handle:e.showDragIcons&&`.${Yt.commandDrag}`,dropFeedbackMode:"indicate"},e,{onDragStart:c=>{var u,p;(u=this.getController("keyboardNavigation"))===null||u===void 0||u._resetFocusedCell();const g=c.component.getVisibleRows()[c.fromIndex];c.itemData=g==null?void 0:g.data;const _=g&&g.rowType==="data";c.cancel=!t||!_,(p=e.onDragStart)===null||p===void 0||p.call(e,c)},onDragEnter:c=>{c.fromComponent!==c.toComponent&&a(!0)},onDragLeave:()=>{a(!1)},onDragEnd:c=>{var u;a(!1),(u=e.onDragEnd)===null||u===void 0||u.call(e,c)},onAdd:c=>{var u;a(!1),(u=e.onAdd)===null||u===void 0||u.call(e,c)},dropFeedbackMode:e.dropFeedbackMode,onOptionChanged:c=>{this._sortableFixed&&(c.name==="fromIndex"||c.name==="toIndex")&&this[o].option(c.name,c.value)}})),i.toggleClass("dx-scrollable-container",n),i.toggleClass(Yt.sortableWithoutHandle,t&&!e.showDragIcons)),i}_renderCore(e){super._renderCore.apply(this,arguments),e&&e.changeType==="update"&&e.repaintChangesOnly&&y.isVirtualRowRendering(this)&&je((()=>{this._updateSortable()}))}_updateSortable(){const e=this._dataController.getRowIndexOffset(),t=e-this._previousOffset;[this._sortable,this._sortableFixed].forEach((i=>{const n=i==null?void 0:i.option("toIndex");m(n)&&m(this._previousOffset)&&(i==null||i.option("toIndex",n-t)),i==null||i.option("offset",e),i==null||i.update()})),this._previousOffset=e}_resizeCore(){super._resizeCore.apply(this,arguments),this._updateSortable()}_getDraggableGridOptions(e){const t=this.option(),i=this.getColumns(),n=h(this.getRowElement(e.rowIndex));return{dataSource:[{id:1,parentId:0}],showBorders:!0,showColumnHeaders:!1,scrolling:{useNative:!1,showScrollbar:"never"},pager:{visible:!1},loadingTimeout:null,columnFixing:t.columnFixing,columnAutoWidth:t.columnAutoWidth,showColumnLines:t.showColumnLines,columns:i.map((s=>({width:s.width||s.visibleWidth,fixed:s.fixed,fixedPosition:s.fixedPosition}))),isDragging:!0,onRowPrepared:s=>{const o=s.component.getView("rowsView");h(s.rowElement).replaceWith(n.eq(o._isFixedTableRendering?1:0).clone())}}}_synchronizeScrollLeftPosition(e){const t=e==null?void 0:e.getScrollable();t==null||t.scrollTo({x:this._scrollLeft})}_getDraggableRowTemplate(){return e=>{const t=this.component.$element(),i=h("<div>");on(i,H(t));const n=this._dataController.items(),s=n&&n[e.fromIndex],o=this._getDraggableGridOptions(s);return this._createComponent(i,this.component.NAME,o),i.find(".dx-gridbase-container").children(`:not(.${this.addWidgetPrefix(Yt.rowsView)})`).hide(),i.addClass(this.addWidgetPrefix(Yt.dragView)),i}}_getHandleTemplate(){return hS.createHandleTemplateFunc((e=>this.addWidgetPrefix(e)))}},uE={defaultOptions:()=>({rowDragging:{showDragIcons:!0,dropFeedbackMode:"indicate",allowReordering:!1,allowDropInsideItem:!1}}),extenders:{views:{rowsView:pS}}};export{Vo as $,US as A,GS as B,hg as C,IS as D,qS as E,jS as F,OS as G,XS as H,ZS as I,QS as J,JS as K,tE as L,iE as M,sE as N,vS as O,oE as P,eI as Q,Cg as R,Ne as S,xs as T,rE as U,aE as V,lE as W,dE as X,cE as Y,uE as Z,pr as _,bS as a,yr as a0,Ac as a1,Tm as a2,Nm as a3,u_ as a4,cf as a5,Jx as a6,Zx as a7,H_ as a8,$_ as a9,N_ as aa,Sy as ab,os as ac,mC as ad,Sh as ae,$c as af,Lc as ag,rs as ah,_o as ai,bh as aj,FS as ak,KS as al,bu as am,Dc as an,wg as ao,mw as ap,gw as aq,_n as ar,Rm as b,wS as c,yS as d,TS as e,DS as f,y as g,RS as h,VS as i,AS as j,PS as k,kS as l,j as m,nc as n,xS as o,Hn as p,MS as q,ES as r,SS as s,NS as t,LS as u,vv as v,$S as w,HS as x,WS as y,zS as z};
