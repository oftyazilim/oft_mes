import{d8 as V,dg as Pt,dr as Da,d9 as Ye,a_ as Qe,d4 as le,d0 as J,e2 as mt,dp as we,d5 as M,d3 as oe,da as Dn,ds as Ia,de as Xe,dE as Me,db as Ue,d1 as Pe,d6 as Kt,di as re,dF as Ha,dc as Yt,e4 as Ra,dU as In,dl as Re,e3 as Na,d7 as ne,dL as La,d as pe,r as ce,v as ka,w as Ma,aO as $a,A as Oa,aI as Qt,c as Ba,b as X,f as ye,u as Z,F as Va,e as Te,ar as Ga,as as za,g as Wa,aG as ja,o as Xt}from"./main-Do_EEeaU.js";import{D as Ua,f as qa,h as Ka,i as Ya,a as Qa}from"./chart-DKFFwr8F.js";import{D as Ze}from"./check-box-DbEA9tcU.js";import{y as Xa,s as Ja,D as ge,j as Za,k as eo,l as to}from"./data-grid-BQ4a7u-d.js";import{D as no}from"./load-panel-C1ouZFGE.js";import{p as ao,a as _e}from"./editor-DoOc0su0.js";import{f as lt,bd as oo,h as Ce,r as R,aT as lo,c as Hn,Y as Rn,b3 as qe,Q as ro,aK as Nn,N as Ln,aJ as so,O as io,P as Le,D as co,e as be,l as ze,an as Jt,ao as Zt,ap as en,b5 as uo,b6 as ho,bj as po,b4 as go,H as $e,B as Je,aB as rt,g as me,R as We,a as pt,C as Dt,W as kn,aI as fo,aL as mo}from"./overlay-DnbPrWeY.js";import{D as st,aq as _o,A as $t,m as xo,q as Co,a as tn,at as nn,e as et,i as wo,b as vo,g as So,B as It,P as Mn}from"./m_select_box-D0u5Mf1k.js";import{$ as it,ai as yo,aj as an,ak as To,al as Eo,g as je,am as Fo,an as bo,ao as Ao,ap as Po,aq as Do,_ as $n,ar as Io}from"./m_row_dragging-BxKAL-qG.js";import{d as Ho,c as Ro}from"./themes-UUA7mPQe.js";import{E as On,M as No,g as Lo,e as ko}from"./exceljs.min-BquV-Ntc.js";import{a as Mo}from"./popup-DW-uyodG.js";import{s as $o}from"./FileSaver-CQu8bA20.js";import{D as _t}from"./button-DAtfDNal.js";import{D as on}from"./date-box-CneIt6cK.js";import{D as Oo}from"./select-box-DqeA75fr.js";import{u as Bo}from"./pageTitle-B7icIlhD.js";import{f as ln}from"./date-C9GFWz3S.js";import{V as Vo,a as Go}from"./VCard-Cr7Zu6A8.js";import{V as zo}from"./VSwitch-B6Q9yTAE.js";import"./m_base_widget-BwXvduad.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./dayjs.min-WZT4ZYRx.js";import"./tr-gc5XBwcp.js";import"./createSimpleFunctional-DilE7x-C.js";import"./VAvatar-BvjilrSr.js";import"./VImg-CORTftTQ.js";import"./index-NBzQHe__.js";import"./VCardText-Bo3ADCXR.js";import"./VInput-CswTLcut.js";import"./focus-DkQWR53M.js";import"./form-1PnKrY7N.js";import"./VSelectionControl-CioP0fRn.js";class Wo{constructor(e,n,a,o){this.component=e,this.dataProvider=n,this.worksheet=a,this.mergedRangesManager=new No(n,a),this.topLeftCell=o.topLeftCell,this.customizeCell=o.customizeCell,this.mergeColumnFieldValues=o.mergeColumnFieldValues,this.mergeRowFieldValues=o.mergeRowFieldValues,this.exportFilterFieldHeaders=o.exportFilterFieldHeaders,this.exportDataFieldHeaders=o.exportDataFieldHeaders,this.exportColumnFieldHeaders=o.exportColumnFieldHeaders,this.exportRowFieldHeaders=o.exportRowFieldHeaders,this.rtlEnabled=e.option("rtlEnabled"),this.rowHeaderLayout=e.option("rowHeaderLayout"),this.wrapText=!!e.option("wordWrapEnabled"),this.filterFieldHeaders=this._tryGetFieldHeaders("filter"),this.dataFieldHeaders=this._tryGetFieldHeaders("data"),this.columnFieldHeaders=this._tryGetFieldHeaders("column"),this.rowFieldHeaders=this._tryGetFieldHeaders("row")}_getFirstColumnIndex(){return this.topLeftCell.column}_getWorksheetFrozenState(e){const{x:n,y:a}=this.dataProvider.getFrozenArea();return{state:"frozen",xSplit:e.from.column+n-1,ySplit:e.from.row+a+this._getFieldHeaderRowsCount()-1}}_getFieldHeaderRowsCount(){return 0+this._allowExportFilterFieldHeaders()+(this._allowExportDataFieldHeaders()||this._allowExportColumnFieldHeaders())}_isFrozenZone(){return!0}_isHeaderCell(e,n){return e<this.dataProvider.getColumnAreaRowCount()||n<this.dataProvider.getRowAreaColCount()}_getDefaultFieldHeaderCellsData(e){return{text:e,value:e}}_isInfoCell(e,n){return e<this.dataProvider.getColumnAreaRowCount()&&n<this.dataProvider.getRowAreaColCount()}_allowToMergeRange(e,n,a,o){return!(this.dataProvider.isColumnAreaCell(e,n)&&!this.mergeColumnFieldValues&&o||this.dataProvider.isRowAreaCell(e,n)&&!this.mergeRowFieldValues&&a)}_trySetAutoFilter(){}_trySetFont(e,n){V(n)&&(e.font=e.font||{},e.font.bold=n)}_getFieldHeaderStyles(){const e={style:"thin",color:{argb:"FF7E7E7E"}};return{alignment:lt(this.rtlEnabled),bold:!0,border:{bottom:e,left:e,right:e,top:e}}}_trySetOutlineLevel(){}_getAllFieldHeaders(){return this.dataProvider._exportController.getDataSource()._descriptions}_tryGetFieldHeaders(e){if(!this[`export${Da(e,!0)}FieldHeaders`])return[];const n=this._getAllFieldHeaders()[e==="data"?"values":`${e}s`].filter((a=>a.area===e));return lt(this.rtlEnabled)==="right"&&n.sort(((a,o)=>o.areaIndex-a.areaIndex)),n.map((a=>a.caption))}_customizeCell(e,n,a){Ye(this.customizeCell)&&!a&&this.customizeCell({excelCell:e,pivotCell:n})}_isRowFieldHeadersRow(e){const n=this._isInfoCell(e,0)&&this.dataProvider.getCellData(e+1,0,!0).cellSourceData.area==="row";return this._allowExportRowFieldHeaders()&&n}_exportAllFieldHeaders(e,n){const a=e.length,o=this.dataProvider.getRowAreaColCount();let r=this.topLeftCell.row;this._allowExportFilterFieldHeaders()&&(this._exportFieldHeaders("filter",r,0,a,n),r+=1),this._allowExportDataFieldHeaders()&&(this._exportFieldHeaders("data",r,0,o,n),this._allowExportColumnFieldHeaders()||this._exportFieldHeaders("column",r,o,a-o,n)),this._allowExportColumnFieldHeaders()&&(this._allowExportDataFieldHeaders()||this._exportFieldHeaders("data",r,0,o,n),this._exportFieldHeaders("column",r,o,a-o,n))}_exportFieldHeaders(e,n,a,o,r){const u=this[`${e}FieldHeaders`],s=this.worksheet.getRow(n),d=e!=="row"||e==="row"&&this.rowHeaderLayout==="tree";d&&this.mergedRangesManager.addMergedRange(s.getCell(this.topLeftCell.column+a),0,o-1);for(let p=0;p<o;p+=1){const C=s.getCell(this.topLeftCell.column+a+p),g=u;let x=[];const F=g.length>o||d?g.join(", "):g[p];x=Qe({},this._getDefaultFieldHeaderCellsData(F),{headerType:e}),C.value=F,this._applyHeaderStyles(C,r),this._customizeCell(C,x)}}_applyHeaderStyles(e,n){const{bold:a,alignment:o,border:r}=this._getFieldHeaderStyles();this._trySetFont(e,a),n(e,this.wrapText,o),e.border=r}_allowExportRowFieldHeaders(){return this.rowFieldHeaders.length>0}_allowExportFilterFieldHeaders(){return this.filterFieldHeaders.length>0}_allowExportDataFieldHeaders(){return this.dataFieldHeaders.length>0}_allowExportColumnFieldHeaders(){return this.columnFieldHeaders.length>0}}function jo(t){return On.export(Uo(t),Wo,qo,Ko)}function Uo(t){if(!(V(t)&&Pt(t)))throw Error('The "exportPivotGrid" method requires a configuration object.');if(!(V(t.component)&&Pt(t.component)&&t.component.NAME==="dxPivotGrid"))throw Error('The "component" field must contain a PivotGrid instance.');return V(t.mergeRowFieldValues)||(t.mergeRowFieldValues=!0),V(t.mergeColumnFieldValues)||(t.mergeColumnFieldValues=!0),V(t.exportDataFieldHeaders)||(t.exportDataFieldHeaders=!1),V(t.exportRowFieldHeaders)||(t.exportRowFieldHeaders=!1),V(t.exportColumnFieldHeaders)||(t.exportColumnFieldHeaders=!1),V(t.exportFilterFieldHeaders)||(t.exportFilterFieldHeaders=!1),On.getFullOptions(t)}function qo(t){return t._dataArea.groupElement()}function Ko(t){return t.$element()}const Yo={scrollBarMeasureElement:"dx-pivotgrid-scrollbar-measure-element"},Se=function(t,e,n,a){const o=t._initProperties=t._initProperties||{},r=a?n:t[e];(!Object.prototype.hasOwnProperty.call(o,e)||a)&&e!=="_initProperties"&&(o[e]=r),t[e]=n};function Qo(t){return _o.sendRequest(t)}let rn=new Date;function Bn(t){const e=function(n,a,o,r,u,s){r=r||[],n=n||[];let d,p;u=u||0;function C(g,x,F){oe(e(n,a,o,r,x,F)).done(g.resolve)}for(d=u;d<n.length;d+=1){if(t&&d>u&&d%1e4===0&&new Date-rn>=300)return rn=new Date,p=new le,C(p,d,!1),p;const g=n[d];if(!s){if(r.unshift(g),o&&a(r,d)===!1)return;if(g.children){const x=e(g.children,a,o,r);if(t&&x)return p=new le,x.done(C(p,d,!0)),p}}if(s=!1,!o&&a(r,d)===!1)return;r.shift(),n[d]!==g&&(d-=1)}};return e}const ie=Bn(!1),ve=Bn(!0);function He(t,e){if(t&&V(e))for(let n=0;n<t.length;n+=1){const a=t[n];if(a.name===e||a.caption===e||a.dataField===e||a.index===e)return n}return-1}function gt(t,e){const n=t===t&&it.format(t,e.format),a={value:t,valueText:n||""};return e.customizeText?e.customizeText.call(e,a):a.valueText}function dt(t){return function(e,n){let a=0;const o=t(e),r=t(n),u=V(o),s=V(r);return u&&s&&(o>r?a=1:o<r&&(a=-1)),u&&!s&&(a=1),!u&&s&&(a=-1),a}}function fe(t){const e=[];for(let n=t.length-1;n>=0;n-=1)e.push(t[n].key||t[n].value);return e}function ft(t,e,n,a){n=n||0,a=a||"children",t.length&&e(t,n);for(let r=0;r<t.length;r+=1){var o;const u=t[r];(o=u[a])!==null&&o!==void 0&&o.length&&ft(u[a],e,n+1,a)}}function Vn(t,e){const n=[];for(let a=0;a<t.length;a+=1)n.push(Math.max(t[a]||0,e[a]||0));return n}function Ke(t,e){const n=t[e],a=(e==="columns"?t.columnExpandedPaths:t.rowExpandedPaths)||[];let o=0;for(t.headerName===e?o=t.path.length:t.headerName&&t.headerName!==e&&t.oppositePath?o=t.oppositePath.length:M(a,((r,u)=>{o=Math.max(o,u.length)}));n[o+1]&&n[o].expanded;)o+=1;return o}function Xo(t){return Xe(["year","quarter","month"],((e,n)=>J({},t,{groupInterval:e,groupIndex:n})))}function Gn(t,e,n,a){const o=[];return Object.keys(e||[]).forEach((r=>{if(r&&r.startsWith("__"))return;let u=1;const s=n.length?`${n}.${r}`:r;let d=a[s];const p=Dn(s);let C=e[r],g;for(;!V(C)&&t[u];)C=p(t[u]),u+=1;!d&&V(C)&&(d=Ia(C)),g=[{dataField:s,dataType:d,groupName:d==="date"?r:void 0,groupInterval:void 0,displayFolder:n}],d==="date"?g=g.concat(Xo(g[0])):d==="object"&&(g=Gn(t,C,s,a)),o.push.apply(o,g)})),o}function zn(t,e){const n=Ot(e);return Gn(t,t[0],"",n)}function Ot(t){const e={};return M(t,((n,a)=>{e[a.dataField]=e[a.dataField]||a.dataType})),e}const Jo={month:t=>mt.getMonthNames()[t-1],quarter:t=>mt.format(new Date(2e3,3*t-1),"quarter"),dayOfWeek:t=>mt.getDayNames()[t]};function Bt(t){if(t.dataType==="date")t.format||Se(t,"format",Jo[t.groupInterval]);else if(t.dataType==="number"){const e=we(t.groupInterval)&&t.groupInterval>0&&t.groupInterval;e&&!t.customizeText&&Se(t,"customizeText",(n=>{const a=n.value+e,o=it.format(a,t.format);return n.valueText&&o?`${n.valueText} - ${o}`:""}))}}function De(t,e){const n=[];e=e||[];for(let a=0;a<e.length;a+=1)n.push(J({},t[a],{groupIndex:null,groupName:null,filterType:"include",filterValues:[e[a]]}));return n}const Vt={createDrillDownDataSource(t,e){const n=this.getDrillDownItems(t,e);function a(r){return function(u){let s;return s=new le,oe(n).done((d=>{new $t(d)[r](u).done(s.resolve).fail(s.reject)})).fail(s.reject),s}}return new st({load:a("load"),totalCount:a("totalCount"),key:this.key()})}},Wn=t=>t.offsetWidth-t.clientWidth,jn=oo((()=>{const t=Ce.getDocument();t.body.insertAdjacentHTML("beforeend",`<div class="${Yo.scrollBarMeasureElement}"></div>`);const e=t.body.lastElementChild,n=Wn(e);return e&&t.body.removeChild(e),n})),Gt={setFieldProperty:Se,sendRequest:Qo,foreachTree:ie,foreachTreeAsync:ve,findField:He,formatValue:gt,getCompareFunction:dt,createPath:fe,foreachDataLevel:ft,mergeArraysByMaxValue:Vn,getExpandedLevel:Ke,discoverObjectFields:zn,getFieldsDataType:Ot,setDefaultFieldValueFormatting:Bt,getFiltersByPath:De,storeDrillDownMixin:Vt,getScrollbarWidth:Wn,calculateScrollbarWidth:jn},Zo={number:"numeric",date:"datetime"},Ht="dxPivotGridUnbinding";function sn(t,e){const n=[],a=e.length-1;return M(t,((o,r)=>{n.push(r.text||gt(r.value,e[a-o]))})),n.reverse()}function dn(t){let e=0;return ie(t,(n=>{e=Math.max(e,n.length-1)})),e}function el(t,e){let{chartDataItem:n}=t,a=e&&e(t);return a?(n=J({},n,a.chartDataItem),a=J({},t,a,{chartDataItem:n}),a):t}function tl(t,e,n){const a=t.getData(),o=[],r=t.getAreaFields("data"),u=t.getAreaFields("row"),s=t.getAreaFields("column"),d=[{index:a.grandTotalColumnIndex,children:a.columns}],p=[{index:a.grandTotalRowIndex,children:a.rows}],C=dn(p),g=dn(d);let x,F,A,y,O,L,G,j,l,i;function c(){const m=(a.values[A]||[])[G]||[],S=m[x];let T,v={rowPath:L,maxRowLevel:C,rowPathFormatted:O,rowFields:u,columnPathFormatted:i,maxColumnLevel:g,columnPath:l,columnFields:s,dataFields:r,dataIndex:x,dataValues:m,visible:j&&y},E=(e.inverted?i:O).join(" - "),h=(e.inverted?O:i).join("/");r.length>1&&((e.putDataFieldsInto==="args"||e.putDataFieldsInto==="both")&&(h+=` | ${F.caption}`),e.putDataFieldsInto!=="args"&&(E+=` | ${F.caption}`,e.dataFieldsDisplayMode!=="singleAxis"&&(T=F.caption))),v.chartDataItem={val:S===void 0?null:S,series:E,arg:h},v=el(v,e.processCell),v.visible&&(n[v.chartDataItem.series]=n[v.chartDataItem.series]||T,o.push(v.chartDataItem))}function f(m){ie(p,(S=>{A=S[0].index,S=S.slice(0,S.length-1),y=C===S.length,L=fe(S),O=sn(S,u),L.length===0&&(O=[e.grandTotalText]),ie(d,(T=>{G=T[0].index,T=T.slice(0,T.length-1),j=g===T.length,l=fe(T),i=sn(T,s),l.length===0&&(i=[e.grandTotalText]),m()}))}))}function _(m){M(r,((S,T)=>{F=T,x=S,m()}))}return e.alternateDataFields===!1?_((()=>{f(c)})):f((()=>{_(c)})),o}function nl(t,e){const n=t.getAreaFields("data");if(e.putDataFieldsInto!=="args"&&e.dataFieldsDisplayMode!=="singleAxis"||n.length===1){const a=[];return M(n,((o,r)=>{const u={name:r.caption,title:r.caption,valueType:Zo[r.dataType]||r.dataType,label:{format:r.format}};r.customizeText&&(u.label.customizeText=function(s){return r.customizeText.call(r,s)}),e.dataFieldsDisplayMode==="splitPanes"&&(u.pane=r.caption),a.push(u)})),a}return[{}]}function al(t,e){const n=[],a=t.getAreaFields("data");return a.length>1&&e.dataFieldsDisplayMode==="splitPanes"&&e.putDataFieldsInto!=="args"&&M(a,((o,r)=>{n.push({name:r.caption})})),n.length||n.push({}),n}function ol(t,e){const{customizeSeries:n}=e,{customizeChart:a}=e;let o={valueAxis:nl(t,e),panes:al(t,e)};const r={};return a&&(o=J(!0,{},o,a(o))),o.dataSource=tl(t,e,r),o.seriesTemplate={nameField:"series",customizeSeries(u){let s={};return e.dataFieldsDisplayMode==="splitPanes"?s.pane=r[u]:e.dataFieldsDisplayMode!=="singleAxis"&&(s.axis=r[u]),n&&(s=J(s,n(u,s))),s}},o}function ll(t){if(!t)return!1;if(t.NAME)return t.NAME==="dxChart"&&t;const e=R(t);return e.data("dxChart")&&e.dxChart("instance")}function rl(t){const e=t.$element().data(Ht);e&&e()}const sl={bindChart(t,e){e=J({},e);const n=this,a=function(){e.grandTotalText=n.option("texts.grandTotal");const r=ol(n.getDataSource(),e);t.option(r)};if(t=ll(t),!t)return null;rl(t),n.on("changed",a),a();const o=function(){t.$element().removeData(Ht),n.off("changed",a)};return t.on("disposing",o),this.on("disposing",o),t.$element().data(Ht,o),o}};function il(t){const e=t();let n={};return function(a){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r={top:a.top!==void 0?Math.ceil(a.top):void 0,left:a.left!==void 0?Math.ceil(a.left):void 0},u=r.top===n.top&&r.left===n.left;!o&&u||(n=r,e.scrollTo(a))}}const dl=function(t){let e=0;const{offsetWidth:n}=t;if(t.getBoundingClientRect){const a=Rn(t);e=a.width,e||(e=a.right-a.left),e<=n-1&&(e=n)}return e>0?e:n};function cn(t,e,n,a){let o=0,r=0;const u=n/2;return t+a-(e+n)>1?(t>=e+n+u&&(r=parseInt((t-(e+n))/u,10)),o=e+n+u*r):t<e?(t<=e-u&&(r=parseInt((t-(e-u))/u,10)),o=e-(n-u*r)):o=e,o}class zt{constructor(e){this.component=e}option(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return this.component.option.apply(this.component,arguments)}_getRowElement(e){const n=this;return n._tableElement&&n._tableElement.length>0?n._tableElement[0].rows[e]:null}_createGroupElement(){return R("<div>")}_createTableElement(){return R("<table>")}_getCellText(e,n){let a=e.isWhiteSpace?"&nbsp":e.text||"&nbsp";return n&&(a.indexOf("<")!==-1||a.indexOf(">")!==-1)&&(a=R("<div>").text(a).html()),a}_getRowClassNames(){}_applyCustomStyles(e){e.cell.width&&e.cssArray.push(`min-width:${e.cell.width}px`),e.cell.sorted&&e.classArray.push("dx-pivotgrid-sorted")}_getMainElementMarkup(){return Ce.createElement("tbody")}_getCloseMainElementMarkup(){return"</tbody>"}_renderTableContent(e,n){const a=this,o=n.length;let r,u,s,d,p;const C=a.option("rtlEnabled"),g=a.option("encodeHtml");let x;e.data("area",a._getAreaName()),e.data("data",n),e.css("width","");const F=this._getMainElementMarkup();for(s=0;s<o;s+=1){r=n[s],x=[];const A=Ce.createElement("tr");for(d=0;d<r.length;d+=1){u=r[d],this._getRowClassNames(s,u,x);const y=Ce.createElement("td");if(u){u.rowspan&&y.setAttribute("rowspan",u.rowspan||1),u.colspan&&y.setAttribute("colspan",u.colspan||1);const L={cellElement:void 0,cell:u,cellsCount:r.length,cellIndex:d,rowElement:void 0,rowIndex:s,rowsCount:o,rtlEnabled:C,classArray:[],cssArray:[]};if(a._applyCustomStyles(L),L.cssArray.length&&lo(y,L.cssArray.join(";")),L.classArray.length&&y.setAttribute("class",L.classArray.join(" ")),V(u.expanded)){const G=Ce.createElement("div");G.classList.add("dx-expand-icon-container");const j=Ce.createElement("span");j.classList.add("dx-expand"),G.appendChild(j),y.appendChild(G)}p=this._getCellText(u,g)}else p="";const O=Ce.createElement("span");if(V(u.wordWrapEnabled)&&(O.style.whiteSpace=u.wordWrapEnabled?"normal":"nowrap"),O.innerHTML=p,y.appendChild(O),u.sorted){const L=Ce.createElement("span");L.classList.add("dx-icon-sorted"),y.appendChild(L)}A.appendChild(y)}x.length&&A.setAttribute("class",x.join(" ")),F.appendChild(A)}e.append(F),this._triggerOnCellPrepared(e,n)}_triggerOnCellPrepared(e,n){const a=this,o=e.find("tr"),r=a._getAreaName(),u=a.option("onCellPrepared"),s=a.component._eventsStrategy.hasEvent("cellPrepared");let d,p,C;const g=this.component._defaultActionArgs();let x,F,A,y;if(u||s)for(A=0;A<n.length;A+=1)for(x=n[A],d=o.eq(A),y=0;y<x.length;y+=1)F=x[y],p=d.children().eq(y),C={area:r,rowIndex:A,columnIndex:y,cellElement:Hn(p),cell:F},s?a.component._trigger("onCellPrepared",C):u(J(C,g))}_getRowHeight(e){const n=this._getRowElement(e);let a=0;const{offsetHeight:o}=n;return n&&n.lastChild?(n.getBoundingClientRect&&(a=Rn(n).height,a<=o-1&&(a=o)),a>0?a:o):0}_setRowHeight(e,n){const a=this._getRowElement(e);a&&(a.style.height=`${n}px`)}getRowsLength(){const e=this;return e._tableElement&&e._tableElement.length>0?e._tableElement[0].rows.length:0}getRowsHeight(){const e=this,n=[],a=e.getRowsLength();for(let o=0;o<a;o+=1)n.push(e._getRowHeight(o));return n}setRowsHeight(e){const n=this;let a=0;const o=e.length;for(let r=0;r<o;r+=1)a+=e[r],n._setRowHeight(r,e[r]);this._tableHeight=a,this._tableElement[0].style.height=`${a}px`}getColumnsWidth(){const e=this.getRowsLength();let n,a,o,r;const u=[],s=[],d=function(p,C,g,x,F){let A,y;for(A=0;A<x;A+=1)for(y=0;y<F;y+=1)p[C+A]=p[C+A]||[],p[C+A][g+y]=!0};if(e)for(n=0;n<e;n+=1)for(u[n]=u[n]||[],a=this._getRowElement(n),o=0;o<a.cells.length;o+=1){for(r=0;u[n][r];r+=1);d(u,n,r,a.cells[o].rowSpan,a.cells[o].colSpan),a.cells[o].colSpan===1&&(s[r]=s[r]||dl(a.cells[o]))}return s}setColumnsWidth(e){let n;const a=this._tableElement[0];this._colgroupElement.html("");const o=this.getColumnsCount(),r=[];for(n=0;n<o;n+=1)r.push(e[n]||0);for(n=o;n<e.length&&e;n+=1)r[o-1]+=e[n];for(n=0;n<o;n+=1){const u=Ce.createElement("col");u.style.width=`${r[n]}px`,this._colgroupElement.append(u)}this._tableWidth=r.reduce(((u,s)=>u+s),0),a.style.width=`${this._tableWidth}px`,a.style.tableLayout="fixed"}resetColumnsWidth(){qe(this._colgroupElement.find("col"),"auto"),this._tableElement.css({width:"",tableLayout:""})}setGroupWidth(e){this._getScrollable().option("width",e)}setGroupHeight(e){this._getScrollable().option("height",e)}getGroupHeight(){return this._getGroupElementSize("height")}getGroupWidth(){return this._getGroupElementSize("width")}_getGroupElementSize(e){const n=this.groupElement()[0].style[e];return n.indexOf("px")>0?parseFloat(n):null}groupElement(){return this._groupElement}tableElement(){return this._tableElement}element(){return this._rootElement}headElement(){return this._tableElement.find("thead")}_setTableCss(e){this.option("rtlEnabled")&&(e.right=e.left,delete e.left),this.tableElement().css(e)}setVirtualContentParams(e){this._virtualContent.css({width:e.width,height:e.height}),this.groupElement().addClass("dx-virtual-mode")}disableVirtualMode(){this.groupElement().removeClass("dx-virtual-mode")}_renderVirtualContent(){const e=this;!e._virtualContent&&e.option("scrolling.mode")==="virtual"&&(e._virtualContent=R("<div>").addClass("dx-virtual-content").insertBefore(e._tableElement))}reset(){const e=this._tableElement[0];if(this._fakeTable&&this._fakeTable.detach(),this._fakeTable=null,this.disableVirtualMode(),this.setGroupWidth("100%"),this.setGroupHeight("auto"),this.resetColumnsWidth(),e){for(let n=0;n<e.rows.length;n+=1)e.rows[n].style.height="";e.style.height="",e.style.width="100%"}}_updateFakeTableVisibility(){const e=this,n=e.tableElement()[0],a=e.option("rtlEnabled")?"right":"left",o=e._fakeTable[0];n.style.top===o.style.top&&o.style[a]===n.style[a]?e._fakeTable.addClass("dx-hidden"):e._fakeTable.removeClass("dx-hidden")}_moveFakeTableHorizontally(e){const n=this,o=n.option("rtlEnabled")?"right":"left",r=parseFloat(n.tableElement()[0].style[o]),u=cn(e,r,n._tableWidth,n.getGroupWidth());parseFloat(n._fakeTable[0].style[o])!==u&&(n._fakeTable[0].style[o]=`${u}px`)}_moveFakeTableTop(e){const n=this,a=parseFloat(n.tableElement()[0].style.top),o=cn(e,a,n._tableHeight,n.getGroupHeight());parseFloat(n._fakeTable[0].style.top)!==o&&(n._fakeTable[0].style.top=`${o}px`)}_moveFakeTable(){this._updateFakeTableVisibility()}_createFakeTable(){const e=this;e._fakeTable||(e._fakeTable=e.tableElement().clone().addClass("dx-pivot-grid-fake-table").appendTo(e._virtualContent))}render(e,n){const a=this;if(a._tableElement){try{a._tableElement[0].innerHTML=""}catch{a._tableElement.empty()}a._tableElement.removeAttr("style")}else a._groupElement=a._createGroupElement(),a._tableElement=a._createTableElement(),a._tableElement.appendTo(a._groupElement),a._groupElement.appendTo(e),a._rootElement=e;a._colgroupElement=R("<colgroup>").appendTo(a._tableElement),a._renderTableContent(a._tableElement,n),a._renderVirtualContent()}_getScrollable(){return this.groupElement().data("dxScrollable")}_getMemoizeScrollTo(){return this._memoizeScrollTo=this._memoizeScrollTo??il((()=>this._getScrollable())),this._memoizeScrollTo}_getMaxLeftOffset(e){const n=R(e.container()).get(0);return n.scrollWidth-n.clientWidth}on(e,n){const a=this,o=a._getScrollable();return o&&o.on(e,(r=>{a.option("rtlEnabled")&&V(r.scrollOffset.left)&&(r.scrollOffset.left=a._getMaxLeftOffset(o)-r.scrollOffset.left),n(r)})),this}off(e){const n=this._getScrollable();return n&&n.off(e),this}scrollTo(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const a=this._getScrollable();if(!a)return;const o=this.option("rtlEnabled"),r=this._getAreaName(),u=Qe({},e,{left:o&&(r==="column"||r==="data")?this._getMaxLeftOffset(a)-e.left:e.left});this._getMemoizeScrollTo()(u,n),this._virtualContent&&(this._createFakeTable(),this._moveFakeTable(e))}updateScrollable(){const e=this._getScrollable();if(e)return e.update()}getColumnsCount(){let e=0;const n=this._getRowElement(0);let a;if(n){a=n.cells;for(let o=0,r=a.length;o<r;++o)e+=a[o].colSpan}return e}getData(){const e=this._tableElement;return e?e.data("data"):[]}}class cl extends zt{_getAreaName(){return"data"}_createGroupElement(){return R("<div>").addClass("dx-pivotgrid-area").addClass("dx-pivotgrid-area-data").css("borderTopWidth",0)}_applyCustomStyles(e){const{cell:n}=e,{classArray:a}=e;(n.rowType==="T"||n.columnType==="T")&&a.push("dx-total"),(n.rowType==="GT"||n.columnType==="GT")&&a.push("dx-grandtotal"),(n.rowType==="T"||n.rowType==="GT")&&a.push("dx-row-total"),e.rowIndex===e.rowsCount-1&&e.cssArray.push("border-bottom: 0px"),super._applyCustomStyles(e)}_moveFakeTable(e){this._moveFakeTableHorizontally(e.x),this._moveFakeTableTop(e.y),super._moveFakeTable()}renderScrollable(){this._groupElement.dxScrollable({useNative:this.getUseNativeValue(),useSimulatedScrollbar:!1,rtlEnabled:this.component.option("rtlEnabled"),bounceEnabled:!1,updateManually:!0})}getUseNativeValue(){const{useNative:e}=this.component.option("scrolling");return e==="auto"?!!ro.nativeScrolling:!!e}getScrollbarWidth(){return this.getUseNativeValue()?jn():0}updateScrollableOptions(e){let{direction:n,rtlEnabled:a}=e;const o=this._getScrollable();o.option("useNative",this.getUseNativeValue()),o.option({direction:n,rtlEnabled:a})}getScrollableDirection(e,n){return e&&!n?"horizontal":!e&&n?"vertical":"both"}reset(){super.reset(),this._virtualContent&&this._virtualContent.parent().css("height","auto")}setVirtualContentParams(e){super.setVirtualContentParams(e),this._virtualContent.parent().css("height",e.height),this._setTableCss({top:e.top,left:e.left})}}const ul={DataArea:cl},hl=Me.inherit((function(){const t={year:l=>l&&l.getFullYear(),quarter:l=>l&&Math.floor(l.getMonth()/3)+1,month:l=>l&&l.getMonth()+1,day:l=>l&&l.getDate(),dayOfWeek:l=>l&&l.getDay()};function e(l){return l.indexOf(".")!==-1?Dn(l):function(i){return i[l]}}function n(l){return function(i){let c=l(i);return c&&!(c instanceof Date)&&(c=Nn.deserializeDate(c)),c}}function a(l){M(l||[],((i,c)=>{let f,_;const{dataField:m}=c;let S;const{levels:T}=c;let v;if(!c.selector){if(m?v=e(m):v=function(E){return E},T&&a(T),c.dataType==="date"){_=t[c.groupInterval];const E=n(v);f=function(h){const w=E(h);return _?_(w):w}}else c.dataType==="number"?(S=we(c.groupInterval)&&c.groupInterval>0&&c.groupInterval,f=function(E){let h=v(E);return Pe(h)&&(h=Number(h)),S?Math.floor(h/S)*S:h}):f=v;Bt(c),Se(c,"selector",f)}}))}function o(l,i,c,f,_){const m=i.dimensions[f],{expandedPathsHash:S}=i;let T,v;m&&(T=m.selector(i.data),_=_!==void 0?_+"/./"+T:`${T}`,v=(function(E,h,w,b){let D=b[w];return D||(D={value:E,index:b.length++},b[w]=D,h.push(D)),D})(T,c,_,i.childrenHash),l.push(v.index),(S&&S[_]||m.expanded)&&(v.children||(v.children=[]),o(l,i,v.children,f+1,_)))}function r(l,i,c,f){const _=[0],m=i.headerName===f?i.path.length:0,S=f==="rows"?i.rowExpandedPaths:i.columnExpandedPaths,T={data:l,childrenHash:c[`${f}Hash`],dimensions:i[f],expandedPathsHash:i.headerName!==f&&S&&S.hash};return o(_,T,c[f],m),_}function u(l,i,c,f){const _=[];let m,S,T,v;const E=r(l,f,c,"rows"),h=r(l,f,c,"columns");for(S=0;S<E.length;S+=1)for(T=E[S],i[T]=i[T]||[],m=0;m<h.length;m+=1)v=h[m],_.push(i[T][v]=i[T][v]||[]);return _}function s(l){if(l){const i=l.hash={};l.forEach((c=>{const f=c.map((_=>`${_}`)).join("/./");i[f]=!0}))}}function d(l){l.rows=l.rows||[],l.columns=l.columns||[],l.filters=l.filters||[],s(l.columnExpandedPaths),s(l.rowExpandedPaths),a(l.columns),a(l.rows),a(l.values),a(l.filters)}function p(l){return l.summaryType==="custom"?(l.calculateCustomSummary=l.calculateCustomSummary||Ue,{seed(){const i={summaryProcess:"start",totalValue:void 0};return l.calculateCustomSummary(i),i},step(i,c){return i.summaryProcess="calculate",i.value=c,l.calculateCustomSummary(i),i},finalize(i){return i.summaryProcess="finalize",delete i.value,l.calculateCustomSummary(i),i.totalValue}}):tn[l.summaryType]||tn.count}function C(l,i,c){for(let f=0;f<l.length;f+=1){const _=l[f],m=_.selector(c),S=p(_),T=typeof S.seed=="function";for(let v=0;v<i.length;v+=1){const E=i[v];E.length<=f&&(E[f]=T?S.seed():S.seed),E[f]===void 0?E[f]=m:V(m)&&(E[f]=S.step(E[f],m))}}}function g(l,i){let c=l&&l.valueOf(),f=i&&i.valueOf();if(Array.isArray(l)){i=i||[];for(let _=0;_<l.length;_+=1)if(c=l[_]&&l[_].valueOf(),f=i[_]&&i[_].valueOf(),c!==f)return!1;return!0}return c===f}function x(l){const i=[];return M(l,((c,f)=>{const _=f.filterValues||[],{groupName:m}=f;m&&we(f.groupIndex)||_.length&&i.push((function(S){const T=f.levels?(function(E,h){const w=[];return M(E,((b,D)=>{w.push(D.selector(h))})),w})(f.levels,S):f.selector(S);let v=!1;for(let E=0;E<_.length;E+=1)if(g(_[E],T)){v=!0;break}return f.filterType==="exclude"?!v:v}))})),i}function F(l){const i=x(l.rows).concat(x(l.columns)).concat(x(l.filters)),c=l[l.headerName],{path:f}=l;return c&&i.push((_=>{let m;for(let S=0;S<f.length;S+=1)if(m=c[S].selector(_),Kt(m,!0)!==Kt(f[S],!0))return!1;return!0})),function(_){for(let m=0;m<i.length;m+=1)if(!i[m](_))return!1;return!0}}function A(l,i,c){const f={columns:[],rows:[],columnsHash:{length:1},rowsHash:{length:1}},_=[];let m,S;const T=new le;let v=0;const E=F(i);return(function h(){const w=new Date,b=v;for(;v<l.length;v+=1){if(v>b&&v%1e4===0&&new Date-w>=300){c(v/l.length),setTimeout(h,0);return}S=l[v],E(S)&&(m=u(S,_,f,i),C(i.values,m,S))}D=i.values,N=_,M(D,((k,K)=>{const B=p(K);B.finalize&&M(N,((z,I)=>{M(I,((H,P)=>{P&&P[k]!==void 0&&(P[k]=B.finalize(P[k]))}))}))}));var D,N;c(1),T.resolve({rows:f.rows,columns:f.columns,values:_,grandTotalRowIndex:0,grandTotalColumnIndex:0})})(),T}function y(l,i){let c=l.filter();return l.store()instanceof xo&&c?(c=j(c,i),Co(l.items()).filter(c).toArray()):l.items()}function O(l,i,c){const f=new le,_=function(m){l.store()instanceof $t&&(m.storeLoadOptions.filter=j(m.storeLoadOptions.filter,i))};if(l.on("customizeStoreLoadOptions",_),!l.isLoaded()||c){const m=c?l.load():l.reload();oe(m).done((()=>{O(l,i).done((()=>{f.resolve(y(l,i))})).fail(f.reject)})).fail(f.reject)}else f.resolve(y(l,i));return f.always((()=>{l.off("customizeStoreLoadOptions",_)}))}function L(l,i){i.forEach((c=>{if(c.dataField&&c.dataType==="date"){const f=n(e(c.dataField));l[c.dataField]=function(_){return f(_)}}}))}function G(l){const i={};return Array.isArray(l)?L(i,l):l&&["rows","columns","filters"].forEach((c=>{l[c]&&L(i,l[c])})),i}function j(l,i){if(!Array.isArray(l))return l;l=l.slice(0),Pe(l[0])&&(l[1]instanceof Date||l[2]instanceof Date)&&(l[0]=i[l[0]]);for(let c=0;c<l.length;c+=1)l[c]=j(l[c],i);return l}return{ctor(l){this._progressChanged=l.onProgressChanged||Ue,this._dataSource=new st(l),this._dataSource.paginate(!1)},getFields(l){const i=this._dataSource,c=new le;return O(i,G(l)).done((f=>{c.resolve(zn(f,l))})).fail(c.reject),c},key(){return this._dataSource.key()},load(l){const i=this,c=i._dataSource,f=new le;return d(l),O(c,G(l),l.reload).done((_=>{oe(A(_,l,i._progressChanged)).done(f.resolve)})).fail(f.reject),f},filter(){const l=this._dataSource;return l.filter.apply(l,arguments)},supportPaging:()=>!1,getDrillDownItems(l,i){l=l||{},i=i||{},d(l);const c=[],f=this._dataSource.items();let _;const{maxRowCount:m}=i,{customColumns:S}=i,T=F(l),v=F({rows:De(l.rows,i.rowPath),columns:De(l.columns,i.columnPath),filters:[]});for(let E=0;E<f.length;E+=1){if(v(f[E])&&T(f[E])){if(S){_={};for(let h=0;h<S.length;h+=1)_[S[h]]=f[E][S[h]]}else _=f[E];c.push(_)}if(m>0&&c.length===m)break}return c}}})()).include(Vt),Un=t=>t.charAt(0).toUpperCase()+t.slice(1),qn=function(t,e,n){t=t||[],n=n||0;for(let a=0;a<t.length;a+=1){const o=t[a];e(o,n),o&&o.items&&o.items.length&&qn(o.items,e,n+1)}};function un(t,e){const n=[];return M(t,((a,o)=>{n.push({selector:o.dataField,groupInterval:o.groupInterval,desc:e&&o.sortOrder==="desc",isExpanded:a<t.length-1})})),n}function pl(t){let e=t.dataField,{groupInterval:n}=t;return t.dataType==="date"&&typeof n=="string"&&(n.toLowerCase()==="quarter"&&(n="Month"),e=`${e}.${Un(n)}`),e}function hn(t,e,n,a){const o=[t,a?"<":">=",n],r=[t,a?">=":"<",n+e];return[o,a?"or":"and",r]}function Kn(t,e,n){const a=pl(t),o=(n||t.filterType)==="exclude";let r=[a,o?"<>":"=",e];return V(t.groupInterval)&&(typeof t.groupInterval=="string"&&t.groupInterval.toLowerCase()==="quarter"?r=hn(a,3,3*(e-1)+1,o):typeof t.groupInterval=="number"&&t.dataType!=="date"&&(r=hn(a,t.groupInterval,e,o))),r}function Yn(t,e){const n=[];return t.searchValue?[t.dataField,"contains",t.searchValue]:(t.filterType==="exclude"?e=e||"and":e=e||"or",M(t.filterValues,((a,o)=>{let r=[];if(Array.isArray(o)){var u;((u=t.levels)===null||u===void 0?void 0:u.length)&&(r=Yn({filterValues:o,filterType:t.filterType,levels:t.levels},"and"))}else{const s=t.levels?t.levels[a]:t;r=Kn(s,o)}r.length&&(n.length&&n.push(e),n.push(r))})),n)}function Qn(t){let e=[];return M(t,((n,a)=>{const o=Yn(a);if(!o.length)return[];e.length&&e.push("and"),e.push(o)})),e.length===1&&(e=e[0]),e}function Oe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"and";const n=[];return M(t,((a,o)=>{(r=>!!(r!=null&&r.length))(o)&&n.push(o,e)})),n.pop(),n.length===1?n[0]:n}function gl(t,e,n){const a={groupSummary:[],totalSummary:[]},o=un(t.rows,t.rowTake),r=un(t.columns,t.columnTake),u=[...o,...r];u.length?(a.group=u,a.take=void 0):(a.group=void 0,a.take=1),t.rows.length&&t.rowTake?(a.skip=t.rowSkip,a.take=t.rowTake,a.requireGroupCount=!0):t.columns.length&&t.columnTake&&!n&&(a.skip=t.columnSkip,a.take=t.columnTake,a.requireGroupCount=!0);let s=Qn(t.filters);return s=Oe(e?[s,t.filterExpression,e]:[s,t.filterExpression]),s.length&&(a.filter=s),M(t.values,((d,p)=>{const C={selector:p.dataField,summaryType:p.summaryType||"count"};a.groupSummary.push(C),t.includeTotalSummary&&a.totalSummary.push(C)})),a}function pn(t,e,n,a,o){t[n]=t[n]||[],t[n][a]=t[n][a]||[],V(t[n][a][o])||(t[n][a][o]=e)}function fl(t,e){return e&&e.dataType==="number"&&Pe(t)?Number(t):e&&e.dataType==="date"&&!e.groupInterval&&!(t instanceof Date)?Nn.deserializeDate(t):t}function ml(t,e,n,a){const o=[];let r=[];const{rowHash:u}=a,{columnHash:s}=a;if(e!=null&&e.summary&&M(e.summary,((p,C)=>{pn(a.values,C,a.grandTotalRowIndex,a.grandTotalColumnIndex,p)})),e&&e.groupCount>=0){const p=n.rows.length?n.rowSkip:n.columnSkip;t=[...Array(p)].concat(t),t.length=e.groupCount}function d(p,C,g,x,F){const A=a[`${C}Hash`];let y,O,L;const G=g.slice(0,x+1).join("/");let j;return A[G]!==void 0?L=A[G]:(L={value:fl(p.key,F),index:a[`${C}Index`]++,displayText:p.displayText},j=g.slice(0,x).join("/"),x>0&&A[j]!==void 0?(y=A[j],O=y.children=y.children||[]):O=a[`${C}s`],O.push(L),A[G]=L),L}return qn(t,((p,C)=>{var g,x;const F=C>=n.rows.length?n.rows.length:C,A=C>=n.rows.length?C-n.rows.length:0;let y,O;if(C>=n.rows.length&&A>=n.columns.length)return;C<n.rows.length&&(r=[]),C>=n.rows.length?p?(r[A]=`${p.key}`,y=d(p,"column",r,A,n.columns[A]),O=u[o.slice(0,F+1).join("/")]):a.columns.push({}):p?(o[F]=`${p.key}`,O=d(p,"row",o,F,n.rows[F]),y=s[r.slice(0,A+1).join("/")]):a.rows.push({});const L=((g=O)===null||g===void 0?void 0:g.index)||a.grandTotalRowIndex,G=((x=y)===null||x===void 0?void 0:x.index)||a.grandTotalColumnIndex;M((p==null?void 0:p.summary)||[],((j,l)=>{pn(a.values,l,L,G,j)}))})),a}function ct(t){return(t==null?void 0:t.filter((e=>{var n;return((n=e.filterValues)===null||n===void 0?void 0:n.length)||e.searchValue})))||[]}function Rt(t,e){if(t.headerName){if(e===t.headerName)return t.path.length;if(t.oppositePath)return t.oppositePath.length}return 0}function _l(t){const e=t.headerName==="rows"?"columns":"rows",n=t[t.headerName],a=t[e],o=De(n,t.path),r=De(a,t.oppositePath||[]);return o.concat(r)}function gn(t){for(let e=0;e<t.length;e+=1)if(!t[e].expanded)return e;return 0}function Nt(t,e,n){if(t.headerName===e)return[];const a=gn(e==="rows"?t.rows:t.columns),o=n<=a?a:0,r=t[e].slice(o,n),u=(e==="rows"?t.rowExpandedPaths:t.columnExpandedPaths)||[];let s=[];return M(u,((d,p)=>{if(p=p.slice(o),!((x,F)=>{if(F.length>n)return!1;let A=F.length;for(;(y=x[A])!==null&&y!==void 0&&y.expanded;){var y;A+=1}return A>=n})(r,p))return;const C=[];for(let x=0;x<p.length;x+=1){const F=r[x];if(!V(F))break;const A=Kn(F,p[x],"include");C.push(A)}const g=Oe(C);s.push(g)})),s=Oe(s,"or"),s}function fn(t,e,n){const a=Rt(t,e),o=Ke(t,e),r=(e==="columns"?t.columnExpandedPaths:t.rowExpandedPaths)||[],u=e==="columns"?"rows":"columns",s=t[e],d=[];if(r.length)for(let p=a;p<=o;p+=1){const C=s.slice(a,p+1),g=Nt(t,e,p),x={filters:n,filterExpression:g,[e]:C,[u]:[]};d.push(J({},t,x))}else{const p=s.slice(a,o+1),C={filters:n,[e]:p,[u]:[]};d.push(J({},t,C))}return d[0].includeTotalSummary=!0,d}function xl(t){const e=Rt(t,"rows"),n=Ke(t,"rows"),a=Rt(t,"columns"),o=Ke(t,"columns"),r=[],u=(t.filters||[]).concat(ct(t.rows),ct(t.columns),_l(t)),s=fn(t,"columns",u),d=fn(t,"rows",u);if(t.rows.length&&t.columns.length){t.headerName!=="rows"&&r.push(...s);for(let p=e;p<=n;p+=1){const C=t.rows.slice(e,p+1),g=Nt(t,"rows",p);for(let x=a;x<=o;x+=1){const F=t.columns.slice(a,x+1),A=Nt(t,"columns",x),y=Oe([g,A]),O=J({},t,{columns:F,rows:C,filters:u,filterExpression:y});r.push(O)}}}else{const p=t.columns.length?s:d;r.push(...p)}return r}function ot(t){M(t||[],((e,n)=>{const{levels:a}=n;a&&ot(a),Bt(n)}))}const Cl=Me.inherit({ctor(t){this._dataSource=new st(t),this._store=this._dataSource.store()},getFields(t){const e=new le;return this._store.load({skip:0,take:20}).done((n=>{const a=nn(n);e.resolve(Gt.discoverObjectFields(a.data,t))})).fail(e.reject),e},key(){return this._store.key()},load(t){const e=this,n=new le,a={rows:[],columns:[],values:[],grandTotalRowIndex:0,grandTotalColumnIndex:0,rowHash:{},columnHash:{},rowIndex:1,columnIndex:1},o=xl(t),r=[];return ot(t.rows),ot(t.columns),ot(t.filters),M(o,((u,s)=>{const d=gl(s,e.filter(),t.rows.length),p=e._store.load(d);r.push(p)})),oe.apply(null,r).done((function(){const u=r.length>1?arguments:[arguments];M(u,((s,d)=>{const p=nn(d[0],d[1]);ml(p.data,p.extra,o[s],a)})),n.resolve({rows:a.rows,columns:a.columns,values:a.values,grandTotalRowIndex:a.grandTotalRowIndex,grandTotalColumnIndex:a.grandTotalColumnIndex})})).fail(n.reject),n},filter(){return this._dataSource.filter.apply(this._dataSource,arguments)},supportPaging:()=>!1,createDrillDownDataSource(t,e){t=t||{},e=e||{};const n=this._store,a=De(t.rows,e.rowPath).concat(De(t.columns,e.columnPath)).concat(ct(t.rows)).concat(t.filters||[]).concat(ct(t.columns)),o=Qn(a);return new st({load(r){const u=Oe([o,r.filter]),s=J({},r,{filter:u.length===0?void 0:u,select:e.customColumns});return n.load(s)}})}}),Ie="column",Be="row",Xn=function(t,e){let n=t/e;return(!V(t)||isNaN(n))&&(n=null),n},xt=function(t,e){return Xn(t.value(),t.grandTotal(e).value())},mn=function(t,e){const n=t.parent(e),a=n?n.value():t.value();return Xn(t.value(),a)},Jn=function(t){return function(e){const n=e.prev(Ie,t),a=n&&n.value();return V(a)&&V(e.value())?e.value()-a:null}},wl=function(t){const e=Jn(t);return function(n){const a=e(n),o=n.prev(Ie,t),r=o&&o.value();return a!==null&&r?a/r:null}},Zn={percentOfColumnTotal:t=>mn(t,Be),percentOfRowTotal:t=>mn(t,Ie),percentOfColumnGrandTotal:t=>xt(t,Be),percentOfRowGrandTotal:t=>xt(t,Ie),percentOfGrandTotal:t=>xt(t)},ea=function(t,e){if(!t||!t.parent(e))return;let n=t.prev(e);return n||(n=ea(t.parent(e),e)),n},vl=t=>{if(!t.runningTotal)return;const e=t.runningTotal===Ie?Be:Ie;return n=>{const a=t.allowCrossGroupCalculation?ea(n,e):n.prev(e,!1),o=n.value(!0),r=n.value(!1),u=a==null?void 0:a.value(!0);switch(!0){case(V(o)&&V(r)&&V(u)):return u+o;case V(u):return u;default:return o}}};function Wt(){return{fields:{},positions:{}}}function Ct(t,e,n){let a={index:-1};if(!Pt(e))if(n.fields[e])e=n[e];else{const o=t.columns.concat(t.rows).concat(t.values),r=He(o,e);e=n[e]=o[r]}if(e){const o=e.area||"data";a=n.positions[e.index]=n.positions[e.index]||{area:o,index:t[o==="data"?"values":`${o}s`].indexOf(e)}}return a}function Ve(t){return t===Be?"_rowPath":"_columnPath"}const Ae=function(t,e,n,a,o,r){this._columnPath=t,this._rowPath=e,this._fieldIndex=o,this._fieldsCache=r||Wt(),this._data=n,this._descriptions=a;const u=n.values&&n.values[e[0].index]&&n.values[e[0].index][t[0].index];u&&(u.originalCell=u.originalCell||u.slice(),u.postProcessedFlags=u.postProcessedFlags||[],this._cell=u)};Ae.prototype=J(Ae.prototype,{_getPath(t){return this[Ve(t)]},_getDimension(t){return t=t===Be?"rows":"columns",this._descriptions[t]},_createCell(t){return new Ae(t._columnPath||this._columnPath,t._rowPath||this._rowPath,this._data,this._descriptions,this._fieldIndex)},parent(t){const e=this._getPath(t).slice(),n={};return e.shift(),e.length?(n[Ve(t)]=e,this._createCell(n)):null},children(t){const e=this._getPath(t).slice(),n=e[0],a=[],o={};if(n.children)for(let r=0;r<n.children.length;r+=1)o[Ve(t)]=[n.children[r]].concat(e.slice()),a.push(this._createCell(o));return a},grandTotal(t){const e={},n=this._rowPath,a=this._columnPath,o=this._getPath(t),r=Ve(t);return t?e[r]=[o[o.length-1]]:(e._rowPath=[n[n.length-1]],e._columnPath=[a[a.length-1]]),this._createCell(e)},next(t,e){const n=this._getPath(t),a=n[0];let o=this.parent(t),r;if(o){const u=n[1].children.indexOf(a);if(r=o.children(t),r[u+1])return r[u+1]}if(e&&o){do o=o.next(t,e),r=o?o.children(t):[];while(o&&!r.length);return r[0]||null}return null},prev(t,e){const n=this._getPath(t),a=n[0];let o=this.parent(t),r;if(o){const u=n[1].children.indexOf(a);if(r=o.children(t),r[u-1])return r[u-1]}if(e&&o){do o=o.prev(t,e),r=o?o.children(t):[];while(o&&!r.length);return r[r.length-1]||null}return null},cell(){return this._cell},field(t){if(t==="data")return this._descriptions.values[this._fieldIndex];const e=this._getPath(t);return this._getDimension(t)[e.length-2]||null},child(t,e){let n;const a=this.children(t);for(let o=0;o<a.length;o+=1)if(n=n||a[o].field(t),a[o].value(n)===e)return a[o];return null},slice(t,e){const n=this,a={},o=Ct(this._descriptions,t,this._fieldsCache),{area:r}=o,u=o.index;let s=null;const d=[];if(r===Be||r===Ie){const p=this._getPath(r).slice(),C=u!==-1&&p.length-2-u;if(p[C]){d[p.length-1]=p[p.length-1];for(let g=C;g>=0;g-=1){if(p[g+1]){const x=p[g+1].children||[],F=g===C?e:p[g].value;p[g]=void 0;for(let A=0;A<x.length;A+=1)if(x[A].value===F){p[g]=x[A];break}}if(p[g]===void 0)return s}a[Ve(r)]=p,s=n._createCell(a)}}return s},value(t,e){const n=this._cell;let a=this._fieldIndex;const o=t===!0||t===!1,r=o?null:t,u=o&&t||e;if(V(r)){const s=Ct(this._descriptions,r,this._fieldsCache);if(a=s.index,s.area!=="data"){const d=this._getPath(s.area),p=a!==-1&&d.length-2-a;return d[p]&&d[p].value}}return n&&n.originalCell?u?n[a]:n.originalCell[a]:null},isPostProcessed(t){let e=this._fieldIndex;if(V(t)){const n=Ct(this._descriptions,t,this._fieldsCache);if(e=n.index,n.area!=="data")return!1}return!!(this._cell&&this._cell.postProcessedFlags[e])}});function ta(t){const{summaryDisplayMode:e}=t,n=t.allowCrossGroupCalculation;let a=null;return Ye(t.calculateSummaryValue)?a=t.calculateSummaryValue:e&&(e==="absoluteVariation"?a=Jn(n):e==="percentVariation"?a=wl(n):a=Zn[e],a&&!t.format&&e.indexOf("percent")!==-1&&Gt.setFieldProperty(t,"format","percent")),a}function na(t,e,n,a){const o=t.values[e][n]=t.values[e][n]||[],{originalCell:r}=o;r&&((o.allowResetting||!a)&&(t.values[e][n]=r.slice()),t.values[e][n].allowResetting=a)}function Sl(t,e){const n=[],a=[{index:e.grandTotalColumnIndex,children:e.columns}],o=[{index:e.grandTotalRowIndex,children:e.rows}],r=t.values,u=Wt();e.values=e.values||[],ie(a,(s=>{s[0].isEmpty=[]}),!1),ie(o,(s=>{const d=s[0];d.isEmpty=[],e.values[d.index]=e.values[d.index]||[],ie(a,(p=>{const C=p[0];let g;na(e,d.index,C.index,!1);for(let x=0;x<r.length;x+=1){const F=r[x],A=n[x]=n[x]===void 0?ta(F):n[x];if(g=!1,A){const y=new Ae(p,s,e,t,x,u),O=y.cell(),L=O[x]=A(y);O.postProcessedFlags[x]=!0,g=L==null}C.isEmpty[x]===void 0&&(C.isEmpty[x]=!0),d.isEmpty[x]===void 0&&(d.isEmpty[x]=!0),g||(d.isEmpty[x]=C.isEmpty[x]=!1)}}),!1)}),!1),e.isEmptyGrandTotalRow=o[0].isEmpty,e.isEmptyGrandTotalColumn=a[0].isEmpty}function yl(t,e){const n=[],a=[{index:e.grandTotalColumnIndex,children:e.columns}],o=[{index:e.grandTotalRowIndex,children:e.rows}],r=t.values,u=Wt();e.values=e.values||[],ie(o,(s=>{const d=s[0];e.values[d.index]=e.values[d.index]||[],ie(a,(p=>{const C=p[0];na(e,d.index,C.index,!0);for(let g=0;g<r.length;g+=1){const x=r[g],F=n[g]=n[g]===void 0?vl(x):n[g];if(F){const A=new Ae(p,s,e,t,g,u),y=A.cell();y[g]=F(A),y.postProcessedFlags[g]=!0}}}),!1)}),!1)}function Tl(t,e,n){const a=new Ae([],[],{},t,0);return a.value=function(o){if(V(o)){const r=He(e,o),u=e[r];!n[r]&&u&&!V(u.area)&&(t.values.push(u),n[r]=!0)}},a.grandTotal=function(){return this},a.children=function(){return[]},a}const wt={Cell:Ae,summaryDictionary:Zn,getExpression:ta,applyRunningTotal:yl,createMockSummaryCell:Tl,applyDisplaySummaryMode:Sl},El=Ln(),Fl=Me.inherit((function(){const t='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>{2}</RequestType><Restrictions><RestrictionList><CATALOG_NAME>{0}</CATALOG_NAME><CUBE_NAME>{1}</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>{0}</Catalog>{3}</PropertyList></Properties></Discover></Body></Envelope>';function e(h,w){const b=new le,{beforeSend:D}=h,N={url:h.url,dataType:"text",data:w,headers:{"Content-Type":"text/xml"},xhrFields:{},method:"POST"};return Ye(D)&&D(N),Gt.sendRequest(N).fail((function(){b.reject(arguments)})).done((k=>{const K=new El.DOMParser;let B;try{try{B=K.parseFromString(k,"text/xml")}catch{B=void 0}if(!B||B.getElementsByTagName("parsererror").length||B.childNodes.length===0)throw et.Error("E4023",k)}catch(z){b.reject({statusText:z.message,stack:z.stack,responseText:k})}b.resolve(B)})),b}function n(){const h=Lo();return h!==void 0?re("<LocaleIdentifier>{0}</LocaleIdentifier>",h):""}function a(h,w,b){return`Descendants({${w||h}}, ${b}, SELF_AND_BEFORE)`}function o(h){return`${h.hierarchyName||h.dataField}.[All]`}function r(h){let w=`${h.dataField}.allMembers`,{searchValue:b}=h;return b&&(b=b.replace(/'/g,"''"),w=`Filter(${w}, instr(${h.dataField}.currentmember.member_caption,'${b}') > 0)`),w}function u(h){const w=h.join(",");return h.length>1?re("CrossJoin({0})",w):w}function s(h,w,b,D,N,k,K,B){const z=[],I=k[K];let H,P,q;for(let U=D;U<=w;U+=1){const W=I[U],{dataField:Y}=W,ee=I[U-1]&&I[U-1].hierarchyName,{hierarchyName:te}=W,de=!te||!I[U+1]||I[U+1].hierarchyName!==te,se=h.length+b+D;if(H=null,U<h.length)de&&(H=`(${Y}.${i(h[U],Y)})`);else if(U<=se)if(U===0&&b===0){const ue=o(I[D]);te?H=`${ue},${I[D].dataField}`:H=r(I[D])}else te?(q=i(N[N.length-1]),(de||U===se)&&(ee===te?(N.length&&(P=I[N.length-1]),(!P||P.hierarchyName!==te)&&(P=I[U-1],q=""),H=a(P.dataField,q,Y)):H=r(W))):H=r(W);else(!te||ee!==te)&&(H=`(${o(W)})`);if(H){if(H=re("{{0}}",H),B){const ue=(W.hierarchyName||W.dataField)+(W.sortBy==="displayText"?".MEMBER_CAPTION":".MEMBER_VALUE");H=re("Order({0}, {1}, {2})",H,ue,W.sortOrder==="desc"?"DESC":"ASC")}z.push(H)}}return u(z)}function d(h,w,b,D,N,k,K,B,z,I){let H=-1;const P=k[K];let q;do{H+=1,q=w.length+H+D;let U=s(w,b,H,D,N,k,K,z);!z&&!I&&(U=re("NonEmpty({0}, {1})",U,B)),h.push(U)}while(P[q]&&P[q+1]&&P[q].expanded)}function p(h,w,b,D){return b=b||`[DX_Set_${w.length}]`,D=D||"set",w.push(re("{0} {1} as {2}",D,b,h)),b}function C(h,w,b,D,N){const k=h[w],K=[];let B=[],z=[],I=0,H=0;const P=[],q=re("{{0}}",b.join(","));if(k&&k.length){h.headerName===w?(B=h.path,I=B.length):h.headerName&&h.oppositePath?(B=h.oppositePath,I=B.length):z=(w==="columns"?h.columnExpandedPaths:h.rowExpandedPaths)||z,H=Ke(h,w),d(K,[],H,I,B,h,w,q,w==="rows"?h.rowTake:h.columnTake,h.totalsOnly),M(z,((U,W)=>{d(K,W,H,I,W,h,w,q)}));for(let U=H;U>=B.length;U-=1)k[U].hierarchyName&&(N.visibleLevels[k[U].hierarchyName]=N.visibleLevels[k[U].hierarchyName]||[],N.visibleLevels[k[U].hierarchyName].push(k[U].dataField))}if(K.length){let U=(function(Y){const ee=Y.join(",");return Y.length>1?`Union(${ee})`:ee})(K);w==="rows"&&h.rowTake&&(U=re("Subset({0}, {1}, {2})",U,h.rowSkip>0?h.rowSkip+1:0,h.rowSkip>0?h.rowTake:h.rowTake+1)),w==="columns"&&h.columnTake&&(U=re("Subset({0}, {1}, {2})",U,h.columnSkip>0?h.columnSkip+1:0,h.columnSkip>0?h.columnTake:h.columnTake+1));const W=`[DX_${w}]`;P.push(p(U,D,W)),h.totalsOnly&&P.push(p(`COUNT(${W})`,D,`[DX_${w}_count]`,"member"))}return w==="columns"&&b.length&&!h.skipValues&&P.push(q),re("{0} DIMENSION PROPERTIES PARENT_UNIQUE_NAME,HIERARCHY_UNIQUE_NAME, MEMBER_VALUE ON {1}",u(P),w)}function g(h){const w=[];return M(h,((b,D)=>{const{dataField:N}=D,k=[],K=D.filterValues||[];let B;D.hierarchyName&&we(D.groupIndex)||(M(K,((z,I)=>{let H=`${N}.${i(Array.isArray(I)?I[I.length-1]:I,N)}`;D.filterType==="exclude"&&(k.push(`${H}.parent`),H=`Descendants(${H})`),k.push(H)})),K.length&&(B=re("{{0}}",k.join(",")),D.filterType==="exclude"&&(B=`Except(${r(D)},${B})`),w.push(B)))})),w.length?u(w):""}function x(h,w,b,D,N,k,K){let B=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},z="";const I=(w.length?`with ${w.join(" ")}`:"")+" ";if(h.length){let H;if(B.totalsOnly){const P=[];D.length&&P.push("[DX_rows_count]"),b.length&&P.push("[DX_columns_count]"),H=`{${P.join(",")}} on columns`}else H=h.join(",");z=I+re("SELECT {2} FROM {0} {1} CELL PROPERTIES VALUE, FORMAT_STRING, LANGUAGE, BACK_COLOR, FORE_COLOR, FONT_FLAGS",(function(P,q,U,W){let Y=`[${W}]`;return M([P,q,U],((ee,te)=>{te&&(Y=re("(SELECT {0} FROM {1})",`${te}on 0`,Y))})),Y})(g(b),g(D),g(N||[]),K),k.length?re("WHERE ({0})",k.join(",")):"",H)}return z}function F(h,w){return Xe(w,(b=>(Pe(b.expression)&&p(b.expression,h,b.dataField,"member"),b.dataField)))}function A(h,w,b,D){M(D,((N,k)=>{const K=w[b][N];(!K.hierarchyName||K.hierarchyName!==w[b][N+1].hierarchyName)&&h.push(`${K.dataField}.${i(k,K.dataField)}`)}))}function y(h,w,b){const D=h.columns||[],N=h.rows||[],k=h.values&&h.values.length?h.values:[{dataField:"[Measures]"}],K=[],B=[],z=[],I=F(B,k);return b.measureCount=h.skipValues?1:k.length,b.visibleLevels={},h.headerName&&h.path&&A(K,h,h.headerName,h.path),h.headerName&&h.oppositePath&&A(K,h,h.headerName==="rows"?"columns":"rows",h.oppositePath),(D.length||I.length)&&z.push(C(h,"columns",I,B,b)),N.length&&z.push(C(h,"rows",I,B,b)),x(z,B,D,N,h.filters,K,w,h)}function O(h,w,b){M(b,((D,N)=>{const k=w[D];k.hierarchyName&&(w[D+1]||{}).hierarchyName===k.hierarchyName||h.push(`${k.dataField}.${i(N,k.dataField)}`)}))}function L(h){return parseInt(h,10)}function G(h,w){return j((function(b,D){return(b.getElementsByTagName(D)||[])[0]})(h,w))}function j(h){return h&&(h.textContent||h.text||h.innerHTML)||""}function l(h,w,b){const D=[];let N=[],k=0;const K=[],B=h.getElementsByTagName("Cell"),z={};for(let I=0;I<B.length;I+=1){const H=B[I],P=H.getElementsByTagName("Value")[0],q=P&&P.getElementsByTagName("Error")||[],U=q.length===0?j(P):"#N/A",W=parseFloat(U),Y=U-W+1>0,ee=L(H.getAttribute("CellOrdinal"));q.length&&(z[j(q[0].getElementsByTagName("ErrorCode")[0])]=j(q[0].getElementsByTagName("Description")[0])),K[ee]={value:Y?W:U||null}}return M(w[1],(()=>{const I=[];D.push(I),M(w[0],(()=>{k%b===0&&(N=[],I.push(N)),N.push(K[k]?K[k].value:null),k+=1}))})),Object.keys(z).forEach((I=>{et.log("W4002",z[I])})),D}function i(h,w){return h&&(h=Pe(h)&&(h.includes("&")||h.startsWith(`${w}.`))?h:`[${h}]`,w&&h.indexOf(`${w}.`)===0&&(h=h.slice(w.length+1,h.length))),h}function c(h,w,b,D){let N=h[w];return N||(N={},h[w]=N),!V(N.value)&&b&&(N.text=b.caption,N.value=b.value,N.key=w||"",N.levelName=b.levelName,N.hierarchyName=b.hierarchyName,N.parentName=b.parentName,N.index=D,N.level=b.level),N}function f(h,w){const b=[],D=h.children&&(h.children.length?h.children:Object.keys(h.children.grandTotalHash||{}).reduce(((k,K)=>k.concat(h.children.grandTotalHash[K].children)),[])),N=D&&D[0];if(N&&(w[N.hierarchyName]&&w[N.hierarchyName].includes(N.levelName)||!w[N.hierarchyName]||N.level===0)){const k=D.filter((K=>K.hierarchyName===N.hierarchyName));return k.grandTotalHash=D.grandTotalHash,k}if(N)for(let k=0;k<D.length;k+=1)D[k].hierarchyName===N.hierarchyName&&b.push.apply(b,f(D[k],w));return b}function _(h,w,b,D){const N=[];M(w,((B,z)=>{let I={children:N};const H=V(b)?Math.floor(B/b):B;M(z,((P,q)=>{I=(function(U,W,Y){let ee=Y.children=Y.children||[];const te=ee.hash=ee.hash||{},de=ee.grandTotalHash=ee.grandTotalHash||{};W.parentName&&(Y=c(te,W.parentName),ee=Y.children=Y.children||[]);const se=c(te,W.name,W,U);return W.hasValue&&!se.added&&(se.index=U,se.added=!0,ee.push(se)),(!Y.value||!Y.parentName)&&W.parentName?de[W.parentName]=Y:de[Y.name]&&delete de[W.parentName],se})(H,q,I)}))}));const k={children:N};k.children=f(k,D);const K=(function(B,z){let I;if(B.children.length===1&&B.children[0].parentName===""){I=B.children[0].index;const{grandTotalHash:H}=B.children;B.children=B.children[0].children||[],B.children.grandTotalHash=H,B.children=f(B,z)}else B.children.length===0&&(I=0);return I})(k,D);return ie(k.children,(B=>{const z=B[0],I=f(z,D);I.length?z.children=I:delete z.children,delete z.levelName,delete z.hierarchyName,delete z.added,delete z.parentName,delete z.level}),!0),M(k.children||[],((B,z)=>{h.push(z)})),K}function m(h){const w=h.getElementsByTagName("soap:Fault"),b=h.getElementsByTagName("Fault"),D=R([].slice.call(b.length?b:w)).find("Error");if(D.length){const N=D.attr("Description"),k=et.Error("E4000",N);return et.log("E4000",N),k}return null}function S(h,w){const b={columns:[],rows:[]},{measureCount:D}=w,N=(function(k,K){const B=[];for(M(k.getElementsByTagName("Axis"),((z,I)=>{const H=I.getAttribute("name"),P=[];let q=0;H.indexOf("Axis")===0&&we(L(H.substr(4)))&&(B.push(P),M(I.getElementsByTagName("Tuple"),((U,W)=>{const Y=W.childNodes;let ee=0;const te=[];let de=K?Y.length:Y.length-1;B.length===1&&(de-=1),P.push(te);for(let ae=de;ae>=0;ae-=1){const xe=Y[ae],Ee=L(G(xe,"LNum"));te[ae]={caption:G(xe,"Caption"),value:(ue=G(xe,"MEMBER_VALUE"),we(ue)?parseFloat(ue):ue),level:Ee,index:q++,hasValue:!ee&&(!!Ee||ae===0),name:G(xe,"UName"),hierarchyName:Y[ae].getAttribute("Hierarchy"),parentName:G(xe,"PARENT_UNIQUE_NAME"),levelName:G(xe,"LName")},ee+=Ee}var ue})))}));B.length<2;)B.push([[{level:0}]]);return B})(h,w.skipValues);return b.grandTotalColumnIndex=_(b.columns,N[0],D,w.visibleLevels),b.grandTotalRowIndex=_(b.rows,N[1],void 0,w.visibleLevels),b.values=l(h,N,D),b}function T(h,w,b,D){const N=[],k=w==="MEASURE",K=k?"MEASUREGROUP_NAME":`${w}_DISPLAY_FOLDER`;return M(h.getElementsByTagName("row"),((B,z)=>{const I=w==="LEVEL"?G(z,"HIERARCHY_UNIQUE_NAME"):void 0,H=G(z,"LEVEL_NUMBER");let P=G(z,K);if(k&&(P=D[P]||P),(H!=="0"||G(z,`${w}_IS_VISIBLE`)!=="true")&&G(z,"DIMENSION_TYPE")!=="2"){const q=k?"DX_MEASURES":G(z,"DIMENSION_UNIQUE_NAME"),U=G(z,`${w}_UNIQUE_NAME`);N.push({dimension:b.names[q]||q,groupIndex:H?L(H)-1:void 0,dataField:U,caption:G(z,`${w}_CAPTION`),hierarchyName:I,groupName:I,displayFolder:P,isMeasure:k,isDefault:!!b.defaultHierarchies[U]})}})),N}function v(h){h=h.replace(/_x(....)_/g,((b,D)=>String.fromCharCode(parseInt(D,16))));const w=h.match(/\[.+?\]/gi);return w&&w.length&&(h=w[w.length-1]),h.replace(/\[/gi,"").replace(/\]/gi,"").replace(/\$/gi,"").replace(/\./gi," ")}function E(h,w){return w=R("<div>").text(w).html(),e(h,re('<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement>{0}</Statement></Command><Properties><PropertyList><Catalog>{1}</Catalog><ShowHiddenCubes>True</ShowHiddenCubes><SspropInitAppName>Microsoft SQL Server Management Studio</SspropInitAppName><Timeout>3600</Timeout>{2}</PropertyList></Properties></Execute></Body></Envelope>',w,h.catalog,n()))}return{ctor(h){this._options=h},getFields(){const h=this._options,{catalog:w}=h,{cube:b}=h,D=n(),N=e(h,re(t,w,b,"MDSCHEMA_DIMENSIONS",D)),k=e(h,re(t,w,b,"MDSCHEMA_MEASURES",D)),K=e(h,re(t,w,b,"MDSCHEMA_HIERARCHIES",D)),B=e(h,re(t,w,b,"MDSCHEMA_LEVELS",D)),z=new le;return oe(N,k,K,B).then(((I,H,P,q)=>{e(h,re(t,w,b,"MDSCHEMA_MEASUREGROUPS",D)).done((U=>{const W=(function(ue){const ae={names:{},defaultHierarchies:{}};return M(R(ue).find("row"),(function(){const xe=R(this),Pa=xe.children("DIMENSION_TYPE").text()==="2"?"DX_MEASURES":xe.children("DIMENSION_UNIQUE_NAME").text();ae.names[Pa]=xe.children("DIMENSION_CAPTION").text(),ae.defaultHierarchies[xe.children("DEFAULT_HIERARCHY").text()]=!0})),ae})(I),Y=T(P,"HIERARCHY",W),ee=T(q,"LEVEL",W),te=(function(ue){const ae={};return M(ue.getElementsByTagName("row"),((xe,Ee)=>{ae[G(Ee,"MEASUREGROUP_NAME")]=G(Ee,"MEASUREGROUP_CAPTION")})),ae})(U),de=T(H,"MEASURE",W,te).concat(Y),se={};M(ee,((ue,ae)=>{se[ae.hierarchyName]=se[ae.hierarchyName]||[],se[ae.hierarchyName].push(ae)})),M(Y,((ue,ae)=>{se[ae.dataField]&&se[ae.dataField].length>1&&(ae.groupName=ae.hierarchyName=ae.dataField,de.push.apply(de,se[ae.hierarchyName]))})),z.resolve(de)})).fail(z.reject)})).fail(z.reject),z},load(h){const w=new le,b=this._options,D={skipValues:h.skipValues},N=y(h,b.cube,D);let k;(h.rowSkip||h.rowTake||h.columnTake||h.columnSkip)&&(k=y(J({},h,{totalsOnly:!0,rowSkip:null,rowTake:null,columnSkip:null,columnTake:null}),b.cube,{}));const K=()=>{N?oe(E(b,N),k&&E(b,k)).done(((B,z)=>{const I=m(B)||z&&m(z);if(I)w.reject(I);else{const H=S(B,D);z&&(function(P,q,U){const W=q.columns||[],Y=q.rows||[];W.length,Y.length;const ee=l(U,[[{}],[{},{}]],1);if(!W.length&&Y.length&&(P.rowCount=Math.max(ee[0][0][0]-1,0)),!Y.length&&W.length&&(P.columnCount=Math.max(ee[0][0][0]-1,0)),Y.length&&W.length&&(P.rowCount=Math.max(ee[0][0][0]-1,0),P.columnCount=Math.max(ee[1][0][0]-1,0)),P.rowCount!==void 0&&q.rowTake){P.rows=[...Array(q.rowSkip)].concat(P.rows),P.rows.length=P.rowCount;for(let te=0;te<P.rows.length;te+=1)P.rows[te]=P.rows[te]||{}}if(P.columnCount!==void 0&&q.columnTake){P.columns=[...Array(q.columnSkip)].concat(P.columns),P.columns.length=P.columnCount;for(let te=0;te<P.columns.length;te+=1)P.columns[te]=P.columns[te]||{}}})(H,h,z),w.resolve(H)}})).fail(w.reject):w.resolve({columns:[],rows:[],values:[],grandTotalColumnIndex:0,grandTotalRowIndex:0})};return h.delay?setTimeout(K,h.delay):K(),w},supportPaging:()=>!0,getDrillDownItems(h,w){const b=new le,D=this._options,N=(function(k,K,B){const z=k.columns||[],I=k.rows||[],H=k.values&&k.values.length?k.values:[{dataField:"[Measures]"}],P=[],q=[],U=[],W=F(q,H),{maxRowCount:Y}=B,ee=B.customColumns||[],te=ee.length>0?` return ${ee.join(",")}`:"";O(P,z,B.columnPath||[]),O(P,I,B.rowPath||[]),(z.length||W.length)&&U.push([`${W[B.dataIndex]||W[0]} on 0`]);const de=x(U,q,z,I,k.filters,P,K);return de&&`drillthrough${Y>0?` maxrows ${Y}`:""}${de}${te}`})(h,D.cube,w);return N?oe(E(D,N)).done((k=>{const K=m(k);K?b.reject(K):b.resolve((function(B){const z=B.getElementsByTagName("row"),I=[],H={};for(let P=0;P<z.length;P+=1){const q=z[P].childNodes,U={};for(let W=0;W<q.length;W+=1){const{tagName:Y}=q[W],ee=H[Y]=H[Y]||v(Y);U[ee]=j(q[W])}I.push(U)}return I})(k))})).fail(b.reject):b.resolve([]),b},key:Ue,filter:Ue}})()).include(Vt),bl={XmlaStore:Fl};function Al(t,e,n){_n(e,t,"rows",n),_n(e,t,"columns",n)}function _n(t,e,n,a){const o=e[n]||[],r=e.headerName===n?e.path.length:0,u=[];ft(t[n],((s,d)=>{const p=o[d]||{},C=u[d]=u[d]||Pl(p,t,e,n,a);s.sort(C)}),r)}function Pl(t,e,n,a,o){const r=o?"asc":t.sortOrder,u=Il(t.sortBy,o),s=t.sortingMethod?function(C,g){return t.sortingMethod(C,g)}:dt((C=>C[u])),d=!o&&Dl(t,e,n,a),p=d&&dt(d);return function(C,g){const x=p&&p(C,g)||s(C,g);return r==="desc"?-x:x}}function Dl(t,e,n,a){const{values:o}=e,r=He(n.values,t.sortBySummaryField),u=a==="rows",s=u?e.columns:e.rows,d=u?e.grandTotalRowIndex:e.grandTotalColumnIndex,p=t.sortBySummaryPath||[],C=p.length?Hl(s,p):d;if(o!=null&&o.length&&r>=0&&V(C))return function(g){const x=u?g.index:C,F=u?C:g.index,A=((o[x]||[[]])[F]||[])[r];return V(A)?A:null}}function Il(t,e){let n="text";return t==="none"?n="index":(e||t!=="displayText")&&(n="value"),n}function Hl(t,e){let n=null;const a=(e||[]).join(".");return a.length&&ie(t,(o=>{const r=o[0],u=fe(o).join("."),s=Xe(o,(d=>d.text)).reverse().join(".");if(a===u||r.key&&s===a)return n=o[0].index,!1})),n}const vt={row:"rows",column:"columns",data:"values",filter:"filters"},St=["area","areaIndex","sortOrder","filterType","filterValues","sortBy","sortBySummaryField","sortBySummaryPath","expanded","summaryType","summaryDisplayMode"],Lt=["format","selector","customizeText","caption"],xn=Lt.concat(["allowSorting","allowSortingBySummary","allowFiltering","allowExpandAll"]);function Rl(t){let e=t.dataField||t.groupName||"",n=(t.summaryType||"").toLowerCase();return Pe(t.groupInterval)&&(e+=`_${t.groupInterval}`),n&&n!=="custom"?(n=n.replace(/^./,n[0].toUpperCase()),e.length&&(n=` (${n})`)):n="",Ra.titleize(e)+n}function kt(t,e){const n=t._initProperties||{};M(e,((a,o)=>{Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}))}function yt(t,e){kt(t,e),V(t.caption)||Se(t,"caption",Rl(t))}function Nl(t){return t.some((e=>e.summaryDisplayMode||e.calculateSummaryValue))}function Ll(t){return t.some((e=>!!e.runningTotal))}function kl(t){return t.rows.length||t.columns.length||t.values.length}const Cn=Me.inherit((function(){const t=function(l,i){if(l._cacheByPath)return l._cacheByPath[i.join(".")]||null},e=function(l,i){let c,f=-1,_;if(l)for(c=0;c<l.length;c+=1)_=l[c],_.index!==void 0&&(f=Math.max(f,_.index)),_.children?f=Math.max(f,e(_.children)):_.collapsedChildren&&(f=Math.max(f,e(_.collapsedChildren)));return V(i)&&(f=Math.max(f,i)),f},n=function(l,i,c,f){const _=e(c)+1;let m=e(l,f)+1,S;const T=[];let v=!1;const E=new le;if(i.children&&i.children.length===c.length)for(let h=0;h<c.length;h+=1){const w=c[h];w.index!==void 0&&(i.children[h].index===void 0?(w.index=T[w.index]=m++,i.children[h]=w):T[w.index]=i.children[h].index)}else{for(v=!0,S=0;S<_;S+=1)T[S]=m++;i.children=c}return oe(ve(i.children,(h=>{v&&(h[0].index=T[h[0].index])}))).done((()=>{E.resolve(T)})),E},a=function(l,i,c){const f=new le;let _=c>=0&&e(l,c)+1;const m=[];return oe(ve(l,(S=>{delete S[0].collapsedChildren}))).done((()=>{oe(ve(i,((S,T)=>{const v=S[0];if(v.index>=0){let E=t(l,fe(S));if(E&&E.index>=0)m[v.index]=E.index;else if(_){const h=fe(S.slice(1));E=t(l,h);const w=h.length?E&&E.children:l;w&&(w[T]=v,v.index=m[v.index]=_++)}}}))).done((()=>{f.resolve(m)}))})),f},o=function(l,i,c,f){let _,m,S,T,v,E;const h=l.values;if(i){for(_=0;_<i.length;_+=1)if(S=i[_],v=c[_],V(v)||(v=l.grandTotalRowIndex),S&&V(v))for(h[v]||(h[v]=[]),m=0;m<S.length;m+=1)T=S[m],E=f[m],V(E)||(E=l.grandTotalColumnIndex),V(T)&&V(E)&&(h[v][E]=T)}};function r(l,i){const c=l.remoteOperations||l.paginate?Cl:hl;return new c(J(vo(l),{onChanged:null,onLoadingChanged:null,onProgressChanged:i}))}function u(l,i,c,f){const _=[],m=i&&i[c]||[],S=f&&f[c]||[];return ie(l[c],(T=>{const v=T[0],E=fe(T);v.children&&m[E.length-1]&&!m[E.length-1].expanded&&E.length<m.length&&(!f||(function(h,w,b){for(let D=0;D<b;D+=1)if(!h[D]||!w[D]||h[D].index!==w[D].index)return!1;return!0})(m,S,E.length))&&_.push(E.slice())}),!0),_}function s(l,i,c,f){return i?M(f,((_,m)=>{if(c)l[m]=i[m];else{if((m==="summaryType"||m==="summaryDisplayMode")&&i[m]===void 0)return;Se(l,m,i[m])}})):kt(l,f),l}function d(l,i){const c=[];return M(l,((f,_)=>{c.push(s({dataField:_.dataField,name:_.name},_,!0,i))})),c}function p(l){return l.name?l.name:`${l.dataField}`}function C(l,i){const c=[];return M(l||[],((f,_)=>{p(_)===i&&c.push(_)})),c}function g(l,i){l=l||[];const c={};let f;return M(i,((_,m)=>{f=p(m),c[f]||(c[f]=C(i,p(m)))})),M(c,((_,m)=>{(function(S,T){return S=S||[],M(T,((v,E)=>{s(E,S[v],!1,St),yt(E,Lt)})),T})(C(l,_),m)})),i}function x(l){l.sort(((i,c)=>i.areaIndex-c.areaIndex||i.groupIndex-c.groupIndex))}function F(l,i){const c=l.groupName||"";return(l.dataField||c)+(l.groupInterval?c+l.groupInterval:"NOGROUP")+(i?"":c)}function A(l,i,c){let f=[];const _={},m={},S=Ot(l);return i?(M(i,((T,v)=>{_[F(v,c)]=v})),M(l,((T,v)=>{const E=F(v,c),h=_[E]||m[E];let w;h?(h._initProperties&&kt(h,xn),w=J({},h,v,{_initProperties:null})):_[E]=w=v,!w.dataType&&S[v.dataField]&&(w.dataType=S[v.dataField]),delete _[E],m[E]=h,f.push(w)})),c&&M(_,((T,v)=>{f.push(v)}))):f=l,f.push.apply(f,[]),(function(T){T.forEach((v=>{if(v.groupName&&v.groupInterval&&v.groupIndex===void 0){const E=T.filter((h=>h.groupName===v.groupName&&we(h.groupIndex))).map((h=>h.groupIndex)).reduce(((h,w)=>Math.max(h,w)),-1);v.groupIndex=E+1}}))})(f),f}function y(l){const i=new le,c=l._store,f=c&&c.getFields(l._fields);let _;return oe(f).done((m=>{l._storeFields=m,_=A(l._fields,m,l._retrieveFields),i.resolve(_)})).fail(i.reject),i}function O(l,i,c){return ve(l[c],(f=>{const _=f[0];_.text=_.text||gt(_.value,i[c][fe(f).length-1])}))}function L(l,i){return oe(O(i,l,"columns"),O(i,l,"rows"))}function G(l){const i=new le,c={};return oe(ve(l,(f=>{const _=fe(f).join(".");c[_]=f[0]}))).done(i.resolve),l._cacheByPath=c,i}function j(l,i){const c=[];return M(l,(function(){(function(f,_){const m=_==="data"||f.visible!==!1;return f.area===_&&!V(f.groupIndex)&&m})(this,i)&&c.push(this)})),c}return{ctor(l){l=l||{},this._eventsStrategy=new io(this);const i=this,c=(function(f,_){let m,S;return Yt(f)&&f.load?m=r(f,_):(f&&!f.store&&(f={store:f}),S=f.store,S.type==="xmla"?m=new bl.XmlaStore(S):Yt(S)&&S.type||S instanceof wo||Array.isArray(S)?m=r(f,_):S instanceof Me&&(m=S)),m})(l,(f=>{i._eventsStrategy.fireEvent("progressChanged",[f])}));i._store=c,i._paginate=!!l.paginate,i._pageSize=l.pageSize||40,i._data={rows:[],columns:[],values:[]},i._loadingCount=0,i._isFieldsModified=!1,M(["changed","loadError","loadingChanged","progressChanged","fieldsPrepared","expandValueChanging"],((f,_)=>{const m=`on${_[0].toUpperCase()}${_.slice(1)}`;Object.prototype.hasOwnProperty.call(l,m)&&this.on(_,l[m])})),i._retrieveFields=V(l.retrieveFields)?l.retrieveFields:!0,i._fields=l.fields||[],i._descriptions=l.descriptions?J(i._createDescriptions(),l.descriptions):void 0,c||J(!0,i._data,l.store||l)},getData(){return this._data},getAreaFields(l,i){let c=[],f;return i||l==="data"?(c=j(this._fields,l),x(c)):(f=this._descriptions||{},c=f[vt[l]]||[]),c},getSummaryFields(){return this.getAreaFields("data").filter((l=>V(l.summaryType)))},fields(l){const i=this;return l&&(i._fields=A(l,i._storeFields,i._retrieveFields),i._fieldsPrepared(i._fields)),i._fields},field(l,i){const c=this,f=c._fields,_=f&&f[we(l)?l:He(f,l)];let m;return _&&i&&(M(i,((S,T)=>{const v=!St.includes(S);if(Se(_,S,T,v),S==="sortOrder"){m=_.levels||[];for(let E=0;E<m.length;E+=1)m[E][S]=T}})),yt(_,Lt),c._descriptions=c._createDescriptions(_),c._isFieldsModified=!0,c._eventsStrategy.fireEvent("fieldChanged",[_])),_},getFieldValues(l,i,c){const f=this,_=this._fields&&this._fields[l],m=this.store(),S=[],T={columns:S,rows:[],values:this.getAreaFields("data"),filters:i?this._fields.filter((h=>h!==_&&h.area&&h.filterValues&&h.filterValues.length)):[],skipValues:!0};let v;const E=new le;return c&&(v=c.searchValue,T.columnSkip=c.skip,T.columnTake=c.take),_&&m?(M(_.levels||[_],(function(){S.push(J({},this,{expanded:!0,filterValues:null,sortOrder:"asc",sortBySummaryField:null,searchValue:v}))})),m.load(T).done((h=>{T.columnSkip&&(h.columns=h.columns.slice(T.columnSkip)),T.columnTake&&(h.columns=h.columns.slice(0,T.columnTake)),L(T,h),T.columnTake||f._sort(T,h),E.resolve(h.columns)})).fail(E)):E.reject(),E},reload(){return this.load({reload:!0})},filter(){const l=this._store;return l.filter.apply(l,arguments)},load:function(l){const i=this,c=new le;l=l||{},i.beginLoading(),c.fail((_=>{i._eventsStrategy.fireEvent("loadError",[_])})).always((()=>{i.endLoading()}));function f(){i._delayedLoadTask=void 0,i._descriptions?i._loadCore(l,c):oe(y(i)).done((_=>{i._fieldsPrepared(_),i._loadCore(l,c)})).fail(c.reject).fail(i._loadErrorHandler)}return i.store()?i._delayedLoadTask=Ha.executeAsync(f):f(),c},createDrillDownDataSource(l){return this._store.createDrillDownDataSource(this._descriptions,l)},_createDescriptions(l){const i=this.fields(),c={rows:[],columns:[],values:[],filters:[]};M(["row","column","data","filter"],((_,m)=>{so(j(i,m),"areaIndex",l)})),M(i||[],((_,m)=>{const S=vt[m.area],T=c[S],{groupName:v}=m;v&&!we(m.groupIndex)&&(m.levels=(function(E,h){return E.filter((w=>w.groupName===h.groupName&&we(w.groupIndex)&&w.visible!==!1)).map((w=>J(w,{areaIndex:h.areaIndex,area:h.area,expanded:V(w.expanded)?w.expanded:h.expanded,dataField:w.dataField||h.dataField,dataType:w.dataType||h.dataType,sortBy:w.sortBy||h.sortBy,sortOrder:w.sortOrder||h.sortOrder,sortBySummaryField:w.sortBySummaryField||h.sortBySummaryField,sortBySummaryPath:w.sortBySummaryPath||h.sortBySummaryPath,visible:w.visible||h.visible,showTotals:V(w.showTotals)?w.showTotals:h.showTotals,showGrandTotals:V(w.showGrandTotals)?w.showGrandTotals:h.showGrandTotals}))).sort(((w,b)=>w.groupIndex-b.groupIndex))})(i,m)),!(!T||v&&we(m.groupIndex)||m.visible===!1&&m.area!=="data"&&m.area!=="filter")&&(m.levels&&T!==c.filters&&T!==c.values?(T.push.apply(T,m.levels),m.filterValues&&m.filterValues.length&&c.filters.push(m)):T.push(m))})),M(c,((_,m)=>{x(m)}));const f={};return M(c.values,((_,m)=>{const S=m.calculateSummaryValue;if(Ye(S)){const T=wt.createMockSummaryCell(c,i,f);S(T)}})),c},_fieldsPrepared(l){this._fields=l,M(l,((c,f)=>{f.index=c,yt(f,xn)}));const i=d(l,["caption"]);this._eventsStrategy.fireEvent("fieldsPrepared",[l]);for(let c=0;c<l.length;c+=1)l[c].caption!==i[c].caption&&Se(l[c],"caption",l[c].caption,!0);this._descriptions=this._createDescriptions()},isLoading(){return this._loadingCount>0},state(l,i){const c=this;if(arguments.length){l=J({rowExpandedPaths:[],columnExpandedPaths:[]},l),c._descriptions?(c._fields=g(l.fields,c._fields),c._descriptions=c._createDescriptions(),!i&&c.load(l)):(c.beginLoading(),oe(y(c)).done((f=>{c._fields=g(l.fields,f),c._fieldsPrepared(f),!i&&c.load(l)})).always((()=>{c.endLoading()})));return}return{fields:d(c._fields,St),columnExpandedPaths:u(c._data,c._descriptions,"columns",c._lastLoadOptions),rowExpandedPaths:u(c._data,c._descriptions,"rows",c._lastLoadOptions)}},beginLoading(){this._changeLoadingCount(1)},endLoading(){this._changeLoadingCount(-1)},_changeLoadingCount(l){const i=this.isLoading();this._loadingCount+=l;const c=this.isLoading();i^c&&this._eventsStrategy.fireEvent("loadingChanged",[c])},_hasPagingValues(l,i,c){const f=`${i}Take`,_=`${i}Skip`,{values:m}=this._data;let S=this._data[`${i}s`];const T=i==="row"?"column":"row",v=[];if(l.path&&l.area===i){const E=t(S,l.path);if(S=E&&E.children,!S)return!1}if(l.oppositePath&&l.area===T){const E=t(S,l.oppositePath);if(S=E&&E.children,!S)return!1}for(let E=l[_];E<l[_]+l[f];E+=1)S[E]&&v.push(S[E].index);return v.every((E=>{if(E!==void 0)return i==="row"?(m[E]||[])[c]:(m[c]||[])[E]}))},_processPagingCacheByArea(l,i,c){const f=`${c}Take`,_=`${c}Skip`;let m=this._data[`${c}s`];const S=c==="row"?"column":"row";let T;if(l[f]){if(l.path&&l.area===c){const v=t(m,l.path);m=v&&v.children||[]}if(l.oppositePath&&l.area===S){const v=t(m,l.oppositePath);m=v&&v.children||[]}do if(T=m[l[_]],T&&T.index!==void 0)if(this._hasPagingValues(l,S,T.index))l[_]++,l[f]--;else break;while(T&&T.index!==void 0&&l[f]);if(l[f]){const v=Math.floor(l[_]/i)*i,E=Math.ceil((l[_]+l[f])/i)*i;l[_]=v,l[f]=E-v}}},_processPagingCache(l){const i=this._pageSize;if(!(i<0))for(let c=0;c<l.length;c+=1)this._processPagingCacheByArea(l[c],i,"row"),this._processPagingCacheByArea(l[c],i,"column")},_loadCore(l,i){const c=this,f=this._store,_=this._descriptions,m=l.reload||this.paginate()&&c._isFieldsModified,S=this.paginate(),T=vt[l.area];if(l=l||{},f){J(l,_),l.columnExpandedPaths=l.columnExpandedPaths||u(this._data,l,"columns",c._lastLoadOptions),l.rowExpandedPaths=l.rowExpandedPaths||u(this._data,l,"rows",c._lastLoadOptions),S&&(l.pageSize=this._pageSize),T&&(l.headerName=T),c.beginLoading(),i.always((()=>{c.endLoading()}));let v=[l];if(c._eventsStrategy.fireEvent("customizeStoreLoadOptions",[v,m]),m||c._processPagingCache(v),v=v.filter((h=>!(h.rows.length&&h.rowTake===0)&&!(h.columns.length&&h.columnTake===0))),!v.length){c._update(i);return}const E=v.map((h=>f.load(h)));oe.apply(null,E).done((function(){const h=arguments;for(let w=0;w<h.length;w+=1){const b=v[w],D=h[w],N=w===h.length-1;b.path?c.applyPartialDataSource(b.area,b.path,D,N?i:!1,b.oppositePath):S&&!m&&kl(c._data)?c.mergePartialDataSource(D,N?i:!1):(J(c._data,D),c._lastLoadOptions=b,c._update(N?i:!1))}})).fail(i.reject)}else c._update(i)},_sort(l,i,c){this._store&&!this._paginate&&Al(l,i,c)},sortLocal(){this._sort(this._descriptions,this._data),this._eventsStrategy.fireEvent("changed")},paginate(){return this._paginate&&this._store&&this._store.supportPaging()},isEmpty(){const l=this.getAreaFields("data").filter((c=>c.visible!==!1)),i=this.getData();return!l.length||!i.values.length},_update(l){const i=this,c=i._descriptions,f=i._data,_=c.values,m=Nl(_);return oe(L(c,f),G(f.rows),G(f.columns)).done((()=>{m&&(i._sort(c,f,m),!i.isEmpty()&&wt.applyDisplaySummaryMode(c,f)),i._sort(c,f),!i.isEmpty()&&Ll(_)&&wt.applyRunningTotal(c,f),i._data=f,l!==!1&&oe(l).done((()=>{i._isFieldsModified=!1,i._eventsStrategy.fireEvent("changed"),V(i._data.grandTotalRowIndex)&&(f.grandTotalRowIndex=i._data.grandTotalRowIndex),V(i._data.grandTotalColumnIndex)&&(f.grandTotalColumnIndex=i._data.grandTotalColumnIndex)})),l&&l.resolve(i._data)})),l},store(){return this._store},collapseHeaderItem(l,i){const c=this,f=l==="column"?c._data.columns:c._data.rows,_=t(f,i),m=c.getAreaFields(l)[i.length-1];return _&&_.children?(c._eventsStrategy.fireEvent("expandValueChanging",[{area:l,path:i,expanded:!1}]),m&&(m.expanded=!1),_.collapsedChildren=_.children,delete _.children,c._update(),c.paginate()&&c.load(),!0):!1},collapseAll(l){let i=!1;const c=this.field(l)||{};let f=[this.getAreaFields(c.area).indexOf(c)];c.expanded=!1,c&&c.levels&&(f=[],c.levels.forEach((_=>{f.push(this.getAreaFields(c.area).indexOf(_)),_.expanded=!1}))),ie(this._data[`${c.area}s`],(_=>{const m=_[0],S=fe(_);m&&m.children&&f.includes(S.length-1)&&(m.collapsedChildren=m.children,delete m.children,i=!0)}),!0),i&&this._update()},expandAll(l){const i=this.field(l);i&&i.area&&(i.expanded=!0,i&&i.levels&&i.levels.forEach((c=>{c.expanded=!0})),this.load())},expandHeaderItem(l,i){const c=this,f=l==="column"?c._data.columns:c._data.rows,_=t(f,i);if(_&&!_.children){const m=!!_.collapsedChildren,S={area:l,path:i,expanded:!0,needExpandData:!m};return c._eventsStrategy.fireEvent("expandValueChanging",[S]),m?(_.children=_.collapsedChildren,delete _.collapsedChildren,c._update()):this.store()&&c.load(S),m}return!1},mergePartialDataSource(l,i){const c=this,f=c._data;let _,m;l&&l.values&&(l.rows=l.rows||[],l.columns=l.columns||[],_=a(f.rows,l.rows,f.grandTotalColumnIndex),m=a(f.columns,l.columns,f.grandTotalColumnIndex),oe(_,m).done(((S,T)=>{(S.length||T.length)&&o(f,l.values,S,T),c._update(i)})))},applyPartialDataSource(l,i,c,f,_){const m=this,S=m._data,T=l==="column"?S.columns:S.rows;let v;const E=l==="column"?S.rows:S.columns;let h,w,b;c&&c.values&&(c.rows=c.rows||[],c.columns=c.columns||[],v=t(T,i),h=_&&t(E,_),v&&(l==="column"?(b=n(T,v,c.columns,S.grandTotalColumnIndex),h?w=n(E,h,c.rows,S.grandTotalRowIndex):w=a(S.rows,c.rows,S.grandTotalRowIndex)):(w=n(T,v,c.rows,S.grandTotalRowIndex),h?b=n(E,h,c.columns,S.grandTotalColumnIndex):b=a(S.columns,c.columns,S.grandTotalColumnIndex)),oe(w,b).done(((D,N)=>{(l==="row"&&D.length||l==="column"&&N.length)&&o(S,c.values,D,N),m._update(f)}))))},on(l,i){return this._eventsStrategy.on(l,i),this},off(l,i){return this._eventsStrategy.off(l,i),this},dispose(){const l=this._delayedLoadTask;this._eventsStrategy.dispose(),l&&l.abort(),this._isDisposed=!0},isDisposed(){return!!this._isDisposed}}})()),Tt=Math,Ge=function(t,e,n){t[e]||(t[e]=function(){const a=this._dataSource;return a?a[e].apply(a,arguments):n})},Ml=Me.inherit((function(){function t(s,d,p){return s==="#N/A"?p:gt(s,d)}const e=(function(){const s=function(g,x){const F=x.lastIndex-x.index||1,A=(function(y,O,L,G){var j;const l={type:y.type,text:y.text};return y.path&&(l.path=y.path),y.width&&(l.width=y.width),V(y.wordWrapEnabled)&&(l.wordWrapEnabled=y.wordWrapEnabled),y.isLast&&(l.isLast=!0),y.sorted&&(l.sorted=!0),y.isMetric&&(l.dataIndex=y.dataIndex),V(y.expanded)&&(l.expanded=y.expanded),O>1&&(l[L?"colspan":"rowspan"]=O),y.depthSize&&y.depthSize>1&&(l[L?"rowspan":"colspan"]=y.depthSize),y.index>=0&&(l.dataSourceIndex=y.index),G&&(j=y.children)!==null&&j!==void 0&&j.length&&!y.children[0].isMetric&&(l.width=null,l.isWhiteSpace=!0),l})(x.headerItem,F,x.isHorizontal,x.isTree);return(function(y,O,L,G,j){const l=j?G:L;for(;!y[l];)y.push([]);j?y[l].push(O):y[l].unshift(O)})(g,A,x.index,x.depth,x.isHorizontal),!x.headerItem.children||x.headerItem.children.length===0?x.lastIndex+1:x.lastIndex},d=function(g,x,F,A,y){const O=F.length,L=(function(l,i){const c=(i==null?void 0:i.length)||0,f=[],_=new le;let m;return oe(ve(l,((S,T)=>{const v=S[0],E=fe(S);m=p(f,E.length,T),m.type="D",m.value=v.value,m.path=E,m.text=v.text,m.index=v.index,m.displayText=v.displayText,m.key=v.key,m.isEmpty=v.isEmpty,E.length<c&&(!v.children||v.children.length!==0)&&(m.expanded=!!v.children)}))).done((()=>{_.resolve(p(f,0,0).children||[])})),_})(g,x),{dataFields:G}=y,j=new le;return oe(L).done((l=>{y.notifyProgress(.5),y.showGrandTotals&&l[y.showTotalsPrior?"unshift":"push"]({type:"GT",isEmpty:y.isEmptyGrandTotal});const i=y.showTotals===!1||G.length>0&&G.length===y.hiddenTotals.length,c=G.length>0&&y.hiddenValues.length===G.length;c&&i&&(A=1),(!i||y.layout==="tree")&&(function(f,_,m,S){m=m||S,ie(f,((T,v)=>{const E=T[0],h=(T[1]?T[1].children:f)||[],w=_[T.length-1];E.type==="D"&&E.expanded&&(w.showTotals!==!1||S)&&(v!==-1&&h.splice(m?v:v+1,0,J({},E,{children:null,type:"T",expanded:m?!0:null,isAdditionalTotal:!0})),m&&(E.expanded=null))}))})(l,x,y.showTotalsPrior,y.layout==="tree"),oe(ve(l,(f=>{const _=f[0];(!_.children||_.children.length===0)&&(_.depthSize=A-f.length+1)}))).done((()=>{O>1&&(function(f,_,m){ie(f,(S=>{const T=S[0];let v;if(!T.children||T.children.length===0)for(T.children=[],v=0;v<_.length;v+=1){var E;const h=T.type==="GT",w=T.type==="T",b=T.type==="D";_[v].visible===!1||h&&m.hiddenGrandTotals.includes(v)||w&&m.hiddenTotals.includes(v)||b&&m.hiddenValues.includes(v)||T.children.push({caption:_[v].caption,path:T.path,type:T.type,value:v,index:T.index,dataIndex:v,isMetric:!0,isEmpty:(E=T.isEmpty)===null||E===void 0?void 0:E[v]})}}))})(l,F,y),!y.showEmpty&&(function(f){ie([{children:f}],((_,m)=>{var S;const T=_[0],v=(_[1]?_[1].children:f)||[];let{isEmpty:E}=T;(S=E)!==null&&S!==void 0&&S.length&&(E=T.isEmpty.filter((h=>h)).length===E.length),T&&!T.children&&E&&(v.splice(m,1),C(_,1))}))})(l),y.notifyProgress(.75),oe(ve(l,(f=>{var _;const m=f[0],{isMetric:S}=m,T=x[f.length-1]||{};if(m.type==="D"&&!S&&(m.width=T.width),c&&m.type==="D"){const v=(f[1]?f[1].children:l)||[];v.splice(v.indexOf(m),1);return}S?m.wordWrapEnabled=F[m.dataIndex].wordWrapEnabled:m.wordWrapEnabled=T.wordWrapEnabled,m.isLast=!((_=m.children)!==null&&_!==void 0&&_.length),m.isLast&&M(y.sortBySummaryPaths,((v,E)=>{if(V(m.dataIndex)||(E=E.slice(0),E.pop()),(function(h,w){let b;const D=h[0],N=Pe(w[0]),k=D.dataIndex>=0?h[1]:D;return N&&w[0].indexOf("&[")!==-1&&k.key||!k.key?b=fe(h):b=Xe(h,(K=>K.dataIndex>=0?K.value:K.text)).reverse(),D.type==="GT"&&(b=b.slice(1)),b.join("/")===w.join("/")})(f,E))return m.sorted=!0,!1})),m.text=(function(v,E,h){let{text:w}=v;return V(v.displayText)?w=v.displayText:V(v.caption)?w=v.caption:v.type==="GT"&&(w=h.texts.grandTotal),v.isAdditionalTotal&&(w=re(h.texts.total||"",w)),w})(m,0,y)}))).done((()=>{l.length||l.push({}),y.notifyProgress(1),j.resolve(l)}))}))})),j};function p(g,x,F){const A=g[x]=g[x]||[],y=A[F]={};if(g[x+1]){y.children=g[x+1];for(let O=x+1;O<g.length;O+=1)g[O]=void 0;g.length=x+1}return y}const C=function(g,x){const F=g[x+1];!g[x].children.length&&F!==null&&F!==void 0&&F.children&&(F.children.splice(F.children.indexOf(g[x]),1),C(g,x+1))};return function(g,x,F,A,y){const O=[],L=(function(j){let l=0;return ie(j,(i=>{l=Tt.max(l,i.length)})),l})(g)||1,G=new le;return d(g,x,F,L,y).done((j=>{(function(l,i,c,f,_){let m=0,S,T;const v=[0];ie(i,(E=>{const h=E[0];for(T=h.isMetric?c:E.length-1;v.length-1<T;)v.push(v[v.length-1]);S=v[T]||0,m=s(l,{headerItem:h,index:S,lastIndex:m,depth:T,isHorizontal:f,isTree:_}),v.length=T,v.push(m)}))})(O,j,L,A,y.layout==="tree"),y.notifyProgress(1),G.resolve(O)})),G}})();function n(s,d){const p=[];return M(s,((C,g)=>{const x=He(d,g.sortBySummaryField);x>=0&&p.push((g.sortBySummaryPath||[]).concat([x]))})),p}function a(s,d){let p=0;const C=[];for(let g=0;g<s.length;g+=1)for(let x=0;x<s[g].length;x+=1){const F=(s[g][x].rowspan||1)-1,A=g+F;if(C[g]&&(p-=C[g],C[g]=0),d(s[g][x],A,g,x,p)===!1)break;C[g+(s[g][x].rowspan||1)]=(C[g+(s[g][x].rowspan||1)]||0)+1,p+=1}}function o(s,d){let p=0;const C=[];return ie(s,(g=>{const x=g[0],F=fe(g);if(x.children&&d.showTotals===!1)return;const A=J(!0,{},x,{visibleIndex:p+=1,path:F});V(A.index)?C[A.index]=A:C.push(A)})),C}function r(s,d,p){return new Eo.VirtualScrollController(d,J({hasKnownLastPage:()=>!0,pageCount(){return Tt.ceil(this.totalItemsCount()/this.pageSize())},updateLoading(){},itemsCount(){return this.pageIndex()<this.pageCount()-1?this.pageSize():this.totalItemsCount()%this.pageSize()},items:()=>[],viewportItems:()=>[],onChanged(){},isLoading:()=>s.isLoading(),changingDuration(){return s._dataSource.paginate()?300:s._changingDuration||0}},p))}const u={ctor(s){const d=this,p=d._fireChanged.bind(d);s=d._options=s||{},d.dataSourceChanged=Re(),d._dataSource=d._createDataSource(s),s.component&&s.component.option("scrolling.mode")==="virtual"&&(d._rowsScrollController=r(d,s.component,{totalItemsCount:()=>d.totalRowCount(),pageIndex:C=>d.rowPageIndex(C),pageSize:()=>d.rowPageSize(),load(){return d._rowsScrollController.pageIndex()>=this.pageCount()&&d._rowsScrollController.pageIndex(this.pageCount()-1),d._rowsScrollController.handleDataChanged((function(){d._dataSource.paginate()?d._dataSource.load():p.apply(this,arguments)}))}}),d._columnsScrollController=r(d,s.component,{totalItemsCount:()=>d.totalColumnCount(),pageIndex:C=>d.columnPageIndex(C),pageSize:()=>d.columnPageSize(),load(){return d._columnsScrollController.pageIndex()>=this.pageCount()&&d._columnsScrollController.pageIndex(this.pageCount()-1),d._columnsScrollController.handleDataChanged((function(){d._dataSource.paginate()?d._dataSource.load():p.apply(this,arguments)}))}})),d._stateStoringController=new To.StateStoringController(s.component).init(),d._columnsInfo=[],d._rowsInfo=[],d._cellsInfo=[],d.expandValueChanging=Re(),d.loadingChanged=Re(),d.progressChanged=Re(),d.scrollChanged=Re(),d.load(),d._update(),d.changed=Re()},_fireChanged(){const s=new Date;this.changed&&!this._lockChanged&&this.changed.fire(),this._changingDuration=new Date-s},_correctSkipsTakes(s,d,p,C,g,x){const F=p?s+p-1:s;g[C.length]=g[C.length]||0,x[C.length]=x[C.length]||0,F<d?g[C.length]+=1:x[C.length]+=1},_calculatePagingForRowExpandedPaths(s,d,p,C,g){const x=this._rowsInfo,F=Math.min(s.rowSkip+s.rowTake,x.length),{rowExpandedPaths:A}=s;let y=[];const O={};let L,G,j;for(A.forEach(((l,i)=>{O[l]=i})),L=0;L<F;L+=1){for(p.length=d.length=y.length+1,G=0;G<x[L].length;G+=1){const l=x[L][G];if(l.type==="D"){this._correctSkipsTakes(L,s.rowSkip,l.rowspan,y,d,p),j=l.path||j;const i=j&&j.length>1?O[j.slice(0,-1)]:-1;i>=0&&(C[i]=d[y.length]||0,g[i]=p[y.length]||0),l.rowspan&&y.push(l.rowspan)}}y=y.map((l=>l-1)).filter((l=>l>0))}},_calculatePagingForColumnExpandedPaths(s,d,p,C,g){const x={},F={};an(this._columnsInfo,((A,y)=>{if(A.type==="D"&&A.path&&A.dataIndex===void 0){const O=A.colspan||1,L=A.path.slice(0,-1).toString();x[L]=x[L]||0,F[L]=F[L]||0,y+O<=s.columnSkip?x[L]+=1:y<s.columnSkip+s.columnTake&&(F[L]+=1)}})),d[0]=x[""],p[0]=F[""],s.columnExpandedPaths.forEach(((A,y)=>{const O=x[A],L=F[A];O!==void 0&&(C[y]=O),L!==void 0&&(g[y]=L)}))},_processPagingForExpandedPaths(s,d,p,C){const g=s[`${d}ExpandedPaths`],x=g.map((()=>0)),F=g.map((()=>C?s.pageSize:0)),A=[],y=[];C||(d==="row"?this._calculatePagingForRowExpandedPaths(s,A,y,x,F):this._calculatePagingForColumnExpandedPaths(s,A,y,x,F)),this._savePagingForExpandedPaths(s,d,p,A[0],y[0],x,F)},_savePagingForExpandedPaths(s,d,p,C,g,x,F){const A=s[`${d}ExpandedPaths`];s[`${d}ExpandedPaths`]=[],s[`${d}Skip`]=C!==void 0?C:s[`${d}Skip`],s[`${d}Take`]=g!==void 0?g:s[`${d}Take`];for(let y=0;y<A.length;y+=1)if(F[y]){const O=s.area&&s.area!==d;p.push(J({area:d,headerName:`${d}s`},s,{[`${d}Skip`]:x[y],[`${d}Take`]:F[y],[O?"oppositePath":"path"]:A[y]}))}},_handleCustomizeStoreLoadOptions(s,d){const p=s[0],C=this._rowsScrollController;if(this._dataSource.paginate()&&C){const x=C.pageSize();p.headerName==="rows"?(p.rowSkip=0,p.rowTake=x,p.rowExpandedPaths=[]):(p.rowSkip=C.beginPageIndex()*x,p.rowTake=(C.endPageIndex()-C.beginPageIndex()+1)*x,this._processPagingForExpandedPaths(p,"row",s,d))}const g=this._columnsScrollController;if(this._dataSource.paginate()&&g){const x=g.pageSize();s.forEach((F=>{F.headerName==="columns"?(F.columnSkip=0,F.columnTake=x,F.columnExpandedPaths=[]):(F.columnSkip=g.beginPageIndex()*x,F.columnTake=(g.endPageIndex()-g.beginPageIndex()+1)*x,this._processPagingForExpandedPaths(F,"column",s,d))}))}},load(){const s=this,d=this._stateStoringController;d.isEnabled()&&!d.isLoaded()?d.load().always((p=>{p?s._dataSource.state(p):s._dataSource.load()})):s._dataSource.load()},calculateVirtualContentParams(s){const d=this,p=d._rowsScrollController,C=d._columnsScrollController;if(p&&C)return p.viewportItemSize(s.virtualRowHeight),p.viewportSize(s.viewportHeight/p.viewportItemSize()),p.setContentItemSizes(s.itemHeights),C.viewportItemSize(s.virtualColumnWidth),C.viewportSize(s.viewportWidth/C.viewportItemSize()),C.setContentItemSizes(s.itemWidths),In((()=>{C.loadIfNeed(),p.loadIfNeed()})),d.scrollChanged.fire({left:C.getViewportPosition(),top:p.getViewportPosition()}),{contentTop:p.getContentOffset(),contentLeft:C.getContentOffset(),width:C.getVirtualContentSize(),height:p.getVirtualContentSize()}},setViewportPosition(s,d){this._rowsScrollController.setViewportPosition(d||0),this._columnsScrollController.setViewportPosition(s||0)},subscribeToWindowScrollEvents(s){var d;(d=this._rowsScrollController)===null||d===void 0||d.subscribeToWindowScrollEvents(s)},updateWindowScrollPosition(s){var d;(d=this._rowsScrollController)===null||d===void 0||d.scrollTo(s)},updateViewOptions(s){J(this._options,s),this._update()},_handleExpandValueChanging(s){this.expandValueChanging.fire(s)},_handleLoadingChanged(s){this.loadingChanged.fire(s)},_handleProgressChanged(s){this.progressChanged.fire(s)},_handleFieldsPrepared(s){var d,p;(d=(p=this._options).onFieldsPrepared)===null||d===void 0||d.call(p,s)},_createDataSource(s){const d=this,p=s.dataSource;let C;return d._isSharedDataSource=p instanceof Cn,d._isSharedDataSource?C=p:C=new Cn(p),d._expandValueChangingHandler=d._handleExpandValueChanging.bind(d),d._loadingChangedHandler=d._handleLoadingChanged.bind(d),d._fieldsPreparedHandler=d._handleFieldsPrepared.bind(d),d._customizeStoreLoadOptionsHandler=d._handleCustomizeStoreLoadOptions.bind(d),d._changedHandler=function(){d._update(),d.dataSourceChanged.fire()},d._progressChangedHandler=function(g){d._handleProgressChanged(.8*g)},C.on("changed",d._changedHandler),C.on("expandValueChanging",d._expandValueChangingHandler),C.on("loadingChanged",d._loadingChangedHandler),C.on("progressChanged",d._progressChangedHandler),C.on("fieldsPrepared",d._fieldsPreparedHandler),C.on("customizeStoreLoadOptions",d._customizeStoreLoadOptionsHandler),C},getDataSource(){return this._dataSource},isLoading(){return this._dataSource.isLoading()},beginLoading(){this._dataSource.beginLoading()},endLoading(){this._dataSource.endLoading()},_update(){const s=this,d=s._dataSource,p=s._options,C=d.getAreaFields("column"),g=d.getAreaFields("row"),x=d.getAreaFields("data"),F=p.dataFieldArea==="row"?x:[],A=p.dataFieldArea!=="row"?x:[],y=d.getData(),O=(function(_){const m=[];return M(_,((S,T)=>{T.showTotals===!1&&m.push(S)})),m})(x),L=(function(_){const m=[];return _.forEach(((S,T)=>{(S.showValues===void 0&&S.showTotals===!1||S.showValues===!1)&&m.push(T)})),m})(x),G=(function(_,m){let S=[];return M(_,((T,v)=>{v.showGrandTotals===!1&&S.push(T)})),m.length===0&&S.length===_.length&&(S=[]),S})(x,C),j=x.length>0?G.length!==x.length:!0,l={texts:p.texts||{},hiddenTotals:O,hiddenValues:L,hiddenGrandTotals:G,showEmpty:!p.hideEmptySummaryCells,dataFields:x,progress:0},i=J({},l,{isEmptyGrandTotal:y.isEmptyGrandTotalRow,showTotals:p.showRowTotals,showTotalsPrior:p.showTotalsPrior==="rows"||p.showTotalsPrior==="both",showGrandTotals:p.showRowGrandTotals!==!1&&j,sortBySummaryPaths:n(C,x),layout:p.rowHeaderLayout,fields:g}),c=J({},l,{isEmptyGrandTotal:y.isEmptyGrandTotalColumn,showTotals:p.showColumnTotals,showTotalsPrior:p.showTotalsPrior==="columns"||p.showTotalsPrior==="both",showGrandTotals:p.showColumnGrandTotals!==!1&&j,sortBySummaryPaths:n(g,x),fields:C}),f=function(_){this.progress=_,s._handleProgressChanged(.8+.1*i.progress+.1*c.progress)};i.notifyProgress=f,c.notifyProgress=f,V(y.grandTotalRowIndex)||(y.grandTotalRowIndex=o(y.rows,i).length),V(y.grandTotalColumnIndex)||(y.grandTotalColumnIndex=o(y.columns,c).length),d._changeLoadingCount(1),oe(e(y.columns,C,A,!0,c),e(y.rows,g,F,!1,i)).always((()=>{d._changeLoadingCount(-1)})).done(((_,m)=>{s._columnsInfo=_,s._rowsInfo=m,s._rowsScrollController&&s._columnsScrollController&&s.changed&&!s._dataSource.paginate()&&(s._rowsScrollController.reset(!0),s._columnsScrollController.reset(!0),s._lockChanged=!0,s._rowsScrollController.load(),s._columnsScrollController.load(),s._lockChanged=!1)})).done((()=>{s._fireChanged(),s._stateStoringController.isEnabled()&&!s._dataSource.isLoading()&&(s._stateStoringController.state(s._dataSource.state()),s._stateStoringController.save())}))},getRowsInfo(s){const d=this,p=d._rowsInfo,C=d._rowsScrollController;let g;const x=p.length===1&&(!p[0].type||p[0].type==="GT");if(C&&!s&&!x){const F=C.beginPageIndex()*d.rowPageSize(),A=C.endPageIndex()*d.rowPageSize()+d.rowPageSize(),y=d._dataSource.getSummaryFields(),O=this._options.dataFieldArea==="row",L=[];let G=1;return a(p,((j,l,i,c,f)=>{const _=l>=F&&i<A,m=i<F?0:i-F;let S=j;if(_){L[m]=L[m]||[],g=i<F?j.rowspan-(F-i)||1:j.rowspan,F+m+g>A&&(g=A-(m+F)||1),g!==j.rowspan&&(S=J({},S,{rowspan:g})),L[m].push(S);const T=y.some((v=>v.caption===S.text));(!O||!T)&&(G=Tt.max(G,f+1))}else return!1})),a(L,((j,l,i,c,f)=>{const _=j.colspan||1;f+_>G&&(L[i][c]=J({},j,{colspan:G-f||1}))})),L}return p},getColumnsInfo(s){const d=this;let p=d._columnsInfo;const C=d._columnsScrollController;if(C&&!s){const g=C.beginPageIndex()*d.columnPageSize(),x=C.endPageIndex()*d.columnPageSize()+d.columnPageSize();p=yo(p,g,x)}return p},totalRowCount(){return this._rowsInfo.length},rowPageIndex(s){return s!==void 0&&(this._rowPageIndex=s),this._rowPageIndex||0},totalColumnCount(){var s;let d=0;if((s=this._columnsInfo)!==null&&s!==void 0&&s.length)for(let p=0;p<this._columnsInfo[0].length;p+=1)d+=this._columnsInfo[0][p].colspan||1;return d},rowPageSize(s){return s!==void 0&&(this._rowPageSize=s),this._rowPageSize||20},columnPageSize(s){return s!==void 0&&(this._columnPageSize=s),this._columnPageSize||20},columnPageIndex(s){return s!==void 0&&(this._columnPageIndex=s),this._columnPageIndex||0},getCellsInfo(s){const d=this.getRowsInfo(s),p=this.getColumnsInfo(s),C=this._dataSource.getData(),g=this._options.texts||{};return(function(x,F,A,y,O,L){const G=[],j=O==="row",l=A.values;return l.length&&a(x,((i,c)=>{const f=G[c]=[],_=l[i.dataSourceIndex>=0?i.dataSourceIndex:A.grandTotalRowIndex]||[];i.isLast&&an(F,((m,S)=>{const T=(j?i.dataIndex:m.dataIndex)||0,v=y[T];if(m.isLast&&v&&v.visible!==!1){let E=_[m.dataSourceIndex>=0?m.dataSourceIndex:A.grandTotalColumnIndex];Array.isArray(E)||(E=[E]);const h=E[T];f[S]={text:t(h,v,L),value:h,format:v.format,dataType:v.dataType,columnType:m.type,rowType:i.type,rowPath:i.path||[],columnPath:m.path||[],dataIndex:T},v.width&&(f[S].width=v.width)}}))})),G})(d,p,C,this._dataSource.getAreaFields("data"),this._options.dataFieldArea,g.dataNotAvailable)},dispose(){var s,d;const p=this;p._isSharedDataSource?(p._dataSource.off("changed",p._changedHandler),p._dataSource.off("expandValueChanging",p._expandValueChangingHandler),p._dataSource.off("loadingChanged",p._loadingChangedHandler),p._dataSource.off("progressChanged",p._progressChangedHandler),p._dataSource.off("fieldsPrepared",p._fieldsPreparedHandler),p._dataSource.off("customizeStoreLoadOptions",p._customizeStoreLoadOptionsHandler)):p._dataSource.dispose(),(s=p._columnsScrollController)===null||s===void 0||s.dispose(),(d=p._rowsScrollController)===null||d===void 0||d.dispose(),p._stateStoringController.dispose(),p.expandValueChanging.empty(),p.changed.empty(),p.loadingChanged.empty(),p.progressChanged.empty(),p.scrollChanged.empty(),p.dataSourceChanged.empty()}};return Ge(u,"applyPartialDataSource"),Ge(u,"collapseHeaderItem"),Ge(u,"expandHeaderItem"),Ge(u,"getData"),Ge(u,"isEmpty"),u})()),$l={DataController:Ml},Ol={exportTo(){const t=this._createActionByOption("onExporting"),e={rtlEnabled:this.option("rtlEnabled"),fileName:"PivotGrid",cancel:!1};Ye(t)&&t(e)},_getLength(t){let e;const n=t[0].length;let a=0;for(e=0;e<n;e+=1)a+=t[0][e].colspan||1;return a},_correctCellsInfoItemLengths(t,e){for(let n=0;n<t.length;n+=1)for(;t[n].length<e;)t[n].push({});return t},_calculateCellInfoItemLength(t){let e=0;for(let n=0;n<t.length;n+=1)e+=V(t[n].colspan)?t[n].colspan:1;return e},_getEmptyCell:()=>({text:"",value:void 0,colspan:1,rowspan:1}),_getAllItems(t,e,n){let a,o,r=n;const u=this._getLength(e),s=t.length;if(t.length>0&&t[0].length>0&&n.length>0&&n[0].length===0){const p=this._calculateCellInfoItemLength(t[0]);p>0&&(r=this._correctCellsInfoItemLengths(n,p))}if(r.length===0){const p=e.length,C=t.map((g=>g.filter((x=>!x.expanded)).length)).reduce(((g,x)=>g+x),0);for(let g=0;g<p;g+=1){r[g]=[];for(let x=0;x<C;x+=1)r[g][x]=this._getEmptyCell()}}const d=t.concat(r);for(o=0;o<e.length;o+=1)for(a=e[o].length-1;a>=0;a-=1)V(d[o+s])||(d[o+s]=[]),d[o+s].splice(0,0,J({},e[o][a]));return d[0].splice(0,0,J({},this._getEmptyCell(),{alignment:lt(this._options.rtlEnabled),colspan:u,rowspan:s})),Xa(d,this._getEmptyCell())},getDataProvider(){return new Bl(this)}};class Bl{constructor(e){this._exportController=e}ready(){this._initOptions();const e=this._options;return oe(e.items).done((n=>{const a=n[0][0].rowspan,o=n[a-1];M(o,((r,u)=>{u.width=100})),e.columns=o,e.items=n}))}_initOptions(){const e=this._exportController,n=e._dataController,a=new le;n.beginLoading(),setTimeout((()=>{const o=J(!0,[],n.getColumnsInfo(!0)),r=J(!0,[],n.getRowsInfo(!0)),u=n.getCellsInfo(!0);a.resolve(e._getAllItems(o,r,u)),n.endLoading()})),this._options={items:a,rtlEnabled:e.option("rtlEnabled"),dataFields:e.getDataSource().getAreaFields("data"),rowsArea:e._rowsArea,columnsArea:e._columnsArea}}getColumns(){return this._options.columns}getColumnsWidths(){const e=this._options.columnsArea,{rowsArea:n}=this._options,{columns:a}=this._options;return!Le()||e.option("scrolling.mode")==="virtual"||e.element().is(":hidden")?a.map((()=>100)):n.getColumnsWidth().concat(e.getColumnsWidth())}getRowsCount(){return this._options.items.length}getGroupLevel(){return 0}getCellMerging(e,n){const{items:a}=this._options,o=a[e]&&a[e][n];return o?{colspan:o.colspan-1,rowspan:o.rowspan-1}:{colspan:0,rowspan:0}}getFrozenArea(){return{x:this.getRowAreaColCount(),y:this.getColumnAreaRowCount()}}getCellType(e,n){const a=this.getStyles()[this.getStyleId(e,n)];return a&&a.dataType||"string"}getCellData(e,n,a){const o={},{items:r}=this._options,u=r[e]&&r[e][n]||{};if(a){o.cellSourceData=u;const s=this._tryGetAreaName(u,e,n);s&&(o.cellSourceData.area=s),o.cellSourceData.rowIndex=e,o.cellSourceData.columnIndex=n}return this.getCellType(e,n)==="string"?o.value=u.text:o.value=u.value,o.cellSourceData&&o.cellSourceData.isWhiteSpace&&(o.value=""),o}_tryGetAreaName(e,n,a){if(this.isColumnAreaCell(n,a))return"column";if(this.isRowAreaCell(n,a))return"row";if(V(e.dataIndex))return"data"}isRowAreaCell(e,n){return e>=this.getColumnAreaRowCount()&&n<this.getRowAreaColCount()}isColumnAreaCell(e,n){return n>=this.getRowAreaColCount()&&e<this.getColumnAreaRowCount()}getColumnAreaRowCount(){return this._options.items[0][0].rowspan}getRowAreaColCount(){return this._options.items[0][0].colspan}getHeaderStyles(){return[{alignment:"center",dataType:"string"},{alignment:lt(this._options.rtlEnabled),dataType:"string"}]}getDataFieldStyles(){const{dataFields:e}=this._options,n={alignment:this._options.rtlEnabled?"left":"right"},a=[];return e.length?(e.forEach((o=>{a.push(Qe({},n,{format:o.format,dataType:this.getCellDataType(o)}))})),a):[n]}getStyles(){return this._styles?this._styles:(this._styles=[...this.getHeaderStyles(),...this.getDataFieldStyles()],this._styles)}getCellDataType(e){if(e&&e.customizeText)return"string";if(e.dataType)return e.dataType;if(e.format){if(Na.parse(it.format(1,e.format))===1)return"number";if(it.format(new Date,e.format))return"date"}return"string"}getStyleId(e,n){const{items:a}=this._options,o=a[e]&&a[e][n]||{};return n===0&&e===0||this.isColumnAreaCell(e,n)?0:this.isRowAreaCell(e,n)?1:this.getHeaderStyles().length+(o.dataIndex||0)}}const ut={treeViewItem:"tree-view-item",allowScrolling:"allow-scrolling",itemGroup:"item-group"},Q={area:{self:"dx-area",box:"dx-area-box",caption:"dx-area-caption",icon:"dx-area-icon",field:"dx-area-field",fieldContainer:"dx-area-field-container",fieldContent:"dx-area-field-content",fieldList:"dx-area-fields",fieldListHeader:"dx-area-fields-header"},pivotGrid:{dragAction:"dx-pivotgrid-drag-action",fieldsContainer:"dx-pivotgrid-fields-container"},fieldChooser:{self:"dx-pivotgridfieldchooser",container:"dx-pivotgridfieldchooser-container",contextMenu:"dx-pivotgridfieldchooser-context-menu"},layout:{zero:"dx-layout-0",second:"dx-layout-2"},treeView:{self:"dx-treeview",borderVisible:"dx-treeview-border-visible"},scrollable:{self:"dx-scrollable"},allFields:"dx-all-fields",col:"dx-col",headerFilter:"dx-header-filter",row:"dx-row",widget:"dx-widget"},tt={all:"smalliconslayout",column:"columnfield",row:"rowfield",filter:"filter",data:"formula",measure:"formula",hierarchy:"hierarchy",dimension:"detailslayout"},aa={targets:{drag:"drag"}},Et={descending:"desc",ascending:"asc"},{getSwatchContainer:Vl}=go,wn="dx-sortable-old";function Gl(t,e,n){const a=R(t),o=a.offset();if(e>=o.left&&e<=o.left+Je(a,!0)&&n>=o.top&&n<=o.top+$e(a,!0))return!0}function zl(t,e,n){return V(e.posHorizontal)?n?t>e.posHorizontal:t<e.posHorizontal:!0}function Wl(t,e){let n=-1;const a=e.get(0);return M(t,((o,r)=>{const u=R(r);if(u.attr("item-group")&&u.attr("item-group")===t.eq(o-1).attr("item-group")||(n+=1),r===a)return!1})),n===t.length?-1:n}function jl(t,e){let n;return M(e,(function(){Gl(this,t.pageX,t.pageY)&&(n=R(this))})),n}function Ul(t,e,n){const a=[];let o=[];for(let r=0;r<t.length;r+=o.length)if(o=t.eq(r),o.attr("item-group")&&(o=n.find(`[item-group='${o.attr("item-group")}']`)),o.is(":visible")){const u={item:o,index:a.length,posVertical:e?(o.last().offset().top+o.offset().top+$e(o.last(),!0))/2:$e(o.last(),!0)+o.last().offset().top,posHorizontal:e?void 0:(Je(o.last(),!0)+o.last().offset().left+o.offset().left)/2};a.push(u)}return a}function ql(t){let e,n=t.scrollTop();const a=t.$element(),{top:o}=a.offset(),r=me(a);let u=0;function s(C){n=C.scrollOffset.top}t.on("scroll",s);function d(){p(),t.scrollTo(n+=u),e=setTimeout(d,10)}function p(){clearTimeout(e)}return{moveIfNeed:function(C){if(C.pageY<=o+20)u=-2;else if(C.pageY>=o+r-20)u=2;else{u=0,p();return}d()},element:()=>a,dispose(){p(),t.off("scroll",s)}}}const oa=co.inherit({_getDefaultOptions(){return J(this.callBase(),{onChanged:null,onDragging:null,itemRender:null,groupSelector:null,itemSelector:".dx-sort-item",itemContainerSelector:".dx-sortable-old",sourceClass:"dx-drag-source",dragClass:"dx-drag",targetClass:"dx-drag-target",direction:"vertical",allowDragging:!0,groupFilter:null,useIndicator:!1})},_renderItem(t,e){const n=this.option("itemRender");let a;return n?a=n(t,e):(a=t.clone(),a.css({width:We(t),height:me(t)})),a},_renderIndicator(t,e,n,a){const o=$e(t,!0),r=Je(t,!0),u=t.offset().top-n.offset().top,s=t.offset().left-n.offset().left;this._indicator.css({position:"absolute",top:a&&e?u+o:u,left:a&&!e?s+r:s}).toggleClass("dx-position-indicator-horizontal",!e).toggleClass("dx-position-indicator-vertical",!!e).toggleClass("dx-position-indicator-last",!!a).appendTo(n),rt(this._indicator,""),qe(this._indicator,""),e?qe(this._indicator,r):rt(this._indicator,o)},_renderDraggable(t){this._$draggable&&this._$draggable.remove(),this._$draggable=this._renderItem(t,"drag").addClass(this.option("dragClass")).appendTo(Vl(t)).css({zIndex:1e6,position:"absolute"})},_detachEventHandlers(){const t=[Zt,Jt,en,uo,ho,po].join(" ");be.off(this._getEventListener(),ze(t,"dxSortable"),void 0)},_getItemOffset(t,e,n){for(let a=0;a<e.length;a+=1){let o;const r=n.pageY<e[a].posVertical;if(t?o=r:r&&(o=zl(n.pageX,e[a],this.option("rtlEnabled")),!o&&e[a+1]&&e[a+1].posVertical>e[a].posVertical&&(o=!0)),o)return e[a]}},_getEventListener(){const t=this.option("groupSelector"),e=this.$element();return t?e.find(t):e},_attachEventHandlers(){const t=this,e=t.option("itemSelector"),n=t.option("itemContainerSelector"),a=t.option("groupSelector"),o=t.option("sourceClass"),r=t.option("targetClass"),u=t.option("onDragging"),s=t.option("groupFilter");let d,p,C,g,x,F;const A=t.$element();let y,O=null,L=-1;const G=function(){var j;(j=O)===null||j===void 0||j.dispose(),O=null};if(t._detachEventHandlers(),t.option("allowDragging")){const j=t._getEventListener();be.on(j,ze(Jt,"dxSortable"),e,(l=>{d=R(l.currentTarget);const i=d.closest(a);F=i.attr("group"),p=Wl((a?i:A).find(e),d),d.attr("item-group")&&(d=i.find(`[item-group='${d.attr("item-group")}']`)),t._renderDraggable(d),C=t._renderItem(d,"target").addClass(r),d.addClass(o),(function(){x=[],M(d,((c,f)=>{x.push(R(f).offset())}))})(),y=(function(){const c=Ce.getRootNode(t.$element().get(0));return a?s?R(c).find(a).filter(s):A.find(a):A})(),t._indicator=R("<div>").addClass("dx-position-indicator")})),be.on(j,ze(Zt,"dxSortable"),(l=>{let i,c,f;if(!d)return;if(L=-1,t._indicator.detach(),M(t._$draggable,((w,b)=>{R(b).css({top:x[w].top+l.offset.y,left:x[w].left+l.offset.x})})),g&&g.removeClass(r),g=jl(l,y),g&&(function(){const w={sourceGroup:F,sourceIndex:p,sourceElement:d,targetGroup:g.attr("group"),targetIndex:g.find(e).index(C)};u&&u(w),w.cancel&&(g=void 0)})(),g&&O&&g.get(0)!==O.element().get(0)&&G(),O&&O.moveIfNeed(l),!g){C.detach();return}!O&&g.attr("allow-scrolling")&&(O=ql(g.dxScrollable("instance"))),g.addClass(r);const _=g.find(n),m=_.find(e),S=g.closest(`.${wn}`).data("dxSortableOld"),T=S.option("useIndicator"),v=(S||t).option("direction")==="vertical",E=Ul(m,v,_),h=t._getItemOffset(v,E,l);if(h){if(i=h.item,f=E[h.index-1]&&E[h.index-1].item,i.hasClass(o)||f&&f.hasClass(o)&&f.is(":visible")){C.detach();return}if(L=h.index,!T){C.insertBefore(i);return}const w=g.attr("group")!==F,b=L===p,D=L===p+1;if(w){t._renderIndicator(i,v,g,t.option("rtlEnabled")&&!v);return}!b&&!D&&t._renderIndicator(i,v,g,t.option("rtlEnabled")&&!v)}else{if(c=m.last(),c.is(":visible")&&c.hasClass(o))return;_.length&&(L=E.length?E[E.length-1].index+1:0),T?m.length&&t._renderIndicator(c,v,g,!t.option("rtlEnabled")||v):C.appendTo(_)}})),be.on(j,ze(en,"dxSortable"),(()=>{if(G(),!d)return;const l=t.option("onChanged"),i={sourceIndex:p,sourceElement:d,sourceGroup:F,targetIndex:L,removeSourceElement:!0,removeTargetElement:!1,removeSourceClass:!0};g&&(g.removeClass(r),i.targetGroup=g.attr("group"),(F!==i.targetGroup||L>-1)&&(l&&l(i),i.removeSourceElement&&d.remove())),t._indicator.detach(),i.removeSourceClass&&d.removeClass(o),d=null,t._$draggable.remove(),t._$draggable=null,i.removeTargetElement&&C.remove(),C.removeClass(r),C=null}))}},_init(){this.callBase(),this._attachEventHandlers()},_render(){this.callBase(),this.$element().addClass(wn)},_dispose(){this.callBase.apply(this,arguments),this._$draggable&&this._$draggable.detach(),this._indicator&&this._indicator.detach()},_optionChanged(t){const e=this;switch(t.name){case"onDragging":case"onChanged":case"itemRender":case"groupSelector":case"itemSelector":case"itemContainerSelector":case"sourceClass":case"targetClass":case"dragClass":case"allowDragging":case"groupFilter":case"useIndicator":e._attachEventHandlers();break;case"direction":break;default:e.callBase(t)}},_useTemplates:()=>!1});pt("dxSortableOld",oa);const Kl={Sortable:oa};function Yl(t){return t.clone().addClass(Q.area.box).css("width",parseFloat(Je(t)))}function Ql(t,e){const n=t.clone();return e===aa.targets.drag&&t.each(((a,o)=>{const r=parseFloat(Je(o));return n.eq(a).css("width",r),!0})),n}function Xl(t){return R("<div>").addClass(Q.area.field).addClass(Q.area.box).text(t.text())}function Jl(t,e){const n=t.hasClass(Q.area.box),a=t.attr(ut.treeViewItem);return n?Ql(t,e):a?Yl(t):Xl(t)}function Zl(t){const e=R("<div>");return t.each(((n,a)=>{const o=R("<div>").addClass(Q.pivotGrid.fieldsContainer).addClass(Q.widget).append(R(a));return e.append(o),!0})),e.children()}function er(t,e){const n=Jl(t,e);return e===aa.targets.drag?Zl(n):n}const tr=t=>t===Et.descending?Et.ascending:Et.descending,{Sortable:nr}=Kl,vn="<div>";class ar extends bo{_getSearchExpr(e,n){return e.useDefaultSearchExpr=!0,super._getSearchExpr(e,n)}}const or=function(t,e){const n=[],a=!!e.groupName,o=e.filterType==="exclude";e.filterValues&&M(e.filterValues,((r,u)=>{n.push(Array.isArray(u)?u.join("/"):u==null?void 0:u.valueOf())})),ie(t,(r=>{var u;const s=r[0],d=fe(r),p=a?Xe(r,(g=>g.text)).reverse().join("/"):s.text;s.value=a?d.slice(0):s.key||s.value;const C=a?d.join("/"):(u=s.value)===null||u===void 0?void 0:u.valueOf();s.children&&(s.items=s.children,s.children=null),Ao(s,s.key&&n.includes(p)||n.includes(C),o)}))};function Ft(t,e){let n=e;return V(e.groupIndex)&&(n=t.getAreaFields(e.area,!0)[e.areaIndex]),n}function Sn(t){return t=t||{},JSON.stringify([t.fields,t.columnExpandedPaths,t.rowExpandedPaths])}const lr=Fo(Po(Do(kn)));class jt extends lr{_getDefaultOptions(){return Qe({},super._getDefaultOptions(),{allowFieldDragging:!0,applyChangesMode:"instantly",state:null,headerFilter:{width:252,height:325,allowSelectAll:!0,showRelevantValues:!1,search:{enabled:!1,timeout:500,editorOptions:{},mode:"contains"},texts:{emptyValue:ne.format("dxDataGrid-headerFilterEmptyValue"),ok:ne.format("dxDataGrid-headerFilterOK"),cancel:ne.format("dxDataGrid-headerFilterCancel")}},remoteSort:!1})}_init(){super._init(),this._headerFilterView=new ar(this),this._refreshDataSource(),this.subscribeToEvents(),je.logHeaderFilterDeprecatedWarningIfNeed(this)}_refreshDataSource(){const e=this.option("dataSource");e!=null&&e.fields&&e.load&&(this._dataSource=e)}_optionChanged(e){switch(e.name){case"dataSource":this._refreshDataSource();break;case"applyChangesMode":case"remoteSort":break;case"state":if(this._skipStateChange||!this._dataSource)break;this.option("applyChangesMode")==="instantly"&&Sn(this._dataSource.state())!==Sn(e.value)?this._dataSource.state(e.value):(this._clean(!0),this._renderComponent());break;case"headerFilter":case"allowFieldDragging":this._invalidate();break;default:super._optionChanged(e)}}renderField(e,n){const a=this,o=R(vn).addClass(Q.area.fieldContent).text(e.caption||e.dataField),r=R(vn).addClass(Q.area.field).addClass(Q.area.box).data("field",e).append(o),u=Ft(a._dataSource,e);return e.area!=="data"&&(e.allowSorting&&a._applyColumnState({name:"sort",rootElement:r,column:{alignment:a.option("rtlEnabled")?"right":"left",sortOrder:e.sortOrder==="desc"?"desc":"asc",allowSorting:e.allowSorting,caption:e.caption||e.dataField},showColumnLines:n}),a._applyColumnState({name:"headerFilter",rootElement:r,column:{alignment:a.option("rtlEnabled")?"right":"left",filterValues:u.filterValues,allowFiltering:u.allowFiltering&&!e.groupIndex,allowSorting:e.allowSorting,caption:e.caption||e.dataField},showColumnLines:n})),e.groupName&&r.attr(ut.itemGroup,e.groupName),r}_clean(e){}_render(){super._render(),this._headerFilterView.render(this.$element())}renderSortable(){const e=this;e._createComponent(e.$element(),nr,J({allowDragging:e.option("allowFieldDragging"),itemSelector:`.${Q.area.field}`,itemContainerSelector:`.${Q.area.fieldContainer}`,groupSelector:`.${Q.area.fieldList}`,groupFilter(){const n=e._dataSource,a=R(this).closest(".dx-sortable-old"),o=a.data("dxPivotGrid"),r=a.data("dxPivotGridFieldChooser");return o?o.getDataSource()===n:r?r.option("dataSource")===n:!1},itemRender:er,onDragging(n){const a=n.sourceElement.data("field"),{targetGroup:o}=n;n.cancel=!1,a.isMeasure===!0?(o==="column"||o==="row"||o==="filter")&&(n.cancel=!0):a.isMeasure===!1&&o==="data"&&(n.cancel=!0)},useIndicator:!0,onChanged(n){const a=n.sourceElement.data("field");if(n.removeSourceElement=!!n.sourceGroup,e._adjustSortableOnChangedArgs(n),a){const{targetIndex:o}=n;let r,u=0;e._processDemandState((s=>{const d=s.getAreaFields(a.area,!0);r=Ft(s,a);const C=d.filter((g=>g.visible!==!1))[o-1];C&&(u=d.filter((g=>g.visible===!1&&g.areaIndex<=C.areaIndex)).length)})),e._applyChanges([r],{area:n.targetGroup,areaIndex:o+u})}}},e._getSortableOptions()))}_processDemandState(e){const n=this,a=n.option("applyChangesMode")==="instantly",o=n._dataSource;if(a)e(o,a);else{const r=o.state(),u=n.option("state");u&&o.state(u,!0),e(o,a),o.state(r,!0)}}_applyChanges(e,n){const a=this;a._processDemandState(((o,r)=>{e.forEach((u=>{let{index:s}=u;o.field(s,n)})),r?o.load():a._changedHandler()}))}_applyLocalSortChanges(e,n){this._processDemandState((a=>{a.field(e,{sortOrder:n}),a.sortLocal()}))}_adjustSortableOnChangedArgs(e){e.removeSourceElement=!1,e.removeTargetElement=!0,e.removeSourceClass=!1}_getSortableOptions(){return{direction:"auto"}}subscribeToEvents(e){const n=this,a=function(o){const r=R(o.currentTarget).data("field"),u=J(!0,{},Ft(n._dataSource,r)),s=R(o.target).hasClass(Q.headerFilter),d=n._dataSource,p=u.groupName?"tree":"list",C=d.paginate()&&p==="list";if(s)n._headerFilterView.showHeaderFilterMenu(R(o.currentTarget),J(u,{type:p,encodeHtml:n.option("encodeHtml"),dataSource:{useDefaultSearch:!C,load(g){const{userData:x}=g;if(x.store)return x.store.load(g);const F=new le;return d.getFieldValues(u.index,n.option("headerFilter.showRelevantValues"),C?g:void 0).done((A=>{const y=n.option("headerFilter.texts.emptyValue");A.forEach((O=>{O.text||(O.text=y)})),C?F.resolve(A):(x.store=new $t(A),x.store.load(g).done(F.resolve).fail(F.reject))})).fail(F.reject),F},postProcess(g){return or(g,u),g}},apply(){n._applyChanges([u],{filterValues:this.filterValues,filterType:this.filterType})}}));else if(r.allowSorting&&r.area!=="data"){const g=n.option("remoteSort"),x=tr(r.sortOrder);g?n._applyChanges([r],{sortOrder:x}):n._applyLocalSortChanges(r.index,x)}};if(e){be.on(e,Dt,`.${Q.area.field}.${Q.area.box}`,a);return}be.on(n.$element(),Dt,`.${Q.area.field}.${Q.area.box}`,a)}_initTemplates(){}addWidgetPrefix(e){return`dx-pivotgrid-${e}`}}pt("dxPivotGridFieldChooserBase",jt);const he="<div>",rr=Le();function la(t,e){const n=[];if(t.items)for(let a=0;a<t.items.length;a+=1)n.push.apply(n,la(t.items[a],e));else V(t.index)&&n.push(e[t.index]);return n}function Mt(t,e){if(t.items)for(let n=0;n<t.items.length;n+=1){const a=Mt(t.items[n],e);if(a)return a}if(e(t))return t}const yn=[function(t,e){const n=-!!t.isMeasure,a=+!!e.isMeasure;return n+a},function(t,e){const n=-!!(t.items&&t.items.length),a=+!!(e.items&&e.items.length);return n+a},function(t,e){const n=+!!(t.isMeasure===!1&&t.field&&t.field.levels&&t.field.levels.length),a=-!!(e.isMeasure===!1&&e.field&&e.field.levels&&e.field.levels.length);return n+a},dt((t=>t.text))];function sr(t,e){let n=0,a=0;for(;!n&&yn[a];)n=yn[a++](t,e);return n}function Tn(t){return t.find(`.${Q.scrollable.self}`).dxScrollable("instance")}class ra extends jt{_getDefaultOptions(){return Qe({},super._getDefaultOptions(),{height:400,layout:0,dataSource:null,encodeHtml:!0,onContextMenuPreparing:null,allowSearch:!1,searchTimeout:500,texts:{columnFields:ne.format("dxPivotGrid-columnFields"),rowFields:ne.format("dxPivotGrid-rowFields"),dataFields:ne.format("dxPivotGrid-dataFields"),filterFields:ne.format("dxPivotGrid-filterFields"),allFields:ne.format("dxPivotGrid-allFields")}})}_refreshDataSource(){const e=this;e._expandedPaths=[],e._changedHandler=e._changedHandler||function(){M(e._dataChangedHandlers,((n,a)=>{a()})),e._fireContentReadyAction(),e._skipStateChange=!0,e.option("state",e._dataSource.state()),e._skipStateChange=!1},e._disposeDataSource(),super._refreshDataSource(),e._dataSource&&e._dataSource.on("changed",e._changedHandler)}_disposeDataSource(){const e=this,n=e._dataSource;n&&(n.off("changed",e._changedHandler),e._dataSource=void 0)}_dispose(){this._disposeDataSource(),super._dispose.apply(this,arguments)}_init(){super._init(),this._refreshDataSource(),this._dataChangedHandlers=[],this._initActions()}_initActions(){this._actions={onContextMenuPreparing:this._createActionByOption("onContextMenuPreparing")}}_trigger(e,n){this._actions[e](n)}_setOptionsByReference(){super._setOptionsByReference(),J(this._optionsByReference,{dataSource:!0})}_optionChanged(e){const n=this;switch(e.name){case"dataSource":n._refreshDataSource(),n._invalidate();break;case"layout":case"texts":case"allowSearch":case"searchTimeout":case"encodeHtml":n._invalidate();break;case"onContextMenuPreparing":n._actions[e.name]=n._createActionByOption(e.name);break;default:super._optionChanged(e)}}_clean(e){!e&&this._dataSource&&this.option("state",this._dataSource.state()),this.$element().children(`.${Q.fieldChooser.container}`).remove()}_renderLayout0(e){e.addClass(Q.layout.zero);const n=R(he).addClass(Q.row).appendTo(e),a=R(he).addClass(Q.row).appendTo(e),o=R(he).addClass(Q.col).appendTo(n),r=R(he).addClass(Q.col).appendTo(n),u=R(he).addClass(Q.col).appendTo(a),s=R(he).addClass(Q.col).appendTo(a);this._renderArea(o,"all"),this._renderArea(r,"row"),this._renderArea(r,"column"),this._renderArea(u,"filter"),this._renderArea(s,"data")}_renderLayout1(e){const n=R(he).addClass(Q.col).appendTo(e),a=R(he).addClass(Q.col).appendTo(e);this._renderArea(n,"all"),this._renderArea(a,"filter"),this._renderArea(a,"row"),this._renderArea(a,"column"),this._renderArea(a,"data")}_renderLayout2(e){e.addClass(Q.layout.second);const n=R(he).addClass(Q.row).appendTo(e);this._renderArea(n,"all");const a=R(he).addClass(Q.row).appendTo(e),o=R(he).addClass(Q.col).appendTo(a),r=R(he).addClass(Q.col).appendTo(a);this._renderArea(o,"filter"),this._renderArea(o,"row"),this._renderArea(r,"column"),this._renderArea(r,"data")}_initMarkup(){const e=this,n=this.$element(),a=R(he).addClass(Q.fieldChooser.container).appendTo(n),o=e.option("layout");super._initMarkup(),n.addClass(Q.fieldChooser.self).addClass(Q.pivotGrid.fieldsContainer),e._dataChangedHandlers=[];const r=this._dataSource,u=e.option("applyChangesMode")!=="instantly"&&r&&r.state();u&&e.option("state")&&r.state(e.option("state"),!0),o===0?e._renderLayout0(a):o===1?e._renderLayout1(a):e._renderLayout2(a),u&&r.state(u,!0)}_renderContentImpl(){super._renderContentImpl(),this.renderSortable(),this._renderContextMenu(),this.updateDimensions()}_fireContentReadyAction(){(!this._dataSource||!this._dataSource.isLoading())&&super._fireContentReadyAction()}_getContextMenuArgs(e){const n=R(e.target).closest(`.${Q.area.field}`),a=R(e.target).closest(`.${Q.area.fieldList}`);let o,r;if(n.length){const u=n.data("field");u&&(o=this.getDataSource().field(u.index)||u)}return a.length&&(r=a.attr("group")),{event:e,field:o,area:r,items:[]}}_renderContextMenu(){const e=this,n=e.$element();e._contextMenu&&e._contextMenu.$element().remove(),e._contextMenu=e._createComponent(R(he).appendTo(n),$n,{onPositioning(a){const{event:o}=a;if(!o)return;const r=e._getContextMenuArgs(o);e._trigger("onContextMenuPreparing",r),r.items&&r.items.length?a.component.option("items",r.items):a.cancel=!0},target:n,onItemClick(a){a.itemData.onItemClick&&a.itemData.onItemClick(a)},cssClass:Q.fieldChooser.contextMenu})}_createTreeItems(e,n,a){const o=this;let r,u=[];const s=[],d=n[0],p={};return d?(M(e,((C,g)=>{const x=g[d]||"";p[x]=p[x]||[],p[x].push(g),r===void 0&&(r=!0),r=r&&g.isMeasure===!0})),M(p,((C,g)=>{const x=a?`${a}.${C}`:C,F=o._createTreeItems(g,n.slice(1),x);C?s.push({key:C,text:C,path:x,isMeasure:F.isMeasure,expanded:o._expandedPaths.includes(x),items:F}):u=F})),u=s.concat(u),u.isMeasure=r):M(e,((C,g)=>{let x;g.isMeasure===!0&&(x=tt.measure),g.isMeasure===!1&&(x=g.groupName?tt.hierarchy:tt.dimension),u.push({index:g.index,field:g,key:g.dataField,selected:V(g.area),text:g.caption||g.dataField,icon:x,isMeasure:g.isMeasure,isDefault:g.isDefault})})),u}_createFieldsDataSource(e){let n=e&&e.fields()||[];n=n.filter((o=>o.visible!==!1&&!V(o.groupIndex)));const a=this._createTreeItems(n,["dimension","displayFolder"]);return ft(a,(o=>{o.sort(sr)}),0,"items"),a}_renderFieldsTreeView(e){const n=this,a=n._dataSource,o=n._createComponent(e,Io,{dataSource:n._createFieldsDataSource(a),showCheckBoxesMode:"normal",expandNodesRecursive:!1,searchEnabled:n.option("allowSearch"),searchTimeout:n.option("searchTimeout"),useNativeScrolling:!1,itemTemplate(r,u,s){const d=R("<div>").toggleClass(Q.area.field,!r.items).attr(ut.treeViewItem,!0).data("field",r.field).appendTo(s);if(r.icon){var p;(p=So(r.icon))===null||p===void 0||p.appendTo(d)}R("<span>").text(r.text).appendTo(d)},onItemCollapsed(r){const u=n._expandedPaths.indexOf(r.itemData.path);u>=0&&n._expandedPaths.splice(u,1)},onItemExpanded(r){n._expandedPaths.indexOf(r.itemData.path)<0&&n._expandedPaths.push(r.itemData.path)},onItemSelectionChanged(r){const u=r.itemData;let s,d,p=!0,C;if(u.items){if(u.selected){o.unselectItem(u);return}if(n._processDemandState((()=>{d=la(u,a.fields());for(let g=0;g<d.length;g+=1)if(d[g].area){p=!1;break}})),p){const g=Mt(u,(x=>x.isDefault))||Mt(u,(x=>V(x.index)));g&&o.selectItem(g);return}}else s=a.fields()[u.index],u.selected&&(C=s.isMeasure?"data":"column"),s&&(d=[s]);n._applyChanges(d,{area:C,areaIndex:void 0})}});n._dataChangedHandlers.push((function(){let r=Tn(e);const u=r?r.scrollTop():0;o.option({dataSource:n._createFieldsDataSource(a)}),r=Tn(e),r&&(r.scrollTo({y:u}),r.update())}))}_renderAreaFields(e,n){const a=this,o=a._dataSource,r=o?J(!0,[],o.getAreaFields(n,!0)):[];e.empty(),M(r,((u,s)=>{s.visible!==!1&&a.renderField(s,!0).appendTo(e)}))}_renderArea(e,n){const a=this,o=R(he).addClass(Q.area.self).appendTo(e),r=R(he).addClass(Q.area.fieldListHeader).appendTo(o),u=a.option(`texts.${n}Fields`);let s,d;R("<span>").addClass(Q.area.icon).addClass(`dx-icon-${tt[n]}`).appendTo(r),R("<span>").html("&nbsp;").appendTo(r),R("<span>").addClass(Q.area.caption).text(u).appendTo(r);const p=R(he).addClass(Q.area.fieldList).addClass(Q.pivotGrid.dragAction).appendTo(o);n!=="all"?(p.attr("group",n).attr(ut.allowScrolling,!0),s=R(he).addClass(Q.area.fieldContainer).appendTo(p),d=function(){a._renderAreaFields(s,n)},a._dataChangedHandlers.push(d),d(),p.dxScrollable({useNative:!1})):(o.addClass(Q.allFields),p.addClass(Q.treeView.borderVisible),a._renderFieldsTreeView(p))}_getSortableOptions(){return{direction:""}}_adjustSortableOnChangedArgs(){}resetTreeView(){const e=this.$element().find(`.${Q.treeView.self}`).dxTreeView("instance");e&&(e.option("searchValue",""),e.collapseAll())}applyChanges(){const e=this.option("state");V(e)&&this._dataSource.state(e)}cancelChanges(){const e=this._dataSource;return e.isLoading()?!1:(this.option("state",e.state()),!0)}getDataSource(){return this._dataSource}updateDimensions(){this.$element().find(`.${Q.area.self} .${Q.scrollable.self}`).dxScrollable("update")}_visibilityChanged(e){e&&rr&&this.updateDimensions()}}pt("dxPivotGridFieldChooser",ra);const ke="<div>",ir="dx-pivotgrid-drag-action";function dr(t,e,n,a){n!=null&&n.groupName&&n.groupName===t.groupName&&R(ke).addClass("dx-group-connector").addClass("dx-group-connector-prev").appendTo(a),e!=null&&e.groupName&&e.groupName===t.groupName&&R(ke).addClass("dx-group-connector").addClass("dx-group-connector-next").appendTo(a)}class nt extends zt{constructor(e,n){super(e),this._area=n}_getAreaName(){return"fields"}_createGroupElement(){return R(ke).addClass("dx-pivotgrid-fields-area").addClass("dx-area-fields").addClass(ir).attr("group",this._area)}isVisible(){return!!this.option("fieldPanel.visible")&&this.option(`fieldPanel.show${Un(this._area)}Fields`)}_renderButton(e){const n=this,a=R("<td>").appendTo(R("<tr>").appendTo(e));n.component._createComponent(R(ke).appendTo(a),It,{text:"Fields",icon:"menu",width:"auto",onClick(){const r=n.tableElement().find(".dx-fields-area-popup").dxPopup("instance");r.option("visible")||r.show()}}).$element().addClass("dx-pivotgrid-fields-area-hamburger")}_getPopupOptions(e,n){return{contentTemplate:()=>R("<table>").addClass("dx-area-field-container").append(R("<thead>").addClass("dx-pivotgrid-fields-area-head").append(e)),height:"auto",width:"auto",position:{at:"left",my:"left",of:n},dragEnabled:!1,animation:{show:{type:"pop",duration:200}},shading:!1,showTitle:!1,hideOnOutsideClick:!0,container:n.parent()}}_renderPopup(e,n){const a=this,o=e.find(".dx-button"),r=a._getPopupOptions(n,o),u=a.component.$element().dxPivotGridFieldChooserBase("instance");a._rowPopup&&a._rowPopup.$element().remove(),a._rowPopup=a.component._createComponent(R(ke).appendTo(e),Mn,r),a._rowPopup.$element().addClass("dx-fields-area-popup"),a._rowPopup.content().addClass("dx-pivotgrid-fields-container"),a._rowPopup.content().parent().attr("group","row"),u.subscribeToEvents(a._rowPopup.content()),u.renderSortable(a._rowPopup.content())}_shouldCreateButton(){return!1}_renderTableContent(e,n){const a=this,o=this.groupElement(),r=this.isVisible(),u=a.component.$element().dxPivotGridFieldChooserBase("instance"),s=R("<thead>").addClass("dx-pivotgrid-fields-area-head").appendTo(e),d=a._area,p=R("<tr>");o.toggleClass("dx-hidden",!r),e.addClass("dx-area-field-container"),r&&(M(n,((C,g)=>{if(g.area===d&&g.visible!==!1){const x=R("<td>").append(u.renderField(g,g.area==="row")),F=x.find(".dx-column-indicators");F.length&&a._shouldCreateButton()&&F.insertAfter(F.next()),x.appendTo(p),dr(g,n[C+1],n[C-1],x)}})),p.children().length||R("<td>").append(R(ke).addClass("dx-empty-area-text").text(this.option(`fieldPanel.texts.${d}FieldArea`))).appendTo(p),a._shouldCreateButton()?(a._renderButton(s),a._renderPopup(e,p)):s.append(p))}setGroupWidth(e){fo(this.groupElement(),e)}setGroupHeight(e){mo(this.groupElement(),e)}reset(){super.reset(),this.groupElement().css("marginTop",0)}_renderVirtualContent(){}}const cr="dx-pivotgrid-horizontal-headers",ur="dx-pivotgrid-vertical-headers";function sa(t,e){if(e){const{data:n}=t.data(),{rowIndex:a}=e.parentNode,{cellIndex:o}=e;return n[a]&&n[a][o]&&n[a][o].path}}class ia extends zt{constructor(e){super(e),this._scrollBarWidth=0}_getAreaName(){return"column"}_getAreaClassName(){return cr}_createGroupElement(){return R("<div>").addClass(this._getAreaClassName()).addClass("dx-pivotgrid-area")}_applyCustomStyles(e){const{cssArray:n}=e,{cell:a}=e,{rowsCount:o}=e,{classArray:r}=e;e.cellIndex===e.cellsCount-1&&n.push((e.rtlEnabled?"border-left:":"border-right:")+"0px"),(a.rowspan===o-e.rowIndex||e.rowIndex+1===o)&&n.push("border-bottom-width:0px"),(a.type==="T"||a.type==="GT")&&r.push("dx-row-total"),e.cell.type==="T"&&r.push("dx-total"),e.cell.type==="GT"&&r.push("dx-grandtotal"),V(a.expanded)&&r.push(a.expanded?"dx-pivotgrid-expanded":"dx-pivotgrid-collapsed"),super._applyCustomStyles(e)}_getMainElementMarkup(){const e=Ce.createElement("thead");return e.setAttribute("class",this._getAreaClassName()),e}_getCloseMainElementMarkup(){return"</thead>"}setVirtualContentParams(e){super.setVirtualContentParams(e),this._setTableCss({left:e.left,top:0}),this._virtualContentWidth=e.width}hasScroll(){const e=this._virtualContent?this._virtualContentWidth:this._tableWidth,n=this.getGroupWidth();return n&&e?e-n>=1:!1}renderScrollable(){this._groupElement.dxScrollable({useNative:!1,useSimulatedScrollbar:!1,showScrollbar:"never",bounceEnabled:!1,direction:"horizontal",rtlEnabled:!1,updateManually:!0})}processScrollBarSpacing(e){const n=this.option("rtlEnabled")?"right":"left",a=this.getGroupWidth();a&&this.setGroupWidth(a-e),this._scrollBarWidth&&this._groupElement.next().remove(),this._groupElement.toggleClass("dx-vertical-scroll",e>0),qe(this._groupElement.css("float",n),this.getGroupHeight()),this._scrollBarWidth=e}getScrollPath(e){const n=this.tableElement();let a;return e-=parseInt(n[0].style.left,10)||0,M(n.find("td"),((o,r)=>{if(r.colSpan===1&&r.offsetLeft<=e&&r.offsetWidth+r.offsetLeft>e)return a=r,!1})),sa(n,a)}_moveFakeTable(e){this._moveFakeTableHorizontally(e),super._moveFakeTable()}}class hr extends ia{_getAreaClassName(){return ur}_applyCustomStyles(e){super._applyCustomStyles(e),e.cellIndex===e.cellsCount-1&&e.classArray.push("dx-last-cell"),e.rowIndex===e.rowsCount-1&&e.cssArray.push("border-bottom: 0px"),e.cell.isWhiteSpace&&e.classArray.push("dx-white-space-column")}_getAreaName(){return"row"}setVirtualContentParams(e){super.setVirtualContentParams(e),this._setTableCss({top:e.top,left:0}),this._virtualContentHeight=e.height}hasScroll(){const e=this._virtualContent?this._virtualContentHeight:this._tableHeight,n=this.getGroupHeight();return n&&e?e-n>=1:!1}renderScrollable(){this._groupElement.dxScrollable({useNative:!1,useSimulatedScrollbar:!1,showScrollbar:"never",bounceEnabled:!1,direction:"vertical",updateManually:!0})}processScrollBarSpacing(e){const n=this.getGroupHeight();if(n&&this.setGroupHeight(n-e),this._scrollBarWidth&&this._groupElement.next().remove(),e){const a=R("<div>");qe(a,"100%"),rt(a,e-1),this._groupElement.after(a)}this._scrollBarWidth=e}getScrollPath(e){const n=this.tableElement();let a;return e-=parseInt(n[0].style.top,10)||0,M(n.find("tr"),((o,r)=>{const u=r.childNodes[r.childNodes.length-1];if(u&&u.rowSpan===1&&u.offsetTop<=e&&u.offsetHeight+u.offsetTop>e)return a=u,!1})),sa(n,a)}_moveFakeTable(e){this._moveFakeTableTop(e),super._moveFakeTable()}_getRowClassNames(e,n,a){e!==0&n.expanded&&!a.includes("dx-expand-border")&&a.push("dx-expand-border")}_getMainElementMarkup(){const e=Ce.createElement("tbody");return e.classList.add(this._getAreaClassName()),e}_getCloseMainElementMarkup(){return"</tbody>"}updateColspans(e){const{rows:n}=this.tableElement()[0];let a=0;const o=[];if(!(this.getColumnsCount()-e>0))for(let r=0;r<n.length;r+=1)for(let u=0;u<n[r].cells.length;u+=1){const s=n[r].cells[u],{rowSpan:d}=s;o[r]&&(a-=o[r],o[r]=0);const p=e-(a+s.colSpan);u===n[r].cells.length-1&&p>0&&(s.colSpan+=p),o[r+d]=(o[r+d]||0)+s.colSpan,a+=s.colSpan}}}const En={HorizontalHeadersArea:ia,VerticalHeadersArea:hr},da=Ln(),Fn="dx-pivotgrid-border",pr="dx-pivotgrid-fields-container",bn="dx-area-fields",at="<tr>",Ne="<td>",Fe="<div>",An=["allowSorting","allowSortingBySummary","allowFiltering","allowExpandAll"];function bt(t){let e=0;return M(t,((n,a)=>{e+=a||0})),e}function At(t,e){const n=e/t.length;for(let a=0;a<t.length;a+=1)t[a]-=n}function ca(t){t.off("scroll").off("stop")}function gr(t,e){ca(t),t.on("scroll",e).on("stop",e)}function Pn(t,e){const n=e==="width"?["borderLeftWidth","borderRightWidth"]:["borderTopWidth","borderBottomWidth"];let a=0;return M(t,((o,r)=>{const u=da.getComputedStyle(r.get(0));n.forEach((s=>{a+=parseFloat(u[s])||0}))})),a}function fr(t){return t.closest(`.${bn}`).length||t.find(`.${bn}`).length}const ua=kn.inherit({_getDefaultOptions(){return J(this.callBase(),{scrolling:{timeout:300,renderingThreshold:150,minTimeout:10,mode:"standard",useNative:"auto",removeInvisiblePages:!0,virtualRowHeight:50,virtualColumnWidth:100,loadTwoPagesOnStart:!0},encodeHtml:!0,dataSource:null,activeStateEnabled:!1,fieldChooser:{minWidth:250,minHeight:250,enabled:!0,allowSearch:!1,searchTimeout:500,layout:0,title:ne.format("dxPivotGrid-fieldChooserTitle"),width:600,height:600,applyChangesMode:"instantly"},onContextMenuPreparing:null,allowSorting:!1,allowSortingBySummary:!1,allowFiltering:!1,allowExpandAll:!1,wordWrapEnabled:!0,fieldPanel:{showColumnFields:!0,showFilterFields:!0,showDataFields:!0,showRowFields:!0,allowFieldDragging:!0,visible:!1,texts:{columnFieldArea:ne.format("dxPivotGrid-columnFieldArea"),rowFieldArea:ne.format("dxPivotGrid-rowFieldArea"),filterFieldArea:ne.format("dxPivotGrid-filterFieldArea"),dataFieldArea:ne.format("dxPivotGrid-dataFieldArea")}},dataFieldArea:"column",export:{enabled:!1,fileName:"PivotGrid"},showRowTotals:!0,showRowGrandTotals:!0,showColumnTotals:!0,showColumnGrandTotals:!0,hideEmptySummaryCells:!0,showTotalsPrior:"none",rowHeaderLayout:"standard",loadPanel:{enabled:!0,text:ne.format("Loading"),width:200,height:70,showIndicator:!0,indicatorSrc:"",showPane:!0},texts:{grandTotal:ne.format("dxPivotGrid-grandTotal"),total:ne.getFormatter("dxPivotGrid-total"),noData:ne.format("dxDataGrid-noDataText"),showFieldChooser:ne.format("dxPivotGrid-showFieldChooser"),expandAll:ne.format("dxPivotGrid-expandAll"),collapseAll:ne.format("dxPivotGrid-collapseAll"),sortColumnBySummary:ne.getFormatter("dxPivotGrid-sortColumnBySummary"),sortRowBySummary:ne.getFormatter("dxPivotGrid-sortRowBySummary"),removeAllSorting:ne.format("dxPivotGrid-removeAllSorting"),exportToExcel:ne.format("dxDataGrid-exportToExcel"),dataNotAvailable:ne.format("dxPivotGrid-dataNotAvailable")},onCellClick:null,onCellPrepared:null,showBorders:!1,stateStoring:{enabled:!1,storageKey:null,type:"localStorage",customLoad:null,customSave:null,savingTimeout:2e3},onExpandValueChanging:null,renderCellCountLimit:2e4,onExporting:null,headerFilter:{width:252,height:325,allowSelectAll:!0,showRelevantValues:!1,search:{enabled:!1,timeout:500,editorOptions:{},mode:"contains"},texts:{emptyValue:ne.format("dxDataGrid-headerFilterEmptyValue"),ok:ne.format("dxDataGrid-headerFilterOK"),cancel:ne.format("dxDataGrid-headerFilterCancel")}}})},_updateCalculatedOptions(t){const e=this;M(t,((n,a)=>{M(An,((o,r)=>{const u=a._initProperties&&r in a._initProperties&&a._initProperties[r]===void 0;(a[r]===void 0||u)&&Se(a,r,e.option(r))}))}))},_getDataControllerOptions(){const t=this;return{component:t,dataSource:t.option("dataSource"),texts:t.option("texts"),showRowTotals:t.option("showRowTotals"),showRowGrandTotals:t.option("showRowGrandTotals"),showColumnTotals:t.option("showColumnTotals"),showTotalsPrior:t.option("showTotalsPrior"),showColumnGrandTotals:t.option("showColumnGrandTotals"),dataFieldArea:t.option("dataFieldArea"),rowHeaderLayout:t.option("rowHeaderLayout"),hideEmptySummaryCells:t.option("hideEmptySummaryCells"),onFieldsPrepared(e){t._updateCalculatedOptions(e)}}},_initDataController(){const t=this;t._dataController&&t._dataController.dispose(),t._dataController=new $l.DataController(t._getDataControllerOptions()),Le()&&t._dataController.changed.add((()=>{t._render()})),t._dataController.scrollChanged.add((n=>{t._scrollLeft=n.left,t._scrollTop=n.top})),t._dataController.loadingChanged.add((()=>{t._updateLoading()})),t._dataController.progressChanged.add(t._updateLoading.bind(t)),t._dataController.dataSourceChanged.add((()=>{t._trigger("onChanged")}));const e=t.option("onExpandValueChanging");e&&t._dataController.expandValueChanging.add((n=>{e(n)}))},_init(){this.callBase(),this._initDataController(),je.logHeaderFilterDeprecatedWarningIfNeed(this),this._scrollLeft=this._scrollTop=null,this._initActions()},_initActions(){this._actions={onChanged:this._createActionByOption("onChanged"),onContextMenuPreparing:this._createActionByOption("onContextMenuPreparing"),onCellClick:this._createActionByOption("onCellClick"),onExporting:this._createActionByOption("onExporting"),onCellPrepared:this._createActionByOption("onCellPrepared")}},_trigger(t,e){this._actions[t](e)},_optionChanged(t){const e=this;if(An.includes(t.name)){const n=this.getDataSource().fields();this._updateCalculatedOptions(n)}switch(t.name){case"dataSource":case"allowSorting":case"allowFiltering":case"allowExpandAll":case"allowSortingBySummary":case"scrolling":case"stateStoring":e._initDataController(),e._fieldChooserPopup.hide(),e._renderFieldChooser(),e._invalidate();break;case"texts":case"showTotalsPrior":case"showRowTotals":case"showRowGrandTotals":case"showColumnTotals":case"showColumnGrandTotals":case"hideEmptySummaryCells":case"dataFieldArea":e._dataController.updateViewOptions(e._getDataControllerOptions());break;case"useNativeScrolling":case"encodeHtml":case"renderCellCountLimit":case"onExpandValueChanging":break;case"rtlEnabled":e.callBase(t),e._renderFieldChooser(),e._renderContextMenu(),Le()&&e._renderLoadPanel(e._dataArea.groupElement(),e.$element()),e._invalidate();break;case"export":e._renderDescriptionArea();break;case"onCellClick":case"onContextMenuPreparing":case"onExporting":case"onExported":case"onFileSaving":case"onCellPrepared":e._actions[t.name]=e._createActionByOption(t.name);break;case"fieldChooser":e._renderFieldChooser(),e._renderDescriptionArea();break;case"loadPanel":Le()&&(t.fullName==="loadPanel.enabled"?(clearTimeout(this._hideLoadingTimeoutID),e._renderLoadPanel(e._dataArea.groupElement(),e.$element())):(e._renderLoadPanel(e._dataArea.groupElement(),e.$element()),e._invalidate()));break;case"fieldPanel":e._renderDescriptionArea(),e._invalidate();break;case"headerFilter":e._renderFieldChooser(),e._invalidate();break;case"showBorders":e._tableElement().toggleClass(Fn,!!t.value),e.updateDimensions();break;case"wordWrapEnabled":e._tableElement().toggleClass("dx-word-wrap",!!t.value),e.updateDimensions();break;case"rowHeaderLayout":e._tableElement().find(".dx-area-row-cell").toggleClass("dx-area-tree-view",t.value==="tree"),e._dataController.updateViewOptions(e._getDataControllerOptions());break;case"height":case"width":e._hasHeight=null,e.callBase(t),e.resize();break;default:e.callBase(t)}},_updateScrollPosition(t,e,n){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=this;let r,u;const s=o._scrollTop||o._scrollLeft;o._scrollUpdating||(o._scrollUpdating=!0,e&&!e.hasScroll()&&o._hasHeight&&(o._scrollTop=null),t&&!t.hasScroll()&&(o._scrollLeft=null),(o._scrollTop!==null||o._scrollLeft!==null||s||o.option("rtlEnabled"))&&(r=o._scrollTop||0,u=o._scrollLeft||0,n.scrollTo({left:u,top:r},a),t.scrollTo({left:u},a),e.scrollTo({top:r},a),o._dataController.updateWindowScrollPosition(o._scrollTop)),o._scrollUpdating=!1)},_subscribeToEvents(t,e,n){const a=this;M([t,e,n],((o,r)=>{gr(r,(u=>(function(s,d){const{scrollOffset:p}=s,C=d._getScrollable(),g=C.option("direction")!=="vertical"?p.left:a._scrollLeft,x=C.option("direction")!=="horizontal"&&a._hasHeight?p.top:a._scrollTop;((a._scrollLeft||0)!==(g||0)||(a._scrollTop||0)!==(x||0))&&(a._scrollLeft=g,a._scrollTop=x,a._updateScrollPosition(t,e,n),a.option("scrolling.mode")==="virtual"&&a._dataController.setViewportPosition(a._scrollLeft,a._scrollTop))})(u,r)))})),!a._hasHeight&&a._dataController.subscribeToWindowScrollEvents(n.groupElement())},_clean:Ue,_needDelayResizing(t){return t.length*(t.length?t[0].length:0)>this.option("renderCellCountLimit")},_renderFieldChooser(){const t=this,e=t._pivotGridContainer,n=t.option("fieldChooser")||{},a=n.applyChangesMode==="onDemand"?[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:ne.format("OK"),onClick(){t._fieldChooserPopup.$content().dxPivotGridFieldChooser("applyChanges"),t._fieldChooserPopup.hide()}}},{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:ne.format("Cancel"),onClick(){t._fieldChooserPopup.hide()}}}]:[],o={layout:n.layout,texts:n.texts||{},dataSource:t.getDataSource(),allowSearch:n.allowSearch,searchTimeout:n.searchTimeout,width:void 0,height:void 0,headerFilter:t.option("headerFilter"),encodeHtml:t.option("fieldChooser.encodeHtml")??t.option("encodeHtml"),applyChangesMode:n.applyChangesMode,rtlEnabled:t.option("rtlEnabled"),onContextMenuPreparing(u){t._trigger("onContextMenuPreparing",u)}},r={shading:!1,title:n.title,width:n.width,height:n.height,showCloseButton:!0,resizeEnabled:!0,minWidth:n.minWidth,minHeight:n.minHeight,toolbarItems:a,onResize(u){u.component.$content().dxPivotGridFieldChooser("updateDimensions")},onShown(u){t._createComponent(u.component.content(),ra,o)},onHidden(u){const s=u.component.$content().dxPivotGridFieldChooser("instance");s.resetTreeView(),s.cancelChanges()}};t._fieldChooserPopup?(t._fieldChooserPopup.option(r),t._fieldChooserPopup.$content().dxPivotGridFieldChooser(o)):t._fieldChooserPopup=t._createComponent(R(Fe).addClass("dx-fieldchooser-popup").appendTo(e),Mn,r)},_renderContextMenu(){const t=this,e=t._pivotGridContainer;t._contextMenu&&t._contextMenu.$element().remove(),t._contextMenu=t._createComponent(R(Fe).appendTo(e),$n,{onPositioning(n){const{event:a}=n;if(n.cancel=!0,!a)return;const o=a.target.cellIndex>=0?a.target:R(a.target).closest("td").get(0);if(!o)return;const r=t._createEventArgs(o,a),u=t._getContextMenuItems(r);u&&(n.component.option("items",u),n.cancel=!1)},onItemClick(n){n.itemData.onItemClick&&n.itemData.onItemClick(n)},cssClass:"dx-pivotgrid",target:t.$element()})},_getContextMenuItems(t){const e=this;let n=[];const a=e.option("texts");if(t.area==="row"||t.area==="column"){const o=t[`${t.area}Fields`],r=t[t.area==="column"?"rowFields":"columnFields"],u=t.cell.path&&o[t.cell.path.length-1],s=e.getDataSource();if(u&&u.allowExpandAll&&t.cell.path.length<t[`${t.area}Fields`].length&&!s.paginate()&&(n.push({beginGroup:!0,icon:"none",text:a.expandAll,onItemClick(){s.expandAll(u.index)}}),n.push({text:a.collapseAll,icon:"none",onItemClick(){s.collapseAll(u.index)}})),t.cell.isLast&&!s.paginate()){let d=0;M(r,((p,C)=>{C.allowSortingBySummary&&M(t.dataFields,((g,x)=>{if(V(t.cell.dataIndex)&&t.cell.dataIndex!==g)return;const F=!V(t.cell.dataIndex)&&t.dataFields.length>1,A=t.area==="column"?a.sortColumnBySummary:a.sortRowBySummary,y=He(t.dataFields,C.sortBySummaryField)===g&&(t.cell.path||[]).join("/")===(C.sortBySummaryPath||[]).join("/"),O=re(A,F?`${C.caption} - ${x.caption}`:C.caption);n.push({beginGroup:d===0,icon:y?C.sortOrder==="desc"?"sortdowntext":"sortuptext":"none",text:O,onItemClick(){s.field(C.index,{sortBySummaryField:x.name||x.caption||x.dataField,sortBySummaryPath:t.cell.path,sortOrder:C.sortOrder==="desc"?"asc":"desc"}),s.load()}}),d+=1}))})),M(r,((p,C)=>{if(!(!C.allowSortingBySummary||!V(C.sortBySummaryField)))return n.push({beginGroup:d===0,icon:"none",text:a.removeAllSorting,onItemClick(){M(r,((g,x)=>{s.field(x.index,{sortBySummaryField:void 0,sortBySummaryPath:void 0,sortOrder:void 0})})),s.load()}}),!1}))}}if(e.option("fieldChooser.enabled")&&n.push({beginGroup:!0,icon:"columnchooser",text:a.showFieldChooser,onItemClick(){e._fieldChooserPopup.show()}}),e.option("export.enabled")&&n.push({beginGroup:!0,icon:"xlsxfile",text:a.exportToExcel,onItemClick(){e.exportTo()}}),t.items=n,e._trigger("onContextMenuPreparing",t),n=t.items,n&&n.length)return n},_createEventArgs(t,e){const n=this,a=n.getDataSource(),o={rowFields:a.getAreaFields("row"),columnFields:a.getAreaFields("column"),dataFields:a.getAreaFields("data"),event:e};return fr(R(t))?J(n._createFieldArgs(t),o):J(n._createCellArgs(t),o)},_createFieldArgs(t){const e=R(t).children().data("field"),n={field:e};return V(e)?n:{}},_createCellArgs(t){const e=R(t),n=t.cellIndex,{rowIndex:a}=t.parentElement,o=e.closest("table"),r=o.data("data"),u=r&&r[a]&&r[a][n];return{area:o.data("area"),rowIndex:a,columnIndex:n,cellElement:Hn(e),cell:u}},_handleCellClick(t){const e=this,n=e._createEventArgs(t.currentTarget,t),{cell:a}=n;!a||!n.area&&(n.rowIndex||n.columnIndex)||(e._trigger("onCellClick",n),a&&!n.cancel&&V(a.expanded)&&setTimeout((()=>{e._dataController[a.expanded?"collapseHeaderItem":"expandHeaderItem"](n.area,a.path)})))},_getNoDataText(){return this.option("texts.noData")},_renderNoDataText:je.renderNoDataText,_renderLoadPanel:je.renderLoadPanel,_updateLoading(t){const e=this,n=e._dataController.isLoading();if(!e._loadPanel)return;const a=e._loadPanel.option("visible");if(a||(e._startLoadingTime=new Date),n&&(t?new Date-e._startLoadingTime>=1e3&&e._loadPanel.option("message",`${Math.floor(100*t)}%`):e._loadPanel.option("message",e.option("loadPanel.text"))),clearTimeout(e._hideLoadingTimeoutID),a&&!n)e._hideLoadingTimeoutID=setTimeout((()=>{e._loadPanel.option("visible",!1),e.$element().removeClass("dx-overflow-hidden")}));else{const o={visible:n};n&&(o.position=je.calculateLoadPanelPosition(e._dataArea.groupElement())),e._loadPanel.option(o),e.$element().toggleClass("dx-overflow-hidden",!n)}},_renderDescriptionArea(){const t=this.$element(),e=t.find(".dx-area-description-cell"),n=R(Fe).addClass("dx-pivotgrid-toolbar"),a=this.option("fieldPanel"),o=t.find(".dx-filter-header"),r=t.find(".dx-column-header");let u;a.visible&&a.showFilterFields?u=o:a.visible&&(a.showDataFields||a.showColumnFields)?u=r:u=e,r.toggleClass("dx-bottom-border",!!(a.visible&&(a.showDataFields||a.showColumnFields))),o.toggleClass("dx-bottom-border",!!(a.visible&&a.showFilterFields)),e.toggleClass("dx-pivotgrid-background",a.visible&&(a.showDataFields||a.showColumnFields||a.showRowFields)),this.$element().find(".dx-pivotgrid-toolbar").remove(),n.prependTo(u);const s=Ho(Ro())?"text":"contained";if(this.option("fieldChooser.enabled")){const d=R(Fe).appendTo(n).addClass("dx-pivotgrid-field-chooser-button"),p={icon:"columnchooser",hint:this.option("texts.showFieldChooser"),stylingMode:s,onClick:()=>{this.getFieldChooserPopup().show()}};this._createComponent(d,It,p)}if(this.option("export.enabled")){const d=R(Fe).appendTo(n).addClass("dx-pivotgrid-export-button"),p={icon:"xlsxfile",hint:this.option("texts.exportToExcel"),stylingMode:s,onClick:()=>{this.exportTo()}};this._createComponent(d,It,p)}},_detectHasContainerHeight(){const t=this,e=t.$element();if(V(t._hasHeight)){const a=t.option("height")||t.$element().get(0).style.height;a&&t._hasHeight^a!=="auto"&&(t._hasHeight=null)}if(V(t._hasHeight)||e.is(":hidden"))return;t._pivotGridContainer.addClass("dx-hidden");const n=R(Fe);rt(n,66666),e.append(n),t._hasHeight=me(e)!==66666,t._pivotGridContainer.removeClass("dx-hidden"),n.remove()},_renderHeaders(t,e,n,a){const o=this.getDataSource();this._rowFields=this._rowFields||new nt(this,"row"),this._rowFields.render(t,o.getAreaFields("row")),this._columnFields=this._columnFields||new nt(this,"column"),this._columnFields.render(e,o.getAreaFields("column")),this._filterFields=this._filterFields||new nt(this,"filter"),this._filterFields.render(n,o.getAreaFields("filter")),this._dataFields=this._dataFields||new nt(this,"data"),this._dataFields.render(a,o.getAreaFields("data")),this.$element().dxPivotGridFieldChooserBase("instance").renderSortable()},_createTableElement(){const t=R("<table>").css({width:"100%"}).toggleClass(Fn,!!this.option("showBorders")).toggleClass("dx-word-wrap",!!this.option("wordWrapEnabled"));return be.on(t,ze(Dt,"dxPivotGrid"),"td",this._handleCellClick.bind(this)),t},_renderDataArea(t){const e=this._dataArea||new ul.DataArea(this);return this._dataArea=e,e.render(t,this._dataController.getCellsInfo()),e},_renderRowsArea(t){const e=this._rowsArea||new En.VerticalHeadersArea(this);return this._rowsArea=e,e.render(t,this._dataController.getRowsInfo()),e},_renderColumnsArea(t){const e=this._columnsArea||new En.HorizontalHeadersArea(this);return this._columnsArea=e,e.render(t,this._dataController.getColumnsInfo()),e},_initMarkup(){this.callBase.apply(this,arguments),this.$element().addClass("dx-pivotgrid")},_renderContentImpl(){const t=this;let e,n,a,o;const r=!t._pivotGridContainer;let u,s,d,p;o=!r&&t._tableElement(),o||(t.$element().addClass("dx-row-lines").addClass(pr),t._pivotGridContainer=R(Fe).addClass("dx-pivotgrid-container"),t._renderFieldChooser(),t._renderContextMenu(),e=R(Ne).addClass("dx-area-column-cell"),n=R(Ne).addClass("dx-area-row-cell"),a=R(Ne).addClass("dx-area-data-cell"),o=t._createTableElement(),p=R(Ne).addClass("dx-data-header"),d=R("<td>").attr("colspan","2").addClass("dx-filter-header"),s=R(Ne).addClass("dx-column-header"),u=R(Ne).addClass("dx-area-description-cell"),R(at).append(d).appendTo(o),R(at).append(p).append(s).appendTo(o),R(at).append(u).append(e).appendTo(o),R(at).addClass("dx-bottom-row").append(n).append(a).appendTo(o),t._pivotGridContainer.append(o),t.$element().append(t._pivotGridContainer),t.option("rowHeaderLayout")==="tree"&&n.addClass("dx-area-tree-view")),t.$element().addClass("dx-overflow-hidden"),t._createComponent(t.$element(),jt,{dataSource:t.getDataSource(),encodeHtml:t.option("encodeHtml"),allowFieldDragging:t.option("fieldPanel.allowFieldDragging"),headerFilter:t.option("headerFilter"),visible:t.option("visible"),remoteSort:t.option("scrolling.mode")==="virtual"});const C=t._renderDataArea(a),g=t._renderRowsArea(n),x=t._renderColumnsArea(e);C.tableElement().prepend(x.headElement()),r&&(t._renderLoadPanel(C.groupElement().parent(),t.$element()),t._renderDescriptionArea(),g.renderScrollable(),x.renderScrollable(),C.renderScrollable()),[C,g,x].forEach((F=>{ca(F)})),t._renderHeaders(u,s,d,p),t._update(r)},_update(t){const e=this,n=function(){e.updateDimensions()};e._needDelayResizing(e._dataArea.getData())&&t?setTimeout(n):n()},_fireContentReadyAction(){this._dataController.isLoading()||this.callBase()},getScrollPath(t){const e=this;return t==="column"?e._columnsArea.getScrollPath(e._scrollLeft):e._rowsArea.getScrollPath(e._scrollTop)},getDataSource(){return this._dataController.getDataSource()},getFieldChooserPopup(){return this._fieldChooserPopup},hasScroll(t){return t==="column"?this._columnsArea.hasScroll():this._rowsArea.hasScroll()},_dimensionChanged(){this.updateDimensions()},_visibilityChanged(t){t&&this.updateDimensions()},_dispose(){const t=this;clearTimeout(t._hideLoadingTimeoutID),t.callBase.apply(t,arguments),t._dataController&&t._dataController.dispose()},_tableElement(){return this.$element().find("table").first()},addWidgetPrefix:t=>`dx-pivotgrid-${t}`,resize(){this.updateDimensions()},isReady(){return this.callBase()&&!this._dataController.isLoading()},updateDimensions(){const t=this;let e;const n=t._tableElement();let a,o=0,r=0,u=0,s,d;const p=n.find(".dx-area-data-cell"),C=n.find(".dx-area-row-cell"),g=n.find(".dx-area-column-cell"),x=n.find(".dx-area-description-cell"),F=n.find(".dx-filter-header"),A=n.find(".dx-column-header"),y=t._rowFields,O=new le;if(!Le())return;const L=y.isVisible()&&t.option("rowHeaderLayout")!=="tree";t._detectHasContainerHeight(),t._dataArea.headElement().length||t._dataArea.tableElement().prepend(t._columnsArea.headElement()),L&&(t._rowsArea.updateColspans(y.getColumnsCount()),t._rowsArea.tableElement().prepend(y.headElement())),n.addClass("dx-incompressible-fields"),t._dataArea.reset(),t._rowsArea.reset(),t._columnsArea.reset(),y.reset();const G=(l,i)=>i-l>=1,j=(l,i,c,f,_)=>c?l:i+(f?_:0);return In((()=>{const l=t._rowsArea.getRowsHeight(),i=$e(x[0],!0)+(L?l[0]:0),c=me(t._dataArea.headElement());let f=0,_=0;if(t._hasHeight){f=me(F);const q=n.find(".dx-data-header"),U=me(q);a=Pn([g,p,n,A,F],"height"),_=me(t.$element())-f-U-(Math.max(c,me(g),i)+a)}const m=t._dataArea.getScrollbarWidth(),S=me(t._rowsArea.tableElement()),T=me(t._dataArea.tableElement()),v=Math.max(S,T-c),E=G(_,v);t._dataArea.tableElement().css({width:t._hasHeight&&E&&m?`calc(100% - ${m}px)`:"100%"});const h=t._dataArea.getColumnsWidth(),w=L?l.slice(1):l,b=t._dataArea.getRowsHeight(),D=t._dataController.getColumnsInfo().length,N=Vn(w,b.slice(D)),k=b.slice(0,D),K=bt(k),B=t._rowsArea.getColumnsWidth();if(o=We(t._dataArea.tableElement()),r=bt(N),!o||!r){O.resolve();return}u=bt(B);const z=We(t.$element());a=Pn([C,p,n],"width"),e=z-u-a,e=e>0?e:o;const I=o-e;I>=0&&I<=2&&(At(h,I),o=e),s=t._hasHeight&&G(_,r),d=G(e,o);const P=j(_,r,s,d,m);La((()=>{if(t._columnsArea.tableElement().append(t._dataArea.headElement()),y.tableElement().append(t._rowsArea.headElement()),i>K&&(At(k,K-i),t._columnsArea.setRowsHeight(k)),n.removeClass("dx-incompressible-fields"),A.children().css("maxWidth",e),t._columnsArea.setGroupWidth(e),t._columnsArea.processScrollBarSpacing(s?m:0),t._columnsArea.setColumnsWidth(h),t._rowsArea.setGroupHeight(t._hasHeight?P:"auto"),t._rowsArea.processScrollBarSpacing(d?m:0),t._rowsArea.setColumnsWidth(B),t._rowsArea.setRowsHeight(N),t._dataArea.setColumnsWidth(h),t._dataArea.setRowsHeight(N),t._dataArea.setGroupWidth(e),t._dataArea.setGroupHeight(t._hasHeight?P:"auto"),L&&y.setColumnsWidth(B),p.toggleClass("dx-bottom-border",!s),C.toggleClass("dx-bottom-border",!s),!t._hasHeight&&z!==We(t.$element())){const W=z-We(t.$element());d||(At(h,W),t._columnsArea.setColumnsWidth(h),t._dataArea.setColumnsWidth(h)),t._dataArea.setGroupWidth(e-W),t._columnsArea.setGroupWidth(e-W)}if(t._hasHeight&&t._filterFields.isVisible()&&me(F)!==f){const W=me(F)-f;if(W>0){s=G(_-W,r);const Y=j(_-W,r,s,d,m);t._dataArea.setGroupHeight(Y),t._rowsArea.setGroupHeight(Y)}}const q=t.option("scrolling");q.mode==="virtual"&&t._setVirtualContentParams(q,h,N,e,P,t._hasHeight,u);const U=[];t._dataArea.updateScrollableOptions({direction:t._dataArea.getScrollableDirection(d,s),rtlEnabled:t.option("rtlEnabled")}),M([t._columnsArea,t._rowsArea,t._dataArea],((W,Y)=>{U.push(Y&&Y.updateScrollable())})),t._updateLoading(),t._renderNoDataText(p),oe.apply(R,U).done((()=>{t._updateScrollPosition(t._columnsArea,t._rowsArea,t._dataArea,!0),t._subscribeToEvents(t._columnsArea,t._rowsArea,t._dataArea),O.resolve()}))}))})),O},_setVirtualContentParams(t,e,n,a,o,r,u){const s=this._dataController.calculateVirtualContentParams({virtualRowHeight:t.virtualRowHeight,virtualColumnWidth:t.virtualColumnWidth,itemWidths:e,itemHeights:n,rowCount:n.length,columnCount:e.length,viewportWidth:a,viewportHeight:r?o:$e(da)});this._dataArea.setVirtualContentParams({top:s.contentTop,left:s.contentLeft,width:s.width,height:s.height}),this._rowsArea.setVirtualContentParams({top:s.contentTop,width:u,height:s.height}),this._columnsArea.setVirtualContentParams({left:s.contentLeft,width:s.width,height:me(this._columnsArea.groupElement())})},applyPartialDataSource(t,e,n){this._dataController.applyPartialDataSource(t,e,n)}}).inherit(Ol).include(sl);pt("dxPivotGrid",ua);/*!
 * devextreme-vue
 * Version: 25.1.5
 * Build date: Wed Sep 03 2025
 *
 * Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file in the root of the project for details.
 *
 * https://github.com/DevExpress/devextreme-vue
 */const ha={props:{allowExpandAll:Boolean,allowFiltering:Boolean,allowSorting:Boolean,allowSortingBySummary:Boolean,dataFieldArea:String,dataSource:[Array,Object],disabled:Boolean,elementAttr:Object,encodeHtml:Boolean,export:Object,fieldChooser:Object,fieldPanel:Object,headerFilter:Object,height:[Number,String],hideEmptySummaryCells:Boolean,hint:String,loadPanel:Object,onCellClick:Function,onCellPrepared:Function,onContentReady:Function,onContextMenuPreparing:Function,onDisposing:Function,onExporting:Function,onInitialized:Function,onOptionChanged:Function,rowHeaderLayout:String,rtlEnabled:Boolean,scrolling:Object,showBorders:Boolean,showColumnGrandTotals:Boolean,showColumnTotals:Boolean,showRowGrandTotals:Boolean,showRowTotals:Boolean,showTotalsPrior:String,stateStoring:Object,tabIndex:Number,texts:Object,visible:Boolean,width:[Number,String],wordWrapEnabled:Boolean},emits:{"update:isActive":null,"update:hoveredElement":null,"update:allowExpandAll":null,"update:allowFiltering":null,"update:allowSorting":null,"update:allowSortingBySummary":null,"update:dataFieldArea":null,"update:dataSource":null,"update:disabled":null,"update:elementAttr":null,"update:encodeHtml":null,"update:export":null,"update:fieldChooser":null,"update:fieldPanel":null,"update:headerFilter":null,"update:height":null,"update:hideEmptySummaryCells":null,"update:hint":null,"update:loadPanel":null,"update:onCellClick":null,"update:onCellPrepared":null,"update:onContentReady":null,"update:onContextMenuPreparing":null,"update:onDisposing":null,"update:onExporting":null,"update:onInitialized":null,"update:onOptionChanged":null,"update:rowHeaderLayout":null,"update:rtlEnabled":null,"update:scrolling":null,"update:showBorders":null,"update:showColumnGrandTotals":null,"update:showColumnTotals":null,"update:showRowGrandTotals":null,"update:showRowTotals":null,"update:showTotalsPrior":null,"update:stateStoring":null,"update:tabIndex":null,"update:texts":null,"update:visible":null,"update:width":null,"update:wordWrapEnabled":null},computed:{instance(){return this.$_instance}},beforeCreate(){this.$_WidgetClass=ua,this.$_hasAsyncTemplate=!0,this.$_expectedChildren={export:{isCollectionItem:!1,optionName:"export"},fieldChooser:{isCollectionItem:!1,optionName:"fieldChooser"},fieldPanel:{isCollectionItem:!1,optionName:"fieldPanel"},headerFilter:{isCollectionItem:!1,optionName:"headerFilter"},loadPanel:{isCollectionItem:!1,optionName:"loadPanel"},pivotGridTexts:{isCollectionItem:!1,optionName:"texts"},scrolling:{isCollectionItem:!1,optionName:"scrolling"},stateStoring:{isCollectionItem:!1,optionName:"stateStoring"},texts:{isCollectionItem:!1,optionName:"texts"}}}};ao(ha);const mr=pe(ha),pa={emits:{"update:isActive":null,"update:hoveredElement":null,"update:enabled":null},props:{enabled:Boolean}};_e(pa);const ga=pe(pa);ga.$_optionName="export";const fa={emits:{"update:isActive":null,"update:hoveredElement":null,"update:allowSearch":null,"update:applyChangesMode":null,"update:enabled":null,"update:height":null,"update:layout":null,"update:searchTimeout":null,"update:texts":null,"update:title":null,"update:width":null},props:{allowSearch:Boolean,applyChangesMode:String,enabled:Boolean,height:Number,layout:Number,searchTimeout:Number,texts:Object,title:String,width:Number}};_e(fa);const Ut=pe(fa);Ut.$_optionName="fieldChooser";Ut.$_expectedChildren={fieldChooserTexts:{isCollectionItem:!1,optionName:"texts"},texts:{isCollectionItem:!1,optionName:"texts"}};const ma={emits:{"update:isActive":null,"update:hoveredElement":null,"update:allFields":null,"update:columnFields":null,"update:dataFields":null,"update:filterFields":null,"update:rowFields":null},props:{allFields:String,columnFields:String,dataFields:String,filterFields:String,rowFields:String}};_e(ma);const _r=pe(ma);_r.$_optionName="texts";const _a={emits:{"update:isActive":null,"update:hoveredElement":null,"update:allowFieldDragging":null,"update:showColumnFields":null,"update:showDataFields":null,"update:showFilterFields":null,"update:showRowFields":null,"update:texts":null,"update:visible":null},props:{allowFieldDragging:Boolean,showColumnFields:Boolean,showDataFields:Boolean,showFilterFields:Boolean,showRowFields:Boolean,texts:Object,visible:Boolean}};_e(_a);const qt=pe(_a);qt.$_optionName="fieldPanel";qt.$_expectedChildren={fieldPanelTexts:{isCollectionItem:!1,optionName:"texts"},texts:{isCollectionItem:!1,optionName:"texts"}};const xa={emits:{"update:isActive":null,"update:hoveredElement":null,"update:columnFieldArea":null,"update:dataFieldArea":null,"update:filterFieldArea":null,"update:rowFieldArea":null},props:{columnFieldArea:String,dataFieldArea:String,filterFieldArea:String,rowFieldArea:String}};_e(xa);const xr=pe(xa);xr.$_optionName="texts";const Ca={emits:{"update:isActive":null,"update:hoveredElement":null,"update:allowSearch":null,"update:allowSelectAll":null,"update:height":null,"update:search":null,"update:searchTimeout":null,"update:showRelevantValues":null,"update:texts":null,"update:width":null},props:{allowSearch:Boolean,allowSelectAll:Boolean,height:Number,search:Object,searchTimeout:Number,showRelevantValues:Boolean,texts:Object,width:Number}};_e(Ca);const ht=pe(Ca);ht.$_optionName="headerFilter";ht.$_expectedChildren={headerFilterTexts:{isCollectionItem:!1,optionName:"texts"},search:{isCollectionItem:!1,optionName:"search"},texts:{isCollectionItem:!1,optionName:"texts"}};const wa={emits:{"update:isActive":null,"update:hoveredElement":null,"update:cancel":null,"update:emptyValue":null,"update:ok":null},props:{cancel:String,emptyValue:String,ok:String}};_e(wa);const Cr=pe(wa);Cr.$_optionName="texts";const va={emits:{"update:isActive":null,"update:hoveredElement":null,"update:enabled":null,"update:height":null,"update:indicatorSrc":null,"update:shading":null,"update:shadingColor":null,"update:showIndicator":null,"update:showPane":null,"update:text":null,"update:width":null},props:{enabled:Boolean,height:Number,indicatorSrc:String,shading:Boolean,shadingColor:String,showIndicator:Boolean,showPane:Boolean,text:String,width:Number}};_e(va);const wr=pe(va);wr.$_optionName="loadPanel";const Sa={emits:{"update:isActive":null,"update:hoveredElement":null,"update:collapseAll":null,"update:dataNotAvailable":null,"update:expandAll":null,"update:exportToExcel":null,"update:grandTotal":null,"update:noData":null,"update:removeAllSorting":null,"update:showFieldChooser":null,"update:sortColumnBySummary":null,"update:sortRowBySummary":null,"update:total":null},props:{collapseAll:String,dataNotAvailable:String,expandAll:String,exportToExcel:String,grandTotal:String,noData:String,removeAllSorting:String,showFieldChooser:String,sortColumnBySummary:String,sortRowBySummary:String,total:String}};_e(Sa);const vr=pe(Sa);vr.$_optionName="texts";const ya={emits:{"update:isActive":null,"update:hoveredElement":null,"update:mode":null,"update:useNative":null},props:{mode:String,useNative:[Boolean,String]}};_e(ya);const Sr=pe(ya);Sr.$_optionName="scrolling";const Ta={emits:{"update:isActive":null,"update:hoveredElement":null,"update:editorOptions":null,"update:enabled":null,"update:mode":null,"update:timeout":null},props:{editorOptions:{},enabled:Boolean,mode:String,timeout:Number}};_e(Ta);const Ea=pe(Ta);Ea.$_optionName="search";const Fa={emits:{"update:isActive":null,"update:hoveredElement":null,"update:customLoad":null,"update:customSave":null,"update:enabled":null,"update:savingTimeout":null,"update:storageKey":null,"update:type":null},props:{customLoad:Function,customSave:Function,enabled:Boolean,savingTimeout:Number,storageKey:String,type:String}};_e(Fa);const ba=pe(Fa);ba.$_optionName="stateStoring";const Aa={emits:{"update:isActive":null,"update:hoveredElement":null,"update:allFields":null,"update:cancel":null,"update:collapseAll":null,"update:columnFieldArea":null,"update:columnFields":null,"update:dataFieldArea":null,"update:dataFields":null,"update:dataNotAvailable":null,"update:emptyValue":null,"update:expandAll":null,"update:exportToExcel":null,"update:filterFieldArea":null,"update:filterFields":null,"update:grandTotal":null,"update:noData":null,"update:ok":null,"update:removeAllSorting":null,"update:rowFieldArea":null,"update:rowFields":null,"update:showFieldChooser":null,"update:sortColumnBySummary":null,"update:sortRowBySummary":null,"update:total":null},props:{allFields:String,cancel:String,collapseAll:String,columnFieldArea:String,columnFields:String,dataFieldArea:String,dataFields:String,dataNotAvailable:String,emptyValue:String,expandAll:String,exportToExcel:String,filterFieldArea:String,filterFields:String,grandTotal:String,noData:String,ok:String,removeAllSorting:String,rowFieldArea:String,rowFields:String,showFieldChooser:String,sortColumnBySummary:String,sortRowBySummary:String,total:String}};_e(Aa);const yr=pe(Aa);yr.$_optionName="texts";const Tr={class:"demo-space-x"},Er={class:"pa-2"},Fr={class:"export-options"},br={class:"options"},ss=pe({__name:"ciro-ozettablo",setup(t){const e=ce();ce(null);const n=Bo(),a=ce(),o=ce([]),r=ce(),u=ce(!1),s=ce(!1),d=ce(!1),p=ce(!1),C=ce(null),g=ce(""),x=ce(!1),F=ce(!1),A=ce(!1),y=ce(""),O=ce(["Açık","Kapalı"]),L=new Date,G=new Date(L);G.setDate(L.getDate()-L.getDay()+1);const j=new Date(L);j.setDate(L.getDate()-L.getDay()+7);const i=ce([G,j]),c=ce(G),f=ce(j);document.title="OFT - Cirolar Özet Tablo";function _(I){}const m=async()=>{var I,H,P;await k(),(P=(H=(I=a.value)==null?void 0:I.instance)==null?void 0:H.getDataSource())==null||P.reload()};function S(){var I,H;(H=(I=r.value)==null?void 0:I.instance)==null||H.updateDimensions()}const T=ka(()=>({fields:[{caption:"CARİ ADI",width:120,dataField:"CARI_ADI",area:"filter",filterType:"include"},{caption:"FATURA NO",width:70,dataField:"fatura_no",area:"filter",filterType:"include"},{caption:"FATURA TARİHİ",width:400,dataField:"fatura_tarih",area:"filter",filterType:"include"},{caption:"FATURA TARİHİ (YIL)",area:"row",dataField:"fatura_tarih",groupInterval:"year",dataType:"date",filterType:"include",expanded:!0},{caption:"FATURA TARİHİ (AY)",area:"row",dataField:"fatura_tarih",groupInterval:"month",dataType:"date",filterType:"include",expanded:!0},{caption:"KANAL TİPİ",area:"column",dataField:"KANAL_TIPI",filterType:"include"},{caption:"E-FATURA DURUMU",area:"filter",dataField:"E_FATURA_DURUMU",filterType:"include"},{caption:"FATURA TARİHİ (HAFTA)",area:"filter",dataField:"hafta",groupInterval:"week",dataType:"date",filterType:"include"},{caption:"MİKTAR",area:"data",dataField:"miktar",dataType:"number",filterType:"include",format:{type:"fixedPoint",precision:0,useGrouping:!0}},{caption:"USD NET TUTAR",dataField:"USD_NET_TUTAR",dataType:"number",summaryType:"sum",area:"data",format:{type:"fixedPoint",precision:0,useGrouping:!0}},{caption:"SATIŞ PERSONELİ",dataField:"SATIŞ PERSONEL KODU",area:"filter"}],store:o.value})),v=()=>{var I,H,P;(P=(H=(I=a.value)==null?void 0:I.instance)==null?void 0:H.getDataSource())==null||P.state({})};function E(I){const H=I.component.getDataSource(),P=I.field;if(P&&(I.items.push({text:"Düzeni Sıfırla",onItemClick(){H.state({})}}),(!P.groupName||P.groupIndex===0)&&I.items.push({text:"Alanı Gizle",onItemClick(){let q;P.groupName?q=H.getAreaFields(P.area,!0)[P.areaIndex].index:q=P.index,H.field(q,{area:null}),H.load()}}),P.dataType==="number")){const q=function(W){H.field(P.index,{summaryType:W.itemData.value}),H.load()},U=[];I.items.push({text:"Hesaplama Türü",items:U}),["Sum","Count","Avg","Min","Max"].forEach(W=>{const Y=W.toLowerCase();U.push({text:W,value:W.toLowerCase(),onItemClick:q,selected:I.field.summaryType===Y})})}}function h({value:I}){u.value=I}function w({value:I}){s.value=I}function b({value:I}){d.value=I}function D({value:I}){p.value=I}function N(I){const H=new ko.Workbook,P=H.addWorksheet("Cirolar");P.columns=[{width:35}],jo({component:I.component,worksheet:P,topLeftCell:{row:4,column:1},keepColumnWidths:!1,exportDataFieldHeaders:u.value,exportRowFieldHeaders:s.value,exportColumnFieldHeaders:d.value,exportFilterFieldHeaders:p.value}).then(q=>{var ue,ae;const U=P.getRow(2),W=P.views[0];U.height=30;const Y=W.xSplit+1,ee=Y+3;P.mergeCells(2,Y,2,ee);const te=U.getCell(Y);te.value="Cirolar",te.font={name:"Segoe UI Light",size:22,bold:!0},te.alignment={horizontal:"left",vertical:"middle",wrapText:!0};const de=(((ue=q==null?void 0:q.to)==null?void 0:ue.row)??0)+2,se=P.getRow(de).getCell(((ae=q==null?void 0:q.to)==null?void 0:ae.column)??0);se.value="www.oftyazilim.com",se.font={color:{argb:"BFBFBF"},italic:!0},se.alignment={horizontal:"right"}}).then(()=>{H.xlsx.writeBuffer().then(q=>{$o(new Blob([q],{type:"application/octet-stream"}),"Cirolar.xlsx")})})}Ma(o,()=>{var I,H,P,q,U,W;(P=(H=(I=a.value)==null?void 0:I.instance)==null?void 0:H.getDataSource())==null||P.reload(),(W=(q=a.value)==null?void 0:q.instance)==null||W.bindChart((U=e.value)==null?void 0:U.instance,{dataFieldsDisplayMode:"splitPanes",alternateDataFields:!0})});const k=async()=>{i.value=[c.value,f.value],c.value=ln(i.value[0]),f.value=ln(i.value[1]),F.value=!0;try{const I=await Qt.get("/api/ciro-ozettablo",{params:{filterValue:c.value,filterValue1:f.value,acik_kapali:y.value,userId:K.value.id}});o.value=I.data.ciro}catch(I){console.error("Veri çekilirken hata oluştu:",I)}F.value=!1},K=$a("userData");Oa(async()=>{n.setTitle("Cirolar Özet Tablo"),Qt.post("/api/log-kayit",{userId:K.value.id,sayfa:"Cirolar (özet tablo)",eylem:"Yükleme"})});const B=({seriesName:I,originalValue:H})=>{const P=I.indexOf("Total")!==-1?new Intl.NumberFormat("en-TR").format(H):H;return{html:`${I}<div class='currency'>${P}</div>`}},z=I=>{ja(()=>{I.component._$element.find(".dx-pivotgrid-cell").each((q,U)=>{const W=$(U),Y=parseFloat(W.text());if(!isNaN(Y)){W.empty();const ee=document.createElement("div");W.append(ee),new DxProgressBar({elementAttr:{class:"progress-bar"},value:Y,showStatus:!0}).$mount(ee)}})})};return(I,H)=>(Xt(),Ba(Va,null,[X(Vo,{class:"mt-0 pa-0 pt-2"},{default:ye(()=>[Te("div",null,[X(Go,null,{default:ye(()=>[Te("div",Tr,[X(Z(on),{label:"Başlangıç Tarihi",width:"150","label-mode":"floating",value:c.value,"onUpdate:value":H[0]||(H[0]=P=>c.value=P),type:"date"},null,8,["value"]),X(Z(on),{label:"Bitiş Tarihi",width:"150","label-mode":"floating",value:f.value,"onUpdate:value":H[1]||(H[1]=P=>f.value=P),type:"date"},null,8,["value"]),X(Z(Oo),{items:O.value,value:y.value,"onUpdate:value":H[2]||(H[2]=P=>y.value=P),"show-clear-button":!0,label:"Açık-Kapalı","label-mode":"floating",width:"140"},null,8,["items","value"]),X(Z(_t),{class:"mt-1",icon:"refresh",text:"Yenile",onClick:m}),X(Z(_t),{class:"mt-1",icon:"undo",text:"Düzen Sıfırla",onClick:H[3]||(H[3]=P=>v())}),X(zo,{modelValue:A.value,"onUpdate:modelValue":H[4]||(H[4]=P=>A.value=P),label:"Grafik Göster",value:"chartGoster"},null,8,["modelValue"])])]),_:1}),Ga(Te("div",Er,[H[8]||(H[8]=Te("div",{class:"long-title"},[Te("h3",null,"Ciro Tablosu")],-1)),X(Z(Ua),{ref_key:"chart",ref:e},{default:ye(()=>[X(Z(qa),{enabled:!0,"customize-tooltip":B}),X(Z(Ka),{width:450}),X(Z(Ya),{height:320}),X(Z(Qa),{type:"bar"})]),_:1},512)],512),[[za,A.value]]),X(Z(mr),{class:"mt-0 pt-0",id:"pivotgrid",ref_key:"grid",ref:a,"data-source":T.value,"allow-sorting-by-summary":!0,"allow-filtering":!0,"show-borders":!0,"show-column-grand-totals":!0,"show-row-grand-totals":!0,"show-row-totals":!0,"show-column-totals":!0,onExporting:N,onContentReady:z,"on-context-menu-preparing":E,onCellClick:_},{fieldChooserButton:ye(()=>[X(Z(_t),{icon:"plus",text:"Özel Buton",onClick:H[6]||(H[6]=P=>m())})]),default:ye(()=>[X(Z(ht),{"show-relevant-values":!1,width:300,height:400},{default:ye(()=>[X(Z(Ea),{enabled:!0})]),_:1}),(Xt(),Wa(Z(no),{key:F.value,visible:F.value,"onUpdate:visible":H[5]||(H[5]=P=>F.value=P),"show-indicator":!0,"show-pane":!0,shading:!0},null,8,["visible"])),X(Z(Ut),{"allow-search":!0}),X(Z(qt),{"show-data-fields":!0,"show-row-fields":!0,"show-column-fields":!0,"show-filter-fields":!0,"allow-field-dragging":!0,visible:!0}),X(Z(ga),{enabled:!0}),X(Z(ba),{enabled:!0,type:"localStorage","storage-key":"dx-widget-gallery-pivotgrid-ciro-storing"})]),_:1},8,["data-source"])]),Te("div",Fr,[H[9]||(H[9]=Te("div",{class:"caption"},"Dışa Aktarma Seçenekleri",-1)),Te("div",br,[X(Z(Ze),{id:"export-data-field-headers",value:u.value,"on-value-changed":h,text:"Alan Başlıklarını Aktar"},null,8,["value"]),X(Z(Ze),{id:"export-row-field-headers",value:s.value,"on-value-changed":w,text:"Satır Alan Başlıklarını Dışa Aktar"},null,8,["value"]),X(Z(Ze),{id:"export-column-field-headers",value:d.value,"on-value-changed":b,text:"Sütun Alan Başlıklarını Dışa Aktar"},null,8,["value"]),X(Z(Ze),{id:"export-filter-field-headers",value:p.value,"on-value-changed":D,text:"Filtre Alan Başlıklarını Dışa Aktar"},null,8,["value"])])])]),_:1}),X(Z(Mo),{width:1500,height:900,title:g.value,visible:x.value,"onUpdate:visible":H[7]||(H[7]=P=>x.value=P),onShown:S,"show-close-button":!0},{default:ye(()=>[X(Z(Ja),{id:"grid",ref:r.value,"data-source":C.value,"key-expr":"satir_id","show-borders":!0,"row-alternation-enabled":!1,"min-width":200,"allow-column-reordering":!0,"column-auto-width":!1,"allow-column-resizing":!0,"column-resizing-mode":"widget",onCellPrepared:I.onCellPrepared},{default:ye(()=>[X(Z(ge),{"data-field":"id",caption:"ID",visible:!1,"min-width":90}),X(Z(ge),{"data-field":"haftax",caption:"HFT","data-type":"string",visible:!1,width:20}),X(Z(ge),{"data-field":"OPERASYON",caption:"OPERASYON",visible:I.operasyon,width:120},null,8,["visible"]),X(Z(ge),{"data-field":"siparis_belge_no",caption:"SİPARİŞ NO",width:90,visible:!0,"allow-sorting":!1}),X(Z(ge),{"data-field":"cari_ad",caption:"MÜŞTERİ",visible:!0,"min-width":140,"allow-sorting":!1}),X(Z(ge),{"data-field":"stok_kodu",caption:"STOK KODU",visible:!0,width:120,"allow-sorting":!1}),X(Z(ge),{"data-field":"stok_adi",caption:"STOK ADI","min-width":200,"allow-sorting":!1}),X(Z(ge),{"data-field":"isemri_no",caption:"İŞ EMRİ NO",width:120,"allow-sorting":!1}),X(Z(ge),{"data-field":"teslim_tarihi",caption:"TESLİM TARİHİ","data-type":"date",width:140,visible:I.operasyon,format:{formatter:P=>new Intl.DateTimeFormat("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(P)).replace(/\//g,".")},"allow-sorting":!1},null,8,["visible","format"]),X(Z(ge),{"data-field":"kalan_miktar",caption:"KALAN MİKTAR","data-type":"number",width:100,visible:!0,"allow-sorting":!1,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),X(Z(ge),{"data-field":"isemri_miktari",caption:"İŞ EMRİ MİKTARI","data-type":"number",width:90,visible:!0,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),X(Z(ge),{"data-field":"operasyon_hazirlik_suresi",caption:"HAZIRLIK SÜRESİ","data-type":"number",width:90,visible:!0,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),X(Z(ge),{"data-field":"operasyon_suresi",caption:"OPERASYON SÜRESİ","data-type":"number",width:90,visible:!0,format:{type:"fixedPoint",precision:1,thousandsSeparator:","},"allow-sorting":!1}),X(Z(ge),{"data-field":"satir_id",caption:"SATIR ID",visible:!1,"min-width":90,"allow-sorting":!1}),X(Z(ht),{visible:!0}),X(Z(Za),{visible:!0}),X(Z(eo),{visible:!0,width:240}),X(Z(to),{mode:"multiple"})]),_:1},8,["data-source","onCellPrepared"])]),_:1},8,["title","visible"])],64))}});export{ss as default};
