import{d as U,r as s,D as j,i as S,g as $,o as z,f as i,b as t,e as c,T as p,aF as u,p as k,s as f}from"./main-dui5Vje2.js";import{V as w,a as g,b as L}from"./VCard-Ce1yszRz.js";import{V as d}from"./VTextField-CsD0UjxB.js";import{V as x}from"./VCardText-Cy5QQT_n.js";import{V as P}from"./VDataTable-yc1uaprq.js";import{V as I}from"./VDialog-CI4XP-Kl.js";import{V as K}from"./VSpacer-BCrgTeGd.js";import{V as N}from"./VContainer-DnHe3iEb.js";import"./createSimpleFunctional-B2d7GdJi.js";import"./VAvatar-D1E6dIOr.js";import"./VImg-DqPPsg4R.js";import"./index-C5J8P44N.js";/* empty css                   */import"./VCounter-D1rY7xnh.js";import"./VField-BlP1dZkc.js";import"./focus-Cpuo8Mz9.js";import"./easing-Bybner-F.js";import"./VInput-wH71d46B.js";import"./form-V39mdJOI.js";import"./forwardRefs-C-GTDzx5.js";import"./VPagination-e2mLA15l.js";import"./VSelect-DGw-IzkP.js";import"./VList-8ZDPaazy.js";import"./ssrBoot-GyBfYfFD.js";import"./VDivider-DWzx84o8.js";import"./dialog-transition-D0Ybi4xJ.js";import"./VMenu-cmOOOfk2.js";import"./VOverlay-BXyXhy3o.js";import"./delay-CMuwXp9_.js";import"./lazy-b0Kybsre.js";import"./scopeId-C7PK8FF5.js";import"./VCheckboxBtn-CYjLHWHn.js";import"./VSelectionControl-BwCI8yRd.js";import"./VChip-CwVrqSo9.js";import"./VSlideGroup-CjUSE0JU.js";import"./VTable-BvnBbgEk.js";import"./filter-Bt0Zktvz.js";/* empty css              */const xe=U({__name:"acl-policy-yonetimi",setup(Y){const v=s([]),y=s(!1),o=s(null),r=s(""),m=s(""),V=s(""),_=j(()=>{const a=V.value.trim().toLowerCase();return a?v.value.filter(e=>e.key.toLowerCase().includes(a)||(e.description||"").toLowerCase().includes(a)):v.value}),C=j({get:()=>!!o.value,set:a=>{a||(o.value=null)}});async function b(){y.value=!0;try{const{data:a}=await f.get("/api/ability-policies");v.value=(a||[]).map(e=>({id:e.id,key:e.key,actions:e.actions||[],subjects:e.subjects||[],description:e.description||""}))}finally{y.value=!1}}function D(){o.value={key:"",actions:[],subjects:[],description:""},r.value="",m.value=""}function A(a){o.value={...a},r.value=a.actions.join(", "),m.value=a.subjects.join(", ")}async function B(){var e;if(!o.value)return;const a={key:o.value.key.trim(),actions:r.value.split(",").map(l=>l.trim()).filter(Boolean),subjects:m.value.split(",").map(l=>l.trim()).filter(Boolean),description:((e=o.value.description)==null?void 0:e.trim())||null};o.value.id?await f.put(`/api/ability-policies/${o.value.id}`,a):await f.post("/api/ability-policies",a),o.value=null,await b()}async function T(a){a.id&&(await f.delete(`/api/ability-policies/${a.id}`),await b())}return S(b),(a,e)=>(z(),$(N,null,{default:i(()=>[t(w,null,{default:i(()=>[t(g,{class:"d-flex align-center justify-space-between"},{default:i(()=>[e[8]||(e[8]=c("span",null,"ACL Policy Yönetimi",-1)),c("div",null,[t(d,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=l=>V.value=l),density:"compact",label:"Ara (key/description)",class:"me-2"},null,8,["modelValue"]),t(p,{color:"primary",onClick:D},{default:i(()=>e[7]||(e[7]=[u("Yeni Policy")])),_:1,__:[7]})])]),_:1,__:[8]}),t(x,null,{default:i(()=>[t(P,{items:_.value,loading:y.value,headers:[{title:"Key",key:"key"},{title:"Actions",key:"actions"},{title:"Subjects",key:"subjects"},{title:"Description",key:"description"},{title:"",key:"act",sortable:!1}]},{"item.actions":i(({item:l})=>{var n;return[c("div",null,k((n=l.actions)==null?void 0:n.join(", ")),1)]}),"item.subjects":i(({item:l})=>{var n;return[c("div",null,k((n=l.subjects)==null?void 0:n.join(", ")),1)]}),"item.act":i(({item:l})=>[t(p,{size:"small",class:"me-2",onClick:n=>A(l)},{default:i(()=>e[9]||(e[9]=[u("Düzenle")])),_:2,__:[9]},1032,["onClick"]),t(p,{size:"small",color:"error",onClick:n=>T(l)},{default:i(()=>e[10]||(e[10]=[u("Sil")])),_:2,__:[10]},1032,["onClick"])]),_:1},8,["items","loading"])]),_:1})]),_:1}),t(I,{modelValue:C.value,"onUpdate:modelValue":e[6]||(e[6]=l=>C.value=l),"max-width":"640"},{default:i(()=>[t(w,null,{default:i(()=>[t(g,null,{default:i(()=>{var l;return[u(k((l=o.value)!=null&&l.id?"Policy Düzenle":"Yeni Policy"),1)]}),_:1}),t(x,null,{default:i(()=>[t(d,{modelValue:o.value.key,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.key=l),label:"Key (örn: route:dashboards-analytics)"},null,8,["modelValue"]),t(d,{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=l=>r.value=l),label:"Actions (örn: read, update)"},null,8,["modelValue"]),t(d,{modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=l=>m.value=l),label:"Subjects (örn: planlama, all)"},null,8,["modelValue"]),t(d,{modelValue:o.value.description,"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.description=l),label:"Açıklama"},null,8,["modelValue"])]),_:1}),t(L,null,{default:i(()=>[t(K),t(p,{variant:"text",onClick:e[5]||(e[5]=l=>o.value=null)},{default:i(()=>e[11]||(e[11]=[u("İptal")])),_:1,__:[11]}),t(p,{color:"primary",onClick:B},{default:i(()=>e[12]||(e[12]=[u("Kaydet")])),_:1,__:[12]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{xe as default};
