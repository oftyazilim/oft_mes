import{d as T,j as z,r as u,c as h,o as D,b as s,f as r,t as d,m as a,ae as V,v as R,F as j,a$ as y,b4 as f}from"./main-V5EO4bnM.js";import{V as A}from"./VCol-BOvDuIU5.js";import{V as B,a as F,b as N}from"./VCard-BP8zXEbp.js";import{V as b}from"./VCardText-iS_NmLX9.js";import{V as g}from"./VTextField-BWickmOz.js";import{V as S}from"./VRow-C6KOjiEi.js";import{V as U}from"./VSnackbar-CQ9krAkr.js";/* empty css              */import"./VAvatar-BzUBYjyu.js";import"./VImg-B1Egn-l0.js";/* empty css                   */import"./VCounter-DgPkw2o-.js";import"./VField-BfRKWj98.js";import"./focus-BXza71jj.js";import"./easing-Bybner-F.js";import"./VInput-46tJoMeS.js";import"./form-Cqj1JXaW.js";import"./forwardRefs-C-GTDzx5.js";import"./VOverlay-DVCcc7ox.js";import"./delay-RRfhougJ.js";import"./lazy-d6o7y8ym.js";import"./scopeId-D-Ye_Yf0.js";const le=T({__name:"force-password",setup(Y){const c=z(),n=u(!1),l=u({current_password:"halapass1234",password:"",password_confirmation:""}),p=u(!1),m=u(!1),i=u({show:!1,color:"info",text:"Lütfen şifrenizi değiştirin."}),w=o=>!!o||"Zorunlu alan",x=o=>((o==null?void 0:o.length)??0)>=8||"En az 8 karakter",v=o=>o===l.value.password||"Şifreler uyuşmuyor",k=async()=>{var o,e;if(!(!l.value.password||l.value.password!==l.value.password_confirmation))try{n.value=!0,await y.post("/api/auth/change-password",l.value),i.value={show:!0,color:"success",text:"Şifre güncellendi, girişe yönlendiriliyorsunuz."},setTimeout(()=>c.push("/login"),900)}catch(t){const _=((e=(o=t==null?void 0:t.response)==null?void 0:o.data)==null?void 0:e.message)||"İşlem sırasında hata oluştu";i.value={show:!0,color:"error",text:String(_)}}finally{n.value=!1}},C=async()=>{try{await y.get("/api/auth/logout")}catch{}const o=f("accessToken");o.value=null;const e=f("userData");e.value=null;const t=f("userAbilityRules");t.value=null,c.push("/login")};return(o,e)=>(D(),h(j,null,[s(S,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:r(()=>[s(A,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center mx-auto"},{default:r(()=>[s(B,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:r(()=>[s(F,{class:"text-center"},{default:r(()=>e[5]||(e[5]=[d("Şifre Değiştirme Zorunlu")])),_:1,__:[5]}),s(b,{class:"text-center"},{default:r(()=>e[6]||(e[6]=[d("Varsayılan şifre ile giriş yaptınız. Yeni bir şifre belirlemeden devam edemezsiniz.")])),_:1,__:[6]}),s(b,null,{default:r(()=>[s(g,{modelValue:a(l).password,"onUpdate:modelValue":e[0]||(e[0]=t=>a(l).password=t),label:"Yeni Şifre",type:a(p)?"text":"password",disabled:a(n),autocomplete:"new-password",rules:[w,x],"append-inner-icon":a(p)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[1]||(e[1]=t=>p.value=!a(p))},null,8,["modelValue","type","disabled","rules","append-inner-icon"]),s(g,{class:"mt-2",modelValue:a(l).password_confirmation,"onUpdate:modelValue":e[2]||(e[2]=t=>a(l).password_confirmation=t),label:"Yeni Şifre (Tekrar)",type:a(m)?"text":"password",disabled:a(n),autocomplete:"new-password",rules:[w,v],"append-inner-icon":a(m)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[3]||(e[3]=t=>m.value=!a(m))},null,8,["modelValue","type","disabled","rules","append-inner-icon"])]),_:1}),s(N,{class:"justify-end"},{default:r(()=>[s(V,{variant:"tonal",color:"secondary",onClick:C,disabled:a(n)},{default:r(()=>e[7]||(e[7]=[d("Vazgeç")])),_:1,__:[7]},8,["disabled"]),s(V,{color:"primary",onClick:k,loading:a(n)},{default:r(()=>e[8]||(e[8]=[d("Kaydet")])),_:1,__:[8]},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1}),s(U,{modelValue:a(i).show,"onUpdate:modelValue":e[4]||(e[4]=t=>a(i).show=t),color:a(i).color,timeout:"2500"},{default:r(()=>[d(R(a(i).text),1)]),_:1},8,["modelValue","color"])],64))}});export{le as default};
