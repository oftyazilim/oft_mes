import{j as p,M as v,N as w,d as g}from"./dom_component-BOMsNA7g.js";import{d9 as S,d4 as a,d_ as h}from"./main-BsBPzaN6.js";const o=p(),l=v(),m={EXCEL:"xlsx",CSS:"css",PNG:"png",JPEG:"jpeg",GIF:"gif",SVG:"svg",PDF:"pdf"},b={CSS:"text/css",EXCEL:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",PNG:"image/png",JPEG:"image/jpeg",GIF:"image/gif",SVG:"image/svg+xml",PDF:"application/pdf"},f={_revokeObjectURLTimeout:3e4,_getDataUri(e,s){return`data:${this._getMimeType(e)};base64,${s}`},_getMimeType:e=>b[e]||"application/octet-stream",_linkDownloader(e,s){const t=g.createElement("a");return t.download=e,t.href=s,t.target="_blank",t},_winJSBlobSave(e,s,t){const i=new Windows.Storage.Pickers.FileSavePicker;i.suggestedStartLocation=Windows.Storage.Pickers.PickerLocationId.documentsLibrary;const n=m[t];if(n){const c=this._getMimeType(t);i.fileTypeChoices.insert(c,[`.${n}`])}i.suggestedFileName=s,i.pickSaveFileAsync().then((c=>{c&&c.openAsync(Windows.Storage.FileAccessMode.readWrite).then((r=>{const d=e.msDetachStream();Windows.Storage.Streams.RandomAccessStream.copyAsync(d,r).then((()=>{r.flushAsync().done((()=>{d.close(),r.close()}))}))}))}))},_click(e){try{e.dispatchEvent(new MouseEvent("click",{cancelable:!0}))}catch{const t=g.getDocument().createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,o,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}},_saveBlobAs(e,s,t){if(this._blobSaved=!1,a(l.msSaveOrOpenBlob))l.msSaveOrOpenBlob(t,e),this._blobSaved=!0;else if(a(o.WinJS))this._winJSBlobSave(t,e,s),this._blobSaved=!0;else{const i=o.URL||o.webkitURL||o.mozURL||o.msURL||o.oURL;if(a(i)){const n=i.createObjectURL(t),c=this._linkDownloader(e,n);setTimeout((()=>{i.revokeObjectURL(n),this._objectUrlRevoked=!0}),this._revokeObjectURLTimeout),this._click(c)}else h.warn("window.URL || window.webkitURL || window.mozURL || window.msURL || window.oURL is not defined")}},saveAs(e,s,t){const i=m[s];if(i&&(e+=`.${i}`),S(o.Blob))this._saveBlobAs(e,s,t);else{a(/iPad/i.exec(l.userAgent))||w.log("E1034");const n=this._linkDownloader(e,this._getDataUri(s,t));this._click(n)}}};export{f};
