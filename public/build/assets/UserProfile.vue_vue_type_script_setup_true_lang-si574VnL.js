const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-CAZR5bAJ.js","assets/main-Cw89STZt.css"])))=>i.map(i=>d[i]);
import{d as R,aK as U,aN as E,aO as k,v as S,r as u,c as Y,o as v,g as x,j as $,e as m,b as s,u as e,f as l,m as M,k as y,aB as d,at as j,L as _,aA as K,aM as O,aI as q}from"./main-CAZR5bAJ.js";import{p as F}from"./cookies-BKoq7nke.js";import{V as Z}from"./VBadge-CXm9rTQ5.js";import{V as G}from"./VImg-B8ri0-tY.js";import{V as H}from"./VMenu-lBWT4278.js";import{V as J,a as Q,d as W}from"./VList-BvuLZ_yF.js";import{V as X}from"./VAvatar-fzpuo2L0.js";import{V as ee,a as ae,b as te}from"./VCard-D3M-RDL5.js";import{V as oe}from"./VCardText-uZHlghNb.js";import{V as C}from"./VTextField-qord98z0.js";import{V as se}from"./VDialog-BrtYgcZT.js";import{V as le}from"./VSnackbar-LqPLYSlI.js";const re={class:"d-flex align-center gap-2"},ne={class:"d-flex gap-2 align-center"},ie={class:"text-h6 font-weight-medium"},ue={class:"px-4 py-2"},de={class:"px-4 py-2"},pe={class:"d-none d-sm-inline text-body-1 font-weight-medium"},he=R({__name:"UserProfile",setup(fe){const T=U(),I=E(),n=k("userData"),N=S(()=>{const t=n.value;return t?typeof t=="string"?t:t.name||t.fullName||t.username||t.email||"":""}),h=async()=>{try{F()}catch{}k("accessToken").value=null,n.value=null;try{const t=window;t.__appTitleRef&&(t.__appTitleRef.value=null)}catch{}try{const{themeConfig:t,layoutConfig:a}=await O(async()=>{const{themeConfig:o,layoutConfig:b}=await import("./main-CAZR5bAJ.js").then(P=>P.e_);return{themeConfig:o,layoutConfig:b}},__vite__mapDeps([0,1]));t.app.title="firma adı",a.app.title="firma adı"}catch{}await T.push("/login"),k("userAbilityRules").value=null,I.update([])},p=u(!1),r=u({current_password:"",password:"",password_confirmation:""}),i=u(!1),c=u(!1),w=u(!1),V=u(!1),f=u({show:!1,color:"success",text:""}),g=t=>!!t||"Zorunlu alan",D=t=>((t==null?void 0:t.length)??0)>=8||"En az 8 karakter",z=t=>t!==r.value.current_password||"Yeni şifre mevcut şifreyle aynı olamaz",A=t=>t===r.value.password||"Şifreler uyuşmuyor",B=()=>{r.value={current_password:"",password:"",password_confirmation:""},p.value=!0},L=async()=>{var t,a;if(!(!r.value.current_password||!r.value.password||r.value.password!==r.value.password_confirmation))try{i.value=!0,await q.post("/api/auth/change-password",r.value),f.value={show:!0,color:"success",text:"Şifre güncellendi. Lütfen tekrar giriş yapın."},p.value=!1,setTimeout(()=>{h()},800)}catch(o){const b=((a=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:a.message)||"İşlem sırasında hata oluştu";f.value={show:!0,color:"error",text:String(b)}}finally{i.value=!1}};return(t,a)=>(v(),Y("div",re,[e(n)?(v(),x(Z,{key:0,dot:"",bordered:"",location:"bottom right","offset-x":"1","offset-y":"2",color:"success"},{default:l(()=>[s(X,{size:"38",class:"cursor-pointer",color:e(n)&&e(n).avatar?void 0:"primary",variant:e(n)&&e(n).avatar?void 0:"tonal"},{default:l(()=>[e(n)&&e(n).avatar?(v(),x(G,{key:0,src:e(n).avatar},null,8,["src"])):(v(),x(M,{key:1,icon:"tabler-user"})),s(H,{activator:"parent",width:"240",location:"bottom end",offset:"12px"},{default:l(()=>[s(J,null,{default:l(()=>[s(Q,null,{default:l(()=>[m("div",ne,[m("div",null,[m("h6",ie,y(e(n).fullName||e(n).username),1),s(W,{class:"text-capitalize text-disabled"},{default:l(()=>[d(y(e(n).role),1)]),_:1})])])]),_:1}),s(e(j),{options:{wheelPropagation:!1}},{default:l(()=>[m("div",ue,[s(_,{block:"",size:"small",color:"primary","append-icon":"tabler-lock-password",onClick:B,class:"mb-2",variant:"tonal"},{default:l(()=>a[9]||(a[9]=[d(" Şifre Değiştir ")])),_:1,__:[9]})]),m("div",de,[s(_,{block:"",size:"small",color:"error","append-icon":"tabler-logout",onClick:h},{default:l(()=>a[10]||(a[10]=[d(" Çıkış Yap ")])),_:1,__:[10]})])]),_:1})]),_:1})]),_:1})]),_:1},8,["color","variant"])]),_:1})):$("",!0),m("span",pe,y(e(N)),1),s(se,{modelValue:e(p),"onUpdate:modelValue":a[7]||(a[7]=o=>K(p)?p.value=o:null),"max-width":"420",persistent:""},{default:l(()=>[s(ee,null,{default:l(()=>[s(ae,null,{default:l(()=>a[11]||(a[11]=[d("Şifre Değiştir")])),_:1,__:[11]}),s(oe,null,{default:l(()=>[s(C,{modelValue:e(r).current_password,"onUpdate:modelValue":a[0]||(a[0]=o=>e(r).current_password=o),label:"Mevcut Şifre",type:e(c)?"text":"password",disabled:e(i),autocomplete:"current-password",rules:[g],"append-inner-icon":e(c)?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[1]||(a[1]=o=>c.value=!e(c))},null,8,["modelValue","type","disabled","rules","append-inner-icon"]),s(C,{class:"mt-2",modelValue:e(r).password,"onUpdate:modelValue":a[2]||(a[2]=o=>e(r).password=o),label:"Yeni Şifre",type:e(w)?"text":"password",disabled:e(i),autocomplete:"new-password",rules:[g,D,z],"append-inner-icon":e(w)?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[3]||(a[3]=o=>w.value=!e(w))},null,8,["modelValue","type","disabled","rules","append-inner-icon"]),s(C,{class:"mt-2",modelValue:e(r).password_confirmation,"onUpdate:modelValue":a[4]||(a[4]=o=>e(r).password_confirmation=o),label:"Yeni Şifre (Tekrar)",type:e(V)?"text":"password",disabled:e(i),autocomplete:"new-password",rules:[g,A],"append-inner-icon":e(V)?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[5]||(a[5]=o=>V.value=!e(V))},null,8,["modelValue","type","disabled","rules","append-inner-icon"])]),_:1}),s(te,{class:"justify-end"},{default:l(()=>[s(_,{variant:"tonal",onClick:a[6]||(a[6]=o=>p.value=!1),disabled:e(i)},{default:l(()=>a[12]||(a[12]=[d("Vazgeç")])),_:1,__:[12]},8,["disabled"]),s(_,{color:"primary",onClick:L,loading:e(i)},{default:l(()=>a[13]||(a[13]=[d("Kaydet")])),_:1,__:[13]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(le,{modelValue:e(f).show,"onUpdate:modelValue":a[8]||(a[8]=o=>e(f).show=o),color:e(f).color,timeout:"2500"},{default:l(()=>[d(y(e(f).text),1)]),_:1},8,["modelValue","color"])]))}});export{he as _};
