import{dQ as at,dv as Pe,df as m,dG as M,dO as ge,d9 as v,e2 as se,du as W,d4 as x,db as ie,d1 as b,dk as oe,e3 as st,a$ as N,da as z,dC as $,dK as A,d3 as S,dL as V,dc as Y,dm as it,d6 as _,dD as R,dW as O,dw as Te,e4 as ot,dP as ut,dZ as pe,d2 as me}from"./main-MLm3wPHk.js";import{L as ct,d as P,j as Q,M as ke,s as lt,o as ht,_ as dt,N as Fe}from"./dom_component-BiT_5VJZ.js";const y=at(Pe.ERROR_MESSAGES,{E4000:"[DevExpress.data]: {0}",E4001:"Unknown aggregating function is detected: '{0}'",E4002:"Unsupported OData protocol version is used",E4003:"Unknown filter operation is used: {0}",E4004:"The thenby() method is called before the sortby() method",E4005:"Store requires a key expression for this operation",E4006:"ArrayStore 'data' option must be an array",E4007:"Compound keys cannot be auto-generated",E4008:"Attempt to insert an item with a duplicated key",E4009:"Data item cannot be found",E4010:"CustomStore does not support creating queries",E4011:"Custom Store method is not implemented or is not a function: {0}",E4012:"Custom Store method returns an invalid value: {0}",E4013:"Local Store requires the 'name' configuration option is specified",E4014:"Unknown data type is specified for ODataStore: {0}",E4015:"Unknown entity name or alias is used: {0}",E4016:"The compileSetter(expr) method is called with 'self' passed as a parameter",E4017:"Keys cannot be modified",E4018:"The server has returned a non-numeric value in a response to an item count request",E4019:"Mixing of group operators inside a single group of filter expression is not allowed",E4020:"Unknown store type is detected: {0}",E4021:"The server response does not provide the totalCount value",E4022:"The server response does not provide the groupCount value",E4023:"Could not parse the following XML: {0}",E4024:"String function {0} cannot be used with the data field {1} of type {2}.",W4000:"Data returned from the server has an incorrect structure",W4001:'The {0} field is listed in both "keyType" and "fieldTypes". The value of "fieldTypes" is used.',W4002:"Data loading has failed for some cells due to the following error: {0}"});let ft=null;const ue=function(e){var t;(t=ft)===null||t===void 0||t(e)},_t=ct.add,He="DEVEXTREME_XHR_ERROR_UNLOAD",gt=function(e){return[e[0],e.length<3?"=":String(e[1]).toLowerCase(),e.length<2?!0:e[e.length-1]]},Z=function(e){return Array.isArray(e)||(e=[e]),M(e,(t=>{const r={selector:v(t)||typeof t=="string"?t:t.getter||t.field||t.selector,desc:!!(t.desc||String(t.dir).charAt(0).toLowerCase()==="d")};return t.compare&&(r.compare=t.compare),r}))},pt=(function(){const e={timeout:"Network connection timeout",error:"Unspecified network error",parsererror:"Unexpected server response"};let t;return _t((()=>{const r=Q();P.listen(r,"beforeunload",(()=>{t=!0}))})),function(r,n){return t?He:r.status<400?(function(a){let i=e[a];return i||a})(n):r.statusText}})(),mt={count:{seed:0,step:e=>1+e},sum:{seed:0,step:(e,t)=>e+t},min:{step:(e,t)=>t<e?t:e},max:{step:(e,t)=>t>e?t:e},avg:{seed:[0,0],step:(e,t)=>[e[0]+t,e[1]+1],finalize:e=>e[1]?e[0]/e[1]:NaN}},yt=(function(){let e=0,t;return{obtain:function(){e===0&&(t=new m),e++},release:function(){e--,e<1&&t.resolve()},promise:function(){return(e===0?new m().resolve():t).promise()},reset:function(){e=0,t&&t.resolve()}}})();function St(e){return/^(and|&&|&)$/i.test(e)}const ce=function(e,t,r){if(Array.isArray(e)){const n=M(t,((i,s)=>s));let a;for(let i=0;i<n.length;i++)if(a=n[i],!ge(t[a],r[a],{strict:!1}))return!1;return!0}return ge(t,r,{strict:!1})},vt=function(e){return e[0]==="!"&&Array.isArray(e[1])},wt=function(e){return e==="and"||e==="or"},Ct=function(e){if(e.length>2&&Array.isArray(e[0])&&e[1]==="or"&&typeof e[0][0]=="string"&&e[0][1]==="="){const[t]=e[0];return!e.find(((r,n)=>n%2!==0?r!=="or":!Array.isArray(r)||r.length!==3||r[0]!==t||r[1]!=="="))}return!1},Et=function(e){const t=e[0],r=e[1];return!!(Array.isArray(t)||v(t)&&(Array.isArray(r)||v(r)||wt(r)))},D=function(){const e=new m;return e.resolve.apply(e,arguments).promise()},Re=function(){const e=new m;return e.reject.apply(e,arguments).promise()};function Lt(e,t){let r;return function(){return r||(r=setTimeout((()=>{r=void 0,e.call(this)}),v(t)?t():t)),r}}function xt(e,t){let r=[];const n=Lt((function(){e.call(this,r),r=[]}),t);return function(a){return Array.isArray(a)&&r.push(...a),n.call(this,r)}}function bt(e,t){let r;const n=typeof t=="string"?t.split():t.slice();for(;n.length;)if(r=n.shift(),r in e)return!0;return!1}function Me(e,t,r,n){let a,i;if(n){for(let s=0;s<t.length;s++)if(a=t[s].items||t[s].collapsedItems||[],i=Me(e,a||[],r,n-1),i)return i}else if(j(e,t,r)>=0)return t}function At(e,t,r,n){return n?Me(e,t,r,n)||[]:t}function Ot(e,t){if(e.key()&&(!t._dataByKeyMap||t._dataByKeyMapLength!==t.length)){const r={},n=t.length;for(let a=0;a<n;a++)r[JSON.stringify(e.keyOf(t[a]))]=t[a];t._dataByKeyMap=r,t._dataByKeyMapLength=n}}function Dt(e,t){if(e._dataByKeyMap)return e._dataByKeyMap[JSON.stringify(t)]}function It(e,t){return e._dataByKeyMap?e._dataByKeyMap[JSON.stringify(t)]:!0}function je(e,t,r){e._dataByKeyMap&&(e._dataByKeyMap[JSON.stringify(t)]=r,e._dataByKeyMapLength+=r?1:-1)}function Be(e,t,r){r=r||new WeakMap;const n=e?Object.create(Object.getPrototypeOf(e)):{};e&&r.set(e,n);const a=N({},e);se(n,a,!0,!0,!0);for(const i in a){const s=a[i],c=t==null?void 0:t[i];z(s)&&!ie(s)&&z(c)&&!r.has(s)&&(n[i]=Be(s,c,r))}for(const i in n){const s=n[i];z(s)&&r.has(s)&&(n[i]=r.get(s))}return n}function Pt(e,t){const r=Be(e,t);return se(r,t,!0,!0,!0)}function le(e){let{keyInfo:t,data:r,changes:n,groupCount:a,useInsertIndex:i,immutable:s,disableCache:c,logError:o,skipCopying:u}=e;const l=s===!0?[...r]:r;return n.forEach((h=>{const f=h.type==="insert"?l:At(t,l,h.key,a);switch(!c&&Ot(t,f),h.type){case"update":Ke(t,f,h.key,h.data,!0,s,o);break;case"insert":Ue(t,f,h.data,i&&x(h.index)?h.index:-1,!0,o,u);break;case"remove":ze(t,f,h.key,!0,o)}})),l}function G(e,t,r){return e?t&&y.log(r):Re(y.Error(r))}function Ke(e,t,r,n,a,i,s){let c;const o=e.key();if(o){if(bt(n,o)&&!ce(o,r,e.keyOf(n)))return G(a,s,"E4017");if(c=Dt(t,r),!c){const u=j(e,t,r);if(u<0)return G(a,s,"E4009");if(c=t[u],i===!0&&x(c)){const l=Pt(c,n);return t[u]=l,!a&&D(l,r)}}}else c=r;if(se(c,n,!0,!1,!0,!0),!a)return W().useLegacyStoreResult?D(r,n):D(c,r)}function Ue(e,t,r,n,a,i,s){let c;const o=e.key(),u=ie(r)&&!s?b({},r):r;if(o){if(c=e.keyOf(u),c===void 0||typeof c=="object"&&oe(c)){if(Array.isArray(o))throw y.Error("E4007");c=u[o]=String(new st)}else if(t[j(e,t,c)]!==void 0)return G(a,i,"E4008")}else c=u;if(n>=0?t.splice(n,0,u):t.push(u),je(t,c,u),!a)return D(W().useLegacyStoreResult?r:u,c)}function ze(e,t,r,n,a){const i=j(e,t,r);if(i>-1&&(t.splice(i,1),je(t,r,null)),!n)return D(r);if(i<0)return G(n,a,"E4009")}function j(e,t,r){const n=e.key();if(!It(t,r))return-1;for(let a=0,i=t.length;a<i;a++)if(ce(n,e.keyOf(t[a]),r))return a;return-1}const B=$.inherit({toArray(){const e=[];for(this.reset();this.next();)e.push(this.current());return e},countable:()=>!1}),he=B.inherit({ctor(e){this.array=e,this.index=-1},next(){return this.index+1<this.array.length?(this.index++,!0):!1},current(){return this.array[this.index]},reset(){this.index=-1},toArray(){return this.array.slice(0)},countable:()=>!0,count(){return this.array.length}}),q=B.inherit({ctor(e){this.iter=e},next(){return this.iter.next()},current(){return this.iter.current()},reset(){return this.iter.reset()}}),X=q.inherit({ctor(e,t){this.callBase(e),this.index=-1,this.mapper=t},current(){return this.mapper(this.callBase(),this.index)},next(){const e=this.callBase();return e&&this.index++,e}}),Tt=function(e,t,r){return Y(e)&&Y(t)&&(r!=null&&r.locale||r!=null&&r.collatorOptions)?new Intl.Collator((r==null?void 0:r.locale)||void 0,(r==null?void 0:r.collatorOptions)||void 0).compare(e,t):(e=V(e,!1,r),t=V(t,!1,r),e===null&&t!==null?-1:e!==null&&t===null||e===void 0&&t!==void 0?1:e!==void 0&&t===void 0||e<t?-1:e>t?1:0)},ee=B.inherit({ctor(e,t,r,n){this.langParams=e.langParams,e instanceof X||(e=new X(e,this._wrap),e.langParams=this.langParams),this.iter=e,this.rules=[{getter:t,desc:r,compare:n,langParams:this.langParams}]},thenBy(e,t,r){const n=new ee(this.sortedIter||this.iter,e,t,r);return this.sortedIter||(n.rules=this.rules.concat(n.rules)),n},next(){return this._ensureSorted(),this.sortedIter.next()},current(){return this._ensureSorted(),this.sortedIter.current()},reset(){delete this.sortedIter},countable(){return this.sortedIter||this.iter.countable()},count(){return this.sortedIter?this.sortedIter.count():this.iter.count()},_ensureSorted(){const e=this;e.sortedIter||(S(e.rules,(function(){this.getter=A(this.getter)})),e.sortedIter=new X(new he(this.iter.toArray().sort(((t,r)=>e._compare(t,r)))),e._unwrap))},_wrap:(e,t)=>({index:t,value:e}),_unwrap:e=>e.value,_getDefaultCompare:e=>(t,r)=>Tt(t,r,e),_compare(e,t){const r=e.index,n=t.index;if(e=e.value,t=t.value,e===t)return r-n;for(let a=0,i=this.rules.length;a<i;a++){const s=this.rules[a],c=s.getter(e),o=s.getter(t),l=(s.compare||this._getDefaultCompare(s.langParams))(c,o);if(l)return s.desc?-l:l}return r-n}}),te=(function(){let e={};const t=s=>V(s,!1,e),r=function(s){if(Ct(s))return(l=>{const h=A(l[0][0]),f=l.reduce(((d,g,p)=>(p%2===0&&d.push(t(g[2])),d)),[]);return d=>{const g=t(h(d));return f.some((p=>i(p)?g===p:g==p))}})(s);const c=[];let o=!1,u=!1;return S(s,(function(){if(Array.isArray(this)||v(this)){if(c.length>1&&o!==u)throw y.Error("E4019");c.push(te(this,e)),o=u,u=!0}else u=St(this)})),function(l){let h=o;for(let f=0;f<c.length;f++)if(c[f](l)!==o){h=!o;break}return h}},n=function(s){var c;return x(s)?(c=e)!==null&&c!==void 0&&c.locale?s.toLocaleString(e.locale):s.toString():""};function a(s,c,o){return function(u){u=t(s(u));let l=i(c)?u===c:u==c;return o&&(l=!l),l}}function i(s){return s===""||s===0||s===!1}return function(s,c){return e=c||{},v(s)?s:Et(s)?r(s):vt(s)?(function(o){const u=o[0],l=te(o[1],e);if(u==="!")return function(h){return!l(h)};throw y.Error("E4003",u)})(s):(function(o){o=gt(o);const u=A(o[0]),l=o[1];let h=o[2];h=t(h);const f=(d,g)=>(d=t(u(d)),(h==null||d==null)&&h!==d?!1:g(d,h));switch(l.toLowerCase()){case"=":return a(u,h);case"<>":return a(u,h,!0);case">":return d=>f(d,((g,p)=>g>p));case"<":return d=>f(d,((g,p)=>g<p));case">=":return d=>f(d,((g,p)=>g>=p));case"<=":return d=>f(d,((g,p)=>g<=p));case"startswith":return d=>t(n(u(d))).startsWith(h);case"endswith":return d=>t(n(u(d))).endsWith(h);case"contains":return d=>t(n(u(d))).includes(h);case"notcontains":return d=>!t(n(u(d))).includes(h)}throw y.Error("E4003",l)})(s)}})(),kt=q.inherit({ctor(e,t){this.callBase(e),this.langParams=e.langParams,this.criteria=te(t,this.langParams)},next(){for(;this.iter.next();)if(this.criteria(this.current()))return!0;return!1}}),Ft=B.inherit({ctor(e,t){this.iter=e,this.getter=t},next(){return this._ensureGrouped(),this.groupedIter.next()},current(){return this._ensureGrouped(),this.groupedIter.current()},reset(){delete this.groupedIter},countable(){return!!this.groupedIter},count(){return this.groupedIter.count()},_ensureGrouped(){if(this.groupedIter)return;const e={},t=[],{iter:r}=this,n=A(this.getter);for(r.reset();r.next();){const a=r.current(),i=n(a);i in e?e[i].push(a):(e[i]=[a],t.push(i))}this.groupedIter=new he(M(t,(a=>({key:a,items:e[a]}))))}}),Ht=q.inherit({ctor(e,t){this.callBase(e),this.getter=A(t)},current(){return this.getter(this.callBase())},countable(){return this.iter.countable()},count(){return this.iter.count()}}),Rt=q.inherit({ctor(e,t,r){this.callBase(e),this.skip=Math.max(0,t),this.take=Math.max(0,r),this.pos=0},next(){if(this.pos>=this.skip+this.take)return!1;for(;this.pos<this.skip&&this.iter.next();)this.pos++;return this.pos++,this.iter.next()},reset(){this.callBase(),this.pos=0},countable(){return this.iter.countable()},count(){return Math.min(this.iter.count()-this.skip,this.take)}}),K=function(e,t){t=t||{},e instanceof B||(e=new he(e)),t.langParams&&(e.langParams=t.langParams);const r=function(o){const u=t.errorHandler;u&&u(o),ue(o)},n=function(o){const u=new m().fail(r);let l;const{step:h}=o,{finalize:f}=o;try{e.reset(),"seed"in o?l=o.seed:l=e.next()?e.current():NaN;let d=l;for(;e.next();)d=h(d,e.current());u.resolve(f?f(d):d)}catch(d){u.reject(d)}return u.promise()},a=function(o){return n(mt[o])},i=function(o){return!v(o)&&!Array.isArray(o)&&(o=[].slice.call(arguments)),c(new Ht(e,o))},s=function(o){return i(A(o))};function c(o){return K(o,t)}return{toArray:()=>e.toArray(),enumerate(){const o=new m().fail(r);try{o.resolve(e.toArray())}catch(u){o.reject(u)}return o.promise()},setLangParams(o){e.langParams=o},sortBy:(o,u,l)=>c(new ee(e,o,u,l)),thenBy(o,u,l){if(e instanceof ee)return c(e.thenBy(o,u,l));throw y.Error("E4004")},filter(o){return Array.isArray(o)||(o=[].slice.call(arguments)),c(new kt(e,o))},slice(o,u){return u===void 0&&(u=Number.MAX_VALUE),c(new Rt(e,o,u))},select:i,groupBy:o=>c(new Ft(e,o)),aggregate:function(o,u,l){return arguments.length<2?n({step:arguments[0]}):n({seed:o,step:u,finalize:l})},count(){if(e.countable()){const o=new m().fail(r);try{o.resolve(e.count())}catch(u){o.reject(u)}return o.promise()}return a("count")},sum(o){return o?s(o).sum():a("sum")},min(o){return o?s(o).min():a("min")},max(o){return o?s(o).max():a("max")},avg(o){return o?s(o).avg():a("avg")}}};function de(e,t){return e=e.groupBy(t[0].selector),t.length>1&&(e=e.select((r=>b({},r,{items:de(K(r.items),t.slice(1)).toArray()})))),e}function We(e,t){const r=[];return S(e,((n,a)=>{it(t,(s=>a.selector===s.selector)).length<1&&r.push(a)})),r.concat(t)}function Mt(e,t,r){var n;t=t||{};const{filter:a}=t;if((n=t)!==null&&n!==void 0&&n.langParams){var i,s;(i=(s=e).setLangParams)===null||i===void 0||i.call(s,t.langParams)}if(a&&(e=e.filter(a)),r)return e;let{sort:c}=t;const{select:o}=t;let{group:u}=t;const{skip:l}=t,{take:h}=t;return u&&(u=Z(u),u.keepInitialKeyOrder=!!t.group.keepInitialKeyOrder),(c||u)&&(c=Z(c||[]),u&&!u.keepInitialKeyOrder&&(c=We(u,c)),S(c,(function(f){e=e[f?"thenBy":"sortBy"](this.selector,this.desc,this.compare)}))),o&&(e=e.select(o)),u&&(e=de(e,u)),(h||l)&&(e=e.slice(l||0,h)),e}const re={multiLevelGroup:de,arrangeSortingInfo:We,queryByOptions:Mt},{abstract:k}=$,{queryByOptions:ye}=re,ne={},C=$.inherit({_langParams:{},ctor(e){const t=this;e=e||{},this._eventsStrategy=new ke(this),S(["onLoaded","onLoading","onInserted","onInserting","onUpdated","onUpdating","onPush","onRemoved","onRemoving","onModified","onModifying"],((r,n)=>{n in e&&t.on(n.slice(2).toLowerCase(),e[n])})),this._key=e.key,this._errorHandler=e.errorHandler,this._useDefaultSearch=!0},_clearCache:_,_customLoadOptions:()=>null,key(){return this._key},keyOf(e){return this._keyGetter||(this._keyGetter=A(this.key())),this._keyGetter(e)},_requireKey(){if(!this.key())throw y.Error("E4005")},load(e){const t=this;return e=e||{},this._eventsStrategy.fireEvent("loading",[e]),this._withLock(this._loadImpl(e)).done((r=>{t._eventsStrategy.fireEvent("loaded",[r,e])}))},_loadImpl(e){return oe(this._langParams)||(e=e||{},e._langParams=N({},this._langParams,e._langParams)),ye(this.createQuery(e),e).enumerate()},_withLock(e){const t=new m;return e.done((function(){const r=this,n=arguments;yt.promise().done((()=>{t.resolveWith(r,n)}))})).fail((function(){t.rejectWith(this,arguments)})),t},createQuery:k,totalCount(e){return this._totalCountImpl(e)},_totalCountImpl(e){return ye(this.createQuery(e),e,!0).count()},byKey(e,t){return this._addFailHandlers(this._withLock(this._byKeyImpl(e,t)))},_byKeyImpl:k,insert(e){const t=this;return t._eventsStrategy.fireEvent("modifying"),t._eventsStrategy.fireEvent("inserting",[e]),t._addFailHandlers(t._insertImpl(e).done(((r,n)=>{t._eventsStrategy.fireEvent("inserted",[r,n]),t._eventsStrategy.fireEvent("modified")})))},_insertImpl:k,update(e,t){const r=this;return r._eventsStrategy.fireEvent("modifying"),r._eventsStrategy.fireEvent("updating",[e,t]),r._addFailHandlers(r._updateImpl(e,t).done((()=>{r._eventsStrategy.fireEvent("updated",[e,t]),r._eventsStrategy.fireEvent("modified")})))},_updateImpl:k,push(e){const t={changes:e,waitFor:[]};this._eventsStrategy.fireEvent("beforePushAggregation",[t]),R(...t.waitFor).done((()=>{this._pushImpl(e),this._eventsStrategy.fireEvent("beforePush",[{changes:e}]),this._eventsStrategy.fireEvent("push",[e])}))},_pushImpl:_,remove(e){const t=this;return t._eventsStrategy.fireEvent("modifying"),t._eventsStrategy.fireEvent("removing",[e]),t._addFailHandlers(t._removeImpl(e).done((r=>{t._eventsStrategy.fireEvent("removed",[r]),t._eventsStrategy.fireEvent("modified")})))},_removeImpl:k,_addFailHandlers(e){return e.fail(this._errorHandler).fail(ue)},on(e,t){return this._eventsStrategy.on(e,t),this},off(e,t){return this._eventsStrategy.off(e,t),this}});C.create=function(e,t){if(!(e in ne))throw y.Error("E4020",e);return new ne[e](t)};C.registerClass=function(e,t){return t&&(ne[t]=e),e};C.inherit=(function(e){return function(t,r){const n=e.apply(this,[t]);return C.registerClass(n,r),n}})(C.inherit);const Ge="totalCount",ae="load",Ne="byKey",Se="insert",ve="update",we="remove";function I(e){return e&&v(e.then)}function L(e){return new m().resolve(e).promise()}function F(e,t){if(!v(t))throw y.Error("E4011",e)}function $e(e){throw y.Error("E4012",e)}function E(e){return function(t){let r;t instanceof Error?r=t:r=new Error((function(n){const a=n[0],i=n[1];return!a||!a.getResponseHeader?null:pt(a,i)})(arguments)||t&&String(t)||"Unknown error"),r.message!==He&&e.reject(r)}}function Qe(e,t){const r=e._loadFunc;let n;return F(ae,r),n=r.apply(e,[t]),Array.isArray(n)?n=L(n):n==null?n=L([]):I(n)||$e(ae),O(n)}function jt(e,t){const r=e._totalCountFunc;let n;if(!v(r))throw y.Error("E4021");return n=r.apply(e,[t]),I(n)||(n=Number(n),isFinite(n)||$e(Ge),n=L(n)),O(n)}function Bt(e,t,r){const n=e._byKeyFunc;let a;return F(Ne,n),a=n.apply(e,[t,r]),I(a)||(a=L(a)),O(a)}function qe(e,t,r,n){if(t.__rawData)n(t.__rawData);else{const a=t.__rawDataPromise||Qe(t,r);t._cacheRawData&&(t.__rawDataPromise=a),a.always((()=>{delete t.__rawDataPromise})).done((i=>{t._cacheRawData&&(t.__rawData=i),n(i)})).fail((i=>{var s;const c=E(e);(s=t._errorHandler)===null||s===void 0||s.call(t,i),c(i)}))}}function Ce(e,t,r,n){r=r||{};const a={};"userData"in r&&(a.userData=r.userData),qe(e,t,a,(i=>{const s=K(i,{errorHandler:t._errorHandler});let c,o;const u=[];let l,h;n||(c=re.queryByOptions(s,r),c===s?l=i.slice(0):u.push(c.enumerate().done((f=>{l=f})))),(r.requireTotalCount||n)&&(o=re.queryByOptions(s,r,!0),o===s?h=i.length:u.push(o.count().done((f=>{h=f})))),R.apply(lt,u).done((()=>{n?e.resolve(h):r.requireTotalCount?e.resolve(l,{totalCount:h}):e.resolve(l)})).fail((f=>{e.reject(f)}))}))}function Kt(e,t,r){qe(e,t,{},(n=>{const a=t.key();let i;for(let s=0,c=n.length;s<c;s++)if(i=n[s],ce(a,t.keyOf(n[s]),r)){e.resolve(i);return}e.reject(y.Error("E4009"))}))}const fe=C.inherit({ctor(e){e=e||{},this.callBase(e),this._useDefaultSearch=!!e.useDefaultSearch||e.loadMode==="raw",this._loadMode=e.loadMode,this._cacheRawData=e.cacheRawData!==!1,this._loadFunc=e[ae],this._totalCountFunc=e[Ge],this._byKeyFunc=e[Ne],this._insertFunc=e[Se],this._updateFunc=e[ve],this._removeFunc=e[we]},_clearCache(){delete this.__rawData},createQuery(){throw y.Error("E4010")},clearRawDataCache(){this._clearCache()},_totalCountImpl(e){let t=new m;return this._loadMode==="raw"&&!this._totalCountFunc?Ce(t,this,e,!0):(jt(this,e).done((r=>{t.resolve(Number(r))})).fail(E(t)),t=this._addFailHandlers(t)),t.promise()},_pushImpl(e){this.__rawData&&le({keyInfo:this,data:this.__rawData,changes:e})},_loadImpl(e){let t=new m;return this._loadMode==="raw"?Ce(t,this,e,!1):(Qe(this,e).done(((r,n)=>{t.resolve(r,n)})).fail(E(t)),t=this._addFailHandlers(t)),t.promise()},_byKeyImpl(e,t){const r=new m;return this._byKeyViaLoad()?(this._requireKey(),Kt(r,this,e)):Bt(this,e,t).done((n=>{r.resolve(n)})).fail(E(r)),r.promise()},_byKeyViaLoad(){return this._loadMode==="raw"&&!this._byKeyFunc},_insertImpl(e){const t=this,r=t._insertFunc;let n;const a=new m;return F(Se,r),n=r.apply(t,[e]),I(n)||(n=L(n)),O(n).done((i=>{W().useLegacyStoreResult?a.resolve(e,i):a.resolve(i||e,t.keyOf(i))})).fail(E(a)),a.promise()},_updateImpl(e,t){const r=this._updateFunc;let n;const a=new m;return F(ve,r),n=r.apply(this,[e,t]),I(n)||(n=L(n)),O(n).done((i=>{W().useLegacyStoreResult?a.resolve(e,t):a.resolve(i||t,e)})).fail(E(a)),a.promise()},_removeImpl(e){const t=this._removeFunc;let r;const n=new m;return F(we,t),r=t.apply(this,[e]),I(r)||(r=L()),O(r).done((()=>{n.resolve(e)})).fail(E(n)),n.promise()}}),Ut={},Xe=function(e,t,r){r=r||[],t=t||{};const n=function(s,c){return{name:s,args:c}},a=function(s){const c=new m;let o,u,l,h,f;const d=function(p){const w=t.errorHandler;w&&w(p),ue(p),c.reject(p)};function g(p){switch(p.name){case"sortBy":return f=[p.args],!0;case"thenBy":if(!f)throw y.Error("E4004");return f.push(p.args),!0}return!1}try{o=t.adapter,v(o)||(o=Ut[o]),u=o(t),l=[].concat(r).concat(s);const{optimize:p}=u;for(p&&p(l);l.length;){if(h=l[0],!g(h)){if(f){l.unshift(n("multiSort",[f])),f=null;continue}if(String(h.name)!=="enumerate"&&(!u[h.name]||u[h.name].apply(u,h.args)===!1))break}l.shift()}(function(){const w=l[0],T=[];w&&w.name==="multiSort"&&(l.shift(),S(w.args[0],(function(){T.push(n(T.length?"thenBy":"sortBy",this))}))),l=T.concat(l)})(),u.exec(e).done(((w,T)=>{if(!l.length)c.resolve(w,T);else{let U=K(w,{errorHandler:t.errorHandler});S(l,(function(){U=U[this.name].apply(U,this.args)})),U.done(c.resolve).fail(c.reject)}})).fail(d)}catch(p){d(p)}return c.promise()},i={};return S(["sortBy","thenBy","filter","slice","select","groupBy"],(function(){const s=String(this);i[s]=function(){return Xe(e,t,r.concat(n(s,arguments)))}})),S(["count","min","max","sum","avg","aggregate","enumerate"],(function(){const s=String(this);i[s]=function(){return a.call(this,n(s,arguments))}})),i},zt={array:K,remote:Xe},Wt=function(){const e=Array.isArray(arguments[0])?"array":"remote";return zt[e].apply(this,arguments)},Gt=C.inherit({ctor(e){Array.isArray(e)?e={data:e}:e=e||{},this.callBase(e);const t=e.data;if(t&&!Array.isArray(t))throw y.Error("E4006");this._array=t||[]},createQuery(){return Wt(this._array,{errorHandler:this._errorHandler})},_byKeyImpl(e){const t=j(this,this._array,e);return t===-1?Re(y.Error("E4009")):D(this._array[t])},_insertImpl(e){return Ue(this,this._array,e)},_pushImpl(e){le({keyInfo:this,data:this._array,changes:e})},_updateImpl(e,t){return Ke(this,this._array,e,t)},_removeImpl(e){return ze(this,this._array,e)},clear(){this._eventsStrategy.fireEvent("modifying"),this._array=[],this._eventsStrategy.fireEvent("modified")}},"array"),Nt=Q(),$t={getXhr:()=>new Nt.XMLHttpRequest},Qt=Te($t),Je=Q(),Ve=function(e){const t=P.createElement("script");for(const r in e)t[r]=e[r];return t},Ye=function(e){return P.getHead().appendChild(e)},Ze=function(e){e.parentNode.removeChild(e)},Ee=function(e){const t=Ve({text:e});Ye(t),Ze(t)},qt=function(e){const t=Ve({src:e});return new Promise(((r,n)=>{const a={load:r,error:n},i=function(s){a[s.type](),Ze(t)};for(const s in a)P.listen(t,s,i);Ye(t)}))};function _e(e){return(e.method||"GET").toUpperCase()}const Xt=function(e){const t=[];for(const r in e){let n=e[r];n!==void 0&&(n===null&&(n=""),typeof n=="function"&&(n=n()),t.push(`${encodeURIComponent(r)}=${encodeURIComponent(n)}`))}return t.join("&")},Jt=function(e){let t;return e.data&&!e.upload&&_e(e)!=="GET"&&(t="application/x-www-form-urlencoded;charset=utf-8"),e.contentType||t},Vt=function(e){const t=e.dataType||"*",r="text/javascript, application/javascript, application/ecmascript, application/x-ecmascript",n={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript",jsonp:r,script:r};return ot(n,e.accepts,!0),n[t]?n[t]+(t!=="*"?", */*; q=0.01":""):n["*"]},Yt=function(e){const t=e.headers||{};return t["Content-Type"]=t["Content-Type"]||Jt(e),t.Accept=t.Accept||Vt(e),!e.crossDomain&&!t["X-Requested-With"]&&(t["X-Requested-With"]="XMLHttpRequest"),t},Zt=function(e){if(e.dataType==="jsonp"){const t=Math.random().toString().replace(/\D/g,""),r=e.jsonpCallback||`dxCallback${Date.now()}_${t}`,n=e.jsonp||"callback";return e.data=e.data||{},e.data[n]=r,r}},er=function(e,t){let r=e.data;const n=typeof r=="string";let a=e.url||Je.location.href;return!n&&!e.cache&&(r=r||{},r._=Date.now()),r&&!e.upload&&(n||(r=Xt(r)),_e(e)==="GET"?(r!==""&&(a+=(a.indexOf("?")>-1?"&":"?")+r),r=null):t["Content-Type"]&&t["Content-Type"].indexOf("application/x-www-form-urlencoded")>-1&&(r=r.replace(/%20/g,"+"))),{url:a,parameters:r}},tr=function(e){if(!ht())return!0;let t=!1;const r=P.createElement("a"),n=P.createElement("a");r.href=Je.location.href;try{n.href=e,n.href=n.href,t=`${r.protocol}//${r.host}`!=`${n.protocol}//${n.host}`}catch{t=!0}return t},rr=Q(),H="success",J="error",nr="timeout",ar="nocontent",sr="parsererror",ir=function(e){return e>=200&&e<300},or=function(e){return e!==204},ur=function(e){return e.responseType&&e.responseType!=="text"||typeof e.responseText!="string"?e.response:e.responseText},cr=function(e,t,r){const n=ur(t);switch(r){case"jsonp":Ee(n);break;case"script":Ee(n),e.resolve(n,H,t);break;case"json":try{e.resolve(JSON.parse(n),H,t)}catch(a){e.reject(t,sr,a)}break;default:e.resolve(n,H,t)}},lr=function(e,t){return e&&setTimeout((function(){t.customStatus=nr,t.abort()}),e)},hr=function(e){const t=Qt.getXhr(),r=new m,n=r.promise(),a=x(e.async)?e.async:!0,{dataType:i}=e,s=e.timeout||0;let c;e.crossDomain=tr(e.url);const o=i==="jsonp"||i==="script";e.cache===void 0&&(e.cache=!o);const u=Zt(e),l=Yt(e),h=er(e,l),{url:f}=h,{parameters:d}=h;if(u&&(rr[u]=function(g){r.resolve(g,H,t)}),e.crossDomain&&o){const g=function(){r.reject(t,J)},p=function(){i!=="jsonp"&&r.resolve(null,H,t)};return qt(f).then(p,g),n}if(e.crossDomain&&!("withCredentials"in t))return r.reject(t,J),n;if(t.open(_e(e),f,a,e.username,e.password),a&&(t.timeout=s,c=lr(s,t)),t.onreadystatechange=function(g){t.readyState===4&&(clearTimeout(c),ir(t.status)?or(t.status)?cr(r,t,i):r.resolve(null,ar,t):r.reject(t,t.customStatus||J))},e.upload&&(t.upload.onprogress=e.upload.onprogress,t.upload.onloadstart=e.upload.onloadstart,t.upload.onabort=e.upload.onabort),e.xhrFields)for(const g in e.xhrFields)t[g]=e.xhrFields[g];e.responseType==="arraybuffer"&&(t.responseType=e.responseType);for(const g in l)Object.prototype.hasOwnProperty.call(l,g)&&x(l[g])&&t.setRequestHeader(g,l[g]);return e.beforeSend&&e.beforeSend(t),t.send(d),n.abort=function(){t.abort()},n},dr=Te({sendRequest:hr}),fr=["items"],et="canceled",Le=e=>e.state()==="pending",xe=e=>{switch(e.length){case 0:return;case 1:return e[0]}return[].slice.call(e)},_r=(e,t,r)=>M(e,(n=>{const a=dt(n,fr);return N({},a,{items:tt(n.items,t-1,r)})})),tt=(e,t,r)=>Array.isArray(e)?t?_r(e,t,r):M(e,r):e,gr=(e,t,r)=>{const n=r?Z(r).length:0;return tt(e,n,t)},pr=(e,t)=>{var r;return(r=e)!==null&&r!==void 0&&r.data&&(t=e,e=e.data),Array.isArray(e)||(e=[e]),{data:e,extra:t}},mr=e=>{const t={};return S(["useDefaultSearch","key","load","loadMode","cacheRawData","byKey","lookup","totalCount","insert","update","remove"],(function(){t[this]=e[this],delete e[this]})),new fe(t)},yr=e=>{const t=e.type;return delete e.type,C.create(t,e)},Sr=(e,t)=>new fe({load:()=>dr.sendRequest({url:e,dataType:"json"}),loadMode:t==null?void 0:t.fromUrlLoadMode}),rt=(e,t)=>{let r;return typeof e=="string"&&(e={paginate:!1,store:Sr(e,t)}),e===void 0&&(e=[]),Array.isArray(e)||e instanceof C?e={store:e}:e=b({},e),e.store===void 0&&(e.store=[]),r=e.store,"load"in e?r=mr(e):Array.isArray(r)?r=new Gt(r):ie(r)&&(r=yr(b({},r))),e.store=r,e};class vr{constructor(){this._counter=-1,this._deferreds={}}add(t){return this._counter++,this._deferreds[this._counter]=t,this._counter}remove(t){return delete this._deferreds[t]}cancel(t){return t in this._deferreds?(this._deferreds[t].reject(et),!0):!1}cancelAll(){for(;this._counter>-1;)this.cancel(this._counter),this._counter--}}function nt(e){let t=[],r=!1;function n(){for(;t.length;){r=!0;const i=t.shift()();if(i!==void 0){if(i.then){R(i).always(n);return}throw Pe.Error("E0015")}}r=!1}return{add:function(a,i){t.push(a),r||n()},busy:function(){return r}}}nt().add;const be=$.inherit({ctor(e){if(e=rt(e),this._eventsStrategy=new ke(this,{syncStrategy:!0}),this._store=e.store,this._changedTime=0,e.pushAggregationTimeout!==0){const r=e.pushAggregationTimeout===void 0?()=>5*this._changedTime:e.pushAggregationTimeout;let n,a;const i=xt((s=>{n.resolve(),R(...a).done((()=>this._onPush(s))),a=void 0,n=void 0}),r);this._onPushHandler=s=>{this._aggregationTimeoutId=i(s.changes),n||(n=new m),a=s.waitFor,s.waitFor.push(n.promise())},this._store.on("beforePushAggregation",this._onPushHandler)}else this._onPushHandler=r=>this._onPush(r),this._store.on("push",this._onPushHandler);this._storeLoadOptions=this._extractLoadOptions(e),this._mapFunc=e.map,this._postProcessFunc=e.postProcess,this._pageIndex=e.pageIndex!==void 0?e.pageIndex:0,this._pageSize=e.pageSize!==void 0?e.pageSize:20,this._loadingCount=0,this._loadQueue=this._createLoadQueue(),this._searchValue="searchValue"in e?e.searchValue:null,this._searchOperation=e.searchOperation||"contains",this._searchExpr=e.searchExpr,this._paginate=e.paginate,this._reshapeOnPush=e.reshapeOnPush??!1,S(["onChanged","onLoadError","onLoadingChanged","onCustomizeLoadResult","onCustomizeStoreLoadOptions"],((r,n)=>{n in e&&this.on(n.substr(2,1).toLowerCase()+n.substr(3),e[n])})),this._operationManager=new vr,this._init()},_init(){this._items=[],this._userData={},this._totalCount=-1,this._isLoaded=!1,x(this._paginate)||(this._paginate=!this.group()),this._isLastPage=!this._paginate},dispose(){var e;this._store.off("beforePushAggregation",this._onPushHandler),this._store.off("push",this._onPushHandler),this._eventsStrategy.dispose(),clearTimeout(this._aggregationTimeoutId),(e=this._delayedLoadTask)===null||e===void 0||e.abort(),this._operationManager.cancelAll(),delete this._store,delete this._items,delete this._delayedLoadTask,this._disposed=!0},_extractLoadOptions(e){const t={};let r=["sort","filter","langParams","select","group","requireTotalCount"];const n=this._store._customLoadOptions();return n&&(r=r.concat(n)),S(r,(function(){t[this]=e[this]})),t},loadOptions(){return this._storeLoadOptions},items(){return this._items},pageIndex(e){if(!me(e))return this._pageIndex;this._pageIndex=e,this._isLastPage=!this._paginate},paginate(e){if(!pe(e))return this._paginate;this._paginate!==e&&(this._paginate=e,this.pageIndex(0))},pageSize(e){if(!me(e))return this._pageSize;this._pageSize=e},isLastPage(){return this._isLastPage},generateStoreLoadOptionAccessor(e){return t=>{const r=xe(t);if(r===void 0)return this._storeLoadOptions[e];this._storeLoadOptions[e]=r}},sort(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.generateStoreLoadOptionAccessor("sort")(t)},filter(){const e=xe(arguments);if(e===void 0)return this._storeLoadOptions.filter;this._storeLoadOptions.filter=e,this.pageIndex(0)},group(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.generateStoreLoadOptionAccessor("group")(t)},select(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.generateStoreLoadOptionAccessor("select")(t)},requireTotalCount(e){if(!pe(e))return this._storeLoadOptions.requireTotalCount;this._storeLoadOptions.requireTotalCount=e},searchValue(e){if(arguments.length<1)return this._searchValue;this._searchValue=e,this.pageIndex(0)},searchOperation(e){if(!Y(e))return this._searchOperation;this._searchOperation=e,this.pageIndex(0)},searchExpr(e){const t=arguments.length;if(t===0)return this._searchExpr;t>1&&(e=[].slice.call(arguments)),this._searchExpr=e,this.pageIndex(0)},store(){return this._store},key(){var e;return(e=this._store)===null||e===void 0?void 0:e.key()},totalCount(){return this._totalCount},isLoaded(){return this._isLoaded},isLoading(){return this._loadingCount>0},beginLoading(){this._changeLoadingCount(1)},endLoading(){this._changeLoadingCount(-1)},_createLoadQueue:()=>nt(),_changeLoadingCount(e){const t=this.isLoading();this._loadingCount+=e;const r=this.isLoading();t^r&&this._eventsStrategy.fireEvent("loadingChanged",[r])},_scheduleLoadCallbacks(e){this.beginLoading(),e.always((()=>{this.endLoading()}))},_scheduleFailCallbacks(e){var t=this;e.fail((function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];n[0]!==et&&t._eventsStrategy.fireEvent("loadError",n)}))},_fireChanged(e){const t=new Date;this._eventsStrategy.fireEvent("changed",e),this._changedTime=new Date-t},_scheduleChangedCallbacks(e){e.done((()=>this._fireChanged()))},loadSingle(e,t){const r=new m,n=this.key(),a=this._store,i=this._createStoreLoadOptions();return this._scheduleFailCallbacks(r),arguments.length<2&&(t=e,e=n),delete i.skip,delete i.group,delete i.refresh,delete i.pageIndex,delete i.searchString,(e===n||a instanceof fe&&!a._byKeyViaLoad()?a.byKey(t,i):(i.take=1,i.filter=i.filter?[i.filter,[e,t]]:[e,t],a.load(i))).fail(r.reject).done((s=>{const c=Array.isArray(s)&&!s.length;!x(s)||c?r.reject(y.Error("E4009")):(Array.isArray(s)||(s=[s]),r.resolve(this._applyMapFunction(s)[0]))})),r.promise()},load(){const e=new m,t=()=>{if(!this._disposed&&Le(e))return this._loadFromStore(r,e)};this._scheduleLoadCallbacks(e),this._scheduleFailCallbacks(e),this._scheduleChangedCallbacks(e);const r=this._createLoadOperation(e);return this._eventsStrategy.fireEvent("customizeStoreLoadOptions",[r]),this._loadQueue.add((()=>(typeof r.delay=="number"?this._delayedLoadTask=ut.executeAsync(t,r.delay):t(),e.promise()))),e.promise({operationId:r.operationId})},_onPush(e){if(this._reshapeOnPush)this.load();else{const t={changes:e};this._eventsStrategy.fireEvent("changing",[t]);const r=this.group(),n=this.items();let a=0,i=this.paginate()||r?e.filter((s=>s.type==="update")):e;r&&(a=Array.isArray(r)?r.length:1),this._mapFunc&&i.forEach((s=>{s.type==="insert"&&(s.data=this._mapFunc(s.data))})),t.postProcessChanges&&(i=t.postProcessChanges(i)),le({keyInfo:this.store(),data:n,changes:i,groupCount:a,useInsertIndex:!0}),this._fireChanged([{changes:e}])}},_createLoadOperation(e){const t=this._operationManager.add(e),r=this._createStoreLoadOptions();return this._store&&!oe(r==null?void 0:r.langParams)&&(this._store._langParams=N({},this._store._langParams,r.langParams)),e.always((()=>this._operationManager.remove(t))),{operationId:t,storeLoadOptions:r}},reload(){return this.store()._clearCache(),this._init(),this.load()},cancel(e){return this._operationManager.cancel(e)},cancelAll(){return this._operationManager.cancelAll()},_addSearchOptions(e){this._disposed||(this.store()._useDefaultSearch?this._addSearchFilter(e):(e.searchOperation=this._searchOperation,e.searchValue=this._searchValue,e.searchExpr=this._searchExpr))},_createStoreLoadOptions(){const e=b({},this._storeLoadOptions);return this._addSearchOptions(e),this._paginate&&this._pageSize&&(e.skip=this._pageIndex*this._pageSize,e.take=this._pageSize),e.userData=this._userData,e},_addSearchFilter(e){const t=this._searchValue,r=this._searchOperation;let n=this._searchExpr;const a=[];t&&(n||(n="this"),Array.isArray(n)||(n=[n]),S(n,((i,s)=>{a.length&&a.push("or"),a.push([s,r,t])})),e.filter?e.filter=[a,e.filter]:e.filter=a)},_loadFromStore(e,t){const r=(n,a)=>{if(this._disposed||!Le(t))return;const i=b(pr(n,a),e);this._eventsStrategy.fireEvent("customizeLoadResult",[i]),R(i.data).done((s=>{i.data=s,this._processStoreLoadResult(i,t)})).fail(t.reject)};return e.data?new m().resolve(e.data).done(r):this.store().load(e.storeLoadOptions).done(r).fail(t.reject)},_processStoreLoadResult(e,t){let{data:r}=e,{extra:n}=e;const{storeLoadOptions:a}=e,i=()=>(this._isLoaded=!0,this._totalCount=isFinite(n.totalCount)?n.totalCount:-1,t.resolve(r,n)),s=()=>{this.store().totalCount(a).done((c=>{n.totalCount=c,i()})).fail(t.reject)};this._disposed||(r=this._applyPostProcessFunction(this._applyMapFunction(r)),z(n)||(n={}),this._items=r,(!r.length||!this._paginate||this._pageSize&&r.length<this._pageSize)&&(this._isLastPage=!0),a.requireTotalCount&&!isFinite(n.totalCount)?s():i())},_applyMapFunction(e){return this._mapFunc?gr(e,this._mapFunc,this.group()):e},_applyPostProcessFunction(e){return this._postProcessFunc?this._postProcessFunc(e):e},on(e,t){return this._eventsStrategy.on(e,t),this},off(e,t){return this._eventsStrategy.off(e,t),this}}),wr={load:()=>m().reject(),loadSingle:()=>m().reject(),loadFromStore:()=>m().reject(),loadNextPage:()=>m().reject(),loadOptions:_,userData:_,cancel:_,cancelAll:_,filter:_,addSearchFilter:_,group:_,paginate:_,pageSize:_,pageIndex:_,resetDataSourcePageIndex:_,totalCount:_,isLastPage:_,isLoading:_,isLoaded:_,searchValue:_,searchOperation:_,searchExpr:_,select:_,key:_,keyOf:_,store:_,items:_,applyMapFunction:_,getDataSource:_,reload:_,on:_,off:_};class Cr{constructor(t){if(!t)return wr;this._dataSource=t}load(){return this._dataSource.load()}loadSingle(t,r){return arguments.length<2&&(r=t,t=this.key()),this._dataSource.loadSingle(t,r)}loadFromStore(t){return this.store().load(t)}loadNextPage(){return this.pageIndex(1+this.pageIndex()),this.load()}loadOptions(){return this._dataSource.loadOptions()}userData(){return this._dataSource._userData}cancel(t){this._dataSource.cancel(t)}cancelAll(){this._dataSource.cancelAll()}filter(t){return this._dataSource.filter(t)}addSearchFilter(t){this._dataSource._addSearchFilter(t)}group(t){return this._dataSource.group(t)}paginate(){return this._dataSource.paginate()}pageSize(){return this._dataSource._pageSize}pageIndex(t){return this._dataSource.pageIndex(t)}resetDataSourcePageIndex(){this.pageIndex()&&(this.pageIndex(0),this.load())}totalCount(){return this._dataSource.totalCount()}isLastPage(){return this._dataSource.isLastPage()||!this._dataSource._pageSize}isLoading(){return this._dataSource.isLoading()}isLoaded(){return this._dataSource.isLoaded()}searchValue(t){return arguments.length?this._dataSource.searchValue(t):this._dataSource.searchValue()}searchOperation(t){return this._dataSource.searchOperation(t)}searchExpr(t){return arguments.length?this._dataSource.searchExpr(t):this._dataSource.searchExpr()}select(){return this._dataSource.select(...arguments)}key(){return this._dataSource.key()}keyOf(t){return this.store().keyOf(t)}store(){return this._dataSource.store()}items(){return this._dataSource.items()}applyMapFunction(t){return this._dataSource._applyMapFunction(t)}getDataSource(){return this._dataSource||null}reload(){return this._dataSource.reload()}on(t,r){this._dataSource.on(t,r)}off(t,r){this._dataSource.off(t,r)}}const Ae="_dataSourceChangedHandler",Oe="_getSpecificDataSourceOption",De="_normalizeDataSource",Ar={postCtor(){this.on("disposing",(()=>{this._disposeDataSource()}))},_refreshDataSource(){this._initDataSource(),this._loadDataSource()},_initDataSource(){let e=Oe in this?this[Oe]():this.option("dataSource"),t,r;this._disposeDataSource(),e&&(e instanceof be?(this._isSharedDataSource=!0,this._dataSource=e):(t="_dataSourceOptions"in this?this._dataSourceOptions():{},r=this._dataSourceType?this._dataSourceType():be,e=rt(e,{fromUrlLoadMode:"_dataSourceFromUrlLoadMode"in this&&this._dataSourceFromUrlLoadMode()}),this._dataSource=new r(b(!0,{},t,e))),De in this&&(this._dataSource=this[De](this._dataSource)),this._addDataSourceHandlers(),this._initDataController())},_initDataController(){var e;const t=(e=this.option)===null||e===void 0?void 0:e.call(this,"_dataController"),r=this._dataSource;t?this._dataController=t:this._dataController=new Cr(r)},_addDataSourceHandlers(){Ae in this&&this._addDataSourceChangeHandler(),"_dataSourceLoadErrorHandler"in this&&this._addDataSourceLoadErrorHandler(),"_dataSourceLoadingChangedHandler"in this&&this._addDataSourceLoadingChangedHandler(),this._addReadyWatcher()},_addReadyWatcher(){this.readyWatcher=(function(e){this._ready&&this._ready(!e)}).bind(this),this._dataSource.on("loadingChanged",this.readyWatcher)},_addDataSourceChangeHandler(){const e=this._dataSource;this._proxiedDataSourceChangedHandler=(function(t){this[Ae](e.items(),t)}).bind(this),e.on("changed",this._proxiedDataSourceChangedHandler)},_addDataSourceLoadErrorHandler(){this._proxiedDataSourceLoadErrorHandler=this._dataSourceLoadErrorHandler.bind(this),this._dataSource.on("loadError",this._proxiedDataSourceLoadErrorHandler)},_addDataSourceLoadingChangedHandler(){this._proxiedDataSourceLoadingChangedHandler=this._dataSourceLoadingChangedHandler.bind(this),this._dataSource.on("loadingChanged",this._proxiedDataSourceLoadingChangedHandler)},_loadDataSource(){const e=this._dataSource;e&&(e.isLoaded()?this._proxiedDataSourceChangedHandler&&this._proxiedDataSourceChangedHandler():e.load())},_loadSingle(e,t){return e=e==="this"?this._dataSource.key()||"this":e,this._dataSource.loadSingle(e,t)},_isLastPage(){return!this._dataSource||this._dataSource.isLastPage()||!this._dataSource._pageSize},_isDataSourceLoading(){return this._dataSource&&this._dataSource.isLoading()},_disposeDataSource(){this._dataSource&&(this._isSharedDataSource?(delete this._isSharedDataSource,this._proxiedDataSourceChangedHandler&&this._dataSource.off("changed",this._proxiedDataSourceChangedHandler),this._proxiedDataSourceLoadErrorHandler&&this._dataSource.off("loadError",this._proxiedDataSourceLoadErrorHandler),this._proxiedDataSourceLoadingChangedHandler&&this._dataSource.off("loadingChanged",this._proxiedDataSourceLoadingChangedHandler),this._dataSource._eventsStrategy&&this._dataSource._eventsStrategy.off("loadingChanged",this.readyWatcher)):this._dataSource.dispose(),delete this._dataSource,delete this._proxiedDataSourceChangedHandler,delete this._proxiedDataSourceLoadErrorHandler,delete this._proxiedDataSourceLoadingChangedHandler)},getDataSource(){return this._dataSource||null}},Ie=Fe.getWindow(),Er={observe:_,unobserve:_,disconnect:_};class Lr{constructor(){if(!Fe.hasWindow()||!Ie.ResizeObserver)return Er;this._callbacksMap=new Map,this._observer=new Ie.ResizeObserver((t=>{t.forEach((r=>{var n;(n=this._callbacksMap.get(r.target))===null||n===void 0||n(r)}))}))}observe(t,r){this._callbacksMap.set(t,r),this._observer.observe(t)}unobserve(t){this._callbacksMap.delete(t),this._observer.unobserve(t)}disconnect(){this._callbacksMap.clear(),this._observer.disconnect()}}const Or=new Lr;export{dr as A,fe as C,Ar as D,C as S,He as X,mt as a,be as b,rt as c,Gt as d,y as e,pr as f,pt as g,Ut as h,vt as i,St as j,ce as k,gt as l,ue as m,Z as n,j as o,Ue as p,Wt as q,Or as r,re as s,Cr as t,Ke as u,le as v,Pt as w};
