import{d as q,r as o,aO as E,A as W,g as b,f as n,b as e,e as s,u as t,aI as $,o as T}from"./main-CqlTUwGQ.js";import{s as H,D as l,f as L,g as j,h as J,i as Q,j as X,k as Z,d as ee,l as te,m as ae,n as ie,o as le,p as re,b as ne,q as oe,r as se,t as ue}from"./data-grid-Cmz8SCuy.js";import{D as k}from"./button-CoI-8Wb4.js";import{D as de}from"./load-panel-BeY_OYvY.js";import{e as me}from"./export_data_grid-CUoBJwEE.js";import"./overlay-BhkxhbzC.js";import"./m_select_box-CBeGJAQ-.js";import"./m_row_dragging-D1DCBETe.js";import{D as u}from"./tabs-37iYDmlW.js";import{e as pe}from"./exceljs.min-BDOJy6OX.js";import{s as ce}from"./FileSaver-CQu8bA20.js";import{D as fe}from"./context-menu-BMdnx0Im.js";import{u as ve}from"./pageTitle-CJ7lSIa6.js";import{D as C}from"./date-box-CeivVpPy.js";import{V as he}from"./VCard-DNsCm0Sx.js";import{V as ge}from"./VCol-DSRh1xkA.js";import{V as ye}from"./VCardText-CFL57jaN.js";import"./editor-C7QDOJBp.js";import"./themes-ZcQ-fVem.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./VAvatar-BoW3ra5F.js";import"./VImg-DOH9OiQI.js";/* empty css              */const xe={id:"liste",style:{"margin-block-end":"10px","margin-top":"-10px"}},we={style:{"margin-top":"-10px"}},De={style:{"margin-top":"-10px","margin-left":"5px"}},He=q({__name:"satinalma-talepler",setup(be){const P=ve(),p=o(!1),g=o([]);o([]),o("");const z=o(Date.now()),y=E("userData"),c=o(null);o(null),o(!1);const d=new Date,x=new Date(d);x.setDate(d.getDate()-d.getDay()+1);const w=new Date(d);w.setDate(d.getDate()-d.getDay()+7);const f=o([x,w]),v=o(x),h=o(w),A=o(null),D=o(!0);document.title="OFT - Talepler";const Y=async()=>{D.value=!1,g.value=[],await _()},F=async()=>{D.value=!0,g.value=[],await _()},_=async()=>{f.value=[v.value,h.value],f.value[0]&&(v.value=new Date(f.value[0])),f.value[1]&&(h.value=new Date(f.value[1])),p.value=!0;try{const a=await $.get("/api/satinalma-talepleri",{params:{filterValue:v.value,filterValue1:h.value,itemID:null,firma:null,tarihAralik:D.value}});g.value=a.data.talepler}catch(a){console.error("Veri çekilirken hata oluştu: ",a)}finally{p.value=!1}};W(async()=>{P.setTitle("Satınalma Talepleri"),S(),R()});const S=()=>{var i;const a=localStorage.getItem(`${y.value.id}_satinalmatlp`);a&&((i=c.value)==null||i.instance.state(JSON.parse(a)))},I=()=>{var i;const a=(i=c.value)==null?void 0:i.instance.state();localStorage.setItem(`${y.value.id}_satinalmatlp`,JSON.stringify(a))},O=()=>{localStorage.removeItem(`${y.value.id}_satinalmatlp`),c.value.instance.state(null)},R=()=>{const a=new Date,i=a.getFullYear()%100,r=new Date(a.getFullYear(),0,4),m=new Date(r);m.setDate(r.getDate()-(r.getDay()+6)%7);const G=Math.floor((a.getTime()-m.getTime())/864e5),N=Math.floor(G/7)+1;return`${i}-${N.toString().padStart(2,"0")}`},V=()=>{var a;(a=c.value)==null||a.instance.clearFilter()},U=a=>{if(a.rowIndex===-1)return;const i=a.row.data;A.value=i},B=a=>{const i=new pe.Workbook,r=i.addWorksheet("SatinalmaTalepleri");me({component:a.component,worksheet:r,autoFilterEnabled:!0}).then(()=>{i.xlsx.writeBuffer().then(m=>{ce(new Blob([m],{type:"application/octet-stream"}),"SatinalmaTalepleri.xlsx")})}),a.cancel=!0},K=[{text:"Düzen Yükle"},{text:"Düzen Kaydet"},{text:"Düzen Sıfırla"}];function M({itemData:a}){if(!(a!=null&&a.items))switch(a==null?void 0:a.text){case"Düzen Yükle":S();break;case"Düzen Kaydet":I();break;case"Düzen Sıfırla":O();break}}return(a,i)=>(T(),b(he,{class:"mt-0 pa-0"},{default:n(()=>[e(ye,{class:"mt-0 pa-2"},{default:n(()=>[e(ge,{cols:"12",class:"mt-2 pa-1 pe-2 pt-0"},{default:n(()=>[s("div",xe,[e(t(fe),{"data-source":K,width:200,target:"#grid",onItemClick:M}),(T(),b(t(H),{id:"grid",ref_key:"dataGridRef",ref:c,key:z.value,class:"grid","data-source":g.value,"key-expr":"talep_no","show-borders":!0,"focused-row-enabled":"true","row-alternation-enabled":"true","min-width":200,"allow-column-reordering":"true","column-auto-width":"true","allow-column-resizing":"true",onContextMenuPreparing:U,"column-resizing-mode":"widget","auto-navigate-to-focused-row":!0,width:"100%",onExporting:B},{filtreTarih1:n(()=>[s("div",we,[e(t(C),{label:"Başlangıç Tarihi",width:"150","label-mode":"floating",value:v.value,"onUpdate:value":i[1]||(i[1]=r=>v.value=r),type:"date"},null,8,["value"])])]),filtreTarih2:n(()=>[s("div",De,[e(t(C),{label:"Bitiş Tarihi",width:"150","label-mode":"floating",value:h.value,"onUpdate:value":i[2]||(i[2]=r=>h.value=r),type:"date"},null,8,["value"])])]),filtreTemizleTemplate:n(()=>[e(t(k),{id:"filtretemizle",icon:"notequal","styling-mode":"text",hint:"Filtre Temizle"})]),menuFiltreTemizleTemplate:n(()=>i[3]||(i[3]=[s("div",{style:{display:"flex","align-items":"center","margin-inline-start":"13px"}},[s("i",{class:"dx-icon dx-icon-notequal"}),s("span",{style:{"margin-inline-start":"8px"}},"Filtre Temizle")],-1)])),tumu:n(()=>[e(t(k),{id:"sayim",icon:"refresh",text:"Tümü","styling-mode":"text",hint:"Tümünü Yenile"})]),menuYenileTumuTemplate:n(()=>i[4]||(i[4]=[s("div",{style:{display:"flex","align-items":"center","margin-inline-start":"13px"}},[s("i",{class:"dx-icon dx-icon-refresh"}),s("span",{style:{"margin-inline-start":"8px"}},"Tümü")],-1)])),tarih:n(()=>[e(t(k),{id:"sayim",icon:"refresh",text:"Tarih","styling-mode":"text",hint:"Tarih Aralığını Yenile"})]),menuYenileTarihTemplate:n(()=>i[5]||(i[5]=[s("div",{style:{display:"flex","align-items":"center","margin-inline-start":"13px"}},[s("i",{class:"dx-icon dx-icon-refresh"}),s("span",{style:{"margin-inline-start":"8px"}},"Tarih")],-1)])),default:n(()=>[e(t(l),{"data-field":"talep_tarihi",caption:"TALEP TARİHİ","data-type":"date",width:150,visible:!0,format:{formatter:r=>new Intl.DateTimeFormat("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(r)).replace(/\//g,".")},alignment:"center"},null,8,["format"]),e(t(l),{"data-field":"onay_tarihi",caption:"ONAY TARİHİ","data-type":"date",width:150,visible:!0,format:{formatter:r=>new Intl.DateTimeFormat("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(r)).replace(/\//g,".")},alignment:"center"},null,8,["format"]),e(t(l),{"data-field":"talep_no",caption:"TALEP NO",visible:!0,width:120}),e(t(l),{"data-field":"durumu",caption:"DURUMU",visible:!0,width:100}),e(t(l),{"data-field":"ONAY_DURUMU",caption:"ONAY DURUMU",visible:!0,width:120}),e(t(l),{"data-field":"kaynak",caption:"KAYNAK",visible:!0,width:150}),e(t(l),{"data-field":"tipi",caption:"TİPİ",visible:!0,width:90}),e(t(l),{"data-field":"item_id",caption:"STOK ID",visible:!0,width:90}),e(t(l),{"data-field":"item_code",caption:"STOK KODU",visible:!0,width:130}),e(t(l),{"data-field":"item_name",caption:"STOK ADI",visible:!0,width:280}),e(t(l),{"data-field":"miktar",caption:"MİKTAR","data-type":"number",visible:!0,width:100,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),e(t(l),{"data-field":"qty_ordered","data-type":"number",visible:!0,width:100,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),e(t(l),{"data-field":"qty_free_prm","data-type":"number",visible:!0,width:100,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),e(t(l),{"data-field":"qty_free_sec","data-type":"number",visible:!0,width:100,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),e(t(l),{"data-field":"co_id","data-type":"number",visible:!0,width:100,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),e(t(l),{"data-field":"branch_id","data-type":"number",visible:!0,width:100,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),e(t(l),{"data-field":"note_1",visible:!0,width:150}),e(t(l),{"data-field":"note_2",visible:!0,width:150}),e(t(l),{"data-field":"item_line_type","data-type":"number",visible:!0,width:150}),e(t(l),{"data-field":"psm_request_status","data-type":"number",visible:!0,width:150}),e(t(l),{"data-field":"request_status","data-type":"number",visible:!0,width:150}),(T(),b(t(de),{key:p.value,visible:p.value,"onUpdate:visible":i[0]||(i[0]=r=>p.value=r),"show-indicator":!0,"show-pane":!0,shading:!0},null,8,["visible"])),e(t(L),{"auto-expand-all":!1}),e(t(j),{visible:!0}),e(t(J),{visible:!0}),e(t(Q),{visible:!0}),e(t(X),{visible:!0}),e(t(Z),{visible:!0,width:240}),e(t(ee),{mode:"virtual","row-rendering-mode":"virtual","show-scrollbar":"always"}),e(t(te),{mode:"multiple"}),e(t(ae),{enabled:!0,"allow-export-selected-data":!1}),e(t(ie),{height:"540px",enabled:!0,mode:"select",position:a.position},{default:n(()=>[e(t(le),{enabled:!0}),e(t(re),{"allow-select-all":!0,"select-by-click":!0,recursive:!0})]),_:1},8,["position"]),e(t(ne),null,{default:n(()=>[e(t(u),{name:"groupPanel"}),e(t(u),{location:"before","locate-in-menu":"auto",template:"filtreTarih1"}),e(t(u),{location:"before","locate-in-menu":"auto",template:"filtreTarih2"}),e(t(u),{location:"before","locate-in-menu":"auto",template:"tarih","menu-item-template":"menuYenileTarihTemplate",onClick:F}),e(t(u),{location:"before","locate-in-menu":"auto",template:"tumu","menu-item-template":"menuYenileTumuTemplate",onClick:Y}),e(t(u),{location:"after","locate-in-menu":"auto",template:"filtreTemizleTemplate","menu-item-template":"menuFiltreTemizleTemplate",onClick:V}),e(t(u),{name:"exportButton"}),e(t(u),{name:"columnChooserButton"}),e(t(u),{name:"searchPanel"})]),_:1}),e(t(oe),null,{default:n(()=>[e(t(se),{"align-by-column":!0,column:"talep_tarihi","summary-type":"count","display-format":"{0} adet",alignment:a.right},null,8,["alignment"]),e(t(ue),{"align-by-column":!0,column:"talep_tarihi","summary-type":"count","display-format":"{0} adet",alignment:a.right},null,8,["alignment"])]),_:1})]),_:1},8,["data-source"]))])]),_:1})]),_:1})]),_:1}))}});export{He as default};
