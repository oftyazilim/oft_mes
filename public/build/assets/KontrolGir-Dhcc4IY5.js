import{d as $,r,w as p,aO as h,c as x,e as c,b as t,f as o,F as K,aB as f,aJ as _,cT as P,u as q,au as w,k as E,g as J,L as M,aI as Y,aG as O,o as V}from"./main-DLeLKEij.js";import{n as Q}from"./notify-m4ME_Kwe.js";import{D as W}from"./select-box-By2htrww.js";import{A as X}from"./m_select_box-B9XSJ0vr.js";import{V as Z}from"./VDialog-BlyT5Ge-.js";import{V as aa}from"./VSnackbar-DmkzbAz1.js";import{V as ea,a as la,b as ta}from"./VCard-ABx9d_cO.js";import{V as oa}from"./VCardText-DckZSBjl.js";import{V as ra}from"./VForm-C3BZXVRX.js";import{V as sa}from"./VTextField-DDnIyPxi.js";import{V as U}from"./VRow-DabaMRd8.js";import{V as v}from"./VCol-BuS0yzHQ.js";import{V as ia}from"./VContainer-S8_DlotP.js";import{V as ma}from"./VCheckbox-CW99T4L9.js";import{V as da}from"./VTextarea-Bs3cTMgv.js";import{V as ua}from"./VSpacer-SaskTADA.js";import"./overlay-DTXI7SlJ.js";import"./themes-Cj6FTPfL.js";import"./editor-Bx-bcRjD.js";import"./VOverlay-Dbl89MvW.js";import"./easing-Bybner-F.js";import"./delay-ClPeLXiv.js";import"./lazy-DizLGb_a.js";import"./scopeId-BX7MnZ_t.js";import"./VImg-BB7B8OBY.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-BE1MQFWG.js";import"./VAvatar-C72jTTSV.js";import"./form-BCPNlXEK.js";/* empty css                   */import"./VCounter-HBlSCLo7.js";import"./VField-BbMN95BA.js";import"./focus-DfnPVW2s.js";import"./VInput-DeTq0vk_.js";/* empty css              */import"./VCheckboxBtn-CiMpGuSe.js";import"./VSelectionControl-B5yV0Rmk.js";const Ja=$({__name:"KontrolGir",props:{modelValue:Boolean,masterId:Number},emits:["update:modelValue"],setup(A,{emit:R}){const S=r(),y=A,D=R,B=r(!1),F=r(""),C=r(),H=r(!1),u=r(""),n=r(""),k=r(""),m=r(y.modelValue);p(()=>y.modelValue,l=>m.value=l),p(m,l=>D("update:modelValue",l));const g=[{title:"✔️ Onaylandı",value:"Onaylandı",color:"#d4edda"},{title:"❌ Red",value:"Red",color:"#f8d7da"},{title:"⚠️ Şartlı Onay",value:"Şartlı Onay",color:"#fff3cd"}];new X({data:g,key:"value"});const j=()=>{O(()=>{var l;(l=S.value)==null||l.focus()})};p(m,l=>{l&&j()});const d=r({}),N=h("userData"),T=[{baslik:"İş Emri Hataları",hatalar:[{kod:"IEH",aciklama:"İş Emri Hatası"},{kod:"SPH",aciklama:"Sipariş Hatası"},{kod:"TH",aciklama:"Taşeron Hatası"},{kod:"EH",aciklama:"Etiket Hatası"}]},{baslik:"Malzeme Hataları",hatalar:[{kod:"CM",aciklama:"Çapaklı Malzeme"},{kod:"SMH",aciklama:"Saç Malzeme Hatası"},{kod:"KH",aciklama:"Kilit Hatası"},{kod:"FB",aciklama:"Formda Bozukluk"},{kod:"CC",aciklama:"Camda Çizik"},{kod:"OH",aciklama:"Ölçüsel Hata"},{kod:"19''H",aciklama:"19'' Ölçü Hatası"},{kod:"AH",aciklama:"Aksesuar Hatası"},{kod:"KPL",aciklama:"Kaplama Hatası"}]},{baslik:"Montaj Hataları",hatalar:[{kod:"MH",aciklama:"Montaj Hatası"},{kod:"TKH",aciklama:"Topraklama Hatası"},{kod:"KAH",aciklama:"Kaynak Hatası"},{kod:"BKE",aciklama:"Bağlantı Kalemi Eksik"},{kod:"BKS",aciklama:"Bağlantı Kalemi Sıkılmamış"},{kod:"ELK",aciklama:"Elektrik Hatası"},{kod:"STH",aciklama:"Su Testi Hatası"}]},{baslik:"Yüzey / Boya Hataları",hatalar:[{kod:"BC",aciklama:"Boyada Çizik"},{kod:"BH",aciklama:"Boya Hatası"},{kod:"SH",aciklama:"Serigrafi Hatası"}]}];p(d,()=>{const l=Object.entries(d.value).filter(([a,e])=>e).map(([a])=>{const e=T.flatMap(s=>s.hatalar).find(s=>s.kod===a);return e?`${a}: ${e.aciklama}`:a});k.value=l.join(", ")},{deep:!0});const G=async()=>{var l,a;try{const e=Object.entries(d.value).filter(([i,b])=>b).map(([i])=>i),s={serino:u.value,hatalar:e,sonuc:n.value,urun_kontrol_m_id:y.masterId,user_id:N.value.id};await Y.post("/api/hata-kaydet",s),Q({message:"Kayıt başarılı!",type:"success",displayTime:2e3}),z()}catch(e){console.error(e),(a=(l=e.response)==null?void 0:l.data)!=null&&a.message?alert(e.response.data.message):alert("Kayıt sırasında hata oluştu.")}},z=()=>{var l;(l=C.value)==null||l.reset(),u.value="",n.value=!1,k.value="",d.value={},m.value=!1},I=()=>{O(()=>{const l=document.querySelector('input[type="checkbox"]');l==null||l.focus()})};return(l,a)=>(V(),x(K,null,[c("div",null,[t(Z,{modelValue:m.value,"onUpdate:modelValue":a[5]||(a[5]=e=>m.value=e),"max-width":"1000px",persistent:""},{default:o(()=>[t(ea,null,{default:o(()=>[t(la,{class:"text-h6"},{default:o(()=>a[7]||(a[7]=[f("Hata Girişi Ekranı")])),_:1,__:[7]}),t(oa,{class:"pt-4"},{default:o(()=>[t(ra,{ref_key:"formRef",ref:C,modelValue:H.value,"onUpdate:modelValue":a[1]||(a[1]=e=>H.value=e),"lazy-validation":"",onSubmit:a[2]||(a[2]=_(()=>{},["prevent"]))},{default:o(()=>[t(sa,{ref_key:"serinoRef",ref:S,modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),label:"Seri No",variant:"outlined",rules:[e=>!!e||"Seri no zorunlu"],class:"mb-4",onKeydown:P(_(I,["prevent"]),["enter"])},null,8,["modelValue","rules","onKeydown"])]),_:1},8,["modelValue"]),t(U,{dense:""},{default:o(()=>[t(v,{cols:"6",class:"d-flex pa-1 pb-2"}),t(v,{cols:"6",class:"d-flex pa-1 pe-2 pb-3"},{default:o(()=>[t(q(W),{"data-source":g,value:n.value,"display-expr":"title","value-expr":"value",onValueChanged:a[3]||(a[3]=e=>n.value=e.value),height:37},null,8,["value"])]),_:1})]),_:1}),a[8]||(a[8]=c("hr",null,null,-1)),t(ia,null,{default:o(()=>[(V(),x(K,null,w(T,(e,s)=>t(U,{key:s},{default:o(()=>[t(v,{cols:"12"},{default:o(()=>[c("strong",null,E(e.baslik),1)]),_:2},1024),(V(!0),x(K,null,w(e.hatalar,(i,b)=>(V(),J(v,{key:b,cols:"12",sm:"6",md:"4",class:"py-0 my-0"},{default:o(()=>[t(ma,{modelValue:d.value[i.kod],"onUpdate:modelValue":L=>d.value[i.kod]=L,label:`${i.kod}: ${i.aciklama}`,density:"compact","hide-details":"",class:"py-0 my-0"},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024))),128))]),_:2},1024)),64))]),_:1}),a[9]||(a[9]=c("hr",null,null,-1)),t(da,{label:"Hata Özeti",modelValue:k.value,"onUpdate:modelValue":a[4]||(a[4]=e=>k.value=e),"auto-grow":"",readonly:"",class:"mt-4",variant:"outlined"},null,8,["modelValue"])]),_:1,__:[8,9]}),t(ta,null,{default:o(()=>[t(ua),t(M,{text:"",onClick:z},{default:o(()=>a[10]||(a[10]=[f("Vazgeç")])),_:1,__:[10]}),t(M,{disabled:!H.value,color:"primary",onClick:G},{default:o(()=>a[11]||(a[11]=[f("Kaydet")])),_:1,__:[11]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(aa,{modelValue:B.value,"onUpdate:modelValue":a[6]||(a[6]=e=>B.value=e),timeout:3e3,color:"success",location:"top right"},{default:o(()=>[f(E(F.value),1)]),_:1},8,["modelValue"])],64))}});export{Ja as default};
