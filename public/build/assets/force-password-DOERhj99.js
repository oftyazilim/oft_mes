import{d as T,aN as z,r as u,c as h,o as D,b as s,f as r,aF as d,l as a,T as V,p as F,F as N,s as y,q as f}from"./main-Dda-fDvo.js";import{V as R}from"./VCol-B4SanIbp.js";import{V as A,a as B,b as S}from"./VCard-RYBfV1Ap.js";import{V as g}from"./VCardText-BRuZaizK.js";import{V as b}from"./VTextField-DTHpuueB.js";import{V as U}from"./VRow-BHNh141H.js";import{V as Y}from"./VSnackbar-CBuTLa9-.js";/* empty css              */import"./createSimpleFunctional-Bf_IxksE.js";import"./VAvatar-Cn7oPB-D.js";import"./VImg-DDu0J3_3.js";import"./index-CqfbI18D.js";/* empty css                   */import"./VCounter-c9_CpaaQ.js";import"./VField-BIM8Dlhg.js";import"./focus-Co--6TMv.js";import"./easing-Bybner-F.js";import"./VInput-DJuArRhD.js";import"./form-CjACqVE8.js";import"./forwardRefs-C-GTDzx5.js";import"./VOverlay-DnGchtUq.js";import"./delay-BI8n2osi.js";import"./lazy-DMA3tl_N.js";import"./scopeId-Bz0Ui0Om.js";const ie=T({__name:"force-password",setup(j){const c=z(),n=u(!1),l=u({current_password:"halapass1234",password:"",password_confirmation:""}),p=u(!1),m=u(!1),i=u({show:!1,color:"info",text:"Lütfen şifrenizi değiştirin."}),w=o=>!!o||"Zorunlu alan",x=o=>((o==null?void 0:o.length)??0)>=8||"En az 8 karakter",v=o=>o===l.value.password||"Şifreler uyuşmuyor",k=async()=>{var o,e;if(!(!l.value.password||l.value.password!==l.value.password_confirmation))try{n.value=!0,await y.post("/api/auth/change-password",l.value),i.value={show:!0,color:"success",text:"Şifre güncellendi, girişe yönlendiriliyorsunuz."},setTimeout(()=>c.push("/login"),900)}catch(t){const _=((e=(o=t==null?void 0:t.response)==null?void 0:o.data)==null?void 0:e.message)||"İşlem sırasında hata oluştu";i.value={show:!0,color:"error",text:String(_)}}finally{n.value=!1}},C=async()=>{try{await y.get("/api/auth/logout")}catch{}const o=f("accessToken");o.value=null;const e=f("userData");e.value=null;const t=f("userAbilityRules");t.value=null,c.push("/login")};return(o,e)=>(D(),h(N,null,[s(U,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:r(()=>[s(R,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center mx-auto"},{default:r(()=>[s(A,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:r(()=>[s(B,{class:"text-center"},{default:r(()=>e[5]||(e[5]=[d("Şifre Değiştirme Zorunlu")])),_:1,__:[5]}),s(g,{class:"text-center"},{default:r(()=>e[6]||(e[6]=[d("Varsayılan şifre ile giriş yaptınız. Yeni bir şifre belirlemeden devam edemezsiniz.")])),_:1,__:[6]}),s(g,null,{default:r(()=>[s(b,{modelValue:a(l).password,"onUpdate:modelValue":e[0]||(e[0]=t=>a(l).password=t),label:"Yeni Şifre",type:a(p)?"text":"password",disabled:a(n),autocomplete:"new-password",rules:[w,x],"append-inner-icon":a(p)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[1]||(e[1]=t=>p.value=!a(p))},null,8,["modelValue","type","disabled","rules","append-inner-icon"]),s(b,{class:"mt-2",modelValue:a(l).password_confirmation,"onUpdate:modelValue":e[2]||(e[2]=t=>a(l).password_confirmation=t),label:"Yeni Şifre (Tekrar)",type:a(m)?"text":"password",disabled:a(n),autocomplete:"new-password",rules:[w,v],"append-inner-icon":a(m)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[3]||(e[3]=t=>m.value=!a(m))},null,8,["modelValue","type","disabled","rules","append-inner-icon"])]),_:1}),s(S,{class:"justify-end"},{default:r(()=>[s(V,{variant:"tonal",color:"secondary",onClick:C,disabled:a(n)},{default:r(()=>e[7]||(e[7]=[d("Vazgeç")])),_:1,__:[7]},8,["disabled"]),s(V,{color:"primary",onClick:k,loading:a(n)},{default:r(()=>e[8]||(e[8]=[d("Kaydet")])),_:1,__:[8]},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1}),s(Y,{modelValue:a(i).show,"onUpdate:modelValue":e[4]||(e[4]=t=>a(i).show=t),color:a(i).color,timeout:"2500"},{default:r(()=>[d(F(a(i).text),1)]),_:1},8,["modelValue","color"])],64))}});export{ie as default};
