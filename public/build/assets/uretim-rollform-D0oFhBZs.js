import{_ as _t}from"./AppTextarea.vue_vue_type_script_setup_true_lang-BhTE_TVm.js";import{_ as gt}from"./AppSelect.vue_vue_type_script_setup_true_lang-BTTlcn8P.js";import{d as wt,r,X as K,G as kt,aZ as ke,f9 as ht,w as te,af as Dt,b2 as St,b3 as A,c as U,o as B,l as Ue,e as a,b as l,aI as Be,v,f as s,I as xt,t as f,m as d,b7 as me,x as he,d3 as $,a_ as M,ae as T,Z as ae,F as Ye,ba as Vt}from"./main-DnpAGNqn.js";import{u as At}from"./pageTitle-CtaiwNa2.js";import{D as Tt,a as Et,b as It,c as Nt,d as Kt,e as Mt,f as Rt,g as De,h as Ct,i as Pt}from"./circular-gauge-CXpp60nV.js";import{a as w,D as $t}from"./data-grid-Dt-0M8I_.js";import{D as Lt,a as zt}from"./popup-DOx1_Opw.js";import{n as S}from"./notify-Cj94ob8a.js";import{V as L}from"./VCol-JzZVdI_f.js";import{V as le,b as oe,c as je}from"./VCard-Cg69DJDN.js";import{V as ie}from"./VRow-DzvZn2d0.js";import{V as Ft}from"./VSwitch-hs9ZLsnz.js";import{V as We}from"./VCardText-Bs6WdY43.js";import{V as Je}from"./VTextField-DAGBGwGu.js";import{V as Ze}from"./VSpacer-CWSzq34j.js";import{V as Xe}from"./VDialog-DrMU-NX0.js";import{_ as qt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./focus-Dwg9QRHH.js";import"./VTextarea-CCEy02AR.js";/* empty css                   */import"./VCounter-C2sJAJhW.js";import"./VImg-Ce65q7r2.js";import"./VField-Drn2Cy1R.js";import"./easing-Bybner-F.js";import"./VInput-Ca9o50wa.js";import"./form-aJjKEqR1.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-DBcbGfn1.js";import"./VList-zsuiivE3.js";import"./ssrBoot--n5eGGNZ.js";import"./VAvatar-CsZfNcOZ.js";import"./VDivider-BwS-spH5.js";import"./dialog-transition-CI7_de3x.js";import"./VMenu-CYE27Zks.js";import"./VOverlay-6_SLVxrh.js";import"./delay-DYnsdEP-.js";import"./lazy-CeUEeR93.js";import"./scopeId-dKSq_F92.js";import"./VCheckboxBtn-BcRiKjpR.js";import"./VSelectionControl-D6jCOpOV.js";import"./VChip-CLLe59th.js";import"./VSlideGroup-ChPCJwy9.js";import"./index-DUC2JmVk.js";import"./ui.errors-Bp_rhorb.js";import"./m_base_widget-CXPIXpbE.js";import"./format_helper-BrSf9jWA.js";import"./m_resize_observer-DZF4EbxF.js";import"./themes-CnpegddF.js";import"./m_row_dragging-ry81qsWj.js";import"./m_select_box-iyADUyh0.js";import"./overlay-JIAKax_A.js";import"./editor-DhwFsO7f.js";/* empty css              */const Ht={class:"page-rollform pa-0"},Ot={key:0,class:"rf-loading-overlay"},Gt={class:"rf-loader-box"},Ut={key:0,class:"hint-line"},Bt={key:1,class:"warn-line"},Yt={class:"rollform-header"},jt={class:"gauge-wrap"},Wt={class:"badge-left"},Jt={class:"gauge-center-value"},Zt={style:{color:"goldenrod"}},Xt={class:"clock-wrap"},Qt={class:"digital-clock"},ea={class:"digital-date"},ta={class:"kpi-row"},aa={class:"kpi"},la={class:"kpi-value"},oa={class:"pb-1 ms-1 me-1"},ia={class:"kpi"},sa={class:"kpi-value"},na={class:"pb-1 ms-1 me-1"},ra={class:"kpi"},ua={class:"kpi-value"},da={class:"pb-1 ms-1 me-1"},va={class:"oee-title"},ma={class:"panel status-panel"},ca={class:"form-row mt-2"},fa={style:{display:"flex","align-items":"center",gap:"8px"}},pa={class:"status-actions justify-between"},ya={class:"status-actions justify-between"},ba={class:"status-metrics mt-4 text-center"},_a={class:"metric-time"},ga={class:"metric-time"},wa={class:"panel status-panel"},ka={width:"60%"},ha={class:"sayac siparis digit"},Da={width:"60%"},Sa={class:"sayac siparis digit"},xa={width:"60%"},Va={class:"sayac net digit"},Aa={width:"60%"},Ta={class:"sayac net digit"},Ea={width:"60%"},Ia={class:"sayac kalan digit"},Na={class:"sayac hurda digit"},Ka={class:"sayac net digit"},Ma={class:"mt-10"},Ra={class:"info"},Ca={width:"60%"},Pa={class:"info"},$a={width:"60%"},La={class:"info"},za={width:"60%"},Fa={class:"info"},qa={class:"status-actions mt-11 mb-0"},Ha={class:"panel grid-panel"},Oa={class:"mb-2"},Ga={class:"mb-2"},Ua=wt({__name:"uretim-rollform",setup(Ba){const ce=At(),b=r(null);function Se(){var t;try{return`rollform:lastDurusReason:${((t=I==null?void 0:I.value)==null?void 0:t.istasyon_id)??"unknown"}`}catch{return"rollform:lastDurusReason:unknown"}}function Qe(){try{const t=localStorage.getItem(Se());if(!t)return!1;const e=JSON.parse(t);if(e&&e.break_reason_code&&e.break_reason_code!=="000")return b.value={break_reason_code:e.break_reason_code,description:e.description},!0}catch{}return!1}const se=r([]),xe=r(""),Ve=r(!1),o=r(null),Y=K(()=>{var t;return((t=o.value)==null?void 0:t.wstation_code)??"..."}),ne=K(()=>{var t;return((t=o.value)==null?void 0:t.wstation_name)??"..."}),et=K(()=>{var e;const t=(e=o.value)==null?void 0:e.statu_id;return t===0?"rgba(192, 167, 167, 0.30)":t===1?"rgba(180, 50, 50, 1.00)":t===2?"green":"#4b7027"}),E=K(()=>{var t;return((t=o.value)==null?void 0:t.statu_id)===1});ce.setTitle(`${Y.value} (${ne.value})`),document.title=`OFT - ${Y.value} | ${ne.value}`;const Ae=K(()=>`${Y.value} (${ne.value})`),tt=K(()=>{const t=Number(N.value.oee||0);return t<50?"oee-low":t<70?"oee-mid":t<85?"oee-high":"oee-top"}),re=()=>{ce.setTitle(Ae.value),document.title=`OFT - ${Y.value} | ${ne.value}`};kt(async()=>{if(await ke(),re(),await bt(),!p.value){console.warn("İstasyon tespiti başarısız; periyodikler başlatılmadı.");return}ue(),Z(),setInterval(Z,1e4),setInterval(()=>{const t=new Date,e=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0"),u=String(t.getSeconds()).padStart(2,"0");Te.value=`${e}:${n}:${u}`;const i=["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],m=["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"];Ee.value=`${t.getDate()} ${m[t.getMonth()]} ${t.getFullYear()} ${i[t.getDay()]}`,ue()},1e3),setInterval(H,2e3),qe(),pt(),setTimeout(()=>{J.value||(J.value=!0)},15e3),window.addEventListener("keydown",Ie),window.addEventListener("keydown",Ce)}),ht(()=>{re()});const at=te(()=>ce.title,t=>{t!==Ae.value&&re()},{flush:"post"});Dt(()=>{at(),window.removeEventListener("keydown",Ie),window.removeEventListener("keydown",Ce)}),te(()=>o.value,()=>{re(),ue()});const I=St("userData");function z(t){const e=Number(t??0);return Number.isFinite(e)?new Intl.NumberFormat("tr-TR",{maximumFractionDigits:0,minimumFractionDigits:0}).format(Math.floor(e)):"0"}const fe=r("00:00:00"),lt=r("00:00"),Te=r("00:00:00"),Ee=r("...");function ot(t){const e=Math.max(0,Math.floor(t||0)),n=Math.floor(e/3600),u=Math.floor(e%3600/60),i=e%60,m=g=>String(g).padStart(2,"0");return`${m(n)}:${m(u)}:${m(i)}`}function ue(){var n;const t=(n=o.value)==null?void 0:n.statu_time;if(t==null){fe.value="00:00:00";return}let e=0;if(typeof t=="number")t>1e12?e=Math.max(0,Math.floor((Date.now()-t)/1e3)):t>1e9?e=Math.max(0,Math.floor(Date.now()/1e3-t)):e=Math.max(0,Math.floor(t));else if(typeof t=="string"){const u=Date.parse(t);Number.isNaN(u)||(e=Math.max(0,Math.floor((Date.now()-u)/1e3)))}else t instanceof Date&&(e=Math.max(0,Math.floor((Date.now()-t.getTime())/1e3)));fe.value=ot(e)}function h(t){const e=t.toLowerCase();return se.value.find(n=>String(n.description||"").toLowerCase().includes(e))}function Ie(t){if(E.value){if(t.key==="F9"){const e=h("çay ve yemek")||h("cay ve yemek")||h("çay & yemek");e&&(b.value={break_reason_code:e.break_reason_code,description:e.description},t.preventDefault())}else if(t.key==="F8")t.preventDefault(),Ne();else if(t.key==="F10"){const e=h("yemek")||h("öğle")||h("ogle");e&&(b.value={break_reason_code:e.break_reason_code,description:e.description},t.preventDefault())}}}async function Ne(){if(E.value&&p.value)try{await A.post("/api/uretim-rollform/close-and-open-down",{station_id:p.value}),S({message:"Yeni duruş başlatıldı (F8)",type:"success",displayTime:1500}),Promise.allSettled([H(),Z()])}catch(t){console.error("F8 yeni duruş hata",t),S({message:"Yeni duruş başlatılamadı",type:"error",displayTime:2e3})}}async function it(){if(!E.value||_.value)return;const t=h("çay")||h("cay");t?(b.value={break_reason_code:t.break_reason_code,description:t.description},await O()):S({message:"Çay molası sebebi bulunamadı",type:"warning",displayTime:1500})}async function st(){if(!E.value||_.value)return;const t=h("yemek")||h("öğle")||h("ogle");t?(b.value={break_reason_code:t.break_reason_code,description:t.description},await O()):S({message:"Yemek molası sebebi bulunamadı",type:"warning",displayTime:1500})}const j=r(!1),W=r(""),pe=r(null),q=r(!1);let ye=null;function Ke(){var t,e;if(!ye){ye=setTimeout(()=>{ye=null},300);try{(e=(t=pe.value)==null?void 0:t.blur)==null||e.call(t)}catch{}Re()}}function Me(){W.value="",j.value=!0,ke(()=>{var t;return(t=pe.value)==null?void 0:t.focus()})}async function Re(){var m;const t=Number(W.value);if(!Number.isFinite(t)||t<=0){be();return}let e=o.value?{...o.value}:null,n=((m=o.value)==null?void 0:m.worder_id)??null,u=-1,i=null;try{if(q.value)return;if(!p.value)throw new Error("İstasyon yok");q.value=!0;const g=typeof performance<"u"&&performance.now?performance.now():Date.now();if(e){const c=Number(e.scrap_qty||0);o.value={...e,scrap_qty:c+t}}if(n&&(u=x.value.findIndex(c=>c.isEmriID===n),u>=0)){i=Number(x.value[u].hurda||0);const c={...x.value[u],hurda:i+t};x.value.splice(u,1,c)}await A.post("/api/uretim-rollform/hurda-gir",{station_id:p.value,qty:t});const y=typeof performance<"u"&&performance.now?performance.now():Date.now();try{console.info(`[Hurda] POST tamam: ${(y-g).toFixed(0)}ms (qty=${t})`)}catch{}S({message:"Hurda kaydedildi",type:"success",displayTime:1200}),j.value=!1,Promise.allSettled([H(),qe(),Z()])}catch(g){console.error("hurda kayıt hata",g);try{if(n!=null){const y=x.value.findIndex(c=>c.isEmriID===n);if(y>=0&&i!=null){const c={...x.value[y],hurda:i};x.value.splice(y,1,c)}}}catch{}try{e!==null&&(o.value=e)}catch{}S({message:"Hurda kaydedilemedi",type:"error",displayTime:2e3})}finally{q.value=!1}}function be(){W.value="",j.value=!1}function Ce(t){t.key==="F8"&&(Me(),t.preventDefault())}r("uretim-disi");const nt=r(!1),J=r(!1),Pe=r(!1),$e=r(!1),Le=r(!1),ze=r(!1),Fe=r(!1),rt=K(()=>Pe.value&&$e.value&&Le.value&&ze.value&&Fe.value);te(rt,t=>{t&&!J.value&&(J.value=!0)});const ut=K(()=>!J.value),N=r({availability:0,performance:0,quality:0,oee:0}),dt=r(null);async function Z(){try{if(!p.value)return;const{data:t}=await A.get("/api/uretim-rollform/kpi",{params:{station_id:p.value}});if(t!=null&&t.kpi){const e=n=>Math.round(Number(n||0)*100);N.value={availability:e(t.kpi.availability),performance:e(t.kpi.performance),quality:e(t.kpi.quality),oee:e(t.kpi.oee)},t.shift&&(dt.value={id:t.shift.id,start:t.shift.start.substring(11,16),end:t.shift.end.substring(11,16)}),nt.value=!0,Le.value=!0}}catch(t){console.error("fetchKpiDirect error",t)}}const x=r([]),vt=[{hint:"Aktif Et",text:"Aktif Et",icon:"login",onClick:t=>{var e;return mt((e=t==null?void 0:t.row)==null?void 0:e.data)}}],F=r(!1),X=r(null),k=r(null);function mt(t){k.value=t,X.value=null,F.value=!0}async function _e(){if(!k.value)return;const t=Number(X.value??0),e=p.value;if(!e)return;const n={wstation_id:e,worder_id:Number(k.value.isEmriID??0),worder_no:k.value.isEmriNo,item_id:0,item_code:k.value.stokKodu,item_name:k.value.stokAdi,item_length:t,order_qty:Number(k.value.plnAd??0),net_qty:Number(k.value.urtAd??0),scrap_qty:Number(k.value.hurda??0)};try{await A.post("/api/uretim-rollform/activate-workorder",n),F.value=!1,H()}catch(u){console.error("Aktivasyon hatası",u)}}async function H(){try{if(!p.value){o.value=null;return}const t=await A.get("/api/kapasite-works-info",{params:{station_id:p.value}}),e=Array.isArray(t.data)?t.data:[];o.value=e.length>0?e[0]:null,ue()}catch(t){console.error("WorksInfo alınamadı",t),o.value=null}finally{$e.value=!0}}async function qe(){try{if(!p.value){x.value=[];return}const{data:t}=await A.get("/api/uretim-rollform/is-emirleri",{params:{istasyon:p.value}}),e=(t||[]).map(n=>({grp:0,isEmriID:n.isemri_id,isEmriNo:n.isemri_no,stokKodu:n.stok_kodu,stokAdi:n.stok_adi,plnAd:Number(n.siparis_miktari??0),ilvAd:0,klnAd:Number(n.kalan_miktar??0),urtAd:Number(n.uretilen_net_miktar??0),hurda:Number(n.toplam_hurda_miktari??0),plnSure:Number(n.operasyon_suresi??0),grcSure:0}));x.value=e}catch(t){console.error("İş emirleri alınamadı",t)}finally{ze.value=!0}}const V=r(!1),_=r(!1),de=r(!0),ge=r(null);function ve(t=0){var e,n,u;try{const i=((e=ge.value)==null?void 0:e.$el)||((u=(n=ge.value)==null?void 0:n.$refs)==null?void 0:u.root)||null;if(i){const m=i.querySelector("input")||i.querySelector('[role="combobox"]');if(m){m.focus(),document.activeElement!==m&&t<3&&setTimeout(()=>ve(t+1),40);return}}t<5&&setTimeout(()=>ve(t+1),50)}catch{}}function ct(){setTimeout(()=>ve(),10)}const we=r(!0),ft=K(()=>({width:110,marginBottom:30,type:"success",text:_.value?"Kaydediliyor...":"Kaydet",stylingMode:"contained",elementAttr:{class:_.value?"btn-loading":""},disabled:_.value,onClick:()=>{_.value||O()}}));function pt(){p.value&&A.get("/api/durus-sebepleri-al",{params:{istasyon:p.value}}).then(t=>{var e;se.value=((e=t.data)==null?void 0:e.durusSebepleri)||[]}).catch(t=>{console.error("Duruş sebepleri alınamadı",t)}).finally(()=>{Fe.value=!0})}function He(){b.value={break_reason_code:"000",description:"GİRİLMEDİ"},V.value=!0,ke(()=>ve())}async function O(){var t;if(!_.value){if(!b.value){S({message:"Lütfen bir duruş sebebi seçiniz.",type:"error",displayTime:3e3});return}if(!((t=o.value)!=null&&t.worder_id)){S({message:"Aktif iş emri yok.",type:"warning",displayTime:2500}),V.value=!1;return}if(!p.value){S({message:"İstasyon bulunamadı.",type:"error",displayTime:3e3});return}try{_.value=!0,de.value=!1;const e=typeof performance<"u"&&performance.now?performance.now():Date.now();await A.post("/api/duruskaydet-mekanik",{istasyonID:p.value,selectedDurus:b.value});const n=typeof performance<"u"&&performance.now?performance.now():Date.now();try{console.info(`[Duruş] POST tamam: ${(n-e).toFixed(0)}ms (code=${b.value.break_reason_code})`)}catch{}S({message:"Duruş kaydedildi.",type:"success",displayTime:1600});try{localStorage.setItem(Se(),JSON.stringify(b.value))}catch{}V.value=!1,Promise.allSettled([H(),Z()])}catch(e){console.error("Duruş kaydedilemedi",e),S({message:"Duruş kaydedilemedi.",type:"error",displayTime:3e3})}finally{_.value=!1,de.value=!0}}}function yt(t){de.value||(t.cancel=!0)}te(V,(t,e)=>{e&&!t&&H()});const Oe=r(null);te(()=>{var t;return(t=o.value)==null?void 0:t.statu_id},async(t,e)=>{t===1&&Oe.value!==1?we.value?!Qe()&&!V.value&&He():V.value||He():t!==1&&(V.value&&(_.value=!1,de.value=!0,V.value=!1),b.value=null),Oe.value=t??null,we.value&&(we.value=!1)});const p=r(null),G=r(null);async function bt(){var t,e,n;try{G.value=null;const{data:u}=await A.get("/api/uretim-rollform/detect-station");if(u&&u.station_id){p.value=Number(u.station_id),Pe.value=!0;try{const i=Number(((t=I==null?void 0:I.value)==null?void 0:t.id)||((n=(e=I==null?void 0:I.value)==null?void 0:e.user)==null?void 0:n.id));Number.isFinite(i)&&i>0&&await A.post("/api/uretim-rollform/set-operator",{station_id:p.value,operator_id:i})}catch{}}else{p.value=null;const i=u!=null&&u.ip?` – tespit edilen IP: ${u.ip}`:"";G.value="İstasyon bulunamadı (IP eşleşmedi)"+i}}catch(u){G.value="İstasyon tespiti hata: "+((u==null?void 0:u.message)||"bilinmiyor")}}return(t,e)=>{const n=gt,u=_t;return B(),U("div",Ht,[ut.value?(B(),U("div",Ot,[a("div",Gt,[e[12]||(e[12]=a("div",{class:"rf-spinner","aria-hidden":"true"},null,-1)),e[13]||(e[13]=a("h2",null,"Veriler yükleniyor",-1)),e[14]||(e[14]=a("p",null,"İstasyon, aktif iş emri, sayaç ve KPI verileri hazırlanıyor. Lütfen bekleyin…",-1)),!p.value&&!G.value?(B(),U("small",Ut,"İstasyon tespiti yapılıyor...")):G.value?(B(),U("small",Bt,v(G.value)+" – yeniden deniyor...",1)):Ue("",!0)])])):Ue("",!0),a("div",Yt,[l(ie,{class:"match-height"},{default:s(()=>[l(L,{cols:"12",md:"3",sm:"6"},{default:s(()=>[l(le,{class:"pa-3"},{default:s(()=>{var i,m,g;return[a("section",null,[l(oe,{class:"durum-title",style:xt({backgroundColor:et.value})},{default:s(()=>{var y,c;return[f(v(((y=o.value)==null?void 0:y.statu_id)===0?"KAPALI":((c=o.value)==null?void 0:c.statu_id)===1?"DURUYOR":"ÇALIŞIYOR"),1)]}),_:1},8,["style"]),e[20]||(e[20]=a("hr",null,null,-1)),a("div",jt,[a("div",Wt,v(Y.value),1),l(d(Tt),{class:"oee-gauge",value:(i=o.value)==null?void 0:i.speed,subvalues:(m=o.value)==null?void 0:m.speed_target,tooltip:t.gaugeTooltip,size:t.gaugeSize},{default:s(()=>{var y;return[l(d(Et),{"start-angle":225,"end-angle":-45}),l(d(It),{"start-value":0,"end-value":(y=o.value)==null?void 0:y.speed_max,"tick-interval":10,"minor-tick-interval":5},{default:s(()=>[l(d(Nt),{length:8,color:"#666"}),l(d(Kt),{length:4,color:"#444"}),l(d(Mt),{"use-range-colors":!0,font:t.gaugeLabelFont},null,8,["font"])]),_:1},8,["end-value"]),l(d(Rt),{"background-color":"#20252b",offset:10,width:10},{default:s(()=>{var c,R,C,D,P;return[l(d(De),{"start-value":0,"end-value":.4*((c=o.value)==null?void 0:c.speed_max),color:"#ce6978"},null,8,["end-value"]),l(d(De),{"start-value":.4*((R=o.value)==null?void 0:R.speed_max),"end-value":.7*((C=o.value)==null?void 0:C.speed_max),color:"#caa93b"},null,8,["start-value","end-value"]),l(d(De),{"start-value":.7*((D=o.value)==null?void 0:D.speed_max),"end-value":(P=o.value)==null?void 0:P.speed_max,color:"#1e8e3e"},null,8,["start-value","end-value"])]}),_:1}),l(d(Ct),{type:"triangleNeedle","spindle-size":18,"spindle-gap-size":9,offset:10,width:8}),l(d(Pt),{enabled:!1})]}),_:1},8,["value","subvalues","tooltip","size"]),a("div",Jt,[e[15]||(e[15]=a("div",{class:"label",style:{"font-size":"16px","margin-block":"-10px"}},"Hız",-1)),a("div",Zt,v((g=o.value)==null?void 0:g.speed),1)])]),a("div",Xt,[a("div",Qt,v(Te.value),1),a("div",ea,v(Ee.value),1)]),a("div",ta,[a("div",aa,[e[16]||(e[16]=a("div",null,"Meço %",-1)),a("div",la,[f(v(N.value.availability)+" ",1),a("div",oa,[l(me,{"model-value":N.value.availability??0,color:"info",height:"4",rounded:!0},null,8,["model-value"])])])]),a("div",ia,[e[17]||(e[17]=a("div",null,"Performans %",-1)),a("div",sa,[f(v(N.value.performance)+" ",1),a("div",na,[l(me,{"model-value":N.value.performance??0,color:"success",height:"4",rounded:!0},null,8,["model-value"])])])]),a("div",ra,[e[18]||(e[18]=a("div",null,"Kalite %",-1)),a("div",ua,[f(v(N.value.quality)+" ",1),a("div",da,[l(me,{"model-value":N.value.quality??0,color:"error",height:"4",rounded:!0},null,8,["model-value"])])])])]),l(ie,null,{default:s(()=>[l(L,{cols:"12",class:"text-center"},{default:s(()=>[a("div",va,[e[19]||(e[19]=f("OEE % ")),a("span",{class:he(["kpi-oee",tt.value])},v(N.value.oee),3)])]),_:1})]),_:1})])]}),_:1})]),_:1}),l(L,{cols:"12",md:"4",sm:"6"},{default:s(()=>[l(le,{class:"pa-3"},{default:s(()=>[l(oe,{class:"panel-title pa-0"},{default:s(()=>e[21]||(e[21]=[f("DURUM BİLGİLERİ")])),_:1,__:[21]}),e[31]||(e[31]=a("hr",null,null,-1)),a("section",ma,[a("div",ca,[e[23]||(e[23]=a("label",null,"Duruş Sebebi (F8 – Yeni Duruş)",-1)),a("div",fa,[l(n,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=i=>b.value=i),items:se.value,"item-title":"description","item-value":"break_reason_code","return-object":"","single-line":"",placeholder:"Seçiniz...",variant:"outlined",disabled:!E.value||_.value,class:he({"app-select--force-disabled":!E.value||_.value}),onKeydown:$(M(O,["prevent"]),["enter"])},null,8,["modelValue","items","disabled","class","onKeydown"]),l(T,{color:"success",variant:"tonal",size:"small",disabled:!E.value||_.value||!b.value,onClick:O},{default:s(()=>[e[22]||(e[22]=f(" Kaydet ")),l(ae,{end:"",icon:"tabler-check"})]),_:1,__:[22]},8,["disabled"])]),l(u,{modelValue:xe.value,"onUpdate:modelValue":e[1]||(e[1]=i=>xe.value=i),placeholder:"Açıklama...",disabled:""},null,8,["modelValue"])]),a("div",pa,[l(T,{variant:"tonal",color:"error",size:"small"},{default:s(()=>e[24]||(e[24]=[f("Açıklama Gir")])),_:1,__:[24]}),l(Ft,{color:"error",modelValue:Ve.value,"onUpdate:modelValue":e[2]||(e[2]=i=>Ve.value=i),label:"Arızalı",value:"false",height:10},null,8,["modelValue"])]),a("div",ya,[l(T,{variant:"tonal",color:"warning",size:"small",width:"32%",onClick:Ne},{default:s(()=>[e[25]||(e[25]=f(" F8 - Yeni Duruş ")),l(ae,{end:"",icon:"tabler-player-skip-forward"})]),_:1,__:[25]}),l(T,{variant:"tonal",color:"warning",size:"small",width:"32%",onClick:it},{default:s(()=>[e[26]||(e[26]=f(" F9 - Çay Molası ")),l(ae,{end:"",icon:"tabler-mug"})]),_:1,__:[26]}),l(T,{variant:"tonal",color:"warning",size:"small",width:"32%",onClick:st},{default:s(()=>[e[27]||(e[27]=f(" F10 - Yemek Molası ")),l(ae,{end:"",icon:"tabler-bowl-spoon"})]),_:1,__:[27]})]),a("div",ba,[a("div",null,[e[28]||(e[28]=a("div",{class:"label"},"Durum Süresi",-1)),a("div",_a,v(fe.value),1)]),a("div",null,[e[29]||(e[29]=a("div",{class:"label"},"Vardiya",-1)),a("div",ga,v(lt.value),1)])]),e[30]||(e[30]=a("div",{class:"uclu text-center mt-4"},[a("div",null,[a("div",{class:"label"},"Çalışma"),a("div",{class:"metric-time ok"},"00:00")]),a("div",null,[a("div",{class:"label"},"Duruş"),a("div",{class:"metric-time warn"},"00:00")]),a("div",null,[a("div",{class:"label"},"Boşta"),a("div",{class:"metric-time"},"02:00")])],-1))])]),_:1,__:[31]})]),_:1}),l(L,{cols:"12",md:"5",sm:"6"},{default:s(()=>[l(le,{class:"pa-3"},{default:s(()=>{var i,m,g;return[l(oe,{class:"panel-title pa-0"},{default:s(()=>e[32]||(e[32]=[f("ÜRETİM RAKAMLARI")])),_:1,__:[32]}),e[45]||(e[45]=a("hr",null,null,-1)),a("section",wa,[l(me,{"model-value":(((i=o.value)==null?void 0:i.net_qty)+((m=o.value)==null?void 0:m.counter))/((g=o.value)==null?void 0:g.order_qty)*100,color:"warning",height:"10",rounded:!0,class:"my-4"},null,8,["model-value"]),l(ie,null,{default:s(()=>[l(L,{cols:"5"},{default:s(()=>{var y,c,R,C,D,P,Q,ee;return[a("div",null,[a("div",ka,[e[33]||(e[33]=a("div",{class:"label"},"İş Emri Miktarı",-1)),a("div",ha,v(z((y=o.value)==null?void 0:y.order_qty)),1)]),a("div",Da,[e[34]||(e[34]=a("div",{class:"label"},"Üretilen (uyumsoft)",-1)),a("div",Sa,v(z((c=o.value)==null?void 0:c.net_qty)),1)]),a("div",xa,[e[35]||(e[35]=a("div",{class:"label"},"Sayaç",-1)),a("div",Va,v(z((R=o.value)==null?void 0:R.counter)),1)]),a("div",Aa,[e[36]||(e[36]=a("div",{class:"label"},"Üretilen (uyum + sayaç)",-1)),a("div",Ta,v(z(((C=o.value)==null?void 0:C.net_qty)+((D=o.value)==null?void 0:D.counter))),1)]),a("div",Ea,[e[37]||(e[37]=a("div",{class:"label"},"Kalan",-1)),a("div",Ia,v(z((((P=o.value)==null?void 0:P.order_qty)??0)-((Q=o.value)==null?void 0:Q.counter)-(((ee=o.value)==null?void 0:ee.net_qty)??0))),1)])])]}),_:1}),l(L,{cols:"7"},{default:s(()=>{var y,c,R,C;return[a("div",null,[l(ie,null,{default:s(()=>[l(L,{cols:"6"},{default:s(()=>{var D;return[e[38]||(e[38]=a("div",{class:"label"},"Hurda",-1)),a("div",Na,v(z((D=o.value)==null?void 0:D.scrap_qty)),1)]}),_:1,__:[38]}),l(L,{cols:"6"},{default:s(()=>{var D,P,Q,ee,Ge;return[e[39]||(e[39]=a("div",{class:"label"},"O.A.%",-1)),a("div",Ka,v(((D=o.value)==null?void 0:D.net_qty)===0||((P=o.value)==null?void 0:P.order_qty)===0?0:((((Q=o.value)==null?void 0:Q.net_qty)+((ee=o.value)==null?void 0:ee.counter))/((Ge=o.value)==null?void 0:Ge.order_qty)*100).toFixed(0)),1)]}),_:1,__:[39]})]),_:1}),a("div",Ma,[e[40]||(e[40]=a("div",null,"İş Emri No:",-1)),a("div",Ra,v((y=o.value)==null?void 0:y.worder_no),1)]),a("div",Ca,[e[41]||(e[41]=a("div",null,"Ürün Kodu:",-1)),a("div",Pa,v((c=o.value)==null?void 0:c.item_code),1)]),a("div",$a,[e[42]||(e[42]=a("div",null,"Ürün Adı:",-1)),a("div",La,v((R=o.value)==null?void 0:R.item_name),1)])]),a("div",za,[e[43]||(e[43]=a("div",null,"Ürün Boyu:",-1)),a("div",Fa,v(z((C=o.value)==null?void 0:C.item_length)),1)]),a("div",qa,[l(T,{id:"hurdaGir",variant:"outlined",color:"error",width:"100%",onClick:Me},{default:s(()=>[e[44]||(e[44]=f(" F8 - Hurda Girişi ")),l(ae,{end:"",icon:"tabler-trash"})]),_:1,__:[44]})])]}),_:1})]),_:1})])]}),_:1,__:[45]})]),_:1})]),_:1})]),l(Xe,{modelValue:j.value,"onUpdate:modelValue":e[4]||(e[4]=i=>j.value=i),"max-width":"400"},{default:s(()=>[l(le,null,{default:s(()=>[l(oe,null,{default:s(()=>e[46]||(e[46]=[f("Hurda Girişi")])),_:1,__:[46]}),l(We,null,{default:s(()=>[l(Je,{ref_key:"hurdaInputRef",ref:pe,modelValue:W.value,"onUpdate:modelValue":e[3]||(e[3]=i=>W.value=i),label:"Hurda Miktarı",type:"number","hide-details":"",min:1,step:"1",autofocus:"",onKeydown:[$(M(Ke,["prevent"]),["enter"]),$(M(be,["prevent"]),["esc"])],onKeyup:$(M(Ke,["prevent"]),["enter"])},null,8,["modelValue","onKeydown","onKeyup"]),e[47]||(e[47]=a("div",{class:"text-caption mt-2"},"Enter = Kaydet, Esc = İptal",-1))]),_:1,__:[47]}),l(je,null,{default:s(()=>[l(Ze),l(T,{variant:"text",color:"grey",onClick:be},{default:s(()=>e[48]||(e[48]=[f("İptal (Esc)")])),_:1,__:[48]}),l(T,{variant:"elevated",color:"error",onClick:Re,loading:q.value,disabled:q.value},{default:s(()=>[q.value?(B(),U(Ye,{key:0},[l(Vt,{indeterminate:"",size:"18",color:"white",class:"mr-2"}),e[49]||(e[49]=f(" Kaydediliyor... "))],64)):(B(),U(Ye,{key:1},[f("Kaydet (Enter)")],64))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e[55]||(e[55]=Be('<div class="mid-actions" data-v-574067ef><div class="action-left" data-v-574067ef><button class="btn" data-v-574067ef>İş Emrini Kapat</button><button class="btn btn-primary" data-v-574067ef>Çalışmaya Başla</button><button class="btn" data-v-574067ef>Operasyon Gir</button><button class="btn" data-v-574067ef>Teknik Resim</button><button class="btn" data-v-574067ef>Ürün Etiketi Bas</button><button class="btn icon" data-v-574067ef>🔍 Ara</button></div><div class="action-right" data-v-574067ef><button class="btn btn-warn" data-v-574067ef>Vardiya Bitir</button><button class="btn icon" data-v-574067ef>🟨</button><button class="btn icon" data-v-574067ef>🗂️</button><button class="btn icon" data-v-574067ef>⏻</button></div></div>',1)),a("section",Ha,[l(d($t),{class:"orders-grid","data-source":x.value,"hover-state-enabled":!0,"row-alternation-enabled":!1,"show-borders":!1,"column-auto-width":!0,"column-resizing-mode":"nextColumn","column-min-width":80,height:"360"},{default:s(()=>[l(d(w),{type:"buttons",width:"30",buttons:vt}),l(d(w),{"data-field":"grp",caption:"GRP",width:"60",visible:!1}),l(d(w),{"data-field":"isEmriID",caption:"İŞ EMRİ ID",width:"140"}),l(d(w),{"data-field":"isEmriNo",caption:"İŞ EMRİ NO",width:"140"}),l(d(w),{"data-field":"stokKodu",caption:"STOK KODU",width:"120"}),l(d(w),{"data-field":"stokAdi",caption:"STOK ADI"}),l(d(w),{"data-field":"plnAd",caption:"PLN.AD",width:"90","data-type":"number",format:{type:"fixedPoint",precision:0,thousandsSeparator:","}}),l(d(w),{"data-field":"ilvAd",caption:"İLV.AD",width:"90","data-type":"number",format:{type:"fixedPoint",precision:0,thousandsSeparator:","}}),l(d(w),{"data-field":"klnAd",caption:"KLN.AD",width:"90","data-type":"number",format:{type:"fixedPoint",precision:0,thousandsSeparator:","}}),l(d(w),{"data-field":"urtAd",caption:"ÜRT.AD",width:"90","data-type":"number",format:{type:"fixedPoint",precision:0,thousandsSeparator:","}}),l(d(w),{"data-field":"hurda",caption:"HURDA",width:"90","data-type":"number",format:{type:"fixedPoint",precision:0,thousandsSeparator:","}}),l(d(w),{"data-field":"plnSure",caption:"PLN.SÜRE",width:"100","data-type":"number",format:{type:"fixedPoint",precision:0,thousandsSeparator:","}}),l(d(w),{"data-field":"grcSure",caption:"GRÇ.SÜRE",width:"100","data-type":"number",format:{type:"fixedPoint",precision:0,thousandsSeparator:","}})]),_:1},8,["data-source"])]),e[56]||(e[56]=Be('<div class="bottom-tabs" data-v-574067ef><button class="tab active" data-v-574067ef>İş Emirleri</button><button class="tab" data-v-574067ef>Duruşlar</button><button class="tab" data-v-574067ef>Hurdalar</button><button class="tab" data-v-574067ef>Ölçümler</button><button class="tab" data-v-574067ef>Kısayollar</button></div>',1)),l(Xe,{modelValue:F.value,"onUpdate:modelValue":e[8]||(e[8]=i=>F.value=i),"max-width":"420",onKeydown:e[9]||(e[9]=$(M(i=>F.value=!1,["prevent","stop"]),["esc"]))},{default:s(()=>[l(le,null,{default:s(()=>[l(oe,null,{default:s(()=>e[50]||(e[50]=[f("İş Emrini Aktif Et")])),_:1,__:[50]}),l(We,null,{default:s(()=>{var i,m,g;return[a("form",{onSubmit:M(_e,["prevent"])},[a("div",Oa,[a("strong",null,v((i=k.value)==null?void 0:i.isEmriNo),1),f(" – "+v((m=k.value)==null?void 0:m.stokKodu),1)]),a("div",Ga,v((g=k.value)==null?void 0:g.stokAdi),1),l(Je,{ref:"activateLengthInput",modelValue:X.value,"onUpdate:modelValue":e[5]||(e[5]=y=>X.value=y),modelModifiers:{number:!0},type:"number",label:"Ürün Boyu (mm)",variant:"outlined",density:"compact",autofocus:"",onKeydown:[$(M(_e,["prevent"]),["enter"]),e[6]||(e[6]=$(M(y=>F.value=!1,["prevent","stop"]),["esc"]))]},null,8,["modelValue","onKeydown"]),e[51]||(e[51]=a("button",{type:"submit",style:{display:"none"}},null,-1))],32)]}),_:1}),l(je,null,{default:s(()=>[l(Ze),l(T,{variant:"text",onClick:e[7]||(e[7]=i=>F.value=!1)},{default:s(()=>e[52]||(e[52]=[f("İptal")])),_:1,__:[52]}),l(T,{color:"primary",variant:"flat",onClick:_e,disabled:!X.value},{default:s(()=>e[53]||(e[53]=[f("Onayla")])),_:1,__:[53]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(d(zt),{visible:V.value,"onUpdate:visible":e[11]||(e[11]=i=>V.value=i),width:500,height:200,"hide-on-outside-click":!1,"show-close-button":!1,"drag-enabled":!1,"close-on-back-button":!1,"defer-rendering":!1,"focus-state-enabled":!0,shading:!0,"shading-color":"rgba(0,0,0,0.5)","on-hiding":yt,titleTemplate:"title",animation:{show:{type:"fade",duration:120},hide:{type:"fade",duration:80}},"on-shown":ct},{content:s(()=>[l(ie,{class:"pa-4"},{default:s(()=>[l(n,{ref_key:"durusSelectRef",ref:ge,modelValue:b.value,"onUpdate:modelValue":e[10]||(e[10]=i=>b.value=i),items:se.value,"item-title":"description","item-value":"break_reason_code","return-object":"",label:"Duruş Sebebi","single-line":"",placeholder:"Seçiniz...",variant:"outlined",disabled:!E.value||_.value,class:he({"app-select--force-disabled":!E.value||_.value}),onKeydown:$(M(O,["prevent"]),["enter"])},null,8,["modelValue","items","disabled","class","onKeydown"])]),_:1})]),title:s(()=>e[54]||(e[54]=[a("p",{class:"popup-title"},"Duruş Sebebini Giriniz",-1)])),default:s(()=>[l(d(Lt),{widget:"dxButton",toolbar:"bottom",location:"center",options:ft.value},null,8,["options"])]),_:1},8,["visible"])])}}}),Bl=qt(Ua,[["__scopeId","data-v-574067ef"]]);export{Bl as default};
