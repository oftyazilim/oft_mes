import{u as N}from"./pageTitle-B1F1JWjV.js";import{d as E,r as o,q as W,i as $,g as D,f as n,b as e,e as s,l as t,s as H,o as T}from"./main-Buc254Rl.js";import{D as k}from"./button-BD3XHxol.js";import{D as L}from"./context-menu-DWUxrT1G.js";import{s as j,D as l,f as J,g as Q,h as X,i as Z,j as ee,k as te,d as ae,l as ie,m as le,n as re,o as ne,p as oe,b as se,q as ue,r as de,t as me}from"./data-grid-zY_7UUEw.js";import{D as C}from"./date-box-C6Nob3S8.js";import{D as pe}from"./load-panel-BOKwE2id.js";import{D as u}from"./tabs-B4aSjzHk.js";import{e as ce}from"./export_data_grid-BJ_ostud.js";import"./dom_component-B8wT4Ms5.js";import"./m_select_box-DpsiAR-p.js";import"./m_resize_observer-B9xXnUFQ.js";import"./format_helper-8FPqNnuq.js";import{e as fe}from"./exceljs.min-Dm3_meIG.js";import{s as he}from"./FileSaver-CQu8bA20.js";import{V as ve}from"./VCard-DXv8uyHv.js";import{V as ye}from"./VCol-hdI8oBcS.js";import{V as ge}from"./VCardText-Dj--lOYm.js";import"./index-CEhlOack.js";import"./m_row_dragging-K1byIlde.js";import"./themes-Dacyhg8v.js";import"./overlay-R7xNNk8V.js";import"./editor-JDJfWeMw.js";import"./export_merged_ranges_manager-DXOVkNTk.js";import"./language_codes-BJ6-wmbR.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./createSimpleFunctional-DV8ZLWRk.js";import"./VAvatar-Bz9IhJnE.js";import"./VImg-C5tfnJmP.js";import"./index-qFdlBbmw.js";/* empty css              */const xe={id:"liste",style:{"margin-block":"-10px 10px"}},be={style:{"margin-block-start":"-10px"}},we={style:{"margin-block-start":"-10px","margin-inline-start":"5px"}},tt=E({__name:"satinalma-talepler",setup(De){const P=N(),v=o(!1),y=o([]);o([]),o("");const z=o(Date.now()),g=W("userData"),p=o(null);o(null),o(!1);const d=new Date,x=new Date(d);x.setDate(d.getDate()-d.getDay()+1);const b=new Date(d);b.setDate(d.getDate()-d.getDay()+7);const c=o([x,b]),f=o(x),h=o(b),Y=o(null),w=o(!0);document.title="OFT - Talepler";const A=async()=>{w.value=!1,y.value=[],await _()},F=async()=>{w.value=!0,y.value=[],await _()},_=async()=>{c.value=[f.value,h.value],c.value[0]&&(f.value=new Date(c.value[0])),c.value[1]&&(h.value=new Date(c.value[1]));try{const a=await H.get("/api/satinalma-talepleri",{params:{filterValue:f.value,filterValue1:h.value,itemID:null,firma:null,tarihAralik:w.value}});y.value=a.data.talepler}catch(a){console.error("Veri çekilirken hata oluştu: ",a)}finally{v.value=!1}};$(async()=>{P.setTitle("Satınalma Talepleri"),S(),V()});const S=()=>{var i;const a=localStorage.getItem(`${g.value.id}_satinalmatlp`);a&&((i=p.value)==null||i.instance.state(JSON.parse(a)))},I=()=>{var i;const a=(i=p.value)==null?void 0:i.instance.state();localStorage.setItem(`${g.value.id}_satinalmatlp`,JSON.stringify(a))},R=()=>{localStorage.removeItem(`${g.value.id}_satinalmatlp`),p.value.instance.state(null)},V=()=>{const a=new Date,i=a.getFullYear()%100,r=new Date(a.getFullYear(),0,4),m=new Date(r);m.setDate(r.getDate()-(r.getDay()+6)%7);const q=Math.floor((a.getTime()-m.getTime())/864e5),G=Math.floor(q/7)+1;return`${i}-${G.toString().padStart(2,"0")}`},O=()=>{var a;(a=p.value)==null||a.instance.clearFilter()},U=a=>{if(a.rowIndex===-1)return;const i=a.row.data;Y.value=i},B=a=>{const i=new fe.Workbook,r=i.addWorksheet("SatinalmaTalepleri");ce({component:a.component,worksheet:r,autoFilterEnabled:!0}).then(()=>{i.xlsx.writeBuffer().then(m=>{he(new Blob([m],{type:"application/octet-stream"}),"SatinalmaTalepleri.xlsx")})}),a.cancel=!0},K=[{text:"Düzen Yükle"},{text:"Düzen Kaydet"},{text:"Düzen Sıfırla"}];function M({itemData:a}){if(!(a!=null&&a.items))switch(a==null?void 0:a.text){case"Düzen Yükle":S();break;case"Düzen Kaydet":I();break;case"Düzen Sıfırla":R();break}}return(a,i)=>(T(),D(ve,{class:"mt-0 pa-0"},{default:n(()=>[e(ge,{class:"mt-0 pa-2"},{default:n(()=>[e(ye,{cols:"12",class:"mt-2 pa-1 pe-2 pt-0"},{default:n(()=>[s("div",xe,[e(t(L),{"data-source":K,width:200,target:"#grid",onItemClick:M}),(T(),D(t(j),{id:"grid",ref_key:"dataGridRef",ref:p,key:z.value,class:"grid","data-source":y.value,"key-expr":"talep_no","show-borders":!0,"focused-row-enabled":"true","row-alternation-enabled":"true","min-width":200,"allow-column-reordering":"true","column-auto-width":"true","allow-column-resizing":"true",onContextMenuPreparing:U,"column-resizing-mode":"widget","auto-navigate-to-focused-row":!0,width:"100%",onExporting:B},{filtreTarih1:n(()=>[s("div",be,[e(t(C),{label:"Başlangıç Tarihi",width:"150","label-mode":"floating",value:f.value,"onUpdate:value":i[1]||(i[1]=r=>f.value=r),type:"date"},null,8,["value"])])]),filtreTarih2:n(()=>[s("div",we,[e(t(C),{label:"Bitiş Tarihi",width:"150","label-mode":"floating",value:h.value,"onUpdate:value":i[2]||(i[2]=r=>h.value=r),type:"date"},null,8,["value"])])]),filtreTemizleTemplate:n(()=>[e(t(k),{id:"filtretemizle",icon:"notequal","styling-mode":"text",hint:"Filtre Temizle"})]),menuFiltreTemizleTemplate:n(()=>i[3]||(i[3]=[s("div",{style:{display:"flex","align-items":"center","margin-inline-start":"13px"}},[s("i",{class:"dx-icon dx-icon-notequal"}),s("span",{style:{"margin-inline-start":"8px"}},"Filtre Temizle")],-1)])),tumu:n(()=>[e(t(k),{id:"sayim",icon:"refresh",text:"Tümü","styling-mode":"text",hint:"Tümünü Yenile"})]),menuYenileTumuTemplate:n(()=>i[4]||(i[4]=[s("div",{style:{display:"flex","align-items":"center","margin-inline-start":"13px"}},[s("i",{class:"dx-icon dx-icon-refresh"}),s("span",{style:{"margin-inline-start":"8px"}},"Tümü")],-1)])),tarih:n(()=>[e(t(k),{id:"sayim",icon:"refresh",text:"Tarih","styling-mode":"text",hint:"Tarih Aralığını Yenile"})]),menuYenileTarihTemplate:n(()=>i[5]||(i[5]=[s("div",{style:{display:"flex","align-items":"center","margin-inline-start":"13px"}},[s("i",{class:"dx-icon dx-icon-refresh"}),s("span",{style:{"margin-inline-start":"8px"}},"Tarih")],-1)])),default:n(()=>[e(t(l),{"data-field":"talep_tarihi",caption:"TALEP TARİHİ","data-type":"date",width:150,visible:!0,format:{formatter:r=>new Intl.DateTimeFormat("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(r)).replace(/\//g,".")},alignment:"center"},null,8,["format"]),e(t(l),{"data-field":"onay_tarihi",caption:"ONAY TARİHİ","data-type":"date",width:150,visible:!0,format:{formatter:r=>new Intl.DateTimeFormat("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(r)).replace(/\//g,".")},alignment:"center"},null,8,["format"]),e(t(l),{"data-field":"talep_no",caption:"TALEP NO",visible:!0,width:120}),e(t(l),{"data-field":"durumu",caption:"DURUMU",visible:!0,width:100}),e(t(l),{"data-field":"ONAY_DURUMU",caption:"ONAY DURUMU",visible:!0,width:120}),e(t(l),{"data-field":"kaynak",caption:"KAYNAK",visible:!0,width:150}),e(t(l),{"data-field":"tipi",caption:"TİPİ",visible:!0,width:90}),e(t(l),{"data-field":"item_id",caption:"STOK ID",visible:!0,width:90}),e(t(l),{"data-field":"item_code",caption:"STOK KODU",visible:!0,width:130}),e(t(l),{"data-field":"item_name",caption:"STOK ADI",visible:!0,width:280}),e(t(l),{"data-field":"miktar",caption:"MİKTAR","data-type":"number",visible:!0,width:100,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),e(t(l),{"data-field":"qty_ordered","data-type":"number",visible:!0,width:100,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),e(t(l),{"data-field":"qty_free_prm","data-type":"number",visible:!0,width:100,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),e(t(l),{"data-field":"qty_free_sec","data-type":"number",visible:!0,width:100,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),e(t(l),{"data-field":"co_id","data-type":"number",visible:!0,width:100,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),e(t(l),{"data-field":"branch_id","data-type":"number",visible:!0,width:100,format:{type:"fixedPoint",precision:1,thousandsSeparator:","}}),e(t(l),{"data-field":"note_1",visible:!0,width:150}),e(t(l),{"data-field":"note_2",visible:!0,width:150}),e(t(l),{"data-field":"item_line_type","data-type":"number",visible:!0,width:150}),e(t(l),{"data-field":"psm_request_status","data-type":"number",visible:!0,width:150}),e(t(l),{"data-field":"request_status","data-type":"number",visible:!0,width:150}),(T(),D(t(pe),{key:v.value,visible:v.value,"onUpdate:visible":i[0]||(i[0]=r=>v.value=r),"show-indicator":!0,"show-pane":!0,shading:!0},null,8,["visible"])),e(t(J),{"auto-expand-all":!1}),e(t(Q),{visible:!0}),e(t(X),{visible:!0}),e(t(Z),{visible:!0}),e(t(ee),{visible:!0}),e(t(te),{visible:!0,width:240}),e(t(ae),{mode:"virtual","row-rendering-mode":"virtual","show-scrollbar":"always"}),e(t(ie),{mode:"multiple"}),e(t(le),{enabled:!0,"allow-export-selected-data":!1}),e(t(re),{height:"540px",enabled:!0,mode:"select",position:a.position},{default:n(()=>[e(t(ne),{enabled:!0}),e(t(oe),{"allow-select-all":!0,"select-by-click":!0,recursive:!0})]),_:1},8,["position"]),e(t(se),null,{default:n(()=>[e(t(u),{name:"groupPanel"}),e(t(u),{location:"before","locate-in-menu":"auto",template:"filtreTarih1"}),e(t(u),{location:"before","locate-in-menu":"auto",template:"filtreTarih2"}),e(t(u),{location:"before","locate-in-menu":"auto",template:"tarih","menu-item-template":"menuYenileTarihTemplate",onClick:F}),e(t(u),{location:"before","locate-in-menu":"auto",template:"tumu","menu-item-template":"menuYenileTumuTemplate",onClick:A}),e(t(u),{location:"after","locate-in-menu":"auto",template:"filtreTemizleTemplate","menu-item-template":"menuFiltreTemizleTemplate",onClick:O}),e(t(u),{name:"exportButton"}),e(t(u),{name:"columnChooserButton"}),e(t(u),{name:"searchPanel"})]),_:1}),e(t(ue),null,{default:n(()=>[e(t(de),{"align-by-column":!0,column:"talep_tarihi","summary-type":"count","display-format":"{0} adet",alignment:a.right},null,8,["alignment"]),e(t(me),{"align-by-column":!0,column:"talep_tarihi","summary-type":"count","display-format":"{0} adet",alignment:a.right},null,8,["alignment"])]),_:1})]),_:1},8,["data-source"]))])]),_:1})]),_:1})]),_:1}))}});export{tt as default};
