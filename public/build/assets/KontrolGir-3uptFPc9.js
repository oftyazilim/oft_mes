import{d as L,r,w as k,q as h,c as K,e as c,b as t,f as o,F as x,aF as f,aM as _,cU as q,l as P,ay as w,p as M,g as Y,T as E,s as J,aK as U,o as V}from"./main-NnotjNYg.js";import{n as Q}from"./notify-DUVZjlio.js";import{D as W}from"./select-box-D60QYDUM.js";import{A as X}from"./m_select_box-D5pKQ1YU.js";import{V as Z}from"./VDialog-CdlH7Yp9.js";import{V as aa}from"./VSnackbar-BiIZWoYw.js";import{V as ea,a as la,b as ta}from"./VCard-1goAl3aC.js";import{V as oa}from"./VCardText-BHNCWHoQ.js";import{V as ra}from"./VForm-DOP5YtvM.js";import{V as sa}from"./VTextField-CHe-_6VM.js";import{V as O}from"./VRow-DOW84wdd.js";import{V as v}from"./VCol-CbpQ4cor.js";import{V as ia}from"./VContainer-Cne70ZIb.js";import{V as ma}from"./VCheckbox-BSsTR8P6.js";import{V as da}from"./VTextarea-DyVaBQCv.js";import{V as na}from"./VSpacer-DSu9cAB7.js";import"./overlay-N8U-Qxmx.js";import"./themes-CKTlm77a.js";import"./editor-oHO2BN5l.js";import"./VOverlay-C45q-3rl.js";import"./easing-Bybner-F.js";import"./delay-CNR6pejd.js";import"./lazy-D_ntC0BY.js";import"./scopeId-Cx7kpKTE.js";import"./index-Bg4-HE-t.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-CFRi2Oki.js";import"./createSimpleFunctional-BCn0Xlu1.js";import"./VAvatar-gZXSY5M3.js";import"./VImg-CQk22Lyp.js";import"./form-DXIevp9v.js";/* empty css                   */import"./VCounter-hcK9UGF6.js";import"./VField-BxZQtPZl.js";import"./focus-DQw3NBg7.js";import"./VInput-BNMnKlzx.js";/* empty css              */import"./VCheckboxBtn-C66HjjmV.js";import"./VSelectionControl-C9siXect.js";const Qa=L({__name:"KontrolGir",props:{modelValue:Boolean,masterId:Number},emits:["update:modelValue"],setup(A,{emit:F}){const S=r(),y=A,R=F,C=r(!1),D=r(""),B=r(),H=r(!1),n=r(""),u=r(""),p=r(""),m=r(y.modelValue);k(()=>y.modelValue,l=>m.value=l),k(m,l=>R("update:modelValue",l));const g=[{title:"✔️ Onaylandı",value:"Onaylandı",color:"#d4edda"},{title:"❌ Red",value:"Red",color:"#f8d7da"},{title:"⚠️ Şartlı Onay",value:"Şartlı Onay",color:"#fff3cd"}];new X({data:g,key:"value"});const j=()=>{U(()=>{var l;(l=S.value)==null||l.focus()})};k(m,l=>{l&&j()});const d=r({}),N=h("userData"),T=[{baslik:"İş Emri Hataları",hatalar:[{kod:"IEH",aciklama:"İş Emri Hatası"},{kod:"SPH",aciklama:"Sipariş Hatası"},{kod:"TH",aciklama:"Taşeron Hatası"},{kod:"EH",aciklama:"Etiket Hatası"}]},{baslik:"Malzeme Hataları",hatalar:[{kod:"CM",aciklama:"Çapaklı Malzeme"},{kod:"SMH",aciklama:"Saç Malzeme Hatası"},{kod:"KH",aciklama:"Kilit Hatası"},{kod:"FB",aciklama:"Formda Bozukluk"},{kod:"CC",aciklama:"Camda Çizik"},{kod:"OH",aciklama:"Ölçüsel Hata"},{kod:"19''H",aciklama:"19'' Ölçü Hatası"},{kod:"AH",aciklama:"Aksesuar Hatası"},{kod:"KPL",aciklama:"Kaplama Hatası"}]},{baslik:"Montaj Hataları",hatalar:[{kod:"MH",aciklama:"Montaj Hatası"},{kod:"TKH",aciklama:"Topraklama Hatası"},{kod:"KAH",aciklama:"Kaynak Hatası"},{kod:"BKE",aciklama:"Bağlantı Kalemi Eksik"},{kod:"BKS",aciklama:"Bağlantı Kalemi Sıkılmamış"},{kod:"ELK",aciklama:"Elektrik Hatası"},{kod:"STH",aciklama:"Su Testi Hatası"}]},{baslik:"Yüzey / Boya Hataları",hatalar:[{kod:"BC",aciklama:"Boyada Çizik"},{kod:"BH",aciklama:"Boya Hatası"},{kod:"SH",aciklama:"Serigrafi Hatası"}]}];k(d,()=>{const l=Object.entries(d.value).filter(([a,e])=>e).map(([a])=>{const e=T.flatMap(s=>s.hatalar).find(s=>s.kod===a);return e?`${a}: ${e.aciklama}`:a});p.value=l.join(", ")},{deep:!0});const $=async()=>{var l,a;try{const e=Object.entries(d.value).filter(([i,b])=>b).map(([i])=>i),s={serino:n.value,hatalar:e,sonuc:u.value,urun_kontrol_m_id:y.masterId,user_id:N.value.id};await J.post("/api/hata-kaydet",s),Q({message:"Kayıt başarılı!",type:"success",displayTime:2e3}),z()}catch(e){console.error(e),(a=(l=e.response)==null?void 0:l.data)!=null&&a.message?alert(e.response.data.message):alert("Kayıt sırasında hata oluştu.")}},z=()=>{var l;(l=B.value)==null||l.reset(),n.value="",u.value=!1,p.value="",d.value={},m.value=!1},G=()=>{U(()=>{const l=document.querySelector('input[type="checkbox"]');l==null||l.focus()})};return(l,a)=>(V(),K(x,null,[c("div",null,[t(Z,{modelValue:m.value,"onUpdate:modelValue":a[5]||(a[5]=e=>m.value=e),"max-width":"1000px",persistent:""},{default:o(()=>[t(ea,null,{default:o(()=>[t(la,{class:"text-h6"},{default:o(()=>a[7]||(a[7]=[f("Hata Girişi Ekranı")])),_:1,__:[7]}),t(oa,{class:"pt-4"},{default:o(()=>[t(ra,{ref_key:"formRef",ref:B,modelValue:H.value,"onUpdate:modelValue":a[1]||(a[1]=e=>H.value=e),"lazy-validation":"",onSubmit:a[2]||(a[2]=_(()=>{},["prevent"]))},{default:o(()=>[t(sa,{ref_key:"serinoRef",ref:S,modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),label:"Seri No",variant:"outlined",rules:[e=>!!e||"Seri no zorunlu"],class:"mb-4",onKeydown:q(_(G,["prevent"]),["enter"])},null,8,["modelValue","rules","onKeydown"])]),_:1},8,["modelValue"]),t(O,{dense:""},{default:o(()=>[t(v,{cols:"6",class:"d-flex pa-1 pb-2"}),t(v,{cols:"6",class:"d-flex pa-1 pe-2 pb-3"},{default:o(()=>[t(P(W),{"data-source":g,value:u.value,"display-expr":"title","value-expr":"value",onValueChanged:a[3]||(a[3]=e=>u.value=e.value),height:37},null,8,["value"])]),_:1})]),_:1}),a[8]||(a[8]=c("hr",null,null,-1)),t(ia,null,{default:o(()=>[(V(),K(x,null,w(T,(e,s)=>t(O,{key:s},{default:o(()=>[t(v,{cols:"12"},{default:o(()=>[c("strong",null,M(e.baslik),1)]),_:2},1024),(V(!0),K(x,null,w(e.hatalar,(i,b)=>(V(),Y(v,{key:b,cols:"12",sm:"6",md:"4",class:"py-0 my-0"},{default:o(()=>[t(ma,{modelValue:d.value[i.kod],"onUpdate:modelValue":I=>d.value[i.kod]=I,label:`${i.kod}: ${i.aciklama}`,density:"compact","hide-details":"",class:"py-0 my-0"},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024))),128))]),_:2},1024)),64))]),_:1}),a[9]||(a[9]=c("hr",null,null,-1)),t(da,{label:"Hata Özeti",modelValue:p.value,"onUpdate:modelValue":a[4]||(a[4]=e=>p.value=e),"auto-grow":"",readonly:"",class:"mt-4",variant:"outlined"},null,8,["modelValue"])]),_:1,__:[8,9]}),t(ta,null,{default:o(()=>[t(na),t(E,{text:"",onClick:z},{default:o(()=>a[10]||(a[10]=[f("Vazgeç")])),_:1,__:[10]}),t(E,{disabled:!H.value,color:"primary",onClick:$},{default:o(()=>a[11]||(a[11]=[f("Kaydet")])),_:1,__:[11]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(aa,{modelValue:C.value,"onUpdate:modelValue":a[6]||(a[6]=e=>C.value=e),timeout:3e3,color:"success",location:"top right"},{default:o(()=>[f(M(D.value),1)]),_:1},8,["modelValue"])],64))}});export{Qa as default};
