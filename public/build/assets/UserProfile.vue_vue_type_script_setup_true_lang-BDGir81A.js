const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-NnotjNYg.js","assets/main-0wKr-Em8.css"])))=>i.map(i=>d[i]);
import{d as U,aN as E,aQ as L,q as k,D as $,r as d,c as S,o as y,g as x,m as Y,e as m,b as s,l as e,f as l,y as q,p as v,aF as u,ax as F,T as _,aE as M,aP as j,s as K}from"./main-NnotjNYg.js";import{p as O}from"./cookies-BKoq7nke.js";import{V as Q}from"./VBadge-D8Ro0MLA.js";import{V as Z}from"./VImg-CQk22Lyp.js";import{V as G}from"./VMenu-B3Hgt7h5.js";import{V as H,a as J,d as W}from"./VList-BbF5vTyu.js";import{V as X}from"./VAvatar-gZXSY5M3.js";import{V as ee,a as ae,b as te}from"./VCard-1goAl3aC.js";import{V as oe}from"./VCardText-BHNCWHoQ.js";import{V as C}from"./VTextField-CHe-_6VM.js";import{V as se}from"./VDialog-CdlH7Yp9.js";import{V as le}from"./VSnackbar-BiIZWoYw.js";const re={class:"d-flex align-center gap-2"},ne={class:"d-flex gap-2 align-center"},ie={class:"text-h6 font-weight-medium"},de={class:"px-4 py-2"},ue={class:"px-4 py-2"},pe={class:"d-none d-sm-inline text-body-1 font-weight-medium"},he=U({__name:"UserProfile",setup(fe){const T=E(),D=L(),n=k("userData"),N=$(()=>{const t=n.value;return t?typeof t=="string"?t:t.name||t.fullName||t.username||t.email||"":""}),h=async()=>{try{O()}catch{}k("accessToken").value=null,n.value=null;try{const t=window;t.__appTitleRef&&(t.__appTitleRef.value=null)}catch{}try{const{themeConfig:t,layoutConfig:a}=await j(async()=>{const{themeConfig:o,layoutConfig:b}=await import("./main-NnotjNYg.js").then(R=>R.e$);return{themeConfig:o,layoutConfig:b}},__vite__mapDeps([0,1]));t.app.title="firma adı",a.app.title="firma adı"}catch{}await T.push("/login"),k("userAbilityRules").value=null,D.update([])},p=d(!1),r=d({current_password:"",password:"",password_confirmation:""}),i=d(!1),c=d(!1),w=d(!1),V=d(!1),f=d({show:!1,color:"success",text:""}),g=t=>!!t||"Zorunlu alan",I=t=>((t==null?void 0:t.length)??0)>=8||"En az 8 karakter",z=t=>t!==r.value.current_password||"Yeni şifre mevcut şifreyle aynı olamaz",P=t=>t===r.value.password||"Şifreler uyuşmuyor",A=()=>{r.value={current_password:"",password:"",password_confirmation:""},p.value=!0},B=async()=>{var t,a;if(!(!r.value.current_password||!r.value.password||r.value.password!==r.value.password_confirmation))try{i.value=!0,await K.post("/api/auth/change-password",r.value),f.value={show:!0,color:"success",text:"Şifre güncellendi. Lütfen tekrar giriş yapın."},p.value=!1,setTimeout(()=>{h()},800)}catch(o){const b=((a=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:a.message)||"İşlem sırasında hata oluştu";f.value={show:!0,color:"error",text:String(b)}}finally{i.value=!1}};return(t,a)=>(y(),S("div",re,[e(n)?(y(),x(Q,{key:0,dot:"",bordered:"",location:"bottom right","offset-x":"1","offset-y":"2",color:"success"},{default:l(()=>[s(X,{size:"38",class:"cursor-pointer",color:e(n)&&e(n).avatar?void 0:"primary",variant:e(n)&&e(n).avatar?void 0:"tonal"},{default:l(()=>[e(n)&&e(n).avatar?(y(),x(Z,{key:0,src:e(n).avatar},null,8,["src"])):(y(),x(q,{key:1,icon:"tabler-user"})),s(G,{activator:"parent",width:"240",location:"bottom end",offset:"12px"},{default:l(()=>[s(H,null,{default:l(()=>[s(J,null,{default:l(()=>[m("div",ne,[m("div",null,[m("h6",ie,v(e(n).fullName||e(n).username),1),s(W,{class:"text-capitalize text-disabled"},{default:l(()=>[u(v(e(n).role),1)]),_:1})])])]),_:1}),s(e(F),{options:{wheelPropagation:!1}},{default:l(()=>[m("div",de,[s(_,{block:"",size:"small",color:"primary","append-icon":"tabler-lock-password",onClick:A,class:"mb-2",variant:"tonal"},{default:l(()=>a[9]||(a[9]=[u(" Şifre Değiştir ")])),_:1,__:[9]})]),m("div",ue,[s(_,{block:"",size:"small",color:"error","append-icon":"tabler-logout",onClick:h},{default:l(()=>a[10]||(a[10]=[u(" Çıkış Yap ")])),_:1,__:[10]})])]),_:1})]),_:1})]),_:1})]),_:1},8,["color","variant"])]),_:1})):Y("",!0),m("span",pe,v(e(N)),1),s(se,{modelValue:e(p),"onUpdate:modelValue":a[7]||(a[7]=o=>M(p)?p.value=o:null),"max-width":"420",persistent:""},{default:l(()=>[s(ee,null,{default:l(()=>[s(ae,null,{default:l(()=>a[11]||(a[11]=[u("Şifre Değiştir")])),_:1,__:[11]}),s(oe,null,{default:l(()=>[s(C,{modelValue:e(r).current_password,"onUpdate:modelValue":a[0]||(a[0]=o=>e(r).current_password=o),label:"Mevcut Şifre",type:e(c)?"text":"password",disabled:e(i),autocomplete:"current-password",rules:[g],"append-inner-icon":e(c)?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[1]||(a[1]=o=>c.value=!e(c))},null,8,["modelValue","type","disabled","rules","append-inner-icon"]),s(C,{class:"mt-2",modelValue:e(r).password,"onUpdate:modelValue":a[2]||(a[2]=o=>e(r).password=o),label:"Yeni Şifre",type:e(w)?"text":"password",disabled:e(i),autocomplete:"new-password",rules:[g,I,z],"append-inner-icon":e(w)?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[3]||(a[3]=o=>w.value=!e(w))},null,8,["modelValue","type","disabled","rules","append-inner-icon"]),s(C,{class:"mt-2",modelValue:e(r).password_confirmation,"onUpdate:modelValue":a[4]||(a[4]=o=>e(r).password_confirmation=o),label:"Yeni Şifre (Tekrar)",type:e(V)?"text":"password",disabled:e(i),autocomplete:"new-password",rules:[g,P],"append-inner-icon":e(V)?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[5]||(a[5]=o=>V.value=!e(V))},null,8,["modelValue","type","disabled","rules","append-inner-icon"])]),_:1}),s(te,{class:"justify-end"},{default:l(()=>[s(_,{variant:"tonal",onClick:a[6]||(a[6]=o=>p.value=!1),disabled:e(i)},{default:l(()=>a[12]||(a[12]=[u("Vazgeç")])),_:1,__:[12]},8,["disabled"]),s(_,{color:"primary",onClick:B,loading:e(i)},{default:l(()=>a[13]||(a[13]=[u("Kaydet")])),_:1,__:[13]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(le,{modelValue:e(f).show,"onUpdate:modelValue":a[8]||(a[8]=o=>e(f).show=o),color:e(f).color,timeout:"2500"},{default:l(()=>[u(v(e(f).text),1)]),_:1},8,["modelValue","color"])]))}});export{he as _};
