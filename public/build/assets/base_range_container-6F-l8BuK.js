import{d1 as C,dC as it,d6 as X,a$ as dt,d4 as E,d2 as A,d3 as I,dc as pt}from"./main-MLm3wPHk.js";import{B as ft,y as mt,X as gt,C as bt,D as vt,E as Tt,F as xt,n as at,m as L,I as It,f as G,p as D}from"./m_base_widget-h0QUprfY.js";import{g as S,p as B,c as Ct,L as kt,e as Vt,d as yt}from"./dom_component-BiT_5VJZ.js";import{f as St}from"./format_helper-CsbPpe7k.js";const k=Number;function Y(){this.setDomain(arguments[0],arguments[1]).setCodomain(arguments[2],arguments[3]).setInverted(!1)}Y.prototype={constructor:Y,setDomain:function(t,e){return this._domain1=k(t),this._domain2=k(e),this._domainDelta=this._domain2-this._domain1,this},setCodomain:function(t,e){return this._codomain1=k(t),this._codomain2=k(e),this._codomainDelta=this._codomain2-this._codomain1,this},setInverted(t){this.inverted=t},getDomain:function(){return[this._domain1,this._domain2]},getCodomain:function(){return[this._codomain1,this._codomain2]},getDomainStart:function(){return this._domain1},getDomainEnd:function(){return this._domain2},getCodomainStart:function(){return this._codomain1},getCodomainEnd:function(){return this._codomain2},getDomainRange:function(){return this._domainDelta},getCodomainRange:function(){return this._codomainDelta},translate:function(t){let e=(k(t)-this._domain1)/this._domainDelta;return this.inverted&&(e=1-e),0<=e&&e<=1?this._codomain1+e*this._codomainDelta:NaN},adjust:function(t){const e=(k(t)-this._domain1)/this._domainDelta;let n=NaN;return e<0?n=this._domain1:e>1?n=this._domain2:0<=e&&e<=1&&(n=k(t)),n}};const Q=C,Ot=ft.inherit({ctor(t){this.callBase.apply(this,arguments),this._subTheme=t.subTheme},_initializeTheme:function(){const t=this;let e;t._subTheme&&(e=Q(!0,{},t._theme[t._subTheme],t._theme),Q(!0,t._theme,e)),t.callBase.apply(t,arguments)}}),At={ThemeManager:Ot},x="gauge-tooltip",Bt=kt.add,Mt=it.inherit({ctor:function(t){const e=this;e._element=t.renderer.g().attr({class:"dxg-tracker",stroke:"none","stroke-width":0,fill:"#000000",opacity:1e-4}).linkOn(t.container,{name:"tracker",after:"peripheral"}),e._showTooltipCallback=function(){const n=e._tooltipEvent.target,i=n["gauge-data-target"],a=n["gauge-data-info"];if(e._targetEvent=null,e._tooltipTarget!==n){const o=s=>{s&&(e._tooltipTarget=n)};o(e._callbacks["tooltip-show"](i,a,o))}},e._hideTooltipCallback=function(){e._hideTooltipTimeout=null,e._targetEvent=null,e._tooltipTarget&&(e._callbacks["tooltip-hide"](),e._tooltipTarget=null)},e._dispose=function(){clearTimeout(e._hideTooltipTimeout),e._showTooltipCallback=e._hideTooltipCallback=e._dispose=null}},dispose:function(){return this._dispose(),this.deactivate(),this._element.off("."+x),this._element.linkOff(),this._element=this._context=this._callbacks=null,this},activate:function(){return this._element.linkAppend(),this},deactivate:function(){return this._element.linkRemove().clear(),this},attach:function(t,e,n){return t.data({"gauge-data-target":e,"gauge-data-info":n}).append(this._element),this},detach:function(t){return t.remove(),this},setTooltipState:function(t){const e=this;if(e._element.off("."+x),t){const n={tracker:e};e._element.on(S([B.move],x),n,ot).on(S([B.out],x),n,Et).on(S([B.down],x),n,Dt).on(S([B.up],x),n,Nt).on(S([Ct],x),n,Lt)}return e},setCallbacks:function(t){return this._callbacks=t,this},_showTooltip:function(t){clearTimeout(this._hideTooltipTimeout),this._hideTooltipTimeout=null,this._tooltipTarget!==t.target&&(this._tooltipEvent=t,this._showTooltipCallback())},_hideTooltip:function(t){const e=this;clearTimeout(e._hideTooltipTimeout),t?e._hideTooltipTimeout=setTimeout(e._hideTooltipCallback,t):e._hideTooltipCallback()}});let N=null;function ot(t){const e=t.data.tracker;e._x=t.pageX,e._y=t.pageY,e._showTooltip(t)}function Et(t){t.data.tracker._hideTooltip(100)}function Lt(t){t.data.tracker._hideTooltip()}function Dt(t){const e=N=t.data.tracker;e._touch=!0,ot(t)}function Nt(){N._touch=!1}function wt(t){const e=N;e&&!e._touch&&(e._hideTooltip(100),N=null)}Bt((function(){Vt.subscribeGlobal(yt.getDocument(),S([B.down],x),wt)}));const Pt=Number,$=C,Rt=St.format,g=mt.inherit({_rootClassPrefix:"dxg",_themeSection:"gauge",_titleBBoxCache:null,_createThemeManager:function(){return new At.ThemeManager(this._getThemeManagerOptions())},_initCore:function(){const t=this._renderer.root;this._valueChangingLocker=0,this._translator=this._factory.createTranslator(),this._tracker=this._factory.createTracker({renderer:this._renderer,container:t}),this._setTrackerCallbacks()},_beginValueChanging:function(){this._resetIsReady(),this._onBeginUpdate(),++this._valueChangingLocker},_endValueChanging:function(){--this._valueChangingLocker===0&&this._drawn()},_setTrackerCallbacks:function(){const t=this._renderer,e=this._tooltip;this._tracker.setCallbacks({"tooltip-show":function(n,i,a){const o=n.getTooltipParameters(),s=t.getRootOffset(),c=$({value:o.value,valueText:e.formatValue(o.value),color:o.color},i);return e.show(c,{x:o.x+s.left,y:o.y+s.top,offset:o.offset},{target:i},void 0,a)},"tooltip-hide":function(){return e.hide()}})},_dispose:function(){this._cleanCore(),this.callBase.apply(this,arguments)},_disposeCore:function(){this._themeManager.dispose(),this._tracker.dispose(),this._translator=this._tracker=null},_cleanCore:function(){this._tracker.deactivate(),this._noAnimation=!1,this._cleanContent()},_renderCore:function(){this._isValidDomain&&(this._renderContent(),this._renderGraphicObjects(),this._tracker.setTooltipState(this._tooltip.isEnabled()),this._tracker.activate(),this._noAnimation=!1)},_applyChanges:function(){this.callBase.apply(this,arguments),this._resizing=this._noAnimation=!1},_setContentSize:function(){this._resizing=this._noAnimation=this._changes.count()===2,this.callBase.apply(this,arguments)},_getChangesRequireCoreUpdate:function(){return["DOMAIN","MOSTLY_TOTAL","EXPORT"]},_isTitleBBoxChanged:function(){var t,e,n;const i=this._title.getLayoutOptions(),a=i.height!==((t=this._titleBBoxCache)===null||t===void 0?void 0:t.height),o=i.y!==((e=this._titleBBoxCache)===null||e===void 0?void 0:e.y),s=i.verticalAlignment!==((n=this._titleBBoxCache)===null||n===void 0?void 0:n.verticalAlignment);return this._titleBBoxCache=null,a||o||s},_forceCoreUpdate:function(){return this._changes.has("TITLE")&&!this._getChangesRequireCoreUpdate().some((e=>this._changes.has(e)))?this._isTitleBBoxChanged():!0},_applySize:function(t){const e=this;e._innerRect={left:t[0],top:t[1],right:t[2],bottom:t[3]};const n=e._layout._cache;return e._forceCoreUpdate()&&(e._cleanCore(),e._renderCore()),e._layout._cache=e._layout._cache||n,[t[0],e._innerRect.top,t[2],e._innerRect.bottom]},_initialChanges:["DOMAIN"],_themeDependentChanges:["DOMAIN"],_optionChangesMap:{subtitle:"MOSTLY_TOTAL",indicator:"MOSTLY_TOTAL",geometry:"MOSTLY_TOTAL",animation:"MOSTLY_TOTAL",startValue:"DOMAIN",endValue:"DOMAIN"},_optionChangesOrder:["DOMAIN","MOSTLY_TOTAL"],_change_DOMAIN:function(){this._setupDomain()},_change_MOSTLY_TOTAL:function(){this._applyMostlyTotalChange()},_updateExtraElements:X,_setupDomain:function(){const t=this;t._setupDomainCore(),t._isValidDomain=isFinite(1/(t._translator.getDomain()[1]-t._translator.getDomain()[0])),t._isValidDomain||t._incidentOccurred("W2301"),t._change(["MOSTLY_TOTAL"])},_applyMostlyTotalChange:function(){this._setupCodomain(),this._setupAnimationSettings(),this._setupDefaultFormat(),this._change(["LAYOUT"])},_setupAnimationSettings:function(){const t=this;let e=t.option("animation");t._animationSettings=null,(e===void 0||e)&&(e=$({enabled:!0,duration:1e3,easing:"easeOutCubic"},e),e.enabled&&e.duration>0&&(t._animationSettings={duration:Pt(e.duration),easing:e.easing})),t._containerBackgroundColor=t.option("containerBackgroundColor")||t._themeManager.theme().containerBackgroundColor},_setupDefaultFormat:function(){const t=this._translator.getDomain();this._defaultFormatOptions=gt(t[0],t[1],this._getApproximateScreenRange())},_setupDomainCore:null,_calculateSize:null,_cleanContent:null,_renderContent:null,_setupCodomain:null,_getApproximateScreenRange:null,_factory:{createTranslator:function(){return new Y},createTracker:function(t){return new Mt(t)}}}),H=function(t,e,n){Object.is(t,-0)&&(t=0),e=e||{};const i=Rt(t,e.format);let a;return typeof e.customizeText=="function"?(a=$({value:t,valueText:i},n),String(e.customizeText.call(a,a))):i},Ft=function(t,e){const n=H(t.getDomainStart(),e),i=H(t.getDomainEnd(),e);return n.length>=i.length?n:i};function Ut(t,e){return t&&e&&t.length===e.length&&zt(t,e)}function zt(t,e){let n;const i=t.length;let a,o;for(n=0;n<i;++n)if(a=t[n]!==t[n],o=e[n]!==e[n],!(a&&o)&&t[n]!==e[n])return!1;return!0}g.addPlugin(bt);g.addPlugin(vt);g.addPlugin(Tt);g.addPlugin(xt);const Wt=g.prototype._setTooltipOptions;g.prototype._setTooltipOptions=function(){Wt.apply(this,arguments),this._tracker&&this._tracker.setTooltipState(this._tooltip.isEnabled())};const{_change_TITLE:Gt}=g.prototype;g.prototype._change_TITLE=function(){this._titleBBoxCache=dt({},this._title.getLayoutOptions()),Gt.apply(this,arguments)};const P=Array.isArray,J=isFinite,O=Number,U=Math.min,z=Math.max,j=C,Yt=[1,2,5];function w(t,e){return t===null?t:J(t)?O(t):e}function W(t){return P(t)?t:A(t)?[t]:null}const _e=g.inherit({_initCore:function(){const t=this._renderer;this._setupValue(this.option("value")),this.__subvalues=W(this.option("subvalues")),this._setupSubvalues(this.__subvalues),Ht(this),this.callBase.apply(this,arguments),this._rangeContainer=new this._factory.RangeContainer({renderer:t,container:t.root,translator:this._translator,themeManager:this._themeManager}),this._initScale(),this._subvalueIndicatorContainer=this._renderer.g().attr({class:"dxg-subvalue-indicators"}).linkOn(this._renderer.root,"valueIndicator").enableLinks()},_fontFields:["scale.label.font","valueIndicators.rangebar.text.font","valueIndicators.textcloud.text.font","indicator.text.font"],_initScale:function(){this._scaleGroup=this._renderer.g().attr({class:"dxg-scale"}).linkOn(this._renderer.root,"scale"),this._labelsAxesGroup=this._renderer.g().attr({class:"dxg-scale-elements"}).linkOn(this._renderer.root,"scale-elements"),this._scale=new It({incidentOccurred:this._incidentOccurred,renderer:this._renderer,axesContainerGroup:this._scaleGroup,labelsAxesGroup:this._labelsAxesGroup,axisType:this._scaleTypes.type,drawingType:this._scaleTypes.drawingType,widgetClass:"dxg",getTemplate(){}})},_disposeCore:function(){this.callBase.apply(this,arguments),this._scale.dispose(),this._scaleGroup.linkOff(),this._labelsAxesGroup.linkOff(),this._rangeContainer.dispose(),this._disposeValueIndicators(),this._subvalueIndicatorContainer.linkOff(),this._scale=this._scaleGroup=this._labelsAxesGroup=this._rangeContainer=null},_disposeValueIndicators:function(){this._valueIndicator&&this._valueIndicator.dispose(),this._subvalueIndicatorsSet&&this._subvalueIndicatorsSet.dispose(),this._valueIndicator=this._subvalueIndicatorsSet=null},_setupDomainCore:function(){const t=this.option("scale")||{};let e=this.option("startValue"),n=this.option("endValue");e=A(e)?O(e):A(t.startValue)?O(t.startValue):0,n=A(n)?O(n):A(t.endValue)?O(t.endValue):100,this._baseValue=e<n?e:n,this._translator.setDomain(e,n)},_cleanContent:function(){this._rangeContainer.clean(),this._cleanValueIndicators()},_measureScale:function(t){const e=t.tick,n=e.visible&&e.length>0&&e.width>0,i=t.minorTick,a=i.visible&&i.length>0&&i.width>0,o=t.label,s=Number(o.indentFromTick);if(!n&&!a&&!o.visible)return{};const c=this._scale.measureLabels(C({},this._canvas)),u=this._getScaleLayoutValue(),r={min:u,max:u},b=this._getTicksCoefficients(t),m=b.inner,v=b.outer;return n&&(r.min=U(r.min,u-m*e.length),r.max=z(r.max,u+v*e.length)),a&&(r.min=U(r.min,u-m*i.length),r.max=z(r.max,u+v*i.length)),o.visible&&this._correctScaleIndents(r,s,c),r},_renderContent:function(){const t=this,e=t._prepareScaleSettings();t._rangeContainer.render(j(t._getOption("rangeContainer"),{vertical:t._area.vertical})),t._renderScale(e),t._subvalueIndicatorContainer.linkAppend();const n=L([t._rangeContainer].concat(t._prepareValueIndicators()),(function(i){return i&&i.enabled?i:null}));t._applyMainLayout(n,t._measureScale(e)),n.forEach((i=>i.resize(t._getElementLayout(i.getOffset())))),t._shiftScale(t._getElementLayout(0),e),t._beginValueChanging(),t._updateActiveElements(),t._endValueChanging()},_prepareScaleSettings:function(){const t=this,e=t.option("scale"),n=C(!0,{},t._themeManager.theme("scale"),e);return n.label.indentFromAxis=0,n.isHorizontal=!t._area.vertical,n.forceUserTickInterval|=E(e)&&E(e.tickInterval)&&!E(e.scaleDivisionFactor),n.axisDivisionFactor=n.scaleDivisionFactor||t._gridSpacingFactor,n.minorAxisDivisionFactor=n.minorScaleDivisionFactor||5,n.numberMultipliers=Yt,n.tickOrientation=t._getTicksOrientation(n),n.label.useRangeColors&&(n.label.customizeColor=function(){return t._rangeContainer.getColorForValue(this.value)}),n},_renderScale:function(t){const e=this._translator.getDomain(),n=e[0],i=e[1],a=this._translator.getCodomain(),o=!!(n>i^t.inverted),s=U(n,i),c=z(n,i);t.min=s,t.max=c,t.startAngle=90-a[0],t.endAngle=90-a[1],t.skipViewportExtending=!0,t.inverted=o,this._scale.updateOptions(t),this._scale.setBusinessRange({axisType:"continuous",dataType:"numeric",min:s,max:c,invert:o}),this._updateScaleTickIndent(t),this._scaleGroup.linkAppend(),this._labelsAxesGroup.linkAppend(),this._scale.draw(C({},this._canvas))},_updateIndicatorSettings:function(t){const e=this;t.currentValue=t.baseValue=J(e._translator.translate(t.baseValue))?O(t.baseValue):e._baseValue,t.vertical=e._area.vertical,t.text&&!t.text.format&&(t.text.format=e._defaultFormatOptions)},_prepareIndicatorSettings:function(t,e){const n=this._themeManager.theme("valueIndicators"),i=at(t.type||this._themeManager.theme(e)),a=j(!0,{},n._default,n[i],t);return a.type=i,a.animation=this._animationSettings,a.containerBackgroundColor=this._containerBackgroundColor,this._updateIndicatorSettings(a),a},_cleanValueIndicators:function(){this._valueIndicator&&this._valueIndicator.clean(),this._subvalueIndicatorsSet&&this._subvalueIndicatorsSet.clean()},_prepareValueIndicators:function(){return this._prepareValueIndicator(),this.__subvalues!==null&&this._prepareSubvalueIndicators(),[this._valueIndicator,this._subvalueIndicatorsSet]},_updateActiveElements:function(){this._updateValueIndicator(),this._updateSubvalueIndicators()},_prepareValueIndicator:function(){const t=this;let e=t._valueIndicator;const n=t._prepareIndicatorSettings(t.option("valueIndicator")||{},"valueIndicatorType");e&&e.type!==n.type&&(e.dispose(),e=null),e||(e=t._valueIndicator=t._createIndicator(n.type,t._renderer.root,"dxg-value-indicator","value-indicator")),e.render(n)},_createSubvalueIndicatorsSet:function(){const t=this,e=t._subvalueIndicatorContainer;return new q({createIndicator:function(n,i){return t._createIndicator(n,e,"dxg-subvalue-indicator","subvalue-indicator",i)},createPalette:function(n){return t._themeManager.createPalette(n)}})},_prepareSubvalueIndicators:function(){const t=this;let e=t._subvalueIndicatorsSet;const n=t._prepareIndicatorSettings(t.option("subvalueIndicator")||{},"subvalueIndicatorType");e||(e=t._subvalueIndicatorsSet=t._createSubvalueIndicatorsSet());const i=n.type!==e.type;e.type=n.type;const a=t._createIndicator(n.type,t._renderer.root);a&&(a.dispose(),e.render(n,i))},_setupValue:function(t){this.__value=w(t,this.__value)},_setupSubvalues:function(t){const e=t===void 0?this.__subvalues:W(t);let n,i,a;if(e!==null){for(n=0,i=e.length,a=[];n<i;++n)a.push(w(e[n],this.__subvalues[n]));this.__subvalues=a}},_updateValueIndicator:function(){this._valueIndicator&&this._valueIndicator.value(this.__value,this._noAnimation)},_updateSubvalueIndicators:function(){this._subvalueIndicatorsSet&&this._subvalueIndicatorsSet.values(this.__subvalues,this._noAnimation)},value:function(t){return t!==void 0?(this._changeValue(t),this):this.__value},subvalues:function(t){return t!==void 0?(this._changeSubvalues(t),this):this.__subvalues!==null?this.__subvalues.slice():void 0},_changeValue:function(t){this._setupValue(t),this._beginValueChanging(),this._updateValueIndicator(),this._updateExtraElements(),this.__value!==this.option("value")&&this.option("value",this.__value),this._endValueChanging()},_changeSubvalues:function(t){this.__subvalues!==null?(this._setupSubvalues(t),this._beginValueChanging(),this._updateSubvalueIndicators(),this._updateExtraElements(),this._endValueChanging()):(this.__subvalues=W(t),this._setContentSize(),this._renderContent()),Ut(this.__subvalues,this.option("subvalues"))||this.option("subvalues",this.__subvalues)},_optionChangesMap:{scale:"DOMAIN",rangeContainer:"MOSTLY_TOTAL",valueIndicator:"MOSTLY_TOTAL",subvalueIndicator:"MOSTLY_TOTAL",containerBackgroundColor:"MOSTLY_TOTAL",value:"VALUE",subvalues:"SUBVALUES",valueIndicators:"MOSTLY_TOTAL"},_customChangesOrder:["VALUE","SUBVALUES"],_change_VALUE:function(){this._changeValue(this.option("value"))},_change_SUBVALUES:function(){this._changeSubvalues(this.option("subvalues"))},_applyMainLayout:null,_getElementLayout:null,_createIndicator:function(t,e,n,i,a,o){const s=this._factory.createIndicator({renderer:this._renderer,translator:this._translator,owner:e,tracker:this._tracker,className:n},t,o);return s&&(s.type=t,s._trackerInfo={type:i,index:a}),s},_getApproximateScreenRange:null});function $t(t){return t?t.value:null}function Z(t,e,n){const i=t[e],a=P(n)?L(n,$t):[];let o=0;const s=a.length,c=[];for(;o<s;++o)c.push(w(a[o],i[o]));t[e]=c}function Ht(t){t.option("value")===void 0&&t.option("subvalues")===void 0&&t.option("valueIndicators")!==void 0&&(jt(t),qt(t))}function jt(t){t.value=t.subvalues=X,t._setupValue=t._setupSubvalues=t._updateValueIndicator=t._updateSubvalueIndicators=null}function qt(t){t._indicatorValues=[],Z(t,"_indicatorValues",t.option("valueIndicators")),t._valueIndicators=[];const e=t._applyMostlyTotalChange;t._applyMostlyTotalChange=function(){Z(this,"_indicatorValues",this.option("valueIndicators")),e.call(this)},t._updateActiveElements=Xt,t._prepareValueIndicators=Jt,t._disposeValueIndicators=Kt,t._cleanValueIndicators=Qt,t.indicatorValue=Zt}function Xt(){const t=this;t._valueIndicators.forEach((e=>{e.value(t._indicatorValues[e.index],t._noAnimation)}))}function Jt(){const t=this,e=t._valueIndicators||[],n=t.option("valueIndicators"),i=[];let a=0,o;for(o=P(n)?n.length:0;a<o;++a)i.push(n[a]);for(o=e.length;a<o;++a)i.push(null);const s=[];return i.forEach(((c,u)=>{let r=e[u];if(!c){r&&r.dispose();return}const b=t._prepareIndicatorSettings(c,"valueIndicatorType");r&&r.type!==b.type&&(r.dispose(),r=null),r||(r=t._createIndicator(b.type,t._renderer.root,"dxg-value-indicator","value-indicator",u,!0)),r&&(r.index=u,r.render(b),s.push(r))})),t._valueIndicators=s,t._valueIndicators}function Kt(){this._valueIndicators.forEach((t=>t.dispose())),this._valueIndicators=null}function Qt(){this._valueIndicators.forEach((t=>t.clean()))}function Zt(t,e){return te(this,this._valueIndicators,this._indicatorValues,t,e)}function te(t,e,n,i,a){return a!==void 0?(n[i]!==void 0&&(n[i]=w(a,n[i]),e[i]&&e[i].value(n[i])),t):n[i]}function q(t){this._parameters=t,this._indicators=[]}q.prototype={constructor:q,dispose:function(){return this._indicators.forEach((t=>t.dispose())),this._parameters=this._options=this._indicators=this._colorPalette=this._palette=null,this},clean:function(){return this._sample&&this._sample.clean().dispose(),this._indicators.forEach((t=>t.clean())),this._sample=this._options=this._palette=null,this},render:function(t,e){const n=this;return n._options=t,n._sample=n._parameters.createIndicator(n.type),n._sample.render(t),n.enabled=n._sample.enabled,n._palette=E(t.palette)?n._parameters.createPalette(t.palette):null,n.enabled&&(n._generatePalette(n._indicators.length),n._indicators=L(n._indicators,(function(i,a){return e&&(i.dispose(),i=n._parameters.createIndicator(n.type,a)),i.render(n._getIndicatorOptions(a)),i}))),n},getOffset:function(){return this._sample.getOffset()},resize:function(t){return this._layout=t,this._indicators.forEach((e=>e.resize(t))),this},measure:function(t){return this._sample.measure(t)},_getIndicatorOptions:function(t){let e=this._options;return this._colorPalette&&(e=j({},e,{color:this._colorPalette[t]})),e},_generatePalette:function(t){const e=this;let n=null;e._palette&&(e._palette.reset(),n=e._palette.generateColors(t,{repeat:!0})),e._colorPalette=n},_adjustIndicatorsCount:function(t){const e=this,n=e._indicators;let i,a,o;const s=n.length;if(s>t){for(i=t,a=s;i<a;++i)n[i].clean().dispose();e._indicators=n.slice(0,t),e._generatePalette(n.length)}else if(s<t)for(e._generatePalette(t),i=s,a=t;i<a;++i)o=e._parameters.createIndicator(e.type,i),o.render(e._getIndicatorOptions(i)).resize(e._layout),n.push(o)},values:function(t,e){const n=this;if(n.enabled)return t!==void 0?(P(t)||(t=J(t)?[Number(t)]:null),t&&(n._adjustIndicatorsCount(t.length),n._indicators.forEach(((i,a)=>i.value(t[a],e)))),n):L(n._indicators,(function(i){return i.value()}))}};function he(t){return function(e,n,i){const a=t[at(n)]||!i&&t._default;return a?new a(e):null}}const ee=isFinite,st=Number,p=Math.round,rt=H,lt=Ft,ct=it.inherit({ctor:function(t){const e=this;I(t,(function(n,i){e["_"+n]=i})),e._init()},dispose:function(){const t=this;return t._dispose(),I(t,(function(e){t[e]=null})),t},getOffset:function(){return st(this._options.offset)||0}}),ut=ct.inherit({_init:function(){this._rootElement=this._createRoot().linkOn(this._owner,{name:"value-indicator",after:"core"}),this._trackerElement=this._createTracker()},_dispose:function(){this._rootElement.linkOff()},_setupAnimation:function(){const t=this;t._options.animation&&(t._animation={step:function(e){t._actualValue=t._animation.start+t._animation.delta*e,t._actualPosition=t._translator.translate(t._actualValue),t._move()},duration:t._options.animation.duration>0?st(t._options.animation.duration):0,easing:t._options.animation.easing})},_runAnimation:function(t){const e=this._animation;e.start=this._actualValue,e.delta=t-this._actualValue,this._rootElement.animate({_:0},{step:e.step,duration:e.duration,easing:e.easing})},_createRoot:function(){return this._renderer.g().attr({class:this._className})},_createTracker:function(){return this._renderer.path([],"area")},_getTrackerSettings:X,clean:function(){return this._animation&&this._rootElement.stopAnimation(),this._rootElement.linkRemove().clear(),this._clear(),this._tracker.detach(this._trackerElement),this._options=this.enabled=this._animation=null,this},render:function(t){const e=this;return e.type=t.type,e._options=t,e._actualValue=e._currentValue=e._translator.adjust(e._options.currentValue),e.enabled=e._isEnabled(),e.enabled&&(e._setupAnimation(),e._rootElement.attr({fill:G(e._options.color)}).linkAppend(),e._tracker.attach(e._trackerElement,e,e._trackerInfo)),e},resize:function(t){const e=this;return e._rootElement.clear(),e._clear(),e.visible=e._isVisible(t),e.visible&&(C(e._options,t),e._actualPosition=e._translator.translate(e._actualValue),e._render(),e._trackerElement.attr(e._getTrackerSettings()),e._move()),e},value:function(t,e){const n=this;let i;const a=this._rootElement;let o=null;return t===void 0?n._currentValue:(t===null?(o="hidden",n._currentValue=t):(i=n._translator.adjust(t),n._currentValue!==i&&ee(i)&&(n._currentValue=i,n.visible&&(n._animation&&!e?n._runAnimation(i):(n._actualValue=i,n._actualPosition=n._translator.translate(i),n._move())))),a.attr({visibility:o}),n)},_isEnabled:null,_isVisible:null,_render:null,_clear:null,_move:null}),_={};_["right-bottom"]=_.rb=[0,-1,-1,0,0,1,1,0];_["bottom-right"]=_.br=[-1,0,0,-1,1,0,0,1];_["left-bottom"]=_.lb=[0,-1,1,0,0,1,-1,0];_["bottom-left"]=_.bl=[1,0,0,-1,-1,0,0,1];_["left-top"]=_.lt=[0,1,1,0,0,-1,-1,0];_["top-left"]=_.tl=[1,0,0,1,-1,0,0,-1];_["right-top"]=_.rt=[0,1,-1,0,0,-1,1,0];_["top-right"]=_.tr=[-1,0,0,1,1,0,0,-1];function ne(t){let e=t.x,n=t.y;const i=_[t.type],a=t.cloudWidth,o=t.cloudHeight;let s,c;const u=e,r=n;return s=c=t.tailLength,1&i[0]?c=Math.min(c,o/3):s=Math.min(s,a/3),{cx:p(u+i[0]*s+(i[0]+i[2])*a/2),cy:p(r+i[1]*c+(i[1]+i[3])*o/2),points:[p(e),p(n),p(e+=i[0]*(a+s)),p(n+=i[1]*(o+c)),p(e+=i[2]*a),p(n+=i[3]*o),p(e+=i[4]*a),p(n+=i[5]*o),p(e+=i[6]*(a-s)),p(n+=i[7]*(o-c))]}}const de=ut.inherit({_move:function(){const t=this._options,e=this._getTextCloudOptions(),n=rt(this._actualValue,t.text);this._text.attr({text:n});const i=this._text.getBBox(),a=e.x,o=e.y,s=(i.width||n.length*this._textUnitWidth)+2*t.horizontalOffset,c=(i.height||this._textHeight)+2*t.verticalOffset,u=ne({x:a,y:o,cloudWidth:s,cloudHeight:c,tailLength:t.arrowLength,type:this._correctCloudType(e.type,{x:a,y:o},{width:s,height:c})});this._text.attr({x:u.cx,y:u.cy+this._textVerticalOffset}),this._cloud.attr({points:u.points}),this._trackerElement&&this._trackerElement.attr({points:u.points})},_measureText:function(){const t=this;let e,n,i,a;t._textVerticalOffset||(e=t._createRoot().append(t._owner),a=lt(t._translator,t._options.text),n=t._renderer.text(a,0,0).attr({align:"center"}).css(D(t._options.text.font)).append(e),i=n.getBBox(),e.remove(),t._textVerticalOffset=-i.y-i.height/2,t._textWidth=i.width,t._textHeight=i.height,t._textUnitWidth=t._textWidth/a.length,t._textFullWidth=t._textWidth+2*t._options.horizontalOffset,t._textFullHeight=t._textHeight+2*t._options.verticalOffset)},_render:function(){this._measureText(),this._cloud=this._cloud||this._renderer.path([],"area").append(this._rootElement),this._text=this._text||this._renderer.text().append(this._rootElement),this._text.attr({align:"center"}).css(D(this._options.text.font))},_clear:function(){delete this._cloud,delete this._text},getTooltipParameters:function(){const t=this._getTextCloudOptions();return{x:t.x,y:t.y,value:this._currentValue,color:this._options.color}},_correctCloudType:t=>t}),pe=ut.inherit({_measureText:function(){const t=this;let e,n,i;t._hasText=t._isTextVisible(),t._hasText&&!t._textVerticalOffset&&(e=t._createRoot().append(t._owner),n=t._renderer.text(lt(t._translator,t._options.text),0,0).attr({class:"dxg-text",align:"center"}).css(D(t._options.text.font)).append(e),i=n.getBBox(),e.remove(),t._textVerticalOffset=-i.y-i.height/2,t._textWidth=i.width,t._textHeight=i.height)},_move:function(){const t=this;t._updateBarItemsPositions(),t._hasText&&(t._text.attr({text:rt(t._actualValue,t._options.text)}),t._updateTextPosition(),t._updateLinePosition())},_updateBarItems:function(){const t=this,e=t._options;let n;const i=t._translator;t._setBarSides(),t._startPosition=i.translate(i.getDomainStart()),t._endPosition=i.translate(i.getDomainEnd()),t._basePosition=i.translate(e.baseValue),t._space=t._getSpace();const a=e.backgroundColor||"none";a!=="none"&&t._space>0?n=e.containerBackgroundColor||"none":(t._space=0,n="none"),t._backItem1.attr({fill:a}),t._backItem2.attr({fill:a}),t._spaceItem1.attr({fill:n}),t._spaceItem2.attr({fill:n})},_getSpace:function(){return 0},_updateTextItems:function(){const t=this;t._hasText?(t._line=t._line||t._renderer.path([],"line").attr({class:"dxg-main-bar","stroke-linecap":"square"}).append(t._rootElement),t._text=t._text||t._renderer.text("",0,0).attr({class:"dxg-text"}).append(t._rootElement),t._text.attr({align:t._getTextAlign()}).css(t._getFontOptions()),t._setTextItemsSides()):(t._line&&(t._line.remove(),delete t._line),t._text&&(t._text.remove(),delete t._text))},_isTextVisible:function(){return!1},_getTextAlign:function(){return"center"},_getFontOptions:function(){const t=this._options;let e=t.text.font;return(!e||!e.color)&&(e=C({},e,{color:t.color})),D(e)},_updateBarItemsPositions:function(){const t=this._getPositions();this._backItem1.attr(this._buildItemSettings(t.start,t.back1)),this._backItem2.attr(this._buildItemSettings(t.back2,t.end)),this._spaceItem1.attr(this._buildItemSettings(t.back1,t.main1)),this._spaceItem2.attr(this._buildItemSettings(t.main2,t.back2)),this._mainItem.attr(this._buildItemSettings(t.main1,t.main2)),this._trackerElement&&this._trackerElement.attr(this._buildItemSettings(t.main1,t.main2))},_render:function(){const t=this;t._measureText(),t._backItem1||(t._backItem1=t._createBarItem(),t._backItem1.attr({class:"dxg-back-bar"})),t._backItem2||(t._backItem2=t._createBarItem(),t._backItem2.attr({class:"dxg-back-bar"})),t._spaceItem1||(t._spaceItem1=t._createBarItem(),t._spaceItem1.attr({class:"dxg-space-bar"})),t._spaceItem2||(t._spaceItem2=t._createBarItem(),t._spaceItem2.attr({class:"dxg-space-bar"})),t._mainItem||(t._mainItem=t._createBarItem(),t._mainItem.attr({class:"dxg-main-bar"})),t._updateBarItems(),t._updateTextItems()},_clear:function(){delete this._backItem1,delete this._backItem2,delete this._spaceItem1,delete this._spaceItem2,delete this._mainItem,delete this._hasText,delete this._line,delete this._text},getTooltipParameters:function(){const t=this._getTooltipPosition();return{x:t.x,y:t.y,value:this._currentValue,color:this._options.color,offset:0}}}),tt=Number,et=Array.isArray,nt=isFinite,fe=ct.inherit({_init:function(){this._root=this._renderer.g().attr({class:"dxg-range-container"}).linkOn(this._container,"range-container")},_dispose:function(){this._root.linkOff()},clean:function(){return this._root.linkRemove().clear(),this._options=this.enabled=null,this},_getRanges:function(){const t=this._options,e=this._translator,n=e.getDomain()[0],i=e.getDomain()[1],a=i-n,o=a>=0?oe:se,s=a>=0?ie:ae;let c=[],u=[],r=[{start:n,end:i}];const b=G(t.backgroundColor)||"none",m=t.width||{},v=tt(m>0?m:m.start),R=tt(m>0?m:m.end),K=R-v;if(t.ranges!==void 0&&!et(t.ranges)||!(v>=0&&R>=0&&v+R>0))return null;c=(et(t.ranges)?t.ranges:[]).reduce(((V,l,d)=>{l=l||{};const T=e.adjust(l.startValue),h=e.adjust(l.endValue);return nt(T)&&nt(h)&&o(T,h,l)&&V.push({start:T,end:h,color:G(l.color),classIndex:d}),V}),[]);const ht=this._themeManager.createPalette(t.palette,{type:"indicatingSet",extensionMode:t.paletteExtensionMode,keepLastColorInEnd:!0,count:c.length});return I(c,(function(V,l){const d=ht.getNextColor();l.color=pt(l.color)&&l.color||d||"none",l.className="dxg-range dxg-range-"+l.classIndex,delete l.classIndex})),I(c,(function(V,l){let d,T,h,y,f;const M=[],F=[];for(d=0,T=u.length;d<T;++d)f=u[d],y=s(f.start,f.end,l.start,l.end),(h=y[0])&&(h.color=f.color)&&(h.className=f.className)&&M.push(h),(h=y[1])&&(h.color=f.color)&&(h.className=f.className)&&M.push(h);for(M.push(l),u=M,d=0,T=r.length;d<T;++d)f=r[d],y=s(f.start,f.end,l.start,l.end),(h=y[0])&&F.push(h),(h=y[1])&&F.push(h);r=F})),I(r,(function(V,l){l.color=b,l.className="dxg-range dxg-background-range",u.push(l)})),I(u,(function(V,l){l.startWidth=(l.start-n)/a*K+v,l.endWidth=(l.end-n)/a*K+v})),u},render:function(t){const e=this;return e._options=t,e._processOptions(),e._ranges=e._getRanges(),e._ranges&&(e.enabled=!0,e._root.linkAppend()),e},resize:function(t){const e=this;return e._root.clear(),e._isVisible(t)&&I(e._ranges,(function(n,i){e._createRange(i,t).attr({fill:i.color,class:i.className}).append(e._root)})),e},_processOptions:null,_isVisible:null,_createRange:null,getColorForValue:function(t){let e=null;return I(this._ranges,(function(n,i){if(i.start<=t&&t<=i.end||i.start>=t&&t>=i.end)return e=i.color,!1})),e}});function ie(t,e,n,i){let a;return n>t&&i<e?a=[{start:t,end:n},{start:i,end:e}]:n>=e||i<=t?a=[{start:t,end:e}]:n<=t&&i>=e?a=[]:n>t?a=[{start:t,end:n}]:i<e&&(a=[{start:i,end:e}]),a}function ae(t,e,n,i){let a;return n<t&&i>e?a=[{start:t,end:n},{start:i,end:e}]:n<=e||i>=t?a=[{start:t,end:e}]:n>=t&&i<=e?a=[]:n<t?a=[{start:t,end:n}]:i>e&&(a=[{start:i,end:e}]),a}function _t(t,e,n){let{startValue:i,endValue:a}=n;return a===i&&i===t&&e===t}function oe(t,e,n){return e-t>0||_t(t,e,n)}function se(t,e,n){return t-e>0||_t(t,e,n)}export{ut as B,de as a,pe as b,fe as c,_e as d,g as e,he as f};
