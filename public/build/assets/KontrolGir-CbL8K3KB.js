import{d as L,r,w as p,b4 as h,c as x,e as f,b as t,f as o,F as K,o as c,t as V,b0 as _,d3 as P,m as q,i as w,v as E,g as Y,ae as M,a$ as Z,aZ as O}from"./main-BuFlbFoB.js";import{n as J}from"./notify-qKnweBmz.js";import{D as Q}from"./select-box-BGOVQe5m.js";import{A as W}from"./m_select_box-DZLf6r2f.js";import{V as X}from"./VDialog-sxTjtzBW.js";import{V as aa}from"./VSnackbar-DkGpjpSm.js";import{V as ea,a as la,b as ta}from"./VCard-DEtsoI_r.js";import{V as oa}from"./VCardText-DTHkAN_U.js";import{V as ra}from"./VForm-CUOjMAU_.js";import{V as sa}from"./VTextField-kEUWuOqC.js";import{V as U}from"./VRow-upMvWQZB.js";import{V as v}from"./VCol-Cmdke4Ye.js";import{V as ia}from"./VContainer-B-p9C8vi.js";import{V as ma}from"./VCheckbox-o84l82UW.js";import{V as da}from"./VTextarea-CjUADxPA.js";import{V as na}from"./VSpacer-CP5c71CA.js";import"./overlay-BR4TYQUy.js";import"./themes-CC9uNzK4.js";import"./editor-Dyo8zyyT.js";import"./VOverlay-Ch4F6s8E.js";import"./easing-Bybner-F.js";import"./delay-Cnb0ZFPa.js";import"./lazy-10-C2jWw.js";import"./scopeId-C4A71ple.js";import"./VImg-B96WrjZ5.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-DykugV7V.js";import"./VAvatar-upru2IB3.js";import"./form-CH1KWc_x.js";/* empty css                   */import"./VCounter-NuYK0B5N.js";import"./VField-DOB4DUX_.js";import"./focus-XlYqf9t_.js";import"./VInput-DVNYuhM3.js";/* empty css              */import"./VCheckboxBtn-DwxcjTMS.js";import"./VSelectionControl-8grhmBCm.js";const Ya=L({__name:"KontrolGir",props:{modelValue:Boolean,masterId:Number},emits:["update:modelValue"],setup(A,{emit:R}){const S=r(),y=A,D=R,C=r(!1),F=r(""),B=r(),H=r(!1),n=r(""),u=r(""),k=r(""),m=r(y.modelValue);p(()=>y.modelValue,l=>m.value=l),p(m,l=>D("update:modelValue",l));const g=[{title:"✔️ Onaylandı",value:"Onaylandı",color:"#d4edda"},{title:"❌ Red",value:"Red",color:"#f8d7da"},{title:"⚠️ Şartlı Onay",value:"Şartlı Onay",color:"#fff3cd"}];new W({data:g,key:"value"});const j=()=>{O(()=>{var l;(l=S.value)==null||l.focus()})};p(m,l=>{l&&j()});const d=r({}),N=h("userData"),z=[{baslik:"İş Emri Hataları",hatalar:[{kod:"IEH",aciklama:"İş Emri Hatası"},{kod:"SPH",aciklama:"Sipariş Hatası"},{kod:"TH",aciklama:"Taşeron Hatası"},{kod:"EH",aciklama:"Etiket Hatası"}]},{baslik:"Malzeme Hataları",hatalar:[{kod:"CM",aciklama:"Çapaklı Malzeme"},{kod:"SMH",aciklama:"Saç Malzeme Hatası"},{kod:"KH",aciklama:"Kilit Hatası"},{kod:"FB",aciklama:"Formda Bozukluk"},{kod:"CC",aciklama:"Camda Çizik"},{kod:"OH",aciklama:"Ölçüsel Hata"},{kod:"19''H",aciklama:"19'' Ölçü Hatası"},{kod:"AH",aciklama:"Aksesuar Hatası"},{kod:"KPL",aciklama:"Kaplama Hatası"}]},{baslik:"Montaj Hataları",hatalar:[{kod:"MH",aciklama:"Montaj Hatası"},{kod:"TKH",aciklama:"Topraklama Hatası"},{kod:"KAH",aciklama:"Kaynak Hatası"},{kod:"BKE",aciklama:"Bağlantı Kalemi Eksik"},{kod:"BKS",aciklama:"Bağlantı Kalemi Sıkılmamış"},{kod:"ELK",aciklama:"Elektrik Hatası"},{kod:"STH",aciklama:"Su Testi Hatası"}]},{baslik:"Yüzey / Boya Hataları",hatalar:[{kod:"BC",aciklama:"Boyada Çizik"},{kod:"BH",aciklama:"Boya Hatası"},{kod:"SH",aciklama:"Serigrafi Hatası"}]}];p(d,()=>{const l=Object.entries(d.value).filter(([a,e])=>e).map(([a])=>{const e=z.flatMap(s=>s.hatalar).find(s=>s.kod===a);return e?`${a}: ${e.aciklama}`:a});k.value=l.join(", ")},{deep:!0});const $=async()=>{var l,a;try{const e=Object.entries(d.value).filter(([i,b])=>b).map(([i])=>i),s={serino:n.value,hatalar:e,sonuc:u.value,urun_kontrol_m_id:y.masterId,user_id:N.value.id};await Z.post("/api/hata-kaydet",s),J({message:"Kayıt başarılı!",type:"success",displayTime:2e3}),T()}catch(e){console.error(e),(a=(l=e.response)==null?void 0:l.data)!=null&&a.message?alert(e.response.data.message):alert("Kayıt sırasında hata oluştu.")}},T=()=>{var l;(l=B.value)==null||l.reset(),n.value="",u.value=!1,k.value="",d.value={},m.value=!1},G=()=>{O(()=>{const l=document.querySelector('input[type="checkbox"]');l==null||l.focus()})};return(l,a)=>(c(),x(K,null,[f("div",null,[t(X,{modelValue:m.value,"onUpdate:modelValue":a[5]||(a[5]=e=>m.value=e),"max-width":"1000px",persistent:""},{default:o(()=>[t(ea,null,{default:o(()=>[t(la,{class:"text-h6"},{default:o(()=>a[7]||(a[7]=[V("Hata Girişi Ekranı")])),_:1,__:[7]}),t(oa,{class:"pt-4"},{default:o(()=>[t(ra,{ref_key:"formRef",ref:B,modelValue:H.value,"onUpdate:modelValue":a[1]||(a[1]=e=>H.value=e),"lazy-validation":"",onSubmit:a[2]||(a[2]=_(()=>{},["prevent"]))},{default:o(()=>[t(sa,{ref_key:"serinoRef",ref:S,modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),label:"Seri No",variant:"outlined",rules:[e=>!!e||"Seri no zorunlu"],class:"mb-4",onKeydown:P(_(G,["prevent"]),["enter"])},null,8,["modelValue","rules","onKeydown"])]),_:1},8,["modelValue"]),t(U,{dense:""},{default:o(()=>[t(v,{cols:"6",class:"d-flex pa-1 pb-2"}),t(v,{cols:"6",class:"d-flex pa-1 pe-2 pb-3"},{default:o(()=>[t(q(Q),{"data-source":g,value:u.value,"display-expr":"title","value-expr":"value",onValueChanged:a[3]||(a[3]=e=>u.value=e.value),height:37},null,8,["value"])]),_:1})]),_:1}),a[8]||(a[8]=f("hr",null,null,-1)),t(ia,null,{default:o(()=>[(c(),x(K,null,w(z,(e,s)=>t(U,{key:s},{default:o(()=>[t(v,{cols:"12"},{default:o(()=>[f("strong",null,E(e.baslik),1)]),_:2},1024),(c(!0),x(K,null,w(e.hatalar,(i,b)=>(c(),Y(v,{key:b,cols:"12",sm:"6",md:"4",class:"py-0 my-0"},{default:o(()=>[t(ma,{modelValue:d.value[i.kod],"onUpdate:modelValue":I=>d.value[i.kod]=I,label:`${i.kod}: ${i.aciklama}`,density:"compact","hide-details":"",class:"py-0 my-0"},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024))),128))]),_:2},1024)),64))]),_:1}),a[9]||(a[9]=f("hr",null,null,-1)),t(da,{label:"Hata Özeti",modelValue:k.value,"onUpdate:modelValue":a[4]||(a[4]=e=>k.value=e),"auto-grow":"",readonly:"",class:"mt-4",variant:"outlined"},null,8,["modelValue"])]),_:1,__:[8,9]}),t(ta,null,{default:o(()=>[t(na),t(M,{text:"",onClick:T},{default:o(()=>a[10]||(a[10]=[V("Vazgeç")])),_:1,__:[10]}),t(M,{disabled:!H.value,color:"primary",onClick:$},{default:o(()=>a[11]||(a[11]=[V("Kaydet")])),_:1,__:[11]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(aa,{modelValue:C.value,"onUpdate:modelValue":a[6]||(a[6]=e=>C.value=e),timeout:3e3,color:"success",location:"top right"},{default:o(()=>[V(E(F.value),1)]),_:1},8,["modelValue"])],64))}});export{Ya as default};
